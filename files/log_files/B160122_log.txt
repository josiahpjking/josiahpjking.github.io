

	####### B160122 R script #######

library(psych, quietly = T)
[1] 1
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(ggplot2, quietly = T)
[1] 2
 [1] "ggplot2"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
load(url("https://edin.ac/2QCZNVu"))
[1] 3
[1] "drinkdriving" "officer_inc" 
summary(drinkdriving)
[1] 4
      age          nighttime         prior_offence          speed             bac           outcome          incident_id       
 Min.   : 14.00   Length:250         Length:250         Min.   :  0.00   Min.   : 3.987   Length:250         Length:250        
 1st Qu.: 30.00   Class :character   Class :character   1st Qu.: 30.92   1st Qu.:19.264   Class :character   Class :character  
 Median : 40.50   Mode  :character   Mode  :character   Median : 40.64   Median :23.609   Mode  :character   Mode  :character  
 Mean   : 46.00                                         Mean   : 40.49   Mean   :23.605                                        
 3rd Qu.: 55.25                                         3rd Qu.: 48.84   3rd Qu.:27.898                                        
 Max.   :297.00                                         Max.   :120.34   Max.   :65.764                                        
 NA's   :22                                                              NA's   :5                                             
describe(drinkdriving)
[1] 5
               vars   n mean    sd median trimmed   mad min  max range skew kurtosis   se
age               1 228   46 33.35   40.5   42.34 18.53  14  297   283  5.5    38.49 2.21
nighttime*        2 250  NaN    NA     NA     NaN    NA Inf -Inf  -Inf   NA       NA   NA
prior_offence*    3 250  NaN    NA     NA     NaN    NA Inf -Inf  -Inf   NA       NA   NA
 [ reached 'max' / getOption("max.print") -- omitted 4 rows ]
hist(drinkdriving$age)
[1] 6
drinkdriving$age[drinkdriving$age > 100] <- NA
[1] 7
table(drinkdriving$nighttime)
[1] 8

18:25  2:05   day night 
    1     2    78   169 
drinkdriving$nighttime[drinkdriving$nighttime == "18:25"] <- "day"
[1] 9
drinkdriving$nighttime[drinkdriving$nighttime == "2:05"] <- "night"
[1] 10
drinkdriving$nighttime <- factor(drinkdriving$nighttime)
[1] 11
table(drinkdriving$prior_offence)
[1] 12

          CD10           CD60 CD60,CD10,DR80      CD60,CD60           DD20           DR50           DR80              N           PL10 
             2              1              1              1              4             43              4            185              2 
          SP50           SP60           TS70      TS70,DR50 
             2              1              3              1 
drinkdriving$prior_offence[drinkdriving$prior_offence == "SP50" | 
    drinkdriving$prior_offence == "DR50"] <- "drinking"
[1] 13
drinkdriving$prior_offence[drinkdriving$prior_offence == "CD10" | 
    drinkdriving$prior_offence == "CD60" | drinkdriving$prior_offence == 
    "DR80" | drinkdriving$prior_offence == "PL10" | drinkdriving$prior_offence == 
    "SP60" | drinkdriving$prior_offence == "CD60,CD10,DR80" | 
    drinkdriving$prior_offence == "CD60,CD60" | drinkdriving$prior_offence == 
    "DD20" | drinkdriving$prior_offence == "TS70,DR50" | drinkdriving$prior_offence == 
    "TS70"] <- "non drinking"
[1] 14
drinkdriving$prior_offence <- as.factor(drinkdriving$prior_offence)
[1] 15
hist(drinkdriving$speed)
[1] 16
hist(drinkdriving$bac)
[1] 17
drinkdriving$bac[drinkdriving$bac > 40] <- NA
[1] 18
table(drinkdriving$outcome)
[1] 19

   fine    Fine    FINE warning Warning WARNING 
    191       2       9      43       2       3 
drinkdriving$outcome[drinkdriving$outcome == "Fine"] <- "fine"
[1] 20
drinkdriving$outcome[drinkdriving$outcome == "FINE"] <- "fine"
[1] 21
drinkdriving$outcome[drinkdriving$outcome == "Warning"] <- "warning"
[1] 22
drinkdriving$outcome[drinkdriving$outcome == "WARNING"] <- "warning"
[1] 23
drinkdriving$outcome <- factor(drinkdriving$outcome)
[1] 24
drinkdriving$outcome2 <- ifelse(drinkdriving$outcome == "fine", 
    1, 0)
[1] 25
table(officer_inc$officer)
[1] 26

 AS  IT  NP 
116  66  67 
drinkdriving <- merge(drinkdriving, officer_inc)
[1] 27
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 28
summary(m1)
[1] 29

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.3270  -4.1824  -0.5698   3.9975  14.9487 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 28.68503    1.06949   26.82  < 2e-16 ***
age         -0.13730    0.02331   -5.89 1.47e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.791 on 216 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.1384,	Adjusted R-squared:  0.1344 
F-statistic: 34.69 on 1 and 216 DF,  p-value: 1.469e-08

with(drinkdriving, cor.test(bac, scale(age)))
[1] 30

	Pearson's product-moment correlation

data:  bac and scale(age)
t = -5.8895, df = 216, p-value = 1.469e-08
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.4810759 -0.2515308
sample estimates:
       cor 
-0.3719763 

m2 <- lm(bac ~ scale(age), data = drinkdriving)
[1] 31
summary(m2)
[1] 32

Call:
lm(formula = bac ~ scale(age), data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.3270  -4.1824  -0.5698   3.9975  14.9487 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  22.8255     0.3922   58.20  < 2e-16 ***
scale(age)   -2.3025     0.3909   -5.89 1.47e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.791 on 216 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.1384,	Adjusted R-squared:  0.1344 
F-statistic: 34.69 on 1 and 216 DF,  p-value: 1.469e-08

plot(m2)
[1] 33
mean(drinkdriving$age, na.rm = T)
[1] 34
[1] 42.67556
plot(scale(drinkdriving$age), drinkdriving$bac, main = "Best Fit Line Model Between BAC and AGE", 
    xlab = "Normal Dristribution of Age", ylab = "BAC")
[1] 35
abline(m2)
[1] 36
bac_predict <- data.frame(age = 50)
[1] 37
predict(m2, newdata = bac_predict, interval = "confidence")
[1] 38
       fit      lwr      upr
1 21.81983 20.97678 22.66289
plot(m2, which = 2)
[1] 39
model_time <- lm(bac ~ scale(age) + nighttime, data = drinkdriving)
[1] 40
anova(model_time)
[1] 41
Analysis of Variance Table

Response: bac
            Df Sum Sq Mean Sq F value    Pr(>F)    
scale(age)   1 1163.1 1163.14  38.345 2.969e-09 ***
nighttime    1  721.4  721.42  23.783 2.096e-06 ***
Residuals  215 6521.7   30.33                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(model_time)
[1] 42

Call:
lm(formula = bac ~ scale(age) + nighttime, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.5254  -4.6056   0.3152   3.7847  14.3450 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)     20.1424     0.6647  30.302  < 2e-16 ***
scale(age)      -2.1465     0.3732  -5.752 3.01e-08 ***
nighttimenight   3.9256     0.8050   4.877 2.10e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.508 on 215 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.2242,	Adjusted R-squared:  0.217 
F-statistic: 31.06 on 2 and 215 DF,  p-value: 1.409e-12

model_speed <- lm(bac ~ scale(age) + speed, data = drinkdriving)
[1] 43
anova(model_speed)
[1] 44
Analysis of Variance Table

Response: bac
            Df Sum Sq Mean Sq F value    Pr(>F)    
scale(age)   1 1163.1 1163.14 34.6961 1.471e-08 ***
speed        1   35.5   35.50  1.0589    0.3046    
Residuals  215 7207.6   33.52                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(model_speed)
[1] 45

Call:
lm(formula = bac ~ scale(age) + speed, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.4118  -3.8926  -0.6094   4.1298  14.4229 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 21.16210    1.66335  12.723  < 2e-16 ***
scale(age)  -1.93521    0.52930  -3.656 0.000322 ***
speed        0.04320    0.04198   1.029 0.304616    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.79 on 215 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.1426,	Adjusted R-squared:  0.1346 
F-statistic: 17.88 on 2 and 215 DF,  p-value: 6.574e-08

model_new <- lm(bac ~ scale(age) + nighttime + speed, data = drinkdriving)
[1] 46
anova(model_new)
[1] 47
Analysis of Variance Table

Response: bac
            Df Sum Sq Mean Sq F value    Pr(>F)    
scale(age)   1 1163.1 1163.14 38.3777 2.948e-09 ***
nighttime    1  721.4  721.42 23.8033 2.082e-06 ***
speed        1   35.8   35.83  1.1821    0.2782    
Residuals  214 6485.9   30.31                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(model_new)
[1] 48

Call:
lm(formula = bac ~ scale(age) + nighttime + speed, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.7811  -4.6224   0.5195   3.7225  14.2190 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    18.47070    1.67496  11.028  < 2e-16 ***
scale(age)     -1.77754    0.50431  -3.525 0.000518 ***
nighttimenight  3.92649    0.80461   4.880 2.07e-06 ***
speed           0.04340    0.03992   1.087 0.278151    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.505 on 214 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.2284,	Adjusted R-squared:  0.2176 
F-statistic: 21.12 on 3 and 214 DF,  p-value: 5.044e-12

model_new2 <- lm(bac ~ scale(age) + nighttime, data = drinkdriving)
[1] 49
anova(model_new2)
[1] 50
Analysis of Variance Table

Response: bac
            Df Sum Sq Mean Sq F value    Pr(>F)    
scale(age)   1 1163.1 1163.14  38.345 2.969e-09 ***
nighttime    1  721.4  721.42  23.783 2.096e-06 ***
Residuals  215 6521.7   30.33                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(model_new2)
[1] 51

Call:
lm(formula = bac ~ scale(age) + nighttime, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.5254  -4.6056   0.3152   3.7847  14.3450 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)     20.1424     0.6647  30.302  < 2e-16 ***
scale(age)      -2.1465     0.3732  -5.752 3.01e-08 ***
nighttimenight   3.9256     0.8050   4.877 2.10e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.508 on 215 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.2242,	Adjusted R-squared:  0.217 
F-statistic: 31.06 on 2 and 215 DF,  p-value: 1.409e-12

data <- drinkdriving
[1] 52
data$nightness <- ifelse(data$nighttime == "night", 1, 0)
[1] 53
with(data, plot(jitter(nightness) ~ speed))
[1] 54
model_faster <- glm(nighttime ~ speed, data = drinkdriving, family = binomial)
[1] 55
anova(model_faster)
[1] 56
Analysis of Deviance Table

Model: binomial, link: logit

Response: nighttime

Terms added sequentially (first to last)


      Df Deviance Resid. Df Resid. Dev
NULL                    249     311.91
speed  1   0.5012       248     311.41
summary(model_faster)
[1] 57

Call:
glm(formula = nighttime ~ speed, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.7533  -1.4848   0.8509   0.8818   0.9699  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)
(Intercept) 0.509824   0.394333   1.293    0.196
speed       0.006524   0.009263   0.704    0.481

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 311.91  on 249  degrees of freedom
Residual deviance: 311.41  on 248  degrees of freedom
AIC: 315.41

Number of Fisher Scoring iterations: 4

model_result <- glm(outcome2 ~ scale(age) + speed + bac + nighttime + 
    prior_offence, drinkdriving, family = binomial)
[1] 58
anova(model_result, test = "Chisq")
[1] 59
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome2

Terms added sequentially (first to last)


              Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                            217    216.502              
scale(age)     1   66.496       216    150.005 3.506e-16 ***
speed          1   23.328       215    126.677 1.366e-06 ***
bac            1   20.369       214    106.308 6.386e-06 ***
nighttime      1    0.027       213    106.281   0.86840    
prior_offence  2    8.836       211     97.445   0.01206 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
model_effect <- glm(outcome2 ~ scale(speed) + scale(bac), drinkdriving, 
    family = binomial)
[1] 60
anova(model_effect, test = "Chisq")
[1] 61
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome2

Terms added sequentially (first to last)


             Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                           242     238.69              
scale(speed)  1   86.025       241     152.67 < 2.2e-16 ***
scale(bac)    1   22.540       240     130.13 2.058e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(model_effect)
[1] 62

Call:
glm(formula = outcome2 ~ scale(speed) + scale(bac), family = binomial, 
    data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-4.0812   0.0489   0.1875   0.4458   1.9536  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept)    2.8061     0.3647   7.694 1.43e-14 ***
scale(speed)   2.1932     0.3850   5.697 1.22e-08 ***
scale(bac)     1.1486     0.2737   4.197 2.71e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 238.69  on 242  degrees of freedom
Residual deviance: 130.13  on 240  degrees of freedom
  (7 observations deleted due to missingness)
AIC: 136.13

Number of Fisher Scoring iterations: 6

drinkdriving$drinking_offence <- ifelse(drinkdriving$prior_offence == 
    "drinking", 1, 0)
[1] 63
drinkdriving$drinking_offence[drinkdriving$prior_offence == "N"] <- NA
[1] 64
model_type <- glm(outcome2 ~ drinking_offence, drinkdriving, 
    family = binomial)
[1] 65
coef(model_type)
[1] 66
     (Intercept) drinking_offence 
       0.4054651        2.2335922 
drinkdriving$fit <- coef(model_type)[1] + coef(model_type)[2] * 
    drinkdriving$drinking_offence
[1] 67
drinkdriving$pred_outcome <- (exp(drinkdriving$fit)/(1 + exp(drinkdriving$fit)))
[1] 68
drinkdriving$pred_outcome[drinkdriving$prior_offence == "drinking"]
[1] 69
 [1] 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333
[14] 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333
[27] 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333
[40] 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333 0.9333333
drinkdriving$pred_outcome[drinkdriving$prior_offence == "non drinking"]
[1] 70
 [1] 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6
drinkdriving$no_offence <- ifelse(drinkdriving$prior_offence == 
    "N", 1, 0)
[1] 71
model_type2 <- glm(outcome2 ~ no_offence, drinkdriving, family = binomial)
[1] 72
coef(model_type2)
[1] 73
(Intercept)  no_offence 
  1.5910888  -0.2047944 
drinkdriving$fit2 <- coef(model_type2)[1] + coef(model_type2)[2] * 
    drinkdriving$no_offence
[1] 74
drinkdriving$pred_outcome2 <- (exp(drinkdriving$fit2)/(1 + exp(drinkdriving$fit2)))
[1] 75
drinkdriving$pred_outcome2[drinkdriving$prior_offence == "N"]
[1] 76
 [1] 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
[33] 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 [ reached getOption("max.print") -- omitted 135 entries ]
table(drinkdriving$pred_outcome2)
[1] 77

0.799999999999968 0.830769230769231 
              185                65 
model_pred <- lm(outcome2 == 1 ~ age + prior_offence + nighttime + 
    speed + bac, drinkdriving, )
[1] 78
summary(model_pred)
[1] 79

Call:
lm(formula = outcome2 == 1 ~ age + prior_offence + nighttime + 
    speed + bac, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.93880 -0.17606  0.06907  0.23791  0.79949 

Coefficients:
                           Estimate Std. Error t value Pr(>|t|)    
(Intercept)                0.385523   0.180226   2.139  0.03358 *  
age                       -0.005131   0.001729  -2.968  0.00334 ** 
prior_offenceN            -0.107366   0.054528  -1.969  0.05026 .  
prior_offencenon drinking -0.236563   0.089753  -2.636  0.00902 ** 
nighttimenight            -0.018986   0.047527  -0.399  0.68995    
speed                      0.010113   0.002243   4.508 1.08e-05 ***
bac                        0.015667   0.003818   4.103 5.82e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.3073 on 211 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.4227,	Adjusted R-squared:  0.4063 
F-statistic: 25.75 on 6 and 211 DF,  p-value: < 2.2e-16

head(predict(model_pred))
[1] 80
        1         2         3         4         5         6 
0.8215460 0.3594737 0.3329871 0.6811279 0.7370535 0.7517077 
predict_fine <- data.frame(age = c(14:90), nighttime = c("day"), 
    speed = c(30), bac = c(0), prior_offence = c("N"), outcome = c("fine"))
[1] 81
predictfine <- predict(model_pred, newdata = predict_fine)
[1] 82
head(predictfine)
[1] 83
        1         2         3         4         5         6 
0.5097040 0.5045725 0.4994410 0.4943095 0.4891780 0.4840465 
pred <- merge(drinkdriving, predictfine, by = "row.names")
[1] 84
pred_order <- pred[order(pred$age), ]
[1] 85
ggplot(pred_order, aes(x = age)) + geom_point(aes(y = predictfine), 
    na.rm = T) + theme_minimal() + labs(title = "Predicted Probabilities", 
    x = "Age", y = "Probability of a Fine")
[1] 86
ggplot(pred_order, aes(x = age)) + geom_line(aes(y = predictfine), 
    na.rm = T) + theme_minimal() + labs(title = "Predicted Probabilities", 
    x = "Age", y = "Probability of a Fine")
[1] 87
model_biased <- glm(outcome2 ~ age * officer, drinkdriving, family = binomial)
[1] 88
anova(model_biased, test = "Chisq")
[1] 89
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome2

Terms added sequentially (first to last)


            Df Deviance Resid. Df Resid. Dev Pr(>Chi)    
NULL                          224     222.38             
age          1   67.728       223     154.65  < 2e-16 ***
officer      2    0.861       221     153.79  0.65013    
age:officer  2    7.383       219     146.41  0.02494 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(model_biased)
[1] 90

Call:
glm(formula = outcome2 ~ age * officer, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.7179   0.0642   0.2741   0.5454   2.4089  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept)    9.56920    1.99554   4.795 1.62e-06 ***
age           -0.16122    0.03466  -4.652 3.29e-06 ***
officerIT     -5.04535    2.39610  -2.106   0.0352 *  
officerNP     -4.68465    2.48887  -1.882   0.0598 .  
age:officerIT  0.09612    0.04254   2.260   0.0238 *  
age:officerNP  0.09365    0.04405   2.126   0.0335 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 222.38  on 224  degrees of freedom
Residual deviance: 146.41  on 219  degrees of freedom
  (25 observations deleted due to missingness)
AIC: 158.41

Number of Fisher Scoring iterations: 7

ggplot(data = drinkdriving, aes(x = age, y = outcome2, col = officer, 
    fill = officer)) + geom_smooth(method = "lm", se = T, na.rm = T) + 
    theme_minimal()
[1] 91
ggplot(data = drinkdriving, aes(x = age, y = outcome2, col = officer, 
    fill = officer)) + geom_jitter(na.rm = T) + theme_minimal()
[1] 92
pos_out <- ggplot(data = drinkdriving, aes(x = age, y = outcome2))
[1] 93
pos_out + geom_jitter(na.rm = T) + theme_minimal() + facet_grid(. ~ 
    officer)
[1] 94
model_biased2 <- glm(outcome2 ~ bac + age * officer, drinkdriving, 
    family = binomial)
[1] 95
anova(model_biased2, test = "Chisq")
[1] 96
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome2

Terms added sequentially (first to last)


            Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                          217     216.50              
bac          1   41.973       216     174.53 9.256e-11 ***
age          1   43.076       215     131.45 5.266e-11 ***
officer      2    0.544       213     130.91    0.7620    
age:officer  2    7.338       211     123.57    0.0255 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(model_biased2)
[1] 97

Call:
glm(formula = outcome2 ~ bac + age * officer, family = binomial, 
    data = drinkdriving)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.86053   0.04561   0.19462   0.48231   1.97931  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept)    6.09601    2.32261   2.625 0.008674 ** 
bac            0.16091    0.04294   3.747 0.000179 ***
age           -0.15668    0.03749  -4.179 2.92e-05 ***
officerIT     -5.80941    2.61654  -2.220 0.026401 *  
officerNP     -4.89850    2.69770  -1.816 0.069400 .  
age:officerIT  0.10588    0.04617   2.293 0.021824 *  
age:officerNP  0.09569    0.04772   2.005 0.044936 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 216.50  on 217  degrees of freedom
Residual deviance: 123.57  on 211  degrees of freedom
  (32 observations deleted due to missingness)
AIC: 137.57

Number of Fisher Scoring iterations: 7

new_df <- data.frame(outcome2 = drinkdriving$outcome2[drinkdriving$bac < 
    mean(drinkdriving$bac, na.rm = T)], age = drinkdriving$age[drinkdriving$bac < 
    mean(drinkdriving$bac, na.rm = T)], officer = drinkdriving$officer[drinkdriving$bac < 
    mean(drinkdriving$bac, na.rm = T)])
[1] 98
model_biased3 <- glm(outcome2 ~ age * officer, new_df, family = binomial)
[1] 99
anova(model_biased3, test = "Chisq")
[1] 100
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome2

Terms added sequentially (first to last)


            Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                          111    134.012              
age          1   65.907       110     68.106 4.728e-16 ***
officer      2    2.056       108     66.049  0.357680    
age:officer  2    9.213       106     56.837  0.009987 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
ggplot(data = new_df, aes(x = age, y = outcome2, col = officer, 
    fill = officer)) + geom_smooth(method = "lm", se = T, na.rm = T) + 
    theme_minimal()
[1] 101
ggplot(data = pred_order, aes(x = age, y = outcome2, col = officer, 
    fill = officer)) + geom_smooth(method = "lm", se = T, na.rm = T) + 
    theme_minimal()
[1] 102
