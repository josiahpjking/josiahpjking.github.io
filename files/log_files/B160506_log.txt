

	####### B160506 R script #######

library(psych, quietly = T)
[1] 1
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(ggplot2, quietly = T)
[1] 2
 [1] "ggplot2"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(scatterplot3d, quietly = T)
[1] 3
 [1] "scatterplot3d" "ggplot2"       "psych"         "readr"         "stats"         "graphics"      "grDevices"     "utils"        
 [9] "datasets"      "methods"       "base"         
library(car, quietly = T)
[1] 4
 [1] "car"           "carData"       "scatterplot3d" "ggplot2"       "psych"         "readr"         "stats"         "graphics"     
 [9] "grDevices"     "utils"         "datasets"      "methods"       "base"         
library(lsr)
[1] 5
 [1] "lsr"           "car"           "carData"       "scatterplot3d" "ggplot2"       "psych"         "readr"         "stats"        
 [9] "graphics"      "grDevices"     "utils"         "datasets"      "methods"       "base"         
logit.to.p <- function(logits) {
    exp(logits)/(exp(logits) + 1)
}
[1] 6
load(url("https://edin.ac/2QCZNVu"))
[1] 7
[1] "drinkdriving" "officer_inc" 
ls()
[1] 8
 [1] "author_no"         "basic_pckgs"       "code_run"          "collab_list"       "collabs"           "comments"         
 [7] "drinkdriving"      "edit.script"       "error_log"         "files"             "ii"                "installed_pckgs"  
[13] "ll"                "log_file"          "logit.to.p"        "models"            "n_lines_flag"      "n_model_flag"     
[19] "nn"                "not_run"           "officer_inc"       "p"                 "pckgs"             "plot_index"       
[25] "script"            "start"             "temp"              "undeclared_collab"
summary(drinkdriving)
[1] 9
      age          nighttime         prior_offence          speed             bac           outcome          incident_id       
 Min.   : 14.00   Length:250         Length:250         Min.   :  0.00   Min.   : 3.987   Length:250         Length:250        
 1st Qu.: 30.00   Class :character   Class :character   1st Qu.: 30.92   1st Qu.:19.264   Class :character   Class :character  
 Median : 40.50   Mode  :character   Mode  :character   Median : 40.64   Median :23.609   Mode  :character   Mode  :character  
 Mean   : 46.00                                         Mean   : 40.49   Mean   :23.605                                        
 3rd Qu.: 55.25                                         3rd Qu.: 48.84   3rd Qu.:27.898                                        
 Max.   :297.00                                         Max.   :120.34   Max.   :65.764                                        
 NA's   :22                                                              NA's   :5                                             
describe(drinkdriving)
[1] 10
               vars   n mean    sd median trimmed   mad min  max range skew kurtosis   se
age               1 228   46 33.35   40.5   42.34 18.53  14  297   283  5.5    38.49 2.21
nighttime*        2 250  NaN    NA     NA     NaN    NA Inf -Inf  -Inf   NA       NA   NA
prior_offence*    3 250  NaN    NA     NA     NaN    NA Inf -Inf  -Inf   NA       NA   NA
 [ reached 'max' / getOption("max.print") -- omitted 4 rows ]
warnings()
[1] 11
Warning messages:
1: In if (class(error_log[[paste(ll)]]) == "try-error") { ... :
  the condition has length > 1 and only the first element will be used
2: In if (class(error_log[[paste(ll)]]) == "try-error") { ... :
  the condition has length > 1 and only the first element will be used
3: ‘tidyr’ namespace cannot be unloaded:
  namespace ‘tidyr’ is imported by ‘broom’ so cannot be unloaded
4: ‘dplyr’ namespace cannot be unloaded:
  namespace ‘dplyr’ is imported by ‘sjmisc’, ‘broom’, ‘recipes’, ‘dbplyr’, ‘tidyr’ so cannot be unloaded
5: ‘plyr’ namespace cannot be unloaded:
  namespace ‘plyr’ is imported by ‘reshape2’, ‘reshape’ so cannot be unloaded
6: ‘ggplot2’ namespace cannot be unloaded:
  namespace ‘ggplot2’ is imported by ‘ggiraph’, ‘cowplot’ so cannot be unloaded
7: In if (class(error_log[[paste(ll)]]) == "try-error") { ... :
  the condition has length > 1 and only the first element will be used
8: In if (class(error_log[[paste(ll)]]) == "try-error") { ... :
  the condition has length > 1 and only the first element will be used
9: In if (class(error_log[[paste(ll)]]) == "try-error") { ... :
  the condition has length > 1 and only the first element will be used
10: In if (class(error_log[[paste(ll)]]) == "try-error") { ... :
  the condition has length > 1 and only the first element will be used
11: In if (class(error_log[[paste(ll)]]) == "try-error") { ... :
  the condition has length > 1 and only the first element will be used
12: In if (class(error_log[[paste(ll)]]) == "try-error") { ... :
  the condition has length > 1 and only the first element will be used
13: In if (class(error_log[[paste(ll)]]) == "try-error") { ... :
  the condition has length > 1 and only the first element will be used
14: In if (class(error_log[[paste(ll)]]) == "try-error") { ... :
  the condition has length > 1 and only the first element will be used
15: In if (class(error_log[[paste(ll)]]) == "try-error") { ... :
  the condition has length > 1 and only the first element will be used
16: In if (class(error_log[[paste(ll)]]) == "try-error") { ... :
  the condition has length > 1 and only the first element will be used
17: In readLines(ii) : incomplete final line found on 'B159817.R'
18: In if (class(error_log[[paste(ll)]]) == "try-error") { ... :
  the condition has length > 1 and only the first element will be used
19: In if (class(error_log[[paste(ll)]]) == "try-error") { ... :
  the condition has length > 1 and only the first element will be used
20: In if (class(error_log[[paste(ll)]]) == "try-error") { ... :
  the condition has length > 1 and only the first element will be used
21: In if (class(error_log[[paste(ll)]]) == "try-error") { ... :
  the condition has length > 1 and only the first element will be used
22: In if (class(error_log[[paste(ll)]]) == "try-error") { ... :
  the condition has length > 1 and only the first element will be used
summary(drinkdriving$nighttime)
[1] 12
   Length     Class      Mode 
      250 character character 
drinkdriving$nighttime[drinkdriving$nighttime == "2:05"] <- "night"
[1] 13
drinkdriving$nighttime[drinkdriving$nighttime == "18:25"] <- NA
[1] 14
drinkdriving$nighttime
[1] 15
 [1] "night" "day"   "night" "night" "night" "day"   "night" "day"   "night" "night" "night" "night" "day"   "night" "night" "night"
[17] "night" "day"   "day"   "night" "night" "night" "day"   "day"   "day"   "night" "night" "day"   "day"   "day"   "night" "night"
[33] "night" "night" "night" "day"   "day"   "night" "night" "night" "night" "night" "day"   "night" "day"   "night" "night" "night"
[49] "night" "night"
 [ reached getOption("max.print") -- omitted 200 entries ]
drinkdriving$nighttime <- as.factor(drinkdriving$nighttime)
[1] 16
levels(drinkdriving$nighttime)
[1] 17
[1] "day"   "night"
drinkdriving$prior_offence
[1] 18
 [1] "N"    "N"    "DR50" "N"    "N"    "N"    "N"    "N"    "N"    "N"    "DR80" "N"    "N"    "N"    "N"    "N"    "N"    "N"   
[19] "N"    "N"    "N"    "N"    "N"    "N"    "N"    "DR50" "DR50" "N"    "DD20" "N"    "DR50" "N"    "N"    "N"    "N"    "N"   
[37] "N"    "N"    "N"    "N"    "N"    "N"    "N"    "N"    "PL10" "DR50" "N"    "N"    "N"    "DR50"
 [ reached getOption("max.print") -- omitted 200 entries ]
drinkdriving$dr <- ifelse(drinkdriving$prior_offence == "DR50" | 
    drinkdriving$prior_offence == "TS70,DR50", 1, 0)
[1] 19
drinkdriving$dr <- as.factor(drinkdriving$dr)
[1] 20
drinkdriving$dr
[1] 21
 [1] 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 1
 [ reached getOption("max.print") -- omitted 200 entries ]
Levels: 0 1
drinkdriving$previous_offender <- ifelse(drinkdriving$prior_offence == 
    "N", 0, 1)
[1] 22
drinkdriving$previous_offender <- as.factor(drinkdriving$previous_offender)
[1] 23
drinkdriving$previous_offender
[1] 24
 [1] 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 1 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 1
 [ reached getOption("max.print") -- omitted 200 entries ]
Levels: 0 1
drinkdriving$non_dr <- ifelse(drinkdriving$dr == 0 & drinkdriving$previous_offender == 
    1, 1, 0)
[1] 25
drinkdriving$non_dr <- as.factor(drinkdriving$non_dr)
[1] 26
drinkdriving$non_dr
[1] 27
 [1] 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0
 [ reached getOption("max.print") -- omitted 200 entries ]
Levels: 0 1
drinkdriving$bac
[1] 28
 [1] 17.713735 22.134400 32.789395 20.475763 29.367360 19.127171 21.377196 26.798025 23.794140 24.419368 28.491061 26.457736 15.989616
[14] 30.776194 20.381579 27.218421 36.138410 19.613897 30.069430 20.912267 25.304121 36.138410 17.673018 20.949093 20.706564 32.553559
[27] 24.526098 20.687000 16.369612 11.817715  5.452951 20.123929 25.355380 25.857960 17.775592 14.115921 30.811803 25.911494 20.598902
[40] 22.867645 31.029118 24.678907 24.509071 18.018609 21.719123 25.233391 20.299527 28.200283 22.153350 34.356616
 [ reached getOption("max.print") -- omitted 200 entries ]
plot(drinkdriving$bac)
[1] 29
drinkdriving$outcome
[1] 30
 [1] "fine"    "fine"    "fine"    "warning" "warning" "fine"    "warning" "fine"    "fine"    "warning" "WARNING" "FINE"    "fine"   
[14] "fine"    "fine"    "fine"    "fine"    "fine"    "fine"    "fine"    "fine"    "fine"    "warning" "Fine"    "fine"    "fine"   
[27] "fine"    "fine"    "fine"    "warning" "warning" "warning" "fine"    "fine"    "fine"    "warning" "fine"    "fine"    "fine"   
[40] "fine"    "fine"    "fine"    "fine"    "fine"    "fine"    "fine"    "fine"    "fine"    "warning" "fine"   
 [ reached getOption("max.print") -- omitted 200 entries ]
drinkdriving$outcome[drinkdriving$outcome == "FINE"] <- "fine"
[1] 31
drinkdriving$outcome[drinkdriving$outcome == "WARNING"] <- "warning"
[1] 32
drinkdriving$outcome[drinkdriving$outcome == "Fine"] <- "fine"
[1] 33
drinkdriving$outcome[drinkdriving$outcome == "Warning"] <- "warning"
[1] 34
drinkdriving$outcome <- as.factor(drinkdriving$outcome)
[1] 35
drinkdriving$outcome
[1] 36
 [1] fine    fine    fine    warning warning fine    warning fine    fine    warning warning fine    fine    fine    fine    fine   
[17] fine    fine    fine    fine    fine    fine    warning fine    fine    fine    fine    fine    fine    warning warning warning
[33] fine    fine    fine    warning fine    fine    fine    fine    fine    fine    fine    fine    fine    fine    fine    fine   
[49] warning fine   
 [ reached getOption("max.print") -- omitted 200 entries ]
Levels: fine warning
drinkdriving$outcome_fine <- ifelse(drinkdriving$outcome == "fine", 
    1, 0)
[1] 37
drinkdriving$outcome_fine <- as.factor(drinkdriving$outcome_fine)
[1] 38
drinkdriving$outcome_fine
[1] 39
 [1] 1 1 1 0 0 1 0 1 1 0 0 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 0 0 0 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 0 1
 [ reached getOption("max.print") -- omitted 200 entries ]
Levels: 0 1
drinkdriving$incident_id
[1] 40
 [1] "inc_1"  "inc_2"  "inc_3"  "inc_4"  "inc_5"  "inc_6"  "inc_7"  "inc_8"  "inc_9"  "inc_10" "inc_11" "inc_12" "inc_13" "inc_14"
[15] "inc_15" "inc_16" "inc_17" "inc_18" "inc_19" "inc_20" "inc_21" "inc_22" "inc_23" "inc_24" "inc_25" "inc_26" "inc_27" "inc_28"
[29] "inc_29" "inc_30" "inc_31" "inc_32" "inc_33" "inc_34" "inc_35" "inc_36" "inc_37" "inc_38" "inc_39" "inc_40" "inc_41" "inc_42"
[43] "inc_43" "inc_44" "inc_45" "inc_46" "inc_47" "inc_48" "inc_49" "inc_50"
 [ reached getOption("max.print") -- omitted 200 entries ]
drinkdriving$speed
[1] 41
 [1] 47.957110 43.826353 47.260707 17.221097  1.945818 41.399468  1.012149 34.377506 63.748159  2.533468 50.049472 47.658553 46.209515
[14] 35.044348 45.911152 41.971790 59.500756 38.544314 45.294085 33.660408 66.359756 59.538043 26.205563 49.692191 35.759413 48.880880
[27] 44.464566 34.639220 36.609294 24.917257 13.069805 19.008994 41.009485 36.335035 56.428161 30.141277 45.716490 41.609061 53.768251
[40] 46.424053 23.599427 52.982425 41.674665 38.867482 41.537199 32.599695 61.109335 39.685430 12.246206 64.659834
 [ reached getOption("max.print") -- omitted 200 entries ]
plot(drinkdriving$speed)
[1] 42
summary(drinkdriving$age)
[1] 43
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
  14.00   30.00   40.50   46.00   55.25  297.00      22 
plot(drinkdriving$age)
[1] 44
drinkdriving$age[drinkdriving$age >= 107] <- NA
[1] 45
plot(drinkdriving$age)
[1] 46
sum(!complete.cases(drinkdriving))
[1] 47
[1] 30
drinkdriving4 <- na.omit(drinkdriving)
[1] 48
drinkdriving4

# A tibble: 220 x 11
     age nighttime prior_offence speed   bac outcome incident_id dr    previous_offender non_dr outcome_fine
   <dbl> <fct>     <chr>         <dbl> <dbl> <fct>   <chr>       <fct> <fct>             <fct>  <fct>       
 1    39 night     N             48.0   17.7 fine    inc_1       0     0                 0      1           
 2    28 day       N             43.8   22.1 fine    inc_2       0     0                 0      1           
 3    38 night     DR50          47.3   32.8 fine    inc_3       1     1                 0      1           
 4    51 night     N             17.2   20.5 warning inc_4       0     0                 0      0           
 5    56 night     N              1.95  29.4 warning inc_5       0     0                 0      0           
 6    36 day       N             41.4   19.1 fine    inc_6       0     0                 0      1           
 7    81 night     N              1.01  21.4 warning inc_7       0     0                 0      0           
 8    49 day       N             34.4   26.8 fine    inc_8       0     0                 0      1           
 9    32 night     N             63.7   23.8 fine    inc_9       0     0                 0      1           
10    60 night     N              2.53  24.4 warning inc_10      0     0                 0      0           
# … with 210 more rows


drinkdriving44 <- drinkdriving4
[1] 50
drinkdriving44$age[drinkdriving44$age <= 15] <- NA
[1] 51
drinkdriving44 <- na.omit(drinkdriving44)
[1] 52
drinkdriving44

# A tibble: 214 x 11
     age nighttime prior_offence speed   bac outcome incident_id dr    previous_offender non_dr outcome_fine
   <dbl> <fct>     <chr>         <dbl> <dbl> <fct>   <chr>       <fct> <fct>             <fct>  <fct>       
 1    39 night     N             48.0   17.7 fine    inc_1       0     0                 0      1           
 2    28 day       N             43.8   22.1 fine    inc_2       0     0                 0      1           
 3    38 night     DR50          47.3   32.8 fine    inc_3       1     1                 0      1           
 4    51 night     N             17.2   20.5 warning inc_4       0     0                 0      0           
 5    56 night     N              1.95  29.4 warning inc_5       0     0                 0      0           
 6    36 day       N             41.4   19.1 fine    inc_6       0     0                 0      1           
 7    81 night     N              1.01  21.4 warning inc_7       0     0                 0      0           
 8    49 day       N             34.4   26.8 fine    inc_8       0     0                 0      1           
 9    32 night     N             63.7   23.8 fine    inc_9       0     0                 0      1           
10    60 night     N              2.53  24.4 warning inc_10      0     0                 0      0           
# … with 204 more rows


m1 <- lm(bac ~ age, data = drinkdriving4)
[1] 54
summary(m1)
[1] 55

Call:
lm(formula = bac ~ age, data = drinkdriving4)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.719  -4.516  -0.861   3.849  42.785 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 29.29455    1.25564  23.330  < 2e-16 ***
age         -0.14353    0.02741  -5.236 3.86e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.82 on 218 degrees of freedom
Multiple R-squared:  0.1117,	Adjusted R-squared:  0.1076 
F-statistic: 27.41 on 1 and 218 DF,  p-value: 3.863e-07

plot(m1)
[1] 56
plot(m1, which = 4)
[1] 57
drinkdrivingq1 <- drinkdriving4
[1] 58
drinkdrivingq1[c(154, 110), ] <- NA
[1] 59
mmm1 <- lm(bac ~ age, data = drinkdrivingq1)
[1] 60
summary(mmm1)
[1] 61

Call:
lm(formula = bac ~ age, data = drinkdrivingq1)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.757  -4.529  -0.704   3.833  42.738 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 29.29990    1.25933  23.266  < 2e-16 ***
age         -0.14259    0.02748  -5.188 4.89e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.828 on 216 degrees of freedom
  (2 observations deleted due to missingness)
Multiple R-squared:  0.1108,	Adjusted R-squared:  0.1067 
F-statistic: 26.91 on 1 and 216 DF,  p-value: 4.888e-07

standardCoefs(mmm1)
[1] 62
             b       beta
age -0.1425858 -0.3328662
plot(mmm1, which = c(1:4))
[1] 63
plot(mmm1)
[1] 64
plot(bac ~ age, data = drinkdrivingq1)
[1] 65
abline(lm(drinkdrivingq1$bac ~ drinkdrivingq1$age), col = "black")
[1] 66
fifty_bac_formula <- 29.2999 + 50 * (-0.14259)
[1] 67
fifty_bac_formula

[1] 22.1704


new_age <- data.frame(age = 50)
[1] 69
fifty_bac <- predict(mmm1, newdata = new_age)
[1] 70
fifty_bac

       1 
22.17061 


hist(residuals(mmm1), main = "", breaks = 20)
[1] 72
plot(density(residuals(mmm1)), main = "")
[1] 73
plot(mmm1, which = c(2, 4))
[1] 74
plot(mmm1)
[1] 75
m2 <- lm(bac ~ speed, data = drinkdriving4)
[1] 76
plot(bac ~ speed, data = drinkdriving4)
[1] 77
summary(m2)
[1] 78

Call:
lm(formula = bac ~ speed, data = drinkdriving4)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.812  -4.293  -0.586   4.269  33.168 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 14.40760    1.29792  11.101  < 2e-16 ***
speed        0.22448    0.03127   7.179 1.09e-11 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.507 on 218 degrees of freedom
Multiple R-squared:  0.1912,	Adjusted R-squared:  0.1875 
F-statistic: 51.54 on 1 and 218 DF,  p-value: 1.09e-11

plot(m2)
[1] 79
plot(m2, which = 4)
[1] 80
drinkdrivingq21 <- drinkdriving4
[1] 81
drinkdrivingq21[c(136, 99), ] <- NA
[1] 82
mm2 <- lm(bac ~ speed, data = drinkdrivingq21)
[1] 83
plot(bac ~ speed, data = drinkdrivingq21)
[1] 84
summary(mm2)
[1] 85

Call:
lm(formula = bac ~ speed, data = drinkdrivingq21)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.1318  -3.6379  -0.5018   4.1370  12.3915 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 17.17701    1.29193  13.296  < 2e-16 ***
speed        0.14670    0.03188   4.602 7.14e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.953 on 216 degrees of freedom
  (2 observations deleted due to missingness)
Multiple R-squared:  0.08928,	Adjusted R-squared:  0.08506 
F-statistic: 21.18 on 1 and 216 DF,  p-value: 7.144e-06

plot(mm2)
[1] 86
plot(mm2, which = 4)
[1] 87
standardCoefs(mm2)
[1] 88
              b      beta
speed 0.1466981 0.2987996
mm3 <- lm(bac ~ nighttime, data = drinkdrivingq21)
[1] 89
plot(bac ~ nighttime, data = drinkdrivingq21)
[1] 90
summary(mm3)
[1] 91

Call:
lm(formula = bac ~ nighttime, data = drinkdrivingq21)

Residuals:
     Min       1Q   Median       3Q      Max 
-18.7402  -3.8006   0.4598   3.7555  13.4230 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)     19.8708     0.7106  27.965  < 2e-16 ***
nighttimenight   4.3223     0.8595   5.029 1.04e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.902 on 216 degrees of freedom
  (2 observations deleted due to missingness)
Multiple R-squared:  0.1048,	Adjusted R-squared:  0.1007 
F-statistic: 25.29 on 1 and 216 DF,  p-value: 1.036e-06

plot(mm3)
[1] 92
plot(mm3, which = 4)
[1] 93
standardCoefs(mm3)
[1] 94
                    b      beta
nighttimenight 4.3223 0.3237449
mmm11 <- lm(bac ~ age, data = drinkdrivingq21)
[1] 95
summary(mmm11)
[1] 96

Call:
lm(formula = bac ~ age, data = drinkdrivingq21)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.3270  -4.1824  -0.5698   3.9975  14.9487 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 28.68503    1.06949   26.82  < 2e-16 ***
age         -0.13730    0.02331   -5.89 1.47e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.791 on 216 degrees of freedom
  (2 observations deleted due to missingness)
Multiple R-squared:  0.1384,	Adjusted R-squared:  0.1344 
F-statistic: 34.69 on 1 and 216 DF,  p-value: 1.469e-08

standardCoefs(mmm11)
[1] 97
             b       beta
age -0.1373039 -0.3719763
mm4 <- lm(bac ~ age + speed + nighttime, data = drinkdrivingq21)
[1] 98
summary(mm4)
[1] 99

Call:
lm(formula = bac ~ age + speed + nighttime, data = drinkdrivingq21)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.7811  -4.6224   0.5195   3.7225  14.2190 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    22.99435    2.68293   8.571 2.06e-15 ***
age            -0.10600    0.03007  -3.525 0.000518 ***
speed           0.04340    0.03992   1.087 0.278151    
nighttimenight  3.92649    0.80461   4.880 2.07e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.505 on 214 degrees of freedom
  (2 observations deleted due to missingness)
Multiple R-squared:  0.2284,	Adjusted R-squared:  0.2176 
F-statistic: 21.12 on 3 and 214 DF,  p-value: 5.044e-12

plot(mm4)
[1] 100
m5 <- drop1(mm4, test = "F")
[1] 101
m5

Single term deletions

Model:
bac ~ age + speed + nighttime
          Df Sum of Sq    RSS    AIC F value    Pr(>F)    
<none>                 6485.9 747.65                      
age        1    376.52 6862.4 757.95 12.4234 0.0005185 ***
speed      1     35.83 6521.7 746.85  1.1821 0.2781509    
nighttime  1    721.75 7207.6 768.65 23.8141 2.071e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1


summary(m5)
[1] 103
       Df      Sum of Sq           RSS            AIC           F value           Pr(>F)         
 Min.   :1   Min.   : 35.83   Min.   :6486   Min.   :746.9   Min.   : 1.182   Min.   :0.0000021  
 1st Qu.:1   1st Qu.:206.18   1st Qu.:6513   1st Qu.:747.4   1st Qu.: 6.803   1st Qu.:0.0002603  
 Median :1   Median :376.52   Median :6692   Median :752.8   Median :12.423   Median :0.0005185  
 Mean   :1   Mean   :378.03   Mean   :6769   Mean   :755.3   Mean   :12.473   Mean   :0.0928905  
 3rd Qu.:1   3rd Qu.:549.14   3rd Qu.:6949   3rd Qu.:760.6   3rd Qu.:18.119   3rd Qu.:0.1393347  
 Max.   :1   Max.   :721.75   Max.   :7208   Max.   :768.7   Max.   :23.814   Max.   :0.2781509  
 NA's   :1   NA's   :1                                       NA's   :1        NA's   :1          
m6 <- lm(speed ~ nighttime, data = drinkdriving4)
[1] 104
summary(m6)
[1] 105

Call:
lm(formula = speed ~ nighttime, data = drinkdriving4)

Residuals:
    Min      1Q  Median      3Q     Max 
-39.272  -8.779   0.358   7.732  81.711 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)     38.6255     1.6843  22.933   <2e-16 ***
nighttimenight   0.6466     2.0398   0.317    0.752    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 14.09 on 218 degrees of freedom
Multiple R-squared:  0.0004608,	Adjusted R-squared:  -0.004124 
F-statistic: 0.1005 on 1 and 218 DF,  p-value: 0.7515

plot(m6, which = 4)
[1] 106
plot(m6)
[1] 107
drinkdrivingq23 <- drinkdriving4
[1] 108
drinkdrivingq23[c(99), ] <- NA
[1] 109
drinkdrivingq23$speed[drinkdrivingq23$speed <= 0] <- NA
[1] 110
mm6 <- lm(speed ~ nighttime, data = drinkdrivingq23)
[1] 111
summary(mm6)
[1] 112

Call:
lm(formula = speed ~ nighttime, data = drinkdrivingq23)

Residuals:
    Min      1Q  Median      3Q     Max 
-38.524  -8.030   0.392   7.934  41.492 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)      37.441      1.532   24.45   <2e-16 ***
nighttimenight    2.094      1.853    1.13     0.26    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 12.72 on 216 degrees of freedom
  (2 observations deleted due to missingness)
Multiple R-squared:  0.005882,	Adjusted R-squared:  0.00128 
F-statistic: 1.278 on 1 and 216 DF,  p-value: 0.2595

plot(mm6, which = 4)
[1] 113
plot(mm6)
[1] 114
t.test(speed ~ nighttime, drinkdrivingq23)
[1] 115

	Welch Two Sample t-test

data:  speed by nighttime
t = -1.2993, df = 187.69, p-value = 0.1954
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -5.274369  1.085516
sample estimates:
  mean in group day mean in group night 
           37.44132            39.53575 

anova(mm6)
[1] 116
Analysis of Variance Table

Response: speed
           Df Sum Sq Mean Sq F value Pr(>F)
nighttime   1    207  206.88   1.278 0.2595
Residuals 216  34964  161.87               
summary(mm6)
[1] 117

Call:
lm(formula = speed ~ nighttime, data = drinkdrivingq23)

Residuals:
    Min      1Q  Median      3Q     Max 
-38.524  -8.030   0.392   7.934  41.492 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)      37.441      1.532   24.45   <2e-16 ***
nighttimenight    2.094      1.853    1.13     0.26    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 12.72 on 216 degrees of freedom
  (2 observations deleted due to missingness)
Multiple R-squared:  0.005882,	Adjusted R-squared:  0.00128 
F-statistic: 1.278 on 1 and 216 DF,  p-value: 0.2595

t.test(speed ~ nighttime, drinkdrivingq23)
[1] 118

	Welch Two Sample t-test

data:  speed by nighttime
t = -1.2993, df = 187.69, p-value = 0.1954
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -5.274369  1.085516
sample estimates:
  mean in group day mean in group night 
           37.44132            39.53575 

with(drinkdrivingq23, plot(speed ~ nighttime))
[1] 119
m7 <- glm(outcome_fine ~ age + bac + speed + nighttime + previous_offender, 
    data = drinkdriving4, family = binomial, na.action = na.exclude)
[1] 120
summary(m7)
[1] 121

Call:
glm(formula = outcome_fine ~ age + bac + speed + nighttime + 
    previous_offender, family = binomial, data = drinkdriving4, 
    na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.6106   0.0331   0.1424   0.3855   2.2057  

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)    
(Intercept)        -4.84572    2.20295  -2.200 0.027832 *  
age                -0.04666    0.02053  -2.273 0.023037 *  
bac                 0.19723    0.05218   3.780 0.000157 ***
speed               0.13602    0.03355   4.054 5.04e-05 ***
nighttimenight     -0.13999    0.56434  -0.248 0.804089    
previous_offender1  0.38161    0.60700   0.629 0.529559    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 217.38  on 219  degrees of freedom
Residual deviance: 105.88  on 214  degrees of freedom
AIC: 117.88

Number of Fisher Scoring iterations: 7

logLik(m7)
[1] 122
'log Lik.' -52.93801 (df=6)
anova(m7)
[1] 123
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome_fine

Terms added sequentially (first to last)


                  Df Deviance Resid. Df Resid. Dev
NULL                                219     217.38
age                1   67.049       218     150.33
bac                1   18.873       217     131.45
speed              1   25.145       216     106.31
nighttime          1    0.027       215     106.28
previous_offender  1    0.405       214     105.88
anova(m7, test = "Chisq")
[1] 124
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome_fine

Terms added sequentially (first to last)


                  Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                                219     217.38              
age                1   67.049       218     150.33 2.648e-16 ***
bac                1   18.873       217     131.45 1.397e-05 ***
speed              1   25.145       216     106.31 5.317e-07 ***
nighttime          1    0.027       215     106.28    0.8684    
previous_offender  1    0.405       214     105.88    0.5247    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m77 <- glm(outcome_fine ~ age + bac + speed + nighttime + previous_offender, 
    data = drinkdrivingq21, family = binomial)
[1] 125
summary(m77)
[1] 126

Call:
glm(formula = outcome_fine ~ age + bac + speed + nighttime + 
    previous_offender, family = binomial, data = drinkdrivingq21)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.6106   0.0338   0.1431   0.3860   2.2057  

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)    
(Intercept)        -4.84572    2.20295  -2.200 0.027832 *  
age                -0.04666    0.02053  -2.273 0.023037 *  
bac                 0.19723    0.05218   3.780 0.000157 ***
speed               0.13602    0.03355   4.054 5.04e-05 ***
nighttimenight     -0.13999    0.56434  -0.248 0.804089    
previous_offender1  0.38161    0.60700   0.629 0.529559    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 216.50  on 217  degrees of freedom
Residual deviance: 105.88  on 212  degrees of freedom
  (2 observations deleted due to missingness)
AIC: 117.88

Number of Fisher Scoring iterations: 7

logLik(m77)
[1] 127
'log Lik.' -52.93801 (df=6)
anova(m77)
[1] 128
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome_fine

Terms added sequentially (first to last)


                  Df Deviance Resid. Df Resid. Dev
NULL                                217     216.50
age                1   66.496       216     150.00
bac                1   18.552       215     131.45
speed              1   25.145       214     106.31
nighttime          1    0.027       213     106.28
previous_offender  1    0.405       212     105.88
anova(m77, test = "Chisq")
[1] 129
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome_fine

Terms added sequentially (first to last)


                  Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                                217     216.50              
age                1   66.496       216     150.00 3.506e-16 ***
bac                1   18.552       215     131.45 1.653e-05 ***
speed              1   25.145       214     106.31 5.318e-07 ***
nighttime          1    0.027       213     106.28    0.8684    
previous_offender  1    0.405       212     105.88    0.5247    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
mm77 <- drop1(m77, test = "F")
[1] 130
mm77

Single term deletions

Model:
outcome_fine ~ age + bac + speed + nighttime + previous_offender
                  Df Deviance    AIC F value    Pr(>F)    
<none>                 105.88 117.88                      
age                1   111.16 121.16 10.5797   0.00133 ** 
bac                1   124.09 134.09 36.4774 6.839e-09 ***
speed              1   130.26 140.26 48.8181 3.577e-11 ***
nighttime          1   105.94 115.94  0.1238   0.72531    
previous_offender  1   106.28 116.28  0.8104   0.36904    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1


summary(mm77)
[1] 132
       Df       Deviance          AIC           F value            Pr(>F)       
 Min.   :1   Min.   :105.9   Min.   :115.9   Min.   : 0.1238   Min.   :0.00000  
 1st Qu.:1   1st Qu.:106.0   1st Qu.:116.7   1st Qu.: 0.8104   1st Qu.:0.00000  
 Median :1   Median :108.7   Median :119.5   Median :10.5797   Median :0.00133  
 Mean   :1   Mean   :113.9   Mean   :124.3   Mean   :19.3619   Mean   :0.21913  
 3rd Qu.:1   3rd Qu.:120.9   3rd Qu.:130.9   3rd Qu.:36.4774   3rd Qu.:0.36904  
 Max.   :1   Max.   :130.3   Max.   :140.3   Max.   :48.8181   Max.   :0.72531  
 NA's   :1                                   NA's   :1         NA's   :1        
m7_sd1 <- glm(outcome_fine ~ scale(speed), data = drinkdriving4, 
    family = binomial, na.action = na.exclude)
[1] 133
summary(m7_sd1)
[1] 134

Call:
glm(formula = outcome_fine ~ scale(speed), family = binomial, 
    data = drinkdriving4, na.action = na.exclude)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.92909   0.07523   0.24765   0.50928   1.89668  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept)    2.3985     0.3183   7.534 4.90e-14 ***
scale(speed)   2.4039     0.3850   6.245 4.25e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 217.38  on 219  degrees of freedom
Residual deviance: 137.86  on 218  degrees of freedom
AIC: 141.86

Number of Fisher Scoring iterations: 6

anova(m7_sd1)
[1] 135
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome_fine

Terms added sequentially (first to last)


             Df Deviance Resid. Df Resid. Dev
NULL                           219     217.38
scale(speed)  1   79.517       218     137.86
anova(m7_sd1, test = "Chisq")
[1] 136
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome_fine

Terms added sequentially (first to last)


             Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                           219     217.38              
scale(speed)  1   79.517       218     137.86 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m7_sd2 <- glm(outcome_fine ~ scale(bac), data = drinkdriving4, 
    family = binomial, na.action = na.exclude)
[1] 137
summary(m7_sd2)
[1] 138

Call:
glm(formula = outcome_fine ~ scale(bac), family = binomial, data = drinkdriving4, 
    na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.5154   0.2062   0.4168   0.6714   1.6639  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)   1.8665     0.2321   8.043  8.8e-16 ***
scale(bac)    1.4624     0.2649   5.520  3.4e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 217.38  on 219  degrees of freedom
Residual deviance: 174.53  on 218  degrees of freedom
AIC: 178.53

Number of Fisher Scoring iterations: 5

anova(m7_sd2)
[1] 139
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome_fine

Terms added sequentially (first to last)


           Df Deviance Resid. Df Resid. Dev
NULL                         219     217.38
scale(bac)  1   42.847       218     174.53
anova(m7_sd2, test = "Chisq")
[1] 140
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome_fine

Terms added sequentially (first to last)


           Df Deviance Resid. Df Resid. Dev Pr(>Chi)    
NULL                         219     217.38             
scale(bac)  1   42.847       218     174.53 5.92e-11 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m7_1 <- glm(outcome_fine ~ speed, data = drinkdriving4, family = binomial, 
    na.action = na.exclude)
[1] 141
summary(m7_1)
[1] 142

Call:
glm(formula = outcome_fine ~ speed, family = binomial, data = drinkdriving4, 
    na.action = na.exclude)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.92909   0.07523   0.24765   0.50928   1.89668  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -4.27946    0.86314  -4.958 7.12e-07 ***
speed        0.17094    0.02737   6.245 4.25e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 217.38  on 219  degrees of freedom
Residual deviance: 137.86  on 218  degrees of freedom
AIC: 141.86

Number of Fisher Scoring iterations: 6

exp(coef(m7_1)[1] + coef(m7_1)[2])
[1] 143
(Intercept) 
 0.01643207 
m7_2 <- glm(outcome_fine ~ bac, data = drinkdriving4, family = binomial, 
    na.action = na.exclude)
[1] 144
summary(m7_2)
[1] 145

Call:
glm(formula = outcome_fine ~ bac, family = binomial, data = drinkdriving4, 
    na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.5154   0.2062   0.4168   0.6714   1.6639  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -2.8285     0.7440  -3.802 0.000144 ***
bac           0.2026     0.0367   5.520  3.4e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 217.38  on 219  degrees of freedom
Residual deviance: 174.53  on 218  degrees of freedom
AIC: 178.53

Number of Fisher Scoring iterations: 5

exp(coef(m7_2)[1] + coef(m7_2)[2])
[1] 146
(Intercept) 
 0.07237311 
m9 <- glm(outcome_fine ~ dr, data = drinkdriving4, family = binomial, 
    na.action = na.exclude)
[1] 147
summary(m9)
[1] 148

Call:
glm(formula = outcome_fine ~ dr, family = binomial, data = drinkdriving4, 
    na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1341   0.4652   0.6967   0.6967   0.6967  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)   1.2923     0.1808   7.148  8.8e-13 ***
dr1           0.8768     0.5579   1.572    0.116    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 217.38  on 219  degrees of freedom
Residual deviance: 214.44  on 218  degrees of freedom
AIC: 218.44

Number of Fisher Scoring iterations: 4

plot(m9)
[1] 149
plot(m9, which = 4)
[1] 150
drinkdrivingq32 <- drinkdriving4
[1] 151
drinkdrivingq32[c(29, 143, 153, 183), ] <- NA
[1] 152
m99 <- glm(outcome_fine ~ dr, data = drinkdrivingq32, family = binomial)
[1] 153
summary(m99)
[1] 154

Call:
glm(formula = outcome_fine ~ dr, family = binomial, data = drinkdrivingq32)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.75210   0.00013   0.69666   0.69666   0.69666  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept)    1.2923     0.1808   7.148  8.8e-13 ***
dr1           17.2738  1102.5272   0.016    0.987    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 204.01  on 215  degrees of freedom
Residual deviance: 188.64  on 214  degrees of freedom
  (4 observations deleted due to missingness)
AIC: 192.64

Number of Fisher Scoring iterations: 17

plot(m99)
[1] 155
plot(m99, which = 4)
[1] 156
logLik(m99)
[1] 157
'log Lik.' -94.32162 (df=2)
anova(m99)
[1] 158
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome_fine

Terms added sequentially (first to last)


     Df Deviance Resid. Df Resid. Dev
NULL                   215     204.00
dr    1   15.362       214     188.64
anova(m99, test = "Chisq")
[1] 159
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome_fine

Terms added sequentially (first to last)


     Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                   215     204.00              
dr    1   15.362       214     188.64 8.874e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
exp(coef(m99)[1] + coef(m99)[2])
[1] 160
(Intercept) 
  115648793 
mm99 <- glm(outcome_fine ~ non_dr, data = drinkdrivingq32, family = binomial)
[1] 161
summary(mm99)
[1] 162

Call:
glm(formula = outcome_fine ~ non_dr, family = binomial, data = drinkdrivingq32)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.8877   0.6072   0.6072   0.6072   0.8446  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)   1.5972     0.1909   8.367   <2e-16 ***
non_dr1      -0.7499     0.5240  -1.431    0.152    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 204.01  on 215  degrees of freedom
Residual deviance: 202.12  on 214  degrees of freedom
  (4 observations deleted due to missingness)
AIC: 206.12

Number of Fisher Scoring iterations: 4

plot(mm99)
[1] 163
plot(mm99, which = 4)
[1] 164
logLik(mm99)
[1] 165
'log Lik.' -101.0617 (df=2)
anova(mm99)
[1] 166
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome_fine

Terms added sequentially (first to last)


       Df Deviance Resid. Df Resid. Dev
NULL                     215     204.00
non_dr  1    1.882       214     202.12
anova(mm99, test = "Chisq")
[1] 167
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome_fine

Terms added sequentially (first to last)


       Df Deviance Resid. Df Resid. Dev Pr(>Chi)
NULL                     215     204.00         
non_dr  1    1.882       214     202.12   0.1701
exp(coef(mm99)[1] + coef(mm99)[2])
[1] 168
(Intercept) 
   2.333333 
m10 <- glm(outcome_fine ~ previous_offender, drinkdriving4, family = binomial, 
    na.action = na.exclude)
[1] 169
summary(m10)
[1] 170

Call:
glm(formula = outcome_fine ~ previous_offender, family = binomial, 
    data = drinkdriving4, na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.8841   0.6095   0.6773   0.6773   0.6773  

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)    
(Intercept)          1.3555     0.1952   6.943 3.83e-12 ***
previous_offender1   0.2337     0.3982   0.587    0.557    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 217.38  on 219  degrees of freedom
Residual deviance: 217.02  on 218  degrees of freedom
AIC: 221.02

Number of Fisher Scoring iterations: 4

plot(m10, which = 4)
[1] 171
logLik(m10)
[1] 172
'log Lik.' -108.5111 (df=2)
anova(m10)
[1] 173
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome_fine

Terms added sequentially (first to last)


                  Df Deviance Resid. Df Resid. Dev
NULL                                219     217.38
previous_offender  1  0.35362       218     217.02
anova(m10, test = "Chisq")
[1] 174
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome_fine

Terms added sequentially (first to last)


                  Df Deviance Resid. Df Resid. Dev Pr(>Chi)
NULL                                219     217.38         
previous_offender  1  0.35362       218     217.02   0.5521
chance <- fitted(m10)
[1] 175
chance <- ifelse(chance > 0.5, 1, 0)
[1] 176
bingo <- sum(chance == drinkdriving4$outcome_fine)
[1] 177
bingo/length(drinkdriving4$outcome_fine)
[1] 178
[1] 0.8045455
m11 <- glm(outcome_fine ~ age + nighttime + speed + bac + previous_offender, 
    drinkdriving4, family = binomial)
[1] 179
m11


Call:  glm(formula = outcome_fine ~ age + nighttime + speed + bac + 
    previous_offender, family = binomial, data = drinkdriving4)

Coefficients:
       (Intercept)                 age      nighttimenight               speed                 bac  previous_offender1  
          -4.84572            -0.04666            -0.13999             0.13602             0.19723             0.38161  

Degrees of Freedom: 219 Total (i.e. Null);  214 Residual
Null Deviance:	    217.4 
Residual Deviance: 105.9 	AIC: 117.9


summary(m11)
[1] 181

Call:
glm(formula = outcome_fine ~ age + nighttime + speed + bac + 
    previous_offender, family = binomial, data = drinkdriving4)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.6106   0.0331   0.1424   0.3855   2.2057  

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)    
(Intercept)        -4.84572    2.20295  -2.200 0.027832 *  
age                -0.04666    0.02053  -2.273 0.023037 *  
nighttimenight     -0.13999    0.56434  -0.248 0.804089    
speed               0.13602    0.03355   4.054 5.04e-05 ***
bac                 0.19723    0.05218   3.780 0.000157 ***
previous_offender1  0.38161    0.60700   0.629 0.529559    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 217.38  on 219  degrees of freedom
Residual deviance: 105.88  on 214  degrees of freedom
AIC: 117.88

Number of Fisher Scoring iterations: 7

Q4_dataframe <- data.frame(age = c(14:107), nighttime = c(replicate(94, 
    "day")), speed = c(replicate(94, 30)), bac = c(replicate(94, 
    0)), previous_offender = as.factor(c(replicate(94, 0))))
[1] 182
Q4_dataframe

   age nighttime speed bac previous_offender
1   14       day    30   0                 0
2   15       day    30   0                 0
3   16       day    30   0                 0
4   17       day    30   0                 0
5   18       day    30   0                 0
6   19       day    30   0                 0
7   20       day    30   0                 0
8   21       day    30   0                 0
9   22       day    30   0                 0
10  23       day    30   0                 0
 [ reached 'max' / getOption("max.print") -- omitted 84 rows ]


summary(Q4_dataframe)
[1] 184
      age         nighttime     speed         bac    previous_offender
 Min.   : 14.00   day:94    Min.   :30   Min.   :0   0:94             
 1st Qu.: 37.25             1st Qu.:30   1st Qu.:0                    
 Median : 60.50             Median :30   Median :0                    
 Mean   : 60.50             Mean   :30   Mean   :0                    
 3rd Qu.: 83.75             3rd Qu.:30   3rd Qu.:0                    
 Max.   :107.00             Max.   :30   Max.   :0                    
Q4_dataframe$model_prediction <- predict(m11, newdata = Q4_dataframe)
[1] 185
Q4_dataframe$model_prediction_probabilities <- exp(-4.84572 + 
    (-0.04666 * Q4_dataframe$model_prediction))
[1] 186
levels(Q4_dataframe$previous_offender) <- c("None", "Y")
[1] 187
Q4_dataframe

  age nighttime speed bac previous_offender model_prediction model_prediction_probabilities
1  14       day    30   0              None        -1.418173                    0.008399794
2  15       day    30   0              None        -1.464828                    0.008418100
3  16       day    30   0              None        -1.511484                    0.008436446
4  17       day    30   0              None        -1.558140                    0.008454832
5  18       day    30   0              None        -1.604795                    0.008473257
6  19       day    30   0              None        -1.651451                    0.008491723
7  20       day    30   0              None        -1.698106                    0.008510230
 [ reached 'max' / getOption("max.print") -- omitted 87 rows ]


x <- seq(min(14), max(107), length.out = 49)
[1] 189
y <- exp(-4.84572 + (-0.04666 * x))
[1] 190
plot(y ~ x, xlab = "age", ylab = "p(getting a fine)", type = "p", 
    col = "black")
[1] 191
drinkdriving2 <- drinkdriving[order(drinkdriving$incident_id), 
    ]
[1] 192
drinkdriving2

# A tibble: 250 x 11
     age nighttime prior_offence speed   bac outcome incident_id dr    previous_offender non_dr outcome_fine
   <dbl> <fct>     <chr>         <dbl> <dbl> <fct>   <chr>       <fct> <fct>             <fct>  <fct>       
 1    39 night     N             48.0  17.7  fine    inc_1       0     0                 0      1           
 2    60 night     N              2.53 24.4  warning inc_10      0     0                 0      0           
 3    68 night     N             25.5  10.5  warning inc_100     0     0                 0      0           
 4    35 day       N             44.4   8.55 fine    inc_101     0     0                 0      1           
 5    47 day       N             37.1  20.8  fine    inc_102     0     0                 0      1           
 6    41 night     N             40.4  18.8  fine    inc_103     0     0                 0      1           
 7    36 night     DR50          45.4  18.0  fine    inc_104     1     1                 0      1           
 8    42 night     N             46.8  25.0  fine    inc_105     0     0                 0      1           
 9    21 night     N             55.8  29.8  fine    inc_106     0     0                 0      1           
10    86 night     TS70          29.9  25.9  fine    inc_107     0     1                 1      1           
# … with 240 more rows


officer_inc2 <- officer_inc[order(officer_inc$incident_id), ]
[1] 194
officer_inc2

    officer incident_id
96       AS       inc_1
220      AS      inc_10
236      AS     inc_100
82       NP     inc_101
136      AS     inc_102
114      NP     inc_103
88       NP     inc_104
119      AS     inc_105
20       NP     inc_106
181      IT     inc_107
129      IT     inc_108
12       NP     inc_109
205      NP      inc_11
48       AS     inc_110
123      IT     inc_111
172      IT     inc_112
101      NP     inc_113
248      AS     inc_114
246      AS     inc_115
222      AS     inc_116
234      AS     inc_117
74       IT     inc_118
66       AS     inc_119
111      AS      inc_12
207      AS     inc_120
 [ reached 'max' / getOption("max.print") -- omitted 225 rows ]


drinkdriving2$officer_id <- as.factor(officer_inc2$officer)
[1] 196
drinkdriving2

# A tibble: 250 x 12
     age nighttime prior_offence speed   bac outcome incident_id dr    previous_offender non_dr outcome_fine officer_id
   <dbl> <fct>     <chr>         <dbl> <dbl> <fct>   <chr>       <fct> <fct>             <fct>  <fct>        <fct>     
 1    39 night     N             48.0  17.7  fine    inc_1       0     0                 0      1            AS        
 2    60 night     N              2.53 24.4  warning inc_10      0     0                 0      0            AS        
 3    68 night     N             25.5  10.5  warning inc_100     0     0                 0      0            AS        
 4    35 day       N             44.4   8.55 fine    inc_101     0     0                 0      1            NP        
 5    47 day       N             37.1  20.8  fine    inc_102     0     0                 0      1            AS        
 6    41 night     N             40.4  18.8  fine    inc_103     0     0                 0      1            NP        
 7    36 night     DR50          45.4  18.0  fine    inc_104     1     1                 0      1            NP        
 8    42 night     N             46.8  25.0  fine    inc_105     0     0                 0      1            AS        
 9    21 night     N             55.8  29.8  fine    inc_106     0     0                 0      1            NP        
10    86 night     TS70          29.9  25.9  fine    inc_107     0     1                 1      1            IT        
# … with 240 more rows


officer_AS <- drinkdriving2[drinkdriving2$officer_id == "AS", 
    ]
[1] 198
m_as <- glm(outcome_fine ~ age + speed + bac + age:speed + age:bac, 
    officer_AS, family = binomial, na.action = na.exclude)
[1] 199
summary(m_as)
[1] 200

Call:
glm(formula = outcome_fine ~ age + speed + bac + age:speed + 
    age:bac, family = binomial, data = officer_AS, na.action = na.exclude)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-3.08600   0.02449   0.03646   0.06484   0.99881  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)  
(Intercept) 28.454324  19.648818   1.448   0.1476  
age         -0.780126   0.378942  -2.059   0.0395 *
speed       -0.218183   0.279392  -0.781   0.4348  
bac         -0.386803   0.878943  -0.440   0.6599  
age:speed    0.008070   0.005777   1.397   0.1624  
age:bac      0.014360   0.014721   0.975   0.3293  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 105.085  on 104  degrees of freedom
Residual deviance:  17.268  on  99  degrees of freedom
  (12 observations deleted due to missingness)
AIC: 29.268

Number of Fisher Scoring iterations: 9

logLik(m_as)
[1] 201
'log Lik.' -8.633938 (df=6)
anova(m_as)
[1] 202
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome_fine

Terms added sequentially (first to last)


          Df Deviance Resid. Df Resid. Dev
NULL                        104    105.085
age        1   59.947       103     45.137
speed      1    8.113       102     37.025
bac        1   17.693       101     19.332
age:speed  1    0.949       100     18.383
age:bac    1    1.115        99     17.268
anova(m_as, test = "Chisq")
[1] 203
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome_fine

Terms added sequentially (first to last)


          Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                        104    105.085              
age        1   59.947       103     45.137 9.744e-15 ***
speed      1    8.113       102     37.025  0.004396 ** 
bac        1   17.693       101     19.332 2.596e-05 ***
age:speed  1    0.949       100     18.383  0.329930    
age:bac    1    1.115        99     17.268  0.291070    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
officer_IT <- drinkdriving2[drinkdriving2$officer_id == "IT", 
    ]
[1] 204
m_it <- glm(outcome_fine ~ age + speed + bac + age:speed + age:bac, 
    officer_IT, family = binomial, na.action = na.exclude)
[1] 205
summary(m_it)
[1] 206

Call:
glm(formula = outcome_fine ~ age + speed + bac + age:speed + 
    age:bac, family = binomial, data = officer_IT, na.action = na.exclude)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.19104   0.05917   0.25925   0.48180   2.19770  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)  
(Intercept) -2.0473696  8.1794026  -0.250    0.802  
age         -0.1326928  0.1548309  -0.857    0.391  
speed       -0.0783992  0.1278089  -0.613    0.540  
bac          0.2537766  0.3600819   0.705    0.481  
age:speed    0.0051902  0.0031369   1.655    0.098 .
age:bac     -0.0009576  0.0063792  -0.150    0.881  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 58.193  on 55  degrees of freedom
Residual deviance: 34.266  on 50  degrees of freedom
  (11 observations deleted due to missingness)
AIC: 46.266

Number of Fisher Scoring iterations: 6

logLik(m_it)
[1] 207
'log Lik.' -17.13291 (df=6)
anova(m_it)
[1] 208
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome_fine

Terms added sequentially (first to last)


          Df Deviance Resid. Df Resid. Dev
NULL                         55     58.193
age        1   8.3918        54     49.801
speed      1   8.1758        53     41.625
bac        1   4.8023        52     36.823
age:speed  1   2.5347        51     34.288
age:bac    1   0.0226        50     34.266
anova(m_it, test = "Chisq")
[1] 209
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome_fine

Terms added sequentially (first to last)


          Df Deviance Resid. Df Resid. Dev Pr(>Chi)   
NULL                         55     58.193            
age        1   8.3918        54     49.801 0.003769 **
speed      1   8.1758        53     41.625 0.004245 **
bac        1   4.8023        52     36.823 0.028422 * 
age:speed  1   2.5347        51     34.288 0.111368   
age:bac    1   0.0226        50     34.266 0.880554   
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
officer_NP <- drinkdriving2[drinkdriving2$officer_id == "NP", 
    ]
[1] 210
m_np <- glm(outcome_fine ~ age + speed + bac + age:speed + age:bac, 
    officer_NP, family = binomial, na.action = na.exclude)
[1] 211
summary(m_np)
[1] 212

Call:
glm(formula = outcome_fine ~ age + speed + bac + age:speed + 
    age:bac, family = binomial, data = officer_NP, na.action = na.exclude)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.68920   0.08291   0.21261   0.32576   1.43075  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)  
(Intercept) 11.406398   7.823738   1.458   0.1449  
age         -0.409362   0.159492  -2.567   0.0103 *
speed       -0.250659   0.167181  -1.499   0.1338  
bac         -0.062907   0.332305  -0.189   0.8499  
age:speed    0.010238   0.004541   2.255   0.0242 *
age:bac      0.004557   0.007239   0.629   0.5290  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 53.699  on 58  degrees of freedom
Residual deviance: 24.481  on 53  degrees of freedom
  (9 observations deleted due to missingness)
AIC: 36.481

Number of Fisher Scoring iterations: 7

logLik(m_np)
[1] 213
'log Lik.' -12.24041 (df=6)
anova(m_np)
[1] 214
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome_fine

Terms added sequentially (first to last)


          Df Deviance Resid. Df Resid. Dev
NULL                         58     53.699
age        1   7.4755        57     46.224
speed      1   8.3631        56     37.861
bac        1   2.6368        55     35.224
age:speed  1  10.3346        54     24.889
age:bac    1   0.4086        53     24.481
anova(m_np, test = "Chisq")
[1] 215
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome_fine

Terms added sequentially (first to last)


          Df Deviance Resid. Df Resid. Dev Pr(>Chi)   
NULL                         58     53.699            
age        1   7.4755        57     46.224 0.006254 **
speed      1   8.3631        56     37.861 0.003829 **
bac        1   2.6368        55     35.224 0.104415   
age:speed  1  10.3346        54     24.889 0.001306 **
age:bac    1   0.4086        53     24.481 0.522684   
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
