

	####### B148351 R script #######

library(lsr, quietly = T)
[1] 1
[1] "lsr"       "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 2
 [1] "car"       "carData"   "lsr"       "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
library(plotly, quietly = T)
[1] 3
 [1] "plotly"    "ggplot2"   "car"       "carData"   "lsr"       "readr"     "stats"     "graphics"  "grDevices" "utils"    
[11] "datasets"  "methods"   "base"     
library(ggplot2, quietly = T)
[1] 4
 [1] "plotly"    "ggplot2"   "car"       "carData"   "lsr"       "readr"     "stats"     "graphics"  "grDevices" "utils"    
[11] "datasets"  "methods"   "base"     
load(url("https://edin.ac/2QCZNVu"))
[1] 5
[1] "drinkdriving" "officer_inc" 
ls()
[1] 6
 [1] "author_no"         "basic_pckgs"       "code_run"          "collab_list"       "collabs"           "comments"         
 [7] "drinkdriving"      "edit.script"       "error_log"         "files"             "ii"                "installed_pckgs"  
[13] "ll"                "log_file"          "models"            "n_lines_flag"      "n_model_flag"      "nn"               
[19] "not_run"           "officer_inc"       "p"                 "pckgs"             "plot_index"        "script"           
[25] "start"             "temp"              "undeclared_collab"
who(TRUE)
[1] 7
   -- Name --          -- Class --   -- Size --
   author_no           character     1         
   basic_pckgs         character     8         
   code_run            data.frame    26 x 2    
    $exam_no           factor        26        
    $code_ok           logical       26        
   collab_list         list          14        
   collabs             character     0         
   comments            character     99        
   drinkdriving        tbl_df        250 x 7   
    $age               numeric       250       
    $nighttime         character     250       
    $prior_offence     character     250       
    $speed             numeric       250       
    $bac               numeric       250       
    $outcome           character     250       
    $incident_id       character     250       
 [ reached getOption("max.print") -- omitted 22 rows ]
summary(drinkdriving)
[1] 8
      age          nighttime         prior_offence          speed             bac           outcome          incident_id       
 Min.   : 14.00   Length:250         Length:250         Min.   :  0.00   Min.   : 3.987   Length:250         Length:250        
 1st Qu.: 30.00   Class :character   Class :character   1st Qu.: 30.92   1st Qu.:19.264   Class :character   Class :character  
 Median : 40.50   Mode  :character   Mode  :character   Median : 40.64   Median :23.609   Mode  :character   Mode  :character  
 Mean   : 46.00                                         Mean   : 40.49   Mean   :23.605                                        
 3rd Qu.: 55.25                                         3rd Qu.: 48.84   3rd Qu.:27.898                                        
 Max.   :297.00                                         Max.   :120.34   Max.   :65.764                                        
 NA's   :22                                                              NA's   :5                                             
sum(!complete.cases(drinkdriving))
[1] 9
[1] 27
boxplot(drinkdriving$age)
[1] 10
hist(drinkdriving$age, breaks = 20)
[1] 11
drinkdriving$age[drinkdriving$age > 90 | drinkdriving$age < 17] <- NA
[1] 12
table(drinkdriving$nighttime)
[1] 13

18:25  2:05   day night 
    1     2    78   169 
drinkdriving$nighttime[drinkdriving$nighttime != "day" & drinkdriving$nighttime != 
    "night"] <- NA
[1] 14
drinkdriving$nighttime <- as.factor(drinkdriving$nighttime)
[1] 15
table(drinkdriving$prior_offence)
[1] 16

          CD10           CD60 CD60,CD10,DR80      CD60,CD60           DD20           DR50           DR80              N           PL10 
             2              1              1              1              4             43              4            185              2 
          SP50           SP60           TS70      TS70,DR50 
             2              1              3              1 
drinkdriving$prior_offence <- as.factor(drinkdriving$prior_offence)
[1] 17
drinkdriving$prior_offence <- droplevels(drinkdriving$prior_offence)
[1] 18
hist(drinkdriving$speed, breaks = 20)
[1] 19
plot(drinkdriving$speed)
[1] 20
speed_intervals <- cut(drinkdriving$speed, breaks = seq(0, 90, 
    10))
[1] 21
table(speed_intervals)
[1] 22
speed_intervals
 (0,10] (10,20] (20,30] (30,40] (40,50] (50,60] (60,70] (70,80] (80,90] 
      3      13      39      62      77      38      12       3       1 
drinkdriving$speed[drinkdriving$speed < 1 | drinkdriving$speed > 
    100] <- NA
[1] 23
summary(drinkdriving$speed)
[1] 24
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
  1.012  31.306  40.639  40.328  48.748  81.028       2 
drinkdriving$bac <- drinkdriving$bac/100
[1] 25
hist(drinkdriving$bac)
[1] 26
drinkdriving$bac[drinkdriving$bac > 0.4] <- NA
[1] 27
table(drinkdriving$outcome)
[1] 28

   fine    Fine    FINE warning Warning WARNING 
    191       2       9      43       2       3 
drinkdriving$outcome[drinkdriving$outcome == "Fine" | drinkdriving$outcome == 
    "FINE"] <- "fine"
[1] 29
drinkdriving$outcome[drinkdriving$outcome == "Warning" | drinkdriving$outcome == 
    "WARNING"] <- "warning"
[1] 30
drinkdriving$outcome <- as.factor(drinkdriving$outcome)
[1] 31
drinkdriving$outcome <- droplevels(drinkdriving$outcome)
[1] 32
drinkdriving <- drinkdriving[, c(7, 1:6)]
[1] 33
drinkdriving <- merge(drinkdriving, officer_inc)
[1] 34
sum(!complete.cases(drinkdriving))
[1] 35
[1] 43
drinkdriving <- na.omit(drinkdriving)
[1] 36
with(drinkdriving, plot(bac ~ age, xaxt = "n"))
[1] 37
axis(side = 1, at = seq(17, 90, by = 10))
[1] 38
[1] 17 27 37 47 57 67 77 87
m1 <- lm(bac ~ age, data = drinkdriving, na.action = na.omit)
[1] 39
summary(m1)
[1] 40

Call:
lm(formula = bac ~ age, data = drinkdriving, na.action = na.omit)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.151797 -0.040976 -0.007179  0.040383  0.122694 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.2852353  0.0115008  24.801  < 2e-16 ***
age         -0.0013690  0.0002471  -5.541 9.19e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05754 on 205 degrees of freedom
Multiple R-squared:  0.1302,	Adjusted R-squared:  0.126 
F-statistic:  30.7 on 1 and 205 DF,  p-value: 9.186e-08

mean(residuals(object = m1), na.rm = T)
[1] 41
[1] 1.153831e-18
hist(residuals(object = m1))
[1] 42
par(mfrow = c(2, 2))
[1] 43
$mfrow
[1] 2 2

plot(m1, which = c(1:4))
[1] 44
par(mfrow = c(1, 1))
[1] 45
$mfrow
[1] 2 2

with(drinkdriving, plot(age, bac, xlab = "- Age -", ylab = "Blood Alcohol Content", 
    main = "BAC predicted by Age", col = c("slateblue"), bty = "n", 
    pch = 20, xaxt = "n"))
[1] 46
axis(side = 1, at = seq(17, 90, by = 10))
[1] 47
[1] 17 27 37 47 57 67 77 87
abline(m1)
[1] 48
new_age <- data.frame(age = 50)
[1] 49
prediction <- predict(m1, newdata = new_age, interval = "prediction")
[1] 50
points(x = c(new_age, new_age, new_age), y = c(prediction), col = c("red", 
    "green", "green"), pch = c(15, 0, 0))
[1] 51
NULL
prediction

        fit       lwr       upr
1 0.2167866 0.1030182 0.3305551


hist(x = residuals(m1), xlab = "Value of residual", breaks = 15, 
    main = "")
[1] 53
qqnorm(residuals(m1))
[1] 54
$x
 [1] -0.98694113  0.67829520 -1.51238959 -2.81809723 -0.13359883 -0.69361656 -1.00684418  0.33300510  0.69361656  1.44038518
[11]  1.37515910  0.47771897  0.63325054  0.39774080  1.04789716  1.51238959 -1.93378070 -2.12225387 -1.79619337 -0.04845622
[21]  0.12139062  0.58945580  0.30751145 -1.09079677 -1.28707648  0.75662366 -0.61852111  0.07271993  0.32023226 -1.63786780
[31] -0.32023226  0.15807699 -0.45074421  0.78927432 -2.25466141  0.24460372  0.51885088 -1.13580389  1.15919475 -0.58945580
[41] -0.38466842 -1.44038518  1.59321882  1.31530983 -0.77284600  1.28707648 -0.75662366 -1.11301850 -0.42409356  0.02422100
 [ reached getOption("max.print") -- omitted 157 entries ]

$y
            1             2             3             4             5             6             7             8             9 
-0.0547079897  0.0410967672 -0.0871739399 -0.1517970408 -0.0133300448 -0.0412962674 -0.0561074270  0.0223460214  0.0415872447 
           10            11            12            13            15            16            17            19            20 
 0.0910233469  0.0890941700  0.0301359093  0.0380065587  0.0245906139  0.0614017425  0.0920187594 -0.0975044840 -0.1067526933 
           21            22            23            24            25            27            28            30            31 
-0.0967082911 -0.0086626251  0.0066334779  0.0354699676  0.0215045001 -0.0612820725 -0.0754168484  0.0452430600 -0.0396541274 
           32            34            35            36            37            38            39            42            43 
-0.0008844215  0.0221663729 -0.0938527499 -0.0232265608  0.0115887592 -0.0291969411  0.0463293088 -0.1169012065  0.0142601466 
           44            45            46            47            48            50            51            52            53 
 0.0317238960 -0.0626268457  0.0704407061 -0.0387468166 -0.0260372054 -0.0864514111  0.0952566935  0.0832953581 -0.0451654231 
           54            55            56            57            58 
 0.0829470512 -0.0450302347 -0.0623002639 -0.0280295487 -0.0048941345 
 [ reached getOption("max.print") -- omitted 157 entries ]

shapiro.test(residuals(m1))
[1] 55

	Shapiro-Wilk normality test

data:  residuals(m1)
W = 0.99006, p-value = 0.1645

m.time <- lm(bac ~ age + nighttime, data = drinkdriving, na.action = na.omit)
[1] 56
m.speed <- lm(bac ~ age + speed, data = drinkdriving, na.action = na.omit)
[1] 57
anova(m1)
[1] 58
Analysis of Variance Table

Response: bac
           Df  Sum Sq  Mean Sq F value    Pr(>F)    
age         1 0.10165 0.101653    30.7 9.186e-08 ***
Residuals 205 0.67880 0.003311                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
anova(m1, m.time)
[1] 59
Analysis of Variance Table

Model 1: bac ~ age
Model 2: bac ~ age + nighttime
  Res.Df     RSS Df Sum of Sq      F    Pr(>F)    
1    205 0.67880                                  
2    204 0.61294  1  0.065867 21.922 5.174e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
anova(m1, m.speed)
[1] 60
Analysis of Variance Table

Model 1: bac ~ age
Model 2: bac ~ age + speed
  Res.Df     RSS Df Sum of Sq      F Pr(>F)
1    205 0.67880                           
2    204 0.67618  1 0.0026233 0.7914 0.3747
summary(m.time)
[1] 61

Call:
lm(formula = bac ~ age + nighttime, data = drinkdriving, na.action = na.omit)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.16381 -0.04719  0.00272  0.03758  0.14397 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.2551336  0.0127025  20.085  < 2e-16 ***
age            -0.0012723  0.0002363  -5.385 1.98e-07 ***
nighttimenight  0.0382720  0.0081741   4.682 5.17e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05481 on 204 degrees of freedom
Multiple R-squared:  0.2146,	Adjusted R-squared:  0.2069 
F-statistic: 27.88 on 2 and 204 DF,  p-value: 1.981e-11

summary(m.speed)
[1] 62

Call:
lm(formula = bac ~ age + speed, data = drinkdriving, na.action = na.omit)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.152647 -0.040371 -0.006682  0.040154  0.121269 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.2616445  0.0289067   9.051  < 2e-16 ***
age         -0.0011737  0.0003306  -3.550 0.000478 ***
speed        0.0003969  0.0004462   0.890 0.374716    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05757 on 204 degrees of freedom
Multiple R-squared:  0.1336,	Adjusted R-squared:  0.1251 
F-statistic: 15.73 on 2 and 204 DF,  p-value: 4.434e-07

independentSamplesTTest(formula = speed ~ nighttime, data = drinkdriving)
[1] 63

   Welch's independent samples t-test 

Outcome variable:   speed 
Grouping variable:  nighttime 

Descriptive statistics: 
               day  night
   mean     36.905 38.472
   std dev.  9.019 13.222

Hypotheses: 
   null:        population means equal for both groups
   alternative: different population means in each group

Test results: 
   t-statistic:  -0.999 
   degrees of freedom:  180.781 
   p-value:  0.319 

Other information: 
   two-sided 95% confidence interval:  [-4.664, 1.529] 
   estimated effect size (Cohen's d):  0.138 

with(drinkdriving, plot(speed ~ nighttime, xlab = "Time of the day", 
    ylab = "Miles per hour"))
[1] 64
with(drinkdriving, plot(speed ~ age, xaxt = "n"))
[1] 65
axis(side = 1, at = seq(20, 90, by = 10))
[1] 66
[1] 20 30 40 50 60 70 80 90
contrasts(drinkdriving$outcome)
[1] 67
        warning
fine          0
warning       1
drinkdriving$outcome <- ifelse(drinkdriving$outcome == "fine", 
    1, 0)
[1] 68
logit <- glm(outcome ~ age + nighttime + speed + prior_offence + 
    bac + officer, data = drinkdriving, family = "binomial")
[1] 69
summary(logit)
[1] 70

Call:
glm(formula = outcome ~ age + nighttime + speed + prior_offence + 
    bac + officer, family = "binomial", data = drinkdriving)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-3.11591   0.00254   0.03983   0.21659   2.94901  

Coefficients:
                    Estimate Std. Error z value Pr(>|z|)    
(Intercept)         21.16276 4240.26444   0.005 0.996018    
age                 -0.13848    0.03912  -3.540 0.000400 ***
nighttimenight      -0.65978    0.81198  -0.813 0.416471    
speed                0.13833    0.04340   3.187 0.001436 ** 
prior_offenceCD60  -46.75869 7779.75904  -0.006 0.995205    
prior_offenceDD20  -28.77126 4240.26405  -0.007 0.994586    
prior_offenceDR50  -20.50175 4240.26347  -0.005 0.996142    
prior_offenceDR80  -27.70393 4240.26414  -0.007 0.994787    
prior_offenceN     -23.06010 4240.26337  -0.005 0.995661    
prior_offencePL10  -21.14657 4240.52580  -0.005 0.996021    
 [ reached getOption("max.print") -- omitted 6 rows ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 208.819  on 206  degrees of freedom
Residual deviance:  61.829  on 191  degrees of freedom
AIC: 93.829

Number of Fisher Scoring iterations: 17

anova(logit, test = "Chisq")
[1] 71
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


              Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                            206    208.819              
age            1   63.711       205    145.109 1.441e-15 ***
nighttime      1    0.838       204    144.270    0.3599    
speed          1   20.750       203    123.521 5.234e-06 ***
prior_offence  9   35.981       194     87.539 3.995e-05 ***
bac            1   25.469       193     62.070 4.496e-07 ***
officer        2    0.241       191     61.829    0.8864    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
logit2 <- glm(outcome ~ scale(speed) + scale(bac), data = drinkdriving, 
    family = "binomial")
[1] 72
summary(logit2)
[1] 73

Call:
glm(formula = outcome ~ scale(speed) + scale(bac), family = "binomial", 
    data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.4523   0.0434   0.1813   0.4465   2.1456  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept)    2.6312     0.3746   7.023 2.16e-12 ***
scale(speed)   2.0843     0.3769   5.530 3.21e-08 ***
scale(bac)     1.2747     0.2933   4.346 1.39e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 208.82  on 206  degrees of freedom
Residual deviance: 111.65  on 204  degrees of freedom
AIC: 117.65

Number of Fisher Scoring iterations: 6

anova(logit2, test = "Chisq")
[1] 74
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


             Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                           206     208.82              
scale(speed)  1   71.651       205     137.17 < 2.2e-16 ***
scale(bac)    1   25.523       204     111.65 4.372e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
logit3 <- glm(outcome ~ scale(bac) + scale(speed), data = drinkdriving, 
    family = "binomial")
[1] 75
summary(logit3)
[1] 76

Call:
glm(formula = outcome ~ scale(bac) + scale(speed), family = "binomial", 
    data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.4523   0.0434   0.1813   0.4465   2.1456  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept)    2.6312     0.3746   7.023 2.16e-12 ***
scale(bac)     1.2747     0.2933   4.346 1.39e-05 ***
scale(speed)   2.0843     0.3769   5.530 3.21e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 208.82  on 206  degrees of freedom
Residual deviance: 111.65  on 204  degrees of freedom
AIC: 117.65

Number of Fisher Scoring iterations: 6

anova(logit3, test = "Chisq")
[1] 77
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


             Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                           206     208.82              
scale(bac)    1   40.211       205     168.61 2.280e-10 ***
scale(speed)  1   56.963       204     111.65 4.441e-14 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
length(drinkdriving$prior_offence[drinkdriving$prior_offence == 
    "DR50" & drinkdriving$outcome == 1])
[1] 78
[1] 32
length(drinkdriving$prior_offence[drinkdriving$prior_offence == 
    "DR50"])
[1] 79
[1] 35
length(drinkdriving$prior_offence[drinkdriving$prior_offence != 
    "DR50" & drinkdriving$outcome == 1])
[1] 80
[1] 133
length(drinkdriving$prior_offence[drinkdriving$prior_offence != 
    "DR50"])
[1] 81
[1] 172
drinkdriving$prior_drink <- as.character(drinkdriving$prior_offence)
[1] 82
drinkdriving$prior_drink[drinkdriving$prior_drink == "DR50"] <- 1
[1] 83
drinkdriving$prior_drink[drinkdriving$prior_drink != 1 & drinkdriving$prior_drink != 
    "N"] <- 0
[1] 84
drinkdriving$prior_drink[drinkdriving$prior_drink == "N"] <- NA
[1] 85
t.test(outcome ~ prior_drink, data = drinkdriving)
[1] 86

	Welch Two Sample t-test

data:  outcome by prior_drink
t = -1.9969, df = 23.164, p-value = 0.05772
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.504039219  0.008801124
sample estimates:
mean in group 0 mean in group 1 
      0.6666667       0.9142857 

drinkdriving$any_offence <- ifelse(drinkdriving$prior_offence != 
    "N", 1, 0)
[1] 87
table(drinkdriving$any_offence)
[1] 88

  0   1 
154  53 
m.offence <- glm(outcome ~ any_offence, data = drinkdriving, 
    family = binomial)
[1] 89
summary(m.offence)
[1] 90

Call:
glm(formula = outcome ~ any_offence, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.8831   0.6101   0.6945   0.6945   0.6945  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)   1.2993     0.1964   6.616 3.69e-11 ***
any_offence   0.2877     0.4152   0.693    0.488    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 208.82  on 206  degrees of freedom
Residual deviance: 208.32  on 205  degrees of freedom
AIC: 212.32

Number of Fisher Scoring iterations: 4

anova(m.offence, test = "Chisq")
[1] 91
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


            Df Deviance Resid. Df Resid. Dev Pr(>Chi)
NULL                          206     208.82         
any_offence  1  0.49652       205     208.32    0.481
drinkdriving$nighttime <- ifelse(drinkdriving$nighttime == "day", 
    1, 0)
[1] 92
m.prob <- glm(outcome ~ age + nighttime + speed + any_offence + 
    bac, data = drinkdriving, family = binomial)
[1] 93
summary(m.prob)
[1] 94

Call:
glm(formula = outcome ~ age + nighttime + speed + any_offence + 
    bac, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.5991   0.0431   0.1728   0.4191   2.1880  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -4.81962    2.24072  -2.151  0.03148 *  
age         -0.04734    0.02071  -2.286  0.02224 *  
nighttime    0.14180    0.56218   0.252  0.80086    
speed        0.13267    0.03450   3.846  0.00012 ***
any_offence  0.40332    0.61447   0.656  0.51159    
bac         19.57451    5.22656   3.745  0.00018 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 208.82  on 206  degrees of freedom
Residual deviance: 105.63  on 201  degrees of freedom
AIC: 117.63

Number of Fisher Scoring iterations: 6

predic_by_ages <- exp(coef(m.prob)[1] + coef(m.prob)[2] * 17 + 
    coef(m.prob)[3] * 1 + coef(m.prob)[4] * 30 + coef(m.prob)[5] * 
    0 + coef(m.prob)[6] * 0)
[1] 95
predicted_probs <- exp(predic_by_ages)/(1 + exp(predic_by_ages))
[1] 96
predicted_probs

(Intercept) 
  0.5554202 


ages <- seq(17, 90)
[1] 98
calculate_probs <- function(age) {
    prob <- exp(coef(m.prob)[1] + coef(m.prob)[2] * age + coef(m.prob)[3] * 
        1 + coef(m.prob)[4] * 30 + coef(m.prob)[5] * 0 + coef(m.prob)[6] * 
        0)
    return(exp(prob)/(1 + exp(prob)))
}
[1] 99
predicted_probs <- sapply(ages, calculate_probs)
[1] 100
plot(predicted_probs, type = "l", xlab = "Ages", ylab = "p(getting a fine)", 
    lwd = 2, col = "red", xaxt = "n")
[1] 101
axis(side = 1, at = seq(17, 90, by = 10))
[1] 102
[1] 17 27 37 47 57 67 77 87
data_prob <- data.frame(ages = ages, `p()` = predicted_probs)
[1] 103
data_prob

   ages       p..
1    17 0.5554202
2    18 0.5528772
3    19 0.5504492
4    20 0.5481312
5    21 0.5459185
6    22 0.5438063
7    23 0.5417904
8    24 0.5398664
9    25 0.5380303
10   26 0.5362781
11   27 0.5346061
12   28 0.5330107
13   29 0.5314884
14   30 0.5300360
15   31 0.5286502
16   32 0.5273281
17   33 0.5260668
18   34 0.5248635
19   35 0.5237156
20   36 0.5226206
21   37 0.5215759
22   38 0.5205794
23   39 0.5196288
24   40 0.5187220
25   41 0.5178571
 [ reached 'max' / getOption("max.print") -- omitted 49 rows ]


spec_pro <- ggplot(data = drinkdriving, aes(x = age, y = outcome, 
    color = officer))
[1] 105
spec_pro + geom_jitter() + theme_minimal() + facet_grid(. ~ officer)
[1] 106
range_age <- cut(x = drinkdriving$age, breaks = 6, labels = c("17-29", 
    "30-41", "42-54", "55-66", "67-78", "78-90"))
[1] 107
summary(range_age)
[1] 108
17-29 30-41 42-54 55-66 67-78 78-90 
   43    65    40    37    16     6 
groups_age <- xtabs(~outcome + officer + range_age, data = drinkdriving)
[1] 109
groups_age2 <- xtabs(~outcome + officer, data = drinkdriving[drinkdriving$age < 
    42, ])
[1] 110
addmargins(groups_age2)
[1] 111
       officer
outcome  AS  IT  NP Sum
    0     0   2   2   4
    1    58  17  29 104
    Sum  58  19  31 108
chisq.test(groups_age2)
[1] 112

	Pearson's Chi-squared test

data:  groups_age2
X-squared = 5.3669, df = 2, p-value = 0.06833

fisher.test(groups_age2)
[1] 113

	Fisher's Exact Test for Count Data

data:  groups_age2
p-value = 0.03752
alternative hypothesis: two.sided

