

	####### B154827 R script #######

library(psych, quietly = T)
[1] 1
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(tidyverse, quietly = T)
[1] 2
 [1] "forcats"   "stringr"   "dplyr"     "purrr"     "tidyr"     "tibble"    "ggplot2"   "tidyverse" "psych"     "readr"    
[11] "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
load(url("https://edin.ac/2QCZNVu"))
[1] 3
[1] "drinkdriving" "officer_inc" 
outliers <- function(obs, x = 2.5) {
    return(abs(obs - mean(obs, na.rm = T)) > (sd(obs, na.rm = T) * 
        x))
}
[1] 4
drinkdriving$age[which(outliers(drinkdriving$age))] <- NA
[1] 5
drinkdriving$bac[which(outliers(drinkdriving$bac))] <- NA
[1] 6
drinkdriving$speed[which(outliers(drinkdriving$speed))] <- NA
[1] 7
drinkdriving$nighttime[drinkdriving$nighttime == "18:25"] <- "night"
[1] 8
drinkdriving$nighttime[drinkdriving$nighttime == "2:05"] <- "night"
[1] 9
drinkdriving$nighttime <- as.factor(drinkdriving$nighttime)
[1] 10
drinkdriving$prior_offence[drinkdriving$prior_offence == "DD20"] <- NA
[1] 11
drinkdriving$prior_offence <- ifelse(drinkdriving$prior_offence == 
    "N", "No", ifelse(drinkdriving$prior_offence == "DR50" | 
    drinkdriving$prior_offence == "TS70,DR50", "Drinking", "Non-drinking"))
[1] 12
drinkdriving$prior_offence <- as.factor(drinkdriving$prior_offence)
[1] 13
drinkdriving$outcome[drinkdriving$outcome == "Fine"] <- "fine"
[1] 14
drinkdriving$outcome[drinkdriving$outcome == "FINE"] <- "fine"
[1] 15
drinkdriving$outcome[drinkdriving$outcome == "Warning"] <- "warning"
[1] 16
drinkdriving$outcome[drinkdriving$outcome == "WARNING"] <- "warning"
[1] 17
drinkdriving$outcome <- as.factor(drinkdriving$outcome)
[1] 18
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 19
summary(m1)
[1] 20

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.3270  -4.1824  -0.5698   3.9975  14.9487 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 28.68503    1.06949   26.82  < 2e-16 ***
age         -0.13730    0.02331   -5.89 1.47e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.791 on 216 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.1384,	Adjusted R-squared:  0.1344 
F-statistic: 34.69 on 1 and 216 DF,  p-value: 1.469e-08

plot(m1, which = c(1:4))
[1] 21
age_1.2 <- data.frame(age = 50)
[1] 22
predict(m1, newdata = age_1.2, interval = "confidence")
[1] 23
       fit      lwr      upr
1 21.81983 20.97678 22.66289
m2.1 <- lm(bac ~ age + nighttime + speed, data = drinkdriving)
[1] 24
summary(m2.1)
[1] 25

Call:
lm(formula = bac ~ age + nighttime + speed, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-14.9677  -4.2936   0.3551   3.5986  14.1768 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    21.39236    2.83494   7.546 1.34e-12 ***
age            -0.09683    0.03066  -3.159  0.00182 ** 
nighttimenight  3.75822    0.81057   4.637 6.22e-06 ***
speed           0.07522    0.04376   1.719  0.08709 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.507 on 210 degrees of freedom
  (36 observations deleted due to missingness)
Multiple R-squared:  0.238,	Adjusted R-squared:  0.2272 
F-statistic: 21.87 on 3 and 210 DF,  p-value: 2.302e-12

plot(m2.1, which = c(1:4))
[1] 26
m2.3 <- lm(speed ~ nighttime + age + bac + prior_offence, data = drinkdriving)
[1] 27
summary(m2.3)
[1] 28

Call:
lm(formula = speed ~ nighttime + age + bac + prior_offence, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-26.0159  -3.5159  -0.0941   4.2816  22.1291 

Coefficients:
                          Estimate Std. Error t value Pr(>|t|)    
(Intercept)               54.00980    3.69171  14.630   <2e-16 ***
nighttimenight             0.27743    1.35746   0.204    0.838    
age                       -0.45144    0.03894 -11.593   <2e-16 ***
bac                        0.17649    0.10847   1.627    0.105    
prior_offenceNo            0.37508    1.57504   0.238    0.812    
prior_offenceNon-drinking -1.99291    2.72880  -0.730    0.466    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 8.687 on 204 degrees of freedom
  (40 observations deleted due to missingness)
Multiple R-squared:  0.4719,	Adjusted R-squared:  0.459 
F-statistic: 36.46 on 5 and 204 DF,  p-value: < 2.2e-16

m3.1_no_scale <- glm(outcome ~ age + nighttime + prior_offence + 
    speed + bac, data = drinkdriving, family = binomial)
[1] 29
m3.1_scale <- glm(outcome ~ scale(age) + nighttime + prior_offence + 
    scale(speed) + scale(bac), data = drinkdriving, family = binomial)
[1] 30
summary(m3.1_no_scale)
[1] 31

Call:
glm(formula = outcome ~ age + nighttime + prior_offence + speed + 
    bac, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.8548  -0.2970  -0.0892  -0.0167   3.7482  

Coefficients:
                          Estimate Std. Error z value Pr(>|z|)    
(Intercept)                2.62471    2.91740   0.900 0.368293    
age                        0.07309    0.02535   2.883 0.003937 ** 
nighttimenight             0.17039    0.65411   0.260 0.794484    
prior_offenceNo            2.03895    1.13069   1.803 0.071344 .  
prior_offenceNon-drinking  2.43902    1.60269   1.522 0.128052    
speed                     -0.14563    0.04566  -3.189 0.001426 ** 
bac                       -0.24624    0.06425  -3.832 0.000127 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 195.538  on 209  degrees of freedom
Residual deviance:  78.558  on 203  degrees of freedom
  (40 observations deleted due to missingness)
AIC: 92.558

Number of Fisher Scoring iterations: 7

summary(m3.1_scale)
[1] 32

Call:
glm(formula = outcome ~ scale(age) + nighttime + prior_offence + 
    scale(speed) + scale(bac), family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.8548  -0.2970  -0.0892  -0.0167   3.7482  

Coefficients:
                          Estimate Std. Error z value Pr(>|z|)    
(Intercept)                -5.9287     1.3943  -4.252 2.12e-05 ***
scale(age)                  1.2257     0.4251   2.883 0.003937 ** 
nighttimenight              0.1704     0.6541   0.260 0.794484    
prior_offenceNo             2.0390     1.1307   1.803 0.071344 .  
prior_offenceNon-drinking   2.4390     1.6027   1.522 0.128052    
scale(speed)               -1.8972     0.5949  -3.189 0.001426 ** 
scale(bac)                 -1.6144     0.4213  -3.832 0.000127 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 195.538  on 209  degrees of freedom
Residual deviance:  78.558  on 203  degrees of freedom
  (40 observations deleted due to missingness)
AIC: 92.558

Number of Fisher Scoring iterations: 7

m3.2 <- glm(outcome ~ relevel(prior_offence, "Drinking") + age + 
    nighttime + speed + bac, data = drinkdriving, family = binomial)
[1] 33
summary(m3.2)
[1] 34

Call:
glm(formula = outcome ~ relevel(prior_offence, "Drinking") + 
    age + nighttime + speed + bac, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.8548  -0.2970  -0.0892  -0.0167   3.7482  

Coefficients:
                                               Estimate Std. Error z value Pr(>|z|)    
(Intercept)                                     2.62471    2.91740   0.900 0.368293    
relevel(prior_offence, "Drinking")No            2.03895    1.13069   1.803 0.071344 .  
relevel(prior_offence, "Drinking")Non-drinking  2.43902    1.60269   1.522 0.128052    
age                                             0.07309    0.02535   2.883 0.003937 ** 
nighttimenight                                  0.17039    0.65411   0.260 0.794484    
speed                                          -0.14563    0.04566  -3.189 0.001426 ** 
bac                                            -0.24624    0.06425  -3.832 0.000127 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 195.538  on 209  degrees of freedom
Residual deviance:  78.558  on 203  degrees of freedom
  (40 observations deleted due to missingness)
AIC: 92.558

Number of Fisher Scoring iterations: 7

drinkdriving$prior_binary_offence <- ifelse(drinkdriving$prior_offence == 
    "No", 0, 1)
[1] 35
m3.3 <- glm(outcome ~ prior_binary_offence + age + nighttime + 
    speed + bac, data = drinkdriving, family = binomial)
[1] 36
summary(m3.3)
[1] 37

Call:
glm(formula = outcome ~ prior_binary_offence + age + nighttime + 
    speed + bac, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.2645  -0.3065  -0.0981  -0.0202   4.1458  

Coefficients:
                     Estimate Std. Error z value Pr(>|z|)    
(Intercept)           4.24367    2.68722   1.579 0.114289    
prior_binary_offence -1.15015    0.77538  -1.483 0.137984    
age                   0.07664    0.02598   2.950 0.003178 ** 
nighttimenight        0.07068    0.63577   0.111 0.911474    
speed                -0.14475    0.04450  -3.253 0.001143 ** 
bac                  -0.23373    0.06210  -3.764 0.000168 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 195.538  on 209  degrees of freedom
Residual deviance:  81.002  on 204  degrees of freedom
  (40 observations deleted due to missingness)
AIC: 93.002

Number of Fisher Scoring iterations: 7

data4 <- data.frame(age = c(17:90), nighttime = "day", prior_offence = "No", 
    speed = 30, bac = 0)
[1] 38
drinkdriving$outcome_dummy <- ifelse(drinkdriving$outcome == 
    "fine", 1, 0)
[1] 39
m4 <- glm(outcome_dummy ~ age + nighttime + prior_offence + speed + 
    bac, data = drinkdriving, family = binomial)
[1] 40
predicted_prob <- predict(m4, newdata = data4, type = "response")
[1] 41
data4 <- mutate(data4, probabilities = predicted_prob)
[1] 42
ggplot(data = data4, aes(x = age, y = probabilities)) + geom_line() + 
    labs(title = "Predicted Probabilities of Receiving a Fine for Different Ages")
[1] 43
data5 <- merge(drinkdriving, officer_inc, all.x = T)
[1] 44
m5_to_AS <- glm(outcome ~ age * relevel(officer, "AS") + speed + 
    bac + nighttime, data = data5, family = binomial)
[1] 45
m5_to_IT <- glm(outcome ~ age * relevel(officer, "IT") + speed + 
    bac + nighttime, data = data5, family = binomial)
[1] 46
summary(m5_to_AS)
[1] 47

Call:
glm(formula = outcome ~ age * relevel(officer, "AS") + speed + 
    bac + nighttime, family = binomial, data = data5)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1718  -0.3513  -0.1042  -0.0144   3.3604  

Coefficients:
                             Estimate Std. Error z value Pr(>|z|)    
(Intercept)                   0.89136    3.15324   0.283 0.777421    
age                           0.12879    0.04345   2.964 0.003038 ** 
relevel(officer, "AS")IT      7.23906    3.13673   2.308 0.021008 *  
relevel(officer, "AS")NP      7.04071    3.22877   2.181 0.029212 *  
speed                        -0.14887    0.04166  -3.574 0.000352 ***
bac                          -0.20100    0.05355  -3.753 0.000174 ***
nighttimenight               -0.16218    0.59261  -0.274 0.784337    
age:relevel(officer, "AS")IT -0.13054    0.05446  -2.397 0.016536 *  
age:relevel(officer, "AS")NP -0.13718    0.05701  -2.406 0.016117 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 203.20  on 213  degrees of freedom
Residual deviance:  95.35  on 205  degrees of freedom
  (36 observations deleted due to missingness)
AIC: 113.35

Number of Fisher Scoring iterations: 7

summary(m5_to_IT)
[1] 48

Call:
glm(formula = outcome ~ age * relevel(officer, "IT") + speed + 
    bac + nighttime, family = binomial, data = data5)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1718  -0.3513  -0.1042  -0.0144   3.3604  

Coefficients:
                              Estimate Std. Error z value Pr(>|z|)    
(Intercept)                   8.130421   2.912431   2.792 0.005244 ** 
age                          -0.001748   0.033085  -0.053 0.957877    
relevel(officer, "IT")AS     -7.239059   3.136734  -2.308 0.021008 *  
relevel(officer, "IT")NP     -0.198351   2.424108  -0.082 0.934786    
speed                        -0.148874   0.041659  -3.574 0.000352 ***
bac                          -0.201002   0.053551  -3.753 0.000174 ***
nighttimenight               -0.162179   0.592606  -0.274 0.784337    
age:relevel(officer, "IT")AS  0.130538   0.054462   2.397 0.016536 *  
age:relevel(officer, "IT")NP -0.006639   0.045486  -0.146 0.883955    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 203.20  on 213  degrees of freedom
Residual deviance:  95.35  on 205  degrees of freedom
  (36 observations deleted due to missingness)
AIC: 113.35

Number of Fisher Scoring iterations: 7

police_AS <- data5[which(data5$officer == "AS"), ]
[1] 49
AS_age_outcome <- glm(outcome_dummy ~ age + speed + bac + nighttime, 
    data = police_AS, family = binomial)
[1] 50
summary(AS_age_outcome)
[1] 51

Call:
glm(formula = outcome_dummy ~ age + speed + bac + nighttime, 
    family = binomial, data = police_AS)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.86602   0.00044   0.00761   0.04273   1.06064  

Coefficients:
               Estimate Std. Error z value Pr(>|z|)  
(Intercept)    -4.72074    6.45352  -0.731   0.4645  
age            -0.20479    0.08389  -2.441   0.0146 *
speed           0.19307    0.13499   1.430   0.1526  
bac             0.46264    0.18960   2.440   0.0147 *
nighttimenight  2.27166    1.65137   1.376   0.1689  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 94.673  on 100  degrees of freedom
Residual deviance: 16.644  on  96  degrees of freedom
  (15 observations deleted due to missingness)
AIC: 26.644

Number of Fisher Scoring iterations: 9

