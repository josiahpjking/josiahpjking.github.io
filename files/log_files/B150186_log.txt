

	####### B150186 R script #######

load(url("https://edin.ac/2QCZNVu"))
[1] 1
[1] "drinkdriving" "officer_inc" 
drinkdriving$nighttime <- as.factor(drinkdriving$nighttime)
[1] 2
drinkdriving$nighttime[drinkdriving$nighttime == "18:25"] <- "night"
[1] 3
drinkdriving$nighttime[drinkdriving$nighttime == "2:05"] <- "night"
[1] 4
drinkdriving$prior_offence <- as.factor(drinkdriving$prior_offence)
[1] 5
drinkdriving$prior_offence[drinkdriving$prior_offence == "DD20"] <- NA
[1] 6
drinkdriving$outcome <- as.factor(drinkdriving$outcome)
[1] 7
drinkdriving$outcome[c(11, 97, 120, 123, 233, 244)] <- "warning"
[1] 8
drinkdriving$outcome[c(12, 24, 110, 141, 152, 159, 166, 170, 
    178, 220, 234)] <- "fine"
[1] 9
drinkdriving <- droplevels(drinkdriving)
[1] 10
drinkdriving$speed <- round(drinkdriving$speed, digits = 0)
[1] 11
drinkdriving$bac <- round(drinkdriving$bac, digits = 0)
[1] 12
boxplot(drinkdriving$bac)
[1] 13
boxplot(drinkdriving$speed)
[1] 14
boxplot(drinkdriving$age)
[1] 15
drinkdriving$age[drinkdriving$age > 125] <- NA
[1] 16
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 17
summary(m1)
[1] 18

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.797  -4.267  -0.744   3.738  43.044 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 29.29059    1.25537  23.332  < 2e-16 ***
age         -0.14396    0.02741  -5.253 3.56e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.818 on 218 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1123,	Adjusted R-squared:  0.1083 
F-statistic: 27.59 on 1 and 218 DF,  p-value: 3.559e-07

plot(m1, which = 2)
[1] 19
plot(m1, which = 4)
[1] 20
m2 <- lm(bac ~ age + speed, data = drinkdriving)
[1] 21
hist(drinkdriving$age)
[1] 22
hist(drinkdriving$speed)
[1] 23
m2.s <- lm(scale(bac) ~ scale(age) + scale(speed), data = drinkdriving)
[1] 24
summary(m2.s)
[1] 25

Call:
lm(formula = scale(bac) ~ scale(age) + scale(speed), data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.0645 -0.5905 -0.1221  0.5436  4.6482 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  -0.01984    0.05903  -0.336    0.737    
scale(age)   -0.09608    0.07490  -1.283    0.201    
scale(speed)  0.38664    0.07970   4.851 2.34e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.8681 on 217 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1992,	Adjusted R-squared:  0.1918 
F-statistic: 26.99 on 2 and 217 DF,  p-value: 3.412e-11

drinkdriving$darkness <- ifelse(drinkdriving$nighttime == "night", 
    1, 0)
[1] 26
m2_timeofday <- lm(bac ~ age + darkness, data = drinkdriving)
[1] 27
summary(m2_timeofday)
[1] 28

Call:
lm(formula = bac ~ age + darkness, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-17.113  -4.884   0.036   3.415  41.850 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 26.40876    1.42665  18.511  < 2e-16 ***
age         -0.13577    0.02665  -5.094  7.6e-07 ***
darkness     3.71480    0.95975   3.871 0.000144 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.609 on 217 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1697,	Adjusted R-squared:  0.162 
F-statistic: 22.17 on 2 and 217 DF,  p-value: 1.733e-09

m3 <- lm(bac ~ age + darkness, data = drinkdriving)
[1] 29
summary(m3)
[1] 30

Call:
lm(formula = bac ~ age + darkness, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-17.113  -4.884   0.036   3.415  41.850 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 26.40876    1.42665  18.511  < 2e-16 ***
age         -0.13577    0.02665  -5.094  7.6e-07 ***
darkness     3.71480    0.95975   3.871 0.000144 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.609 on 217 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1697,	Adjusted R-squared:  0.162 
F-statistic: 22.17 on 2 and 217 DF,  p-value: 1.733e-09

m4 <- lm(bac ~ age + speed + darkness, data = drinkdriving)
[1] 31
summary(m4)
[1] 32

Call:
lm(formula = bac ~ age + speed + darkness, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-13.655  -4.741   0.109   3.871  33.254 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 14.00497    2.74320   5.105 7.23e-07 ***
age         -0.03118    0.03225  -0.967    0.335    
speed        0.20034    0.03859   5.192 4.79e-07 ***
darkness     3.88476    0.90762   4.280 2.81e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.246 on 216 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.2618,	Adjusted R-squared:  0.2515 
F-statistic: 25.53 on 3 and 216 DF,  p-value: 3.533e-14

with(drinkdriving, cor.test(speed, darkness))
[1] 33

	Pearson's product-moment correlation

data:  speed and darkness
t = 0.85029, df = 248, p-value = 0.396
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.07062477  0.17679903
sample estimates:
       cor 
0.05391464 

drinkdriving$severity <- ifelse(drinkdriving$outcome == "fine", 
    1, 0)
[1] 34
drinkdriving$repeatoffender <- ifelse(drinkdriving$prior_offence != 
    "N", 1, 0)
[1] 35
drinkdriving$prior_offence[drinkdriving$prior_offence == "TS70,DR50"] <- "DR50"
[1] 36
drinkdriving$drinkoffender <- ifelse(drinkdriving$prior_offence == 
    "DR50", 1, 0)
[1] 37
m5 <- glm(severity ~ age + speed + bac + darkness + repeatoffender + 
    drinkoffender, data = drinkdriving, family = binomial)
[1] 38
summary(m5)
[1] 39

Call:
glm(formula = severity ~ age + speed + bac + darkness + repeatoffender + 
    drinkoffender, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.7889   0.0116   0.0802   0.2765   2.8984  

Coefficients:
               Estimate Std. Error z value Pr(>|z|)    
(Intercept)    -5.52063    2.59783  -2.125 0.033579 *  
age            -0.06954    0.02462  -2.824 0.004739 ** 
speed           0.16500    0.04074   4.050 5.12e-05 ***
bac             0.24850    0.06481   3.834 0.000126 ***
darkness       -0.15606    0.66522  -0.235 0.814520    
repeatoffender -0.40687    1.21048  -0.336 0.736776    
drinkoffender   2.28753    1.52510   1.500 0.133634    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 209.932  on 215  degrees of freedom
Residual deviance:  78.672  on 209  degrees of freedom
  (34 observations deleted due to missingness)
AIC: 92.672

Number of Fisher Scoring iterations: 7

m5.s <- glm(scale(severity) ~ scale(speed) + scale(bac), data = drinkdriving)
[1] 40
summary(m5.s)
[1] 41

Call:
glm(formula = scale(severity) ~ scale(speed) + scale(bac), data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.0232  -0.2547   0.2817   0.6000   1.3025  

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.0003599  0.0536091   0.007 0.994649    
scale(speed) 0.4080839  0.0625614   6.523 3.99e-10 ***
scale(bac)   0.2154410  0.0623784   3.454 0.000652 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for gaussian family taken to be 0.7041138)

    Null deviance: 243.86  on 244  degrees of freedom
Residual deviance: 170.40  on 242  degrees of freedom
  (5 observations deleted due to missingness)
AIC: 614.31

Number of Fisher Scoring iterations: 2

offences_model <- glm(severity ~ repeatoffender + drinkoffender, 
    data = drinkdriving, family = binomial)
[1] 42
summary(offences_model)
[1] 43

Call:
glm(formula = severity ~ repeatoffender + drinkoffender, family = binomial, 
    data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1899   0.4366   0.6681   0.6681   0.8346  

Coefficients:
               Estimate Std. Error z value Pr(>|z|)    
(Intercept)      1.3863     0.1838   7.542 4.62e-14 ***
repeatoffender  -0.5108     0.5631  -0.907   0.3643    
drinkoffender    1.4271     0.7471   1.910   0.0561 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 237.06  on 245  degrees of freedom
Residual deviance: 232.55  on 243  degrees of freedom
  (4 observations deleted due to missingness)
AIC: 238.55

Number of Fisher Scoring iterations: 4

prediction_mod <- glm(severity ~ age + darkness + speed + bac + 
    repeatoffender, data = drinkdriving, family = binomial)
[1] 44
age_range <- data.frame(age = 17:65, darkness = 0, speed = 30, 
    bac = 0, repeatoffender = 0)
[1] 45
prediction <- predict(prediction_mod, newdata = age_range, type = "response")
[1] 46
plot(age_range$age, prediction, xlab = "Age", ylab = "Probability", 
    lwd = "2", col = "red")
[1] 47
drinkdriving <- merge(drinkdriving, officer_inc, by.x = "incident_id", 
    sort = T)
[1] 48
contrasts(drinkdriving$officer)
[1] 49
   IT NP
AS  0  0
IT  1  0
NP  0  1
m6 <- glm(severity ~ age * officer, data = drinkdriving, family = binomial)
[1] 50
summary(m6)
[1] 51

Call:
glm(formula = severity ~ age * officer, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.7179   0.0642   0.2741   0.5454   2.4089  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept)    9.56920    1.99554   4.795 1.62e-06 ***
age           -0.16122    0.03466  -4.652 3.29e-06 ***
officerIT     -5.04535    2.39610  -2.106   0.0352 *  
officerNP     -4.68465    2.48887  -1.882   0.0598 .  
age:officerIT  0.09612    0.04254   2.260   0.0238 *  
age:officerNP  0.09365    0.04405   2.126   0.0335 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 222.38  on 224  degrees of freedom
Residual deviance: 146.41  on 219  degrees of freedom
  (25 observations deleted due to missingness)
AIC: 158.41

Number of Fisher Scoring iterations: 7

