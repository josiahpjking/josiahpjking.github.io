

	####### B151572 R script #######

library(ggplot2, quietly = T)
[1] 1
[1] "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 2
 [1] "car"       "carData"   "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
library(psych, quietly = T)
[1] 3
 [1] "psych"     "car"       "carData"   "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[11] "methods"   "base"     
library(base, quietly = T)
[1] 4
 [1] "psych"     "car"       "carData"   "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[11] "methods"   "base"     
library(plotly, quietly = T)
[1] 5
 [1] "plotly"    "psych"     "car"       "carData"   "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"    
[11] "datasets"  "methods"   "base"     
library(jtools, quietly = T)
[1] 6
 [1] "jtools"    "plotly"    "psych"     "car"       "carData"   "ggplot2"   "readr"     "stats"     "graphics"  "grDevices"
[11] "utils"     "datasets"  "methods"   "base"     
load(url("https://edin.ac/2QCZNVu"))
[1] 7
[1] "drinkdriving" "officer_inc" 
describe(drinkdriving)
[1] 8
               vars   n mean    sd median trimmed   mad min  max range skew kurtosis   se
age               1 228   46 33.35   40.5   42.34 18.53  14  297   283  5.5    38.49 2.21
nighttime*        2 250  NaN    NA     NA     NaN    NA Inf -Inf  -Inf   NA       NA   NA
prior_offence*    3 250  NaN    NA     NA     NaN    NA Inf -Inf  -Inf   NA       NA   NA
 [ reached 'max' / getOption("max.print") -- omitted 4 rows ]
plot(drinkdriving$age)
[1] 9
drinkdriving$age[drinkdriving$age > 100] <- NA
[1] 10
plot(drinkdriving$age)
[1] 11
table(drinkdriving$nighttime)
[1] 12

18:25  2:05   day night 
    1     2    78   169 
drinkdriving$nighttime[!drinkdriving$nighttime == "day" & !drinkdriving$nighttime == 
    "night"] <- NA
[1] 13
drinkdriving$nighttime <- as.factor(drinkdriving$nighttime)
[1] 14
table(drinkdriving$nighttime)
[1] 15

  day night 
   78   169 
table(drinkdriving$prior_offence)
[1] 16

          CD10           CD60 CD60,CD10,DR80      CD60,CD60           DD20           DR50           DR80              N           PL10 
             2              1              1              1              4             43              4            185              2 
          SP50           SP60           TS70      TS70,DR50 
             2              1              3              1 
drinkdriving$prior_offence[drinkdriving$prior_offence == "CD10" | 
    drinkdriving$prior_offence == "CD60" | drinkdriving$prior_offence == 
    "CD60,CD60"] <- "CD"
[1] 17
drinkdriving$prior_offence[drinkdriving$prior_offence == "PL10"] <- "PL"
[1] 18
drinkdriving$prior_offence[drinkdriving$prior_offence == "SP50" | 
    drinkdriving$prior_offence == "SP60"] <- "SP"
[1] 19
drinkdriving$prior_offence[drinkdriving$prior_offence == "TS70"] <- "TS"
[1] 20
drinkdriving$prior_offence[drinkdriving$prior_offence == "DD20"] <- NA
[1] 21
table(drinkdriving$prior_offence)
[1] 22

            CD CD60,CD10,DR80           DR50           DR80              N             PL             SP             TS      TS70,DR50 
             4              1             43              4            185              2              3              3              1 
drinkdriving$prior_offence <- as.factor(drinkdriving$prior_offence)
[1] 23
plot(drinkdriving$speed)
[1] 24
qqnorm(drinkdriving$speed)
[1] 25
$x
 [1]  0.55338472  0.22754498  0.48454378 -1.60724789 -2.32634787  0.07526986 -2.51214433 -0.43991317  1.60724789 -2.19728638
[11]  0.77896556  0.51865693  0.39614237 -0.38532047  0.38532047  0.13577393  1.36580556 -0.12566135  0.32127764 -0.51865693
[21]  1.82500682  1.39174378 -0.97009328  0.75208491 -0.34246630  0.67448975  0.28975981 -0.41792767 -0.25852728 -1.14550506
[31] -1.77438191 -1.53819886  0.04513463 -0.28975981  1.16504692 -0.71275076  0.37454350  0.10547362  0.98627130  0.45098550
[41] -1.24808481  0.95416525  0.11556160 -0.10547362  0.08532879 -0.61281299  1.50626172 -0.07526986 -2.01409081  1.64485363
 [ reached getOption("max.print") -- omitted 200 entries ]

$y
 [1] 47.957110 43.826353 47.260707 17.221097  1.945818 41.399468  1.012149 34.377506 63.748159  2.533468 50.049472 47.658553 46.209515
[14] 35.044348 45.911152 41.971790 59.500756 38.544314 45.294085 33.660408 66.359756 59.538043 26.205563 49.692191 35.759413 48.880880
[27] 44.464566 34.639220 36.609294 24.917257 13.069805 19.008994 41.009485 36.335035 56.428161 30.141277 45.716490 41.609061 53.768251
[40] 46.424053 23.599427 52.982425 41.674665 38.867482 41.537199 32.599695 61.109335 39.685430 12.246206 64.659834
 [ reached getOption("max.print") -- omitted 200 entries ]

drinkdriving$speed[drinkdriving$speed > mean(drinkdriving$speed) + 
    3 * sd(drinkdriving$speed)] <- NA
[1] 26
drinkdriving$speed[drinkdriving$speed == 0] <- NA
[1] 27
plot(drinkdriving$speed)
[1] 28
plot(drinkdriving$bac)
[1] 29
drinkdriving$bac[drinkdriving$bac > 50] <- NA
[1] 30
plot(drinkdriving$bac)
[1] 31
qqnorm(drinkdriving$bac)
[1] 32
$x
 [1] -0.96742157 -0.20779255  1.43158238 -0.48224821  0.88810254 -0.69076707 -0.29296707  0.52914074  0.04127309  0.12410193
[11]  0.75781846  0.50555550 -1.20984741  1.07148677 -0.50555550  0.57722717  2.08535557 -0.62668735  1.00090564 -0.34726125
[21]  0.30375196  2.18612332 -0.98402569 -0.33632538 -0.39143835  1.40341264  0.15535278 -0.41381125 -1.10886202 -1.52374663
[31] -2.50210647 -0.56508425  0.32542959  0.38032564 -0.95107996 -1.37631452  1.10886202  0.40259961 -0.43639324 -0.12410193
[41]  1.14785408  0.17626940  0.13450392 -0.85790214 -0.25015286  0.29296707 -0.52914074  0.71719947 -0.19726343  1.67136196
 [ reached getOption("max.print") -- omitted 200 entries ]

$y
 [1] 17.713735 22.134400 32.789395 20.475763 29.367360 19.127171 21.377196 26.798025 23.794140 24.419368 28.491061 26.457736 15.989616
[14] 30.776194 20.381579 27.218421 36.138410 19.613897 30.069430 20.912267 25.304121 36.138410 17.673018 20.949093 20.706564 32.553559
[27] 24.526098 20.687000 16.369612 11.817715  5.452951 20.123929 25.355380 25.857960 17.775592 14.115921 30.811803 25.911494 20.598902
[40] 22.867645 31.029118 24.678907 24.509071 18.018609 21.719123 25.233391 20.299527 28.200283 22.153350 34.356616
 [ reached getOption("max.print") -- omitted 200 entries ]

table(drinkdriving$outcome)
[1] 33

   fine    Fine    FINE warning Warning WARNING 
    191       2       9      43       2       3 
drinkdriving$outcome[drinkdriving$outcome == "Fine" | drinkdriving$outcome == 
    "FINE"] <- "fine"
[1] 34
drinkdriving$outcome[drinkdriving$outcome == "Warning" | drinkdriving$outcome == 
    "WARNING"] <- "warning"
[1] 35
drinkdriving$outcome <- as.factor(drinkdriving$outcome)
[1] 36
levels(drinkdriving$outcome)
[1] 37
[1] "fine"    "warning"
describe(drinkdriving)
[1] 38
               vars   n  mean    sd median trimmed   mad min max range  skew kurtosis   se
age               1 225 42.68 16.77     40   41.93 17.79  14  90    76  0.40    -0.52 1.12
nighttime*        2 247  1.68  0.47      2    1.73  0.00   1   2     1 -0.79    -1.38 0.03
prior_offence*    3 246  4.64  1.06      5    4.74  0.00   1   9     8 -0.53     3.19 0.07
 [ reached 'max' / getOption("max.print") -- omitted 4 rows ]
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 39
par(mfrow = c(2, 2))
[1] 40
$mfrow
[1] 2 2

plot(m1, which = c(1:4))
[1] 41
summary(m1)
[1] 42

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.3270  -4.1824  -0.5698   3.9975  14.9487 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 28.68503    1.06949   26.82  < 2e-16 ***
age         -0.13730    0.02331   -5.89 1.47e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.791 on 216 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.1384,	Adjusted R-squared:  0.1344 
F-statistic: 34.69 on 1 and 216 DF,  p-value: 1.469e-08

m1scaled <- lm(bac ~ scale(age), data = drinkdriving)
[1] 43
summary(m1scaled)
[1] 44

Call:
lm(formula = bac ~ scale(age), data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.3270  -4.1824  -0.5698   3.9975  14.9487 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  22.8255     0.3922   58.20  < 2e-16 ***
scale(age)   -2.3025     0.3909   -5.89 1.47e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.791 on 216 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.1384,	Adjusted R-squared:  0.1344 
F-statistic: 34.69 on 1 and 216 DF,  p-value: 1.469e-08

mean(drinkdriving$age, na.rm = T)
[1] 45
[1] 42.67556
par(mfrow = c(1, 1))
[1] 46
$mfrow
[1] 2 2

with(drinkdriving, plot(age, bac, xlab = "- age (in years) -", 
    ylab = "blood alcohol content (%)", main = "blood alcohol content by age", 
    col = c("slateblue"), bty = "n", pch = 20))
[1] 47
abline(m1)
[1] 48
age50 <- data.frame(age = 50)
[1] 49
predict(m1, age50, interval = "confidence")
[1] 50
       fit      lwr      upr
1 21.81983 20.97678 22.66289
plot(m1, which = 2)
[1] 51
m2nighttime <- lm(bac ~ age + nighttime, data = drinkdriving)
[1] 52
par(mfrow = c(2, 2))
[1] 53
$mfrow
[1] 1 1

plot(m2nighttime, which = c(1:4))
[1] 54
summary(m2nighttime)
[1] 55

Call:
lm(formula = bac ~ age + nighttime, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.3421  -4.3987   0.2997   3.7390  14.4090 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    26.00346    1.18497  21.944  < 2e-16 ***
age            -0.13690    0.02209  -6.199 2.91e-09 ***
nighttimenight  3.86857    0.79364   4.874 2.13e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.417 on 213 degrees of freedom
  (34 observations deleted due to missingness)
Multiple R-squared:  0.2422,	Adjusted R-squared:  0.235 
F-statistic: 34.03 on 2 and 213 DF,  p-value: 1.498e-13

anova(m2nighttime)
[1] 56
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1300.0 1299.99  44.298 2.349e-10 ***
nighttime   1  697.3  697.27  23.760 2.131e-06 ***
Residuals 213 6250.8   29.35                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m2nighttime)$r.square - summary(m1)$r.square
[1] 57
[1] 0.1037845
m2nighttimescaled <- lm(bac ~ scale(age) + nighttime, data = drinkdriving)
[1] 58
summary(m2nighttimescaled)
[1] 59

Call:
lm(formula = bac ~ scale(age) + nighttime, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.3421  -4.3987   0.2997   3.7390  14.4090 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)     20.1613     0.6538  30.835  < 2e-16 ***
scale(age)      -2.2957     0.3704  -6.199 2.91e-09 ***
nighttimenight   3.8686     0.7936   4.874 2.13e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.417 on 213 degrees of freedom
  (34 observations deleted due to missingness)
Multiple R-squared:  0.2422,	Adjusted R-squared:  0.235 
F-statistic: 34.03 on 2 and 213 DF,  p-value: 1.498e-13

describe(drinkdriving$age)
[1] 60
   vars   n  mean    sd median trimmed   mad min max range skew kurtosis   se
X1    1 225 42.68 16.77     40   41.93 17.79  14  90    76  0.4    -0.52 1.12
m2speed <- lm(bac ~ age + speed, data = drinkdriving)
[1] 61
par(mfrow = c(2, 2))
[1] 62
$mfrow
[1] 2 2

plot(m2speed, which = c(1:4))
[1] 63
summary(m2speed)
[1] 64

Call:
lm(formula = bac ~ age + speed, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.4126  -3.9597  -0.5979   4.0894  14.3787 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 25.69629    2.81054   9.143  < 2e-16 ***
age         -0.11272    0.03188  -3.536 0.000498 ***
speed        0.04991    0.04329   1.153 0.250202    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.798 on 214 degrees of freedom
  (33 observations deleted due to missingness)
Multiple R-squared:  0.1442,	Adjusted R-squared:  0.1362 
F-statistic: 18.03 on 2 and 214 DF,  p-value: 5.782e-08

anova(m2speed)
[1] 65
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1167.7 1167.70 34.7384 1.452e-08 ***
speed       1   44.7   44.69  1.3294    0.2502    
Residuals 214 7193.4   33.61                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m2 <- lm(bac ~ age + nighttime + speed, data = drinkdriving)
[1] 66
with(drinkdriving, plot(bac ~ speed, col = nighttime))
[1] 67
summary(m2)
[1] 68

Call:
lm(formula = bac ~ age + nighttime + speed, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.5449  -4.3884   0.5332   3.5881  14.2799 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    23.28482    2.72172   8.555 2.42e-15 ***
age            -0.11424    0.03020  -3.783 0.000202 ***
nighttimenight  3.85847    0.79604   4.847 2.43e-06 ***
speed           0.04550    0.04084   1.114 0.266497    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.426 on 211 degrees of freedom
  (35 observations deleted due to missingness)
Multiple R-squared:  0.2467,	Adjusted R-squared:  0.236 
F-statistic: 23.03 on 3 and 211 DF,  p-value: 6.166e-13

anova(m2)
[1] 69
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1305.1 1305.14 44.3228 2.367e-10 ***
nighttime   1  692.7  692.69 23.5238 2.393e-06 ***
speed       1   36.6   36.55  1.2413    0.2665    
Residuals 211 6213.2   29.45                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
vif(m2)
[1] 70
      age nighttime     speed 
 1.874311  1.008320  1.866465 
par(mfrow = c(2, 2))
[1] 71
$mfrow
[1] 2 2

plot(m2, which = c(1:4))
[1] 72
m2interaction <- lm(bac ~ age + nighttime * speed, data = drinkdriving)
[1] 73
plot(m2interaction, which = c(1:4))
[1] 74
summary(m2interaction)
[1] 75

Call:
lm(formula = bac ~ age + nighttime * speed, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.9176  -4.3639   0.4369   3.5140  14.2207 

Coefficients:
                     Estimate Std. Error t value Pr(>|t|)    
(Intercept)          18.64652    4.77490   3.905 0.000127 ***
age                  -0.09547    0.03410  -2.800 0.005590 ** 
nighttimenight        7.78460    3.41624   2.279 0.023690 *  
speed                 0.14692    0.09503   1.546 0.123598    
nighttimenight:speed -0.10315    0.08729  -1.182 0.238652    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.421 on 210 degrees of freedom
  (35 observations deleted due to missingness)
Multiple R-squared:  0.2516,	Adjusted R-squared:  0.2374 
F-statistic: 17.65 on 4 and 210 DF,  p-value: 1.658e-12

par(mfrow = c(1, 1))
[1] 76
$mfrow
[1] 2 2

bygroup = describeBy(drinkdriving, drinkdriving$nighttime)
[1] 77
as.data.frame(bygroup$day)[4, c(2:4)]
[1] 78
       n     mean       sd
speed 77 38.25278 11.11428
as.data.frame(bygroup$night)[4, c(2:4)]
[1] 79
        n     mean       sd
speed 168 41.09606 14.87366
boxplot(drinkdriving$speed ~ drinkdriving$nighttime, main = "Mean driving speeds at different times of the day", 
    xlab = "Time of day", ylab = "Driving speed (mph)")
[1] 80
qqnorm(y = drinkdriving$speed)
[1] 81
$x
 [1]  0.55833902  0.22941242  0.48877641 -1.64095647 -2.50930863  0.07587804 -2.87562707 -0.44370198  1.64095647 -2.32333263
[11]  0.78671006  0.52324115  0.39951180 -0.38858841  0.38858841  0.13687572  1.38739096 -0.12668016  0.32396076 -0.52324115
[21]  1.87724976  1.41435374 -0.98095912  0.75945463 -0.34534009  0.68084789  0.29216393 -0.42150399 -0.26065984 -1.16019913
[31] -1.82138478 -1.56776715  0.04549887 -0.29216393  1.18024389 -0.71959532  0.37771118  0.10632742  0.99744535  0.45488281
[41] -1.26563117  0.96473528  0.11649776 -0.10632742  0.08601862 -0.61843244  1.53412054 -0.07587804 -2.09365951  1.68110802
 [ reached getOption("max.print") -- omitted 200 entries ]

$y
 [1] 47.957110 43.826353 47.260707 17.221097  1.945818 41.399468  1.012149 34.377506 63.748159  2.533468 50.049472 47.658553 46.209515
[14] 35.044348 45.911152 41.971790 59.500756 38.544314 45.294085 33.660408 66.359756 59.538043 26.205563 49.692191 35.759413 48.880880
[27] 44.464566 34.639220 36.609294 24.917257 13.069805 19.008994 41.009485 36.335035 56.428161 30.141277 45.716490 41.609061 53.768251
[40] 46.424053 23.599427 52.982425 41.674665 38.867482 41.537199 32.599695 61.109335 39.685430 12.246206 64.659834
 [ reached getOption("max.print") -- omitted 200 entries ]

shapiro.test(drinkdriving$speed)
[1] 82

	Shapiro-Wilk normality test

data:  drinkdriving$speed
W = 0.99666, p-value = 0.8816

leveneTest(drinkdriving$speed ~ drinkdriving$nighttime)
[1] 83
Levene's Test for Homogeneity of Variance (center = median)
       Df F value  Pr(>F)  
group   1   6.202 0.01343 *
      243                  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
t.test(formula = speed ~ nighttime, data = drinkdriving, alternative = "less")
[1] 84

	Welch Two Sample t-test

data:  speed by nighttime
t = -1.6636, df = 192.84, p-value = 0.04891
alternative hypothesis: true difference in means is less than 0
95 percent confidence interval:
        -Inf -0.01846594
sample estimates:
  mean in group day mean in group night 
           38.25278            41.09606 

drinkdriving$fine <- ifelse(drinkdriving$outcome == "fine", 1, 
    0)
[1] 85
m3 <- glm(fine ~ age + relevel(prior_offence, "N") + speed + 
    bac + nighttime, data = drinkdriving, family = binomial)
[1] 86
par(mfrow = c(2, 2))
[1] 87
$mfrow
[1] 1 1

plot(m3, which = 1:4)
[1] 88
anova(m3)
[1] 89
Analysis of Deviance Table

Model: binomial, link: logit

Response: fine

Terms added sequentially (first to last)


                            Df Deviance Resid. Df Resid. Dev
NULL                                          210    204.925
age                          1   79.258       209    125.667
relevel(prior_offence, "N")  6   22.268       203    103.399
speed                        1   16.293       202     87.105
bac                          1   22.909       201     64.196
nighttime                    1    0.258       200     63.939
anova(m3, test = "Chisq")
[1] 90
Analysis of Deviance Table

Model: binomial, link: logit

Response: fine

Terms added sequentially (first to last)


                            Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                                          210    204.925              
age                          1   79.258       209    125.667 < 2.2e-16 ***
relevel(prior_offence, "N")  6   22.268       203    103.399  0.001083 ** 
speed                        1   16.293       202     87.105 5.425e-05 ***
bac                          1   22.909       201     64.196 1.699e-06 ***
nighttime                    1    0.258       200     63.939  0.611771    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m3)
[1] 91

Call:
glm(formula = fine ~ age + relevel(prior_offence, "N") + speed + 
    bac + nighttime, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-4.2511   0.0036   0.0406   0.2104   1.8515  

Coefficients:
                                  Estimate Std. Error z value Pr(>|z|)    
(Intercept)                       -1.96019    3.04871  -0.643 0.520253    
age                               -0.13793    0.03756  -3.672 0.000240 ***
relevel(prior_offence, "N")CD      3.70590    1.92021   1.930 0.053614 .  
relevel(prior_offence, "N")DR50    2.36841    1.23277   1.921 0.054706 .  
relevel(prior_offence, "N")DR80   -4.54899    2.09417  -2.172 0.029839 *  
relevel(prior_offence, "N")PL      2.02662   45.29405   0.045 0.964312    
relevel(prior_offence, "N")SP     -5.08647    1.89030  -2.691 0.007127 ** 
relevel(prior_offence, "N")TS     17.79239 1439.60423   0.012 0.990139    
speed                              0.15135    0.04598   3.292 0.000996 ***
bac                                0.28738    0.07634   3.765 0.000167 ***
 [ reached getOption("max.print") -- omitted 1 row ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 204.925  on 210  degrees of freedom
Residual deviance:  63.939  on 200  degrees of freedom
  (39 observations deleted due to missingness)
AIC: 85.939

Number of Fisher Scoring iterations: 15

m3scaled <- glm(fine ~ scale(age) + relevel(prior_offence, "N") + 
    nighttime + scale(speed) + scale(bac), data = drinkdriving, 
    family = binomial)
[1] 92
summary(m3scaled)
[1] 93

Call:
glm(formula = fine ~ scale(age) + relevel(prior_offence, "N") + 
    nighttime + scale(speed) + scale(bac), family = binomial, 
    data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-4.2511   0.0036   0.0406   0.2104   1.8515  

Coefficients:
                                 Estimate Std. Error z value Pr(>|z|)    
(Intercept)                        4.9507     1.0240   4.835 1.33e-06 ***
scale(age)                        -2.3130     0.6298  -3.672 0.000240 ***
relevel(prior_offence, "N")CD      3.7059     1.9202   1.930 0.053614 .  
relevel(prior_offence, "N")DR50    2.3684     1.2328   1.921 0.054706 .  
relevel(prior_offence, "N")DR80   -4.5490     2.0942  -2.172 0.029839 *  
relevel(prior_offence, "N")PL      2.0266    45.2941   0.045 0.964312    
relevel(prior_offence, "N")SP     -5.0865     1.8903  -2.691 0.007127 ** 
relevel(prior_offence, "N")TS     17.7924  1439.6042   0.012 0.990139    
nighttimenight                    -0.3800     0.7541  -0.504 0.614337    
scale(speed)                       2.0959     0.6367   3.292 0.000996 ***
 [ reached getOption("max.print") -- omitted 1 row ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 204.925  on 210  degrees of freedom
Residual deviance:  63.939  on 200  degrees of freedom
  (39 observations deleted due to missingness)
AIC: 85.939

Number of Fisher Scoring iterations: 15

logit.to.p <- function(logits) {
    exp(logits)/(exp(logits) + 1)
}
[1] 94
speed_odds <- coef(m3scaled)[10]
[1] 95
logit.to.p(speed_odds)
[1] 96
scale(speed) 
   0.8905003 
bac_odds <- coef(m3scaled)[11]
[1] 97
logit.to.p(bac_odds)
[1] 98
scale(bac) 
 0.8714624 
table(drinkdriving$prior_offence)
[1] 99

            CD CD60,CD10,DR80           DR50           DR80              N             PL             SP             TS      TS70,DR50 
             4              1             43              4            185              2              3              3              1 
drinkdriving$priordd <- drinkdriving$prior_offence
[1] 100
levels(drinkdriving$priordd) <- c("N-DD", "N-DD", "DR50", "N-DD", 
    NA, "N-DD", "N-DD", "N-DD", "DR50")
[1] 101
addmargins(xtabs(~drinkdriving$priordd + drinkdriving$outcome))
[1] 102
                    drinkdriving$outcome
drinkdriving$priordd fine warning Sum
                N-DD   12       5  17
                DR50   40       4  44
                Sum    52       9  61
chisq.test(drinkdriving$priordd, drinkdriving$outcome)
[1] 103

	Pearson's Chi-squared test with Yates' continuity correction

data:  drinkdriving$priordd and drinkdriving$outcome
X-squared = 2.5724, df = 1, p-value = 0.1087

table(drinkdriving$priordd, drinkdriving$outcome)
[1] 104
      
       fine warning
  N-DD   12       5
  DR50   40       4
table(drinkdriving$prior_offence)
[1] 105

            CD CD60,CD10,DR80           DR50           DR80              N             PL             SP             TS      TS70,DR50 
             4              1             43              4            185              2              3              3              1 
drinkdriving$offences <- drinkdriving$prior_offence
[1] 106
levels(drinkdriving$offences) <- c("PO", "PO", "PO", "PO", "N", 
    "PO", "PO", "PO", "PO")
[1] 107
addmargins(xtabs(~drinkdriving$offences + drinkdriving$outcome))
[1] 108
                     drinkdriving$outcome
drinkdriving$offences fine warning Sum
                  PO    52       9  61
                  N    148      37 185
                  Sum  200      46 246
chisq.test(drinkdriving$offences, drinkdriving$outcome)
[1] 109

	Pearson's Chi-squared test with Yates' continuity correction

data:  drinkdriving$offences and drinkdriving$outcome
X-squared = 0.52118, df = 1, p-value = 0.4703

predictdata <- data.frame(age = 14:100, prior_offence = "N", 
    nighttime = "day", speed = 30, bac = 0)
[1] 110
predict(m3, type = "response")
[1] 111
           1            2            3            4            5            6            7            8            9           10 
0.9903324361 0.9992325997 0.9999883793 0.2923654967 0.2091377261 0.9921296639 0.0007342162 0.9850115906 0.9999406564 0.0386091414 
          11           12           13           14           15           16           18           19           20           21 
0.9933826489 0.9989106679 0.9984316515 0.9990711527 0.9938571963 0.9952811067 0.9728536969 0.9998561621 0.8950446483 0.9999702715 
          23           24           25           26           27           28           30           31           32           33 
0.1323085187 0.9998308217 0.9551150638 0.9999995319 0.9984925347 0.8864499388 0.0199117851 0.0103071538 0.0392707435 0.9959217141 
          34           35           36           37           38           39           40           41           42           43 
0.9637288323 0.9986666921 0.0797881143 0.9999523483 0.8517680816 0.9946985222 0.9751924561 0.9514938860 0.9951433064 0.9975550418 
          44           45           46           47           48           49           50           52           53           56 
0.7023331022 0.9997561617 0.9989250702 0.9999302010 0.9996324530 0.1536224375 0.9999999777 0.9930918588 0.9999965792 0.9061291014 
 [ reached getOption("max.print") -- omitted 161 entries ]
predictdata$model_prediction <- predict(m3, type = "response", 
    newdata = predictdata)
[1] 112
par(mfrow = c(1, 1))
[1] 113
$mfrow
[1] 2 2

plot(predictdata$age, predictdata$model_prediction, type = "l", 
    xlab = "- age (in years) -", ylab = "Probability of receiving a fine", 
    main = "Probability of receiving a fine by age")
[1] 114
drinkdriving <- merge(drinkdriving, officer_inc)
[1] 115
drinkdriving$officer <- as.factor(drinkdriving$officer)
[1] 116
qplot(officer, age, colour = outcome, data = subset(drinkdriving, 
    !is.na(officer)))
[1] 117
with(drinkdriving, plot_ly(x = age, y = officer, z = outcome))
[1] 118
m5 <- glm(fine ~ age * officer, data = drinkdriving, family = "binomial")
[1] 119
summary(m5)
[1] 120

Call:
glm(formula = fine ~ age * officer, family = "binomial", data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.7179   0.0642   0.2741   0.5454   2.4089  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept)    9.56920    1.99554   4.795 1.62e-06 ***
age           -0.16122    0.03466  -4.652 3.29e-06 ***
officerIT     -5.04535    2.39610  -2.106   0.0352 *  
officerNP     -4.68465    2.48887  -1.882   0.0598 .  
age:officerIT  0.09612    0.04254   2.260   0.0238 *  
age:officerNP  0.09365    0.04405   2.126   0.0335 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 222.38  on 224  degrees of freedom
Residual deviance: 146.41  on 219  degrees of freedom
  (25 observations deleted due to missingness)
AIC: 158.41

Number of Fisher Scoring iterations: 7

prob_AS <- logit.to.p(coef(m5)[2])
[1] 121
prob_IT <- logit.to.p(coef(m5)[2] + coef(m5)[5])
[1] 122
prob_NP <- logit.to.p(coef(m5)[2] + coef(m5)[6])
[1] 123
contrasts(drinkdriving$officer)
[1] 124
   IT NP
AS  0  0
IT  1  0
NP  0  1
contrasts(drinkdriving$officer) <- cbind(ASvITNP = c(2/3, -1/3, 
    -1/3), ITvNP = c(0, 1/2, -1/2))
[1] 125
m5.1 <- glm(outcome ~ age * officer, data = drinkdriving, family = "binomial")
[1] 126
summary(m5.1)
[1] 127

Call:
glm(formula = outcome ~ age * officer, family = "binomial", data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.4089  -0.5454  -0.2741  -0.0642   2.7179  

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)    
(Intercept)        -6.32586    0.94007  -6.729 1.71e-11 ***
age                 0.09796    0.01683   5.821 5.84e-09 ***
officerASvITNP     -4.86500    2.23048  -2.181   0.0292 *  
officerITvNP        0.36070    1.99283   0.181   0.8564    
age:officerASvITNP  0.09489    0.03922   2.419   0.0155 *  
age:officerITvNP   -0.00247    0.03671  -0.067   0.9464    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 222.38  on 224  degrees of freedom
Residual deviance: 146.41  on 219  degrees of freedom
  (25 observations deleted due to missingness)
AIC: 158.41

Number of Fisher Scoring iterations: 7

