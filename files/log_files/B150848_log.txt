

	####### B150848 R script #######

library(ggplot2, quietly = T)
[1] 1
[1] "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(apaTables, quietly = T)
[1] 2
 [1] "apaTables" "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
load(url("https://edin.ac/2QCZNVu"))
[1] 3
[1] "drinkdriving" "officer_inc" 
drinkdriving$age[drinkdriving$age > 100] <- NA
[1] 4
drinkdriving$age[drinkdriving$age < 12] <- NA
[1] 5
as.factor(drinkdriving$nighttime)
[1] 6
 [1] night day   night night night day   night day   night night night night day   night night night night day   day   night night
[22] night day   day   day   night night day   day   day   night night night night night day   day   night night night night night
[43] day   night day   night night night night night
 [ reached getOption("max.print") -- omitted 200 entries ]
Levels: 18:25 2:05 day night
drinkdriving$nighttime[drinkdriving$nighttime == "2:05"] <- NA
[1] 7
drinkdriving$nighttime[drinkdriving$nighttime == "18:25"] <- NA
[1] 8
as.factor(drinkdriving$nighttime)
[1] 9
 [1] night day   night night night day   night day   night night night night day   night night night night day   day   night night
[22] night day   day   day   night night day   day   day   night night night night night day   day   night night night night night
[43] day   night day   night night night night night
 [ reached getOption("max.print") -- omitted 200 entries ]
Levels: day night
as.factor(drinkdriving$prior_offence)
[1] 10
 [1] N    N    DR50 N    N    N    N    N    N    N    DR80 N    N    N    N    N    N    N    N    N    N    N    N    N    N    DR50
[27] DR50 N    DD20 N    DR50 N    N    N    N    N    N    N    N    N    N    N    N    N    PL10 DR50 N    N    N    DR50
 [ reached getOption("max.print") -- omitted 200 entries ]
Levels: CD10 CD60 CD60,CD10,DR80 CD60,CD60 DD20 DR50 DR80 N PL10 SP50 SP60 TS70 TS70,DR50
as.factor(drinkdriving$outcome)
[1] 11
 [1] fine    fine    fine    warning warning fine    warning fine    fine    warning WARNING FINE    fine    fine    fine    fine   
[17] fine    fine    fine    fine    fine    fine    warning Fine    fine    fine    fine    fine    fine    warning warning warning
[33] fine    fine    fine    warning fine    fine    fine    fine    fine    fine    fine    fine    fine    fine    fine    fine   
[49] warning fine   
 [ reached getOption("max.print") -- omitted 200 entries ]
Levels: fine Fine FINE warning Warning WARNING
drinkdriving$outcome[drinkdriving$outcome == "Fine"] <- "fine"
[1] 12
drinkdriving$outcome[drinkdriving$outcome == "WARNING"] <- "warning"
[1] 13
drinkdriving$outcome[drinkdriving$outcome == "FINE"] <- "fine"
[1] 14
drinkdriving$outcome[drinkdriving$outcome == "Warning"] <- "warning"
[1] 15
drinkdriving$prior_offence[drinkdriving$prior_offence == "DD20"] <- NA
[1] 16
summary(drinkdriving$bac)
[1] 17
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
  3.987  19.264  23.609  23.605  27.898  65.764       5 
plot(drinkdriving$bac)
[1] 18
drinkdriving$bac[drinkdriving$bac > 50] <- NA
[1] 19
drinkdriving <- merge(drinkdriving, officer_inc, by = "incident_id")
[1] 20
drinkdriving$outcome = factor(drinkdriving$outcome, levels = c("warning", 
    "fine"))
[1] 21
class(drinkdriving$outcome)
[1] 22
[1] "factor"
drinkdriving$nighttime = factor(drinkdriving$nighttime, levels = c("night", 
    "day"))
[1] 23
class(drinkdriving$nighttime)
[1] 24
[1] "factor"
drinkdriving$prior_offence = as.factor(drinkdriving$prior_offence)
[1] 25
class(drinkdriving$prior_offence)
[1] 26
[1] "factor"
summary(drinkdriving)
[1] 27
 incident_id             age        nighttime   prior_offence     speed             bac            outcome    officer   
 Length:250         Min.   :14.00   night:169   N      :185   Min.   :  0.00   Min.   : 3.987   warning: 48   AS  :116  
 Class :character   1st Qu.:30.00   day  : 78   DR50   : 43   1st Qu.: 30.92   1st Qu.:19.215   fine   :202   IT  : 66  
 Mode  :character   Median :40.00   NA's :  3   DR80   :  4   Median : 40.64   Median :23.504                 NP  : 67  
                    Mean   :42.68               TS70   :  3   Mean   : 40.49   Mean   :23.292                 NA's:  1  
                    3rd Qu.:55.00               CD10   :  2   3rd Qu.: 48.84   3rd Qu.:27.789                           
                    Max.   :90.00               (Other):  9   Max.   :120.34   Max.   :36.138                           
 [ reached getOption("max.print") -- omitted 1 row ]
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 28
summary(m1)
[1] 29

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.3270  -4.1824  -0.5698   3.9975  14.9487 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 28.68503    1.06949   26.82  < 2e-16 ***
age         -0.13730    0.02331   -5.89 1.47e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.791 on 216 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.1384,	Adjusted R-squared:  0.1344 
F-statistic: 34.69 on 1 and 216 DF,  p-value: 1.469e-08

plot(drinkdriving$age, drinkdriving$bac, main = "Drinking and Driving", 
    xlab = "Age", ylab = "Blood Alcohol Content", )
[1] 30
abline(m1)
[1] 31
par(mfrow = c(2, 2))
[1] 32
$mfrow
[1] 2 2

plot(m1, which = c(1:4))
[1] 33
anova(m1)
[1] 34
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1163.1 1163.14  34.687 1.469e-08 ***
Residuals 216 7243.1   33.53                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
coef(m1)
[1] 35
(Intercept)         age 
 28.6850287  -0.1373039 
pred <- data.frame(age = c(50, 50, 50), bac = c(18.75897, 16.369612, 
    24.007394))
[1] 36
pred2 <- data.frame(age = c(50))
[1] 37
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 38
pred3 <- predict(m1, pred2)
[1] 39
predict(m1, data.frame(age = 50), type = "response")
[1] 40
       1 
21.81983 
par(mfrow = c(1, 1))
[1] 41
$mfrow
[1] 2 2

plot(m1, which = 2)
[1] 42
m3 <- lm(bac ~ age + speed + nighttime, data = drinkdriving)
[1] 43
summary(m3)
[1] 44

Call:
lm(formula = bac ~ age + speed + nighttime, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.6457  -4.3757   0.5792   3.5662  14.2890 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  27.40299    2.58791  10.589  < 2e-16 ***
age          -0.11596    0.02990  -3.878 0.000141 ***
speed         0.04110    0.03958   1.038 0.300244    
nighttimeday -3.87648    0.79353  -4.885 2.04e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.416 on 212 degrees of freedom
  (34 observations deleted due to missingness)
Multiple R-squared:  0.246,	Adjusted R-squared:  0.2353 
F-statistic: 23.05 on 3 and 212 DF,  p-value: 5.894e-13

pred_day <- lm(drinkdriving$bac ~ drinkdriving$age + drinkdriving$nighttime)
[1] 45
summary(pred_day)
[1] 46

Call:
lm(formula = drinkdriving$bac ~ drinkdriving$age + drinkdriving$nighttime)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.3421  -4.3987   0.2997   3.7390  14.4090 

Coefficients:
                          Estimate Std. Error t value Pr(>|t|)    
(Intercept)               29.87203    1.02202  29.228  < 2e-16 ***
drinkdriving$age          -0.13690    0.02209  -6.199 2.91e-09 ***
drinkdriving$nighttimeday -3.86857    0.79364  -4.874 2.13e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.417 on 213 degrees of freedom
  (34 observations deleted due to missingness)
Multiple R-squared:  0.2422,	Adjusted R-squared:  0.235 
F-statistic: 34.03 on 2 and 213 DF,  p-value: 1.498e-13

pred_speed <- lm(drinkdriving$bac ~ drinkdriving$age + drinkdriving$speed, 
    data = drinkdriving)
[1] 47
summary(pred_speed)
[1] 48

Call:
lm(formula = drinkdriving$bac ~ drinkdriving$age + drinkdriving$speed, 
    data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.4118  -3.8926  -0.6094   4.1298  14.4229 

Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)        26.08699    2.74183   9.514  < 2e-16 ***
drinkdriving$age   -0.11540    0.03156  -3.656 0.000322 ***
drinkdriving$speed  0.04320    0.04198   1.029 0.304616    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.79 on 215 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.1426,	Adjusted R-squared:  0.1346 
F-statistic: 17.88 on 2 and 215 DF,  p-value: 6.574e-08

fit <- lm(drinkdriving$bac ~ drinkdriving$age + drinkdriving$speed + 
    drinkdriving$nighttime)
[1] 49
summary(fit)
[1] 50

Call:
lm(formula = drinkdriving$bac ~ drinkdriving$age + drinkdriving$speed + 
    drinkdriving$nighttime)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.6457  -4.3757   0.5792   3.5662  14.2890 

Coefficients:
                          Estimate Std. Error t value Pr(>|t|)    
(Intercept)               27.40299    2.58791  10.589  < 2e-16 ***
drinkdriving$age          -0.11596    0.02990  -3.878 0.000141 ***
drinkdriving$speed         0.04110    0.03958   1.038 0.300244    
drinkdriving$nighttimeday -3.87648    0.79353  -4.885 2.04e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.416 on 212 degrees of freedom
  (34 observations deleted due to missingness)
Multiple R-squared:  0.246,	Adjusted R-squared:  0.2353 
F-statistic: 23.05 on 3 and 212 DF,  p-value: 5.894e-13

anova(fit)
[1] 51
Analysis of Variance Table

Response: drinkdriving$bac
                        Df Sum Sq Mean Sq F value    Pr(>F)    
drinkdriving$age         1 1300.0 1299.99 44.3147 2.354e-10 ***
drinkdriving$speed       1   28.8   28.85  0.9833    0.3225    
drinkdriving$nighttime   1  700.1  700.06 23.8640 2.036e-06 ***
Residuals              212 6219.1   29.34                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
fit2 <- lm(drinkdriving$bac ~ drinkdriving$age + drinkdriving$nighttime)
[1] 52
summary(fit2)
[1] 53

Call:
lm(formula = drinkdriving$bac ~ drinkdriving$age + drinkdriving$nighttime)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.3421  -4.3987   0.2997   3.7390  14.4090 

Coefficients:
                          Estimate Std. Error t value Pr(>|t|)    
(Intercept)               29.87203    1.02202  29.228  < 2e-16 ***
drinkdriving$age          -0.13690    0.02209  -6.199 2.91e-09 ***
drinkdriving$nighttimeday -3.86857    0.79364  -4.874 2.13e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.417 on 213 degrees of freedom
  (34 observations deleted due to missingness)
Multiple R-squared:  0.2422,	Adjusted R-squared:  0.235 
F-statistic: 34.03 on 2 and 213 DF,  p-value: 1.498e-13

t.test(drinkdriving$bac, drinkdriving$age, var.equal = TRUE, 
    paired = FALSE)
[1] 54

	Two Sample t-test

data:  drinkdriving$bac and drinkdriving$age
t = -16.657, df = 466, p-value < 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -21.67003 -17.09657
sample estimates:
mean of x mean of y 
 23.29226  42.67556 

drinkdriving$nighttime = as.numeric(drinkdriving$nighttime)
[1] 55
t.test(drinkdriving$bac, drinkdriving$nighttime, var.equal = TRUE, 
    paired = FALSE)
[1] 56

	Two Sample t-test

data:  drinkdriving$bac and drinkdriving$nighttime
t = 51.733, df = 488, p-value < 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 21.14180 22.81114
sample estimates:
mean of x mean of y 
23.292258  1.315789 

Q2.3 <- lm(speed ~ nighttime, data = drinkdriving)
[1] 57
anova(Q2.3)
[1] 58
Analysis of Variance Table

Response: speed
           Df Sum Sq Mean Sq F value Pr(>F)
nighttime   1    128  127.84   0.573 0.4498
Residuals 245  54663  223.12               
t.test(speed ~ nighttime, data = drinkdriving, na.rm = T)
[1] 59

	Welch Two Sample t-test

data:  speed by nighttime
t = 0.7709, df = 156.78, p-value = 0.4419
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -2.417929  5.513418
sample estimates:
mean in group 1 mean in group 2 
       40.85289        39.30514 

drinkdriving$total_offences[drinkdriving$prior_offence == "N"] <- "N"
[1] 60
drinkdriving$total_offences[drinkdriving$prior_offence != "N"] <- "Y"
[1] 61
fine_v_warning <- glm(outcome ~ nighttime + total_offences + 
    speed + bac + age, data = drinkdriving, family = binomial)
[1] 62
summary(fine_v_warning)
[1] 63

Call:
glm(formula = outcome ~ nighttime + total_offences + speed + 
    bac + age, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-4.1762   0.0133   0.0866   0.2899   2.2983  

Coefficients:
                Estimate Std. Error z value Pr(>|z|)    
(Intercept)     -4.97643    2.72251  -1.828 0.067568 .  
nighttime        0.06794    0.64338   0.106 0.915905    
total_offencesY  1.10337    0.75862   1.454 0.145823    
speed            0.15873    0.03990   3.978 6.94e-05 ***
bac              0.23307    0.06256   3.726 0.000195 ***
age             -0.07354    0.02529  -2.909 0.003631 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 208.23  on 211  degrees of freedom
Residual deviance:  81.66  on 206  degrees of freedom
  (38 observations deleted due to missingness)
AIC: 93.66

Number of Fisher Scoring iterations: 7

new <- glm(outcome ~ speed + bac + age, data = drinkdriving, 
    family = binomial)
[1] 64
summary(new)
[1] 65

Call:
glm(formula = outcome ~ speed + bac + age, family = binomial, 
    data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.5396   0.0329   0.1570   0.3674   2.3380  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -4.87364    2.16854  -2.247   0.0246 *  
speed        0.13857    0.03343   4.146 3.39e-05 ***
bac          0.19231    0.04880   3.941 8.12e-05 ***
age         -0.04566    0.01996  -2.287   0.0222 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 216.50  on 217  degrees of freedom
Residual deviance: 106.31  on 214  degrees of freedom
  (32 observations deleted due to missingness)
AIC: 114.31

Number of Fisher Scoring iterations: 7

question3.1 <- glm(outcome ~ speed + bac, data = drinkdriving, 
    family = binomial)
[1] 66
summary(question3.1)
[1] 67

Call:
glm(formula = outcome ~ speed + bac, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-4.0812   0.0489   0.1875   0.4458   1.9536  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -7.16443    1.24676  -5.746 9.11e-09 ***
speed        0.14705    0.02581   5.697 1.22e-08 ***
bac          0.17246    0.04109   4.197 2.71e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 238.69  on 242  degrees of freedom
Residual deviance: 130.13  on 240  degrees of freedom
  (7 observations deleted due to missingness)
AIC: 136.13

Number of Fisher Scoring iterations: 6

anova(question3.1)
[1] 68
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


      Df Deviance Resid. Df Resid. Dev
NULL                    242     238.69
speed  1   86.025       241     152.67
bac    1   22.540       240     130.13
drinkdriving$drinking_offence[drinkdriving$prior_offence != "N"] <- "N"
[1] 69
drinkdriving$drinking_offence[drinkdriving$prior_offence == "DR50"] <- "Y"
[1] 70
drinkdriving$drinking_offence[drinkdriving$prior_offence == "TS70,DR50"] <- "Y"
[1] 71
drinkdriving$other_offence[drinkdriving$prior_offence != "N"] <- "Y"
[1] 72
drinkdriving$other_offence[drinkdriving$prior_offence == "DR50"] <- "N"
[1] 73
drinkdriving$other_offence[drinkdriving$prior_offence == "TS70,DR50"] <- "Y"
[1] 74
all_motoring_offences <- glm(outcome ~ other_offence, data = drinkdriving, 
    family = binomial)
[1] 75
summary(all_motoring_offences)
[1] 76

Call:
glm(formula = outcome ~ other_offence, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.3076   0.3803   0.3803   0.3803   0.9005  

Coefficients:
               Estimate Std. Error z value Pr(>|z|)    
(Intercept)      2.5903     0.5986   4.327 1.51e-05 ***
other_offenceY  -1.8971     0.7800  -2.432    0.015 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 51.047  on 60  degrees of freedom
Residual deviance: 44.676  on 59  degrees of freedom
  (189 observations deleted due to missingness)
AIC: 48.676

Number of Fisher Scoring iterations: 5

drinking_fines <- glm(outcome ~ drinking_offence, data = drinkdriving, 
    family = binomial)
[1] 77
summary(drinking_fines)
[1] 78

Call:
glm(formula = outcome ~ drinking_offence, family = binomial, 
    data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1899   0.4366   0.4366   0.4366   0.8346  

Coefficients:
                  Estimate Std. Error z value Pr(>|z|)  
(Intercept)         0.8755     0.5323   1.645   0.1000  
drinking_offenceY   1.4271     0.7472   1.910   0.0561 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 51.047  on 60  degrees of freedom
Residual deviance: 47.405  on 59  degrees of freedom
  (189 observations deleted due to missingness)
AIC: 51.405

Number of Fisher Scoring iterations: 5

drinking_fines2 <- glm(outcome ~ other_offence, data = drinkdriving, 
    family = binomial)
[1] 79
summary(drinking_fines2)
[1] 80

Call:
glm(formula = outcome ~ other_offence, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.3076   0.3803   0.3803   0.3803   0.9005  

Coefficients:
               Estimate Std. Error z value Pr(>|z|)    
(Intercept)      2.5903     0.5986   4.327 1.51e-05 ***
other_offenceY  -1.8971     0.7800  -2.432    0.015 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 51.047  on 60  degrees of freedom
Residual deviance: 44.676  on 59  degrees of freedom
  (189 observations deleted due to missingness)
AIC: 48.676

Number of Fisher Scoring iterations: 5

drinking_other <- glm(outcome ~ drinking_offence + other_offence, 
    data = drinkdriving, family = binomial)
[1] 81
summary(drinking_other)
[1] 82

Call:
glm(formula = outcome ~ drinking_offence + other_offence, family = binomial, 
    data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.3076   0.3803   0.3803   0.3803   0.8346  

Coefficients:
                  Estimate Std. Error z value Pr(>|z|)
(Intercept)          20.03    2399.54   0.008    0.993
drinking_offenceY   -17.44    2399.54  -0.007    0.994
other_offenceY      -19.16    2399.54  -0.008    0.994

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 51.047  on 60  degrees of freedom
Residual deviance: 42.358  on 58  degrees of freedom
  (189 observations deleted due to missingness)
AIC: 48.358

Number of Fisher Scoring iterations: 15

table(drinkdriving$outcome, drinkdriving$total_offences)
[1] 83
         
            N   Y
  warning  37   9
  fine    148  52
prior_convictions <- glm(outcome ~ total_offences, data = drinkdriving, 
    family = binomial)
[1] 84
summary(prior_convictions)
[1] 85

Call:
glm(formula = outcome ~ total_offences, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.9564   0.5650   0.6681   0.6681   0.6681  

Coefficients:
                Estimate Std. Error z value Pr(>|z|)    
(Intercept)       1.3863     0.1838   7.542 4.62e-14 ***
total_offencesY   0.3677     0.4051   0.908    0.364    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 237.06  on 245  degrees of freedom
Residual deviance: 236.20  on 244  degrees of freedom
  (4 observations deleted due to missingness)
AIC: 240.2

Number of Fisher Scoring iterations: 4

drinkdriving$total_offences = as.factor(drinkdriving$total_offences)
[1] 86
summary(drinkdriving$total_offences)
[1] 87
   N    Y NA's 
 185   61    4 
chisq.test(drinkdriving$outcome, drinkdriving$total_offences)
[1] 88

	Pearson's Chi-squared test with Yates' continuity correction

data:  drinkdriving$outcome and drinkdriving$total_offences
X-squared = 0.52118, df = 1, p-value = 0.4703

drivingoffence <- glm(outcome ~ total_offences, data = drinkdriving, 
    family = binomial)
[1] 89
summary(drivingoffence)
[1] 90

Call:
glm(formula = outcome ~ total_offences, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.9564   0.5650   0.6681   0.6681   0.6681  

Coefficients:
                Estimate Std. Error z value Pr(>|z|)    
(Intercept)       1.3863     0.1838   7.542 4.62e-14 ***
total_offencesY   0.3677     0.4051   0.908    0.364    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 237.06  on 245  degrees of freedom
Residual deviance: 236.20  on 244  degrees of freedom
  (4 observations deleted due to missingness)
AIC: 240.2

Number of Fisher Scoring iterations: 4

question3 <- glm(outcome ~ nighttime + speed + bac + age, data = drinkdriving, 
    family = binomial)
[1] 91
pred_df <- data.frame(age = 14:100, speed = 30, bac = 0, prior_offence = "N", 
    nighttime = "day")
[1] 92
pred_df

   age speed bac prior_offence nighttime
1   14    30   0             N       day
2   15    30   0             N       day
3   16    30   0             N       day
4   17    30   0             N       day
5   18    30   0             N       day
6   19    30   0             N       day
7   20    30   0             N       day
8   21    30   0             N       day
9   22    30   0             N       day
10  23    30   0             N       day
 [ reached 'max' / getOption("max.print") -- omitted 77 rows ]


pred_df$model_prediction <- predict(new, type = "response", newdata = pred_df)
[1] 94
plot(pred_df$age, pred_df$model_prediction, main = "Predicted Probabilities for Receiving a Fine", 
    xlab = "Age", ylab = "Probability of Receiving a Fine ")
[1] 95
drinkdriving$outcome = as.factor(drinkdriving$outcome)
[1] 96
bias_officer <- ggplot(drinkdriving, aes(x = officer, y = age, 
    color = outcome)) + geom_jitter(position = position_jitter(0.2)) + 
    geom_boxplot(outlier.size = 2)
[1] 97
bias_officer



####################################################################################################

[1] "Error in eval(script[[ll]]) : object 'bias_officer' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in eval(script[[ll]]): object 'bias_officer' not found>
####################################################################################################




bias_officer + ggtitle("Bias Officers") + xlab("Officer") + ylab("Age")
[1] 99
[1] "Error in eval(script[[ll]]) : object 'bias_officer' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in eval(script[[ll]]): object 'bias_officer' not found>


####################################################################################################

[1] "Error in eval(script[[ll]]) : object 'bias_officer' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in eval(script[[ll]]): object 'bias_officer' not found>
####################################################################################################


contrasts(drinkdriving$officer) <- cbind(ASvITvNP = c(2/3, -1/3, 
    -1/3), ITvNP = c(0, 1, -1))
[1] 100
officer_model <- glm(outcome ~ officer * age, data = drinkdriving, 
    family = binomial)
[1] 101
contrasts(drinkdriving$officer)
[1] 102
     ASvITvNP ITvNP
AS  0.6666667     0
IT -0.3333333     1
NP -0.3333333    -1
summary(officer_model)
[1] 103

Call:
glm(formula = outcome ~ officer * age, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.7179   0.0642   0.2741   0.5454   2.4089  

Coefficients:
                     Estimate Std. Error z value Pr(>|z|)    
(Intercept)          6.325860   0.940070   6.729 1.71e-11 ***
officerASvITvNP      4.865004   2.230480   2.181   0.0292 *  
officerITvNP        -0.180350   0.996417  -0.181   0.8564    
age                 -0.097965   0.016829  -5.821 5.84e-09 ***
officerASvITvNP:age -0.094887   0.039218  -2.419   0.0155 *  
officerITvNP:age     0.001235   0.018357   0.067   0.9464    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 222.38  on 224  degrees of freedom
Residual deviance: 146.41  on 219  degrees of freedom
  (25 observations deleted due to missingness)
AIC: 158.41

Number of Fisher Scoring iterations: 7

drinkdriving$outcome = as.numeric(drinkdriving$outcome)
[1] 104
bias_residuals <- residuals(object = officer_model)
[1] 105
shapiro.test(x = bias_residuals)
[1] 106

	Shapiro-Wilk normality test

data:  bias_residuals
W = 0.86779, p-value = 4.687e-13

