

	####### B159817 R script #######

library(ggplot2, quietly = T)
[1] 1
[1] "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(psych, quietly = T)
[1] 2
 [1] "psych"     "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(lsr, quietly = T)
[1] 3
 [1] "lsr"       "psych"     "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
load(url("https://edin.ac/2QCZNVu"))
[1] 4
[1] "drinkdriving" "officer_inc" 
summary(drinkdriving)
[1] 5
      age          nighttime         prior_offence          speed             bac           outcome          incident_id       
 Min.   : 14.00   Length:250         Length:250         Min.   :  0.00   Min.   : 3.987   Length:250         Length:250        
 1st Qu.: 30.00   Class :character   Class :character   1st Qu.: 30.92   1st Qu.:19.264   Class :character   Class :character  
 Median : 40.50   Mode  :character   Mode  :character   Median : 40.64   Median :23.609   Mode  :character   Mode  :character  
 Mean   : 46.00                                         Mean   : 40.49   Mean   :23.605                                        
 3rd Qu.: 55.25                                         3rd Qu.: 48.84   3rd Qu.:27.898                                        
 Max.   :297.00                                         Max.   :120.34   Max.   :65.764                                        
 NA's   :22                                                              NA's   :5                                             
class(drinkdriving$nighttime)
[1] 6
[1] "character"
drinkdriving$nighttime <- as.factor(drinkdriving$nighttime)
[1] 7
levels(drinkdriving$nighttime)
[1] 8
[1] "18:25" "2:05"  "day"   "night"
drinkdriving$nighttime[drinkdriving$nighttime != "day" & drinkdriving$nighttime != 
    "night"] <- NA
[1] 9
drinkdriving$nighttime <- droplevels(drinkdriving$nighttime)
[1] 10
class(drinkdriving$outcome)
[1] 11
[1] "character"
drinkdriving$outcome <- as.factor(drinkdriving$outcome)
[1] 12
levels(drinkdriving$outcome)
[1] 13
[1] "fine"    "Fine"    "FINE"    "warning" "Warning" "WARNING"
drinkdriving$outcome[drinkdriving$outcome == "Fine"] <- "fine"
[1] 14
drinkdriving$outcome[drinkdriving$outcome == "FINE"] <- "fine"
[1] 15
drinkdriving$outcome[drinkdriving$outcome == "Warning"] <- "warning"
[1] 16
drinkdriving$outcome[drinkdriving$outcome == "WARNING"] <- "warning"
[1] 17
drinkdriving$outcome <- droplevels(drinkdriving$outcome)
[1] 18
drinkdriving$age[drinkdriving$age >= 105] <- NA
[1] 19
drinkdriving$bac[drinkdriving$bac > 40] <- NA
[1] 20
drinkdriving$speed[drinkdriving$speed <= 10] <- NA
[1] 21
levels(drinkdriving$prior_offence)
[1] 22
NULL
drinkdriving$kind_offence <- drinkdriving$prior_offence
[1] 23
drinkdriving$kind_offence[drinkdriving$kind_offence == "DD20"] <- NA
[1] 24
drinkdriving$kind_offence[drinkdriving$kind_offence == "DR50"] <- "drinking_offence"
[1] 25
drinkdriving$kind_offence[drinkdriving$kind_offence == "N"] <- "no_offence"
[1] 26
drinkdriving$kind_offence[drinkdriving$kind_offence != "drinking_offence" & 
    drinkdriving$kind_offence != "no_offence"] <- "other_offence"
[1] 27
drinkdriving$kind_offence <- as.factor(drinkdriving$kind_offence)
[1] 28
drinkdriving$kind_offence <- droplevels(drinkdriving$kind_offence)
[1] 29
drinkdriving$prior_offence[drinkdriving$prior_offence == "DD20"] <- NA
[1] 30
drinkdriving$prior_offence[drinkdriving$prior_offence != "N"] <- "Y"
[1] 31
drinkdriving$prior_offence <- as.factor(drinkdriving$prior_offence)
[1] 32
drinkdriving$prior_offence <- droplevels(drinkdriving$prior_offence)
[1] 33
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 34
with(drinkdriving, cor.test(bac, age, use = "pairwise.complete.obs"))
[1] 35

	Pearson's product-moment correlation

data:  bac and age
t = -5.8895, df = 216, p-value = 1.469e-08
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.4810759 -0.2515308
sample estimates:
       cor 
-0.3719763 

summary(m1)
[1] 36

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.3270  -4.1824  -0.5698   3.9975  14.9487 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 28.68503    1.06949   26.82  < 2e-16 ***
age         -0.13730    0.02331   -5.89 1.47e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.791 on 216 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.1384,	Adjusted R-squared:  0.1344 
F-statistic: 34.69 on 1 and 216 DF,  p-value: 1.469e-08

with(drinkdriving, plot(age, bac, ylim = c(0, 40), main = "Blood alcohol content predicted by age"))
[1] 37
abline(m1, col = "red", lwd = "3")
[1] 38
bac_for_50 <- predict(m1, age = 50)
[1] 39
summary(bac_for_50)
[1] 40
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  16.33   21.13   23.19   22.83   24.57   26.76 
hist(residuals(m1, breaks = 30), xlab = "Residuals", main = "Normality of the residuals")
[1] 41
describe(residuals(m1))
[1] 42
   vars   n mean   sd median trimmed  mad    min   max range skew kurtosis   se
X1    1 218    0 5.78  -0.57   -0.05 5.95 -15.33 14.95 30.28 0.06    -0.43 0.39
plot(m1, which = 2)
[1] 43
m2 <- lm(bac ~ age + speed, data = drinkdriving)
[1] 44
summary(m2)
[1] 45

Call:
lm(formula = bac ~ age + speed, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.4289  -3.6417  -0.6605   3.8871  14.2922 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 23.84391    2.91735   8.173 2.76e-14 ***
age         -0.10325    0.03208  -3.219  0.00149 ** 
speed        0.08457    0.04578   1.847  0.06613 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.768 on 211 degrees of freedom
  (36 observations deleted due to missingness)
Multiple R-squared:   0.16,	Adjusted R-squared:  0.1521 
F-statistic:  20.1 on 2 and 211 DF,  p-value: 1.022e-08

contrasts(drinkdriving$nighttime)
[1] 46
      night
day       0
night     1
m3 <- lm(bac ~ age + nighttime, data = drinkdriving)
[1] 47
summary(m3)
[1] 48

Call:
lm(formula = bac ~ age + nighttime, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.3421  -4.3987   0.2997   3.7390  14.4090 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    26.00346    1.18497  21.944  < 2e-16 ***
age            -0.13690    0.02209  -6.199 2.91e-09 ***
nighttimenight  3.86857    0.79364   4.874 2.13e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.417 on 213 degrees of freedom
  (34 observations deleted due to missingness)
Multiple R-squared:  0.2422,	Adjusted R-squared:  0.235 
F-statistic: 34.03 on 2 and 213 DF,  p-value: 1.498e-13

plot(m2)
[1] 49
plot(m3)
[1] 50
hist(drinkdriving$bac)
[1] 51
describe(drinkdriving$bac)
[1] 52
   vars   n  mean   sd median trimmed  mad  min   max range  skew kurtosis   se
X1    1 243 23.29 6.66   23.5   23.53 6.43 3.99 36.14 32.15 -0.34     0.01 0.43
hist(drinkdriving$age)
[1] 53
describe(drinkdriving$age)
[1] 54
   vars   n  mean    sd median trimmed   mad min max range skew kurtosis   se
X1    1 225 42.68 16.77     40   41.93 17.79  14  90    76  0.4    -0.52 1.12
hist(drinkdriving$speed)
[1] 55
describe(drinkdriving$speed)
[1] 56
   vars   n  mean    sd median trimmed   mad   min    max  range skew kurtosis  se
X1    1 246 41.12 14.17  40.74   40.64 12.34 11.23 120.34 109.11  0.8     3.17 0.9
describe(night)
[1] 57
[1] "Error in describe(night) : object 'night' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in describe(night): object 'night' not found>


####################################################################################################

[1] "Error in describe(night) : object 'night' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in describe(night): object 'night' not found>
####################################################################################################


m2s <- lm(scale(bac) ~ scale(age) + scale(speed), data = drinkdriving)
[1] 58
night <- with(drinkdriving, ifelse(nighttime == "night", 1, 0))
[1] 59
m3s <- lm(scale(bac) ~ scale(age) + scale(night), data = drinkdriving)
[1] 60
summary(m2s)
[1] 61

Call:
lm(formula = scale(bac) ~ scale(age) + scale(speed), data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.31668 -0.54681 -0.09917  0.58366  2.14601 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)   
(Intercept)  -0.05661    0.06096  -0.929  0.35411   
scale(age)   -0.25998    0.08077  -3.219  0.00149 **
scale(speed)  0.17988    0.09738   1.847  0.06613 . 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.8661 on 211 degrees of freedom
  (36 observations deleted due to missingness)
Multiple R-squared:   0.16,	Adjusted R-squared:  0.1521 
F-statistic:  20.1 on 2 and 211 DF,  p-value: 1.022e-08

summary(m3s)
[1] 62

Call:
lm(formula = scale(bac) ~ scale(age) + scale(night), data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.4538 -0.6605  0.0450  0.5614  2.1635 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  -0.07269    0.05535  -1.313    0.191    
scale(age)   -0.34470    0.05561  -6.199 2.91e-09 ***
scale(night)  0.27056    0.05550   4.874 2.13e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.8134 on 213 degrees of freedom
  (34 observations deleted due to missingness)
Multiple R-squared:  0.2422,	Adjusted R-squared:  0.235 
F-statistic: 34.03 on 2 and 213 DF,  p-value: 1.498e-13

m4 <- lm(speed ~ nighttime, data = drinkdriving)
[1] 63
summary(m4)
[1] 64

Call:
lm(formula = speed ~ nighttime, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-30.584  -9.183  -0.201   7.435  81.032 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)      39.305      1.603  24.527   <2e-16 ***
nighttimenight    2.505      1.945   1.288    0.199    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 14.15 on 241 degrees of freedom
  (7 observations deleted due to missingness)
Multiple R-squared:  0.006837,	Adjusted R-squared:  0.002716 
F-statistic: 1.659 on 1 and 241 DF,  p-value: 0.199

outcome_model <- glm(outcome ~ age + bac + speed + prior_offence + 
    nighttime, data = drinkdriving, family = "binomial")
[1] 65
anova(outcome_model, test = "Chisq")
[1] 66
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


              Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                            207    194.759              
age            1   73.452       206    121.306 < 2.2e-16 ***
bac            1   22.649       205     98.658 1.945e-06 ***
speed          1   15.235       204     83.422 9.492e-05 ***
prior_offence  1    2.428       203     80.994    0.1192    
nighttime      1    0.012       202     80.982    0.9112    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(outcome_model)
[1] 67

Call:
glm(formula = outcome ~ age + bac + speed + prior_offence + nighttime, 
    family = "binomial", data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.2639  -0.3097  -0.0984  -0.0197   4.1427  

Coefficients:
               Estimate Std. Error z value Pr(>|z|)    
(Intercept)     4.22207    2.69261   1.568 0.116876    
age             0.07669    0.02597   2.953 0.003148 ** 
bac            -0.23325    0.06223  -3.748 0.000178 ***
speed          -0.14445    0.04455  -3.242 0.001185 ** 
prior_offenceY -1.14605    0.77590  -1.477 0.139662    
nighttimenight  0.07078    0.63546   0.111 0.911307    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 194.759  on 207  degrees of freedom
Residual deviance:  80.982  on 202  degrees of freedom
  (42 observations deleted due to missingness)
AIC: 92.982

Number of Fisher Scoring iterations: 7

drop1(outcome_model, test = "F")
[1] 68
Single term deletions

Model:
outcome ~ age + bac + speed + prior_offence + nighttime
              Df Deviance     AIC F value    Pr(>F)    
<none>             80.982  92.982                      
age            1   90.817 100.817 24.5343 1.539e-06 ***
bac            1  100.222 110.222 47.9926 5.603e-11 ***
speed          1   94.459 104.459 33.6177 2.553e-08 ***
prior_offence  1   83.398  93.398  6.0283   0.01492 *  
nighttime      1   80.994  90.994  0.0310   0.86039    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
outcome_model2 <- glm(outcome ~ prior_offence + bac + speed + 
    age + nighttime, data = drinkdriving, family = "binomial")
[1] 69
summary(outcome_model2)
[1] 70

Call:
glm(formula = outcome ~ prior_offence + bac + speed + age + nighttime, 
    family = "binomial", data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.2639  -0.3097  -0.0984  -0.0197   4.1427  

Coefficients:
               Estimate Std. Error z value Pr(>|z|)    
(Intercept)     4.22207    2.69261   1.568 0.116876    
prior_offenceY -1.14605    0.77590  -1.477 0.139662    
bac            -0.23325    0.06223  -3.748 0.000178 ***
speed          -0.14445    0.04455  -3.242 0.001185 ** 
age             0.07669    0.02597   2.953 0.003148 ** 
nighttimenight  0.07078    0.63546   0.111 0.911307    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 194.759  on 207  degrees of freedom
Residual deviance:  80.982  on 202  degrees of freedom
  (42 observations deleted due to missingness)
AIC: 92.982

Number of Fisher Scoring iterations: 7

fine <- ifelse(drinkdriving$outcome == "fine", 1, 0)
[1] 71
model_fine <- glm(fine ~ speed + bac, data = drinkdriving)
[1] 72
standardCoefs(model_fine)
[1] 73
               b      beta
speed 0.01048282 0.3523756
bac   0.01786778 0.3111228
drink <- with(drinkdriving, ifelse(kind_offence == "drinking_offence", 
    1, 0))
[1] 74
other <- with(drinkdriving, ifelse(kind_offence == "other_offence", 
    1, 0))
[1] 75
m5 <- glm(outcome ~ drink + other, data = drinkdriving, family = "binomial")
[1] 76
summary(m5)
[1] 77

Call:
glm(formula = outcome ~ drink + other, family = "binomial", data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.9005  -0.6681  -0.6681  -0.3803   2.3076  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -1.3863     0.1838  -7.542 4.62e-14 ***
drink        -1.2040     0.6262  -1.923   0.0545 .  
other         0.6931     0.5327   1.301   0.1932    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 237.06  on 245  degrees of freedom
Residual deviance: 229.82  on 243  degrees of freedom
  (4 observations deleted due to missingness)
AIC: 235.82

Number of Fisher Scoring iterations: 5

m6 <- glm(outcome ~ prior_offence, data = drinkdriving, family = "binomial")
[1] 78
summary(m6)
[1] 79

Call:
glm(formula = outcome ~ prior_offence, family = "binomial", data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.6681  -0.6681  -0.6681  -0.5650   1.9564  

Coefficients:
               Estimate Std. Error z value Pr(>|z|)    
(Intercept)     -1.3863     0.1838  -7.542 4.62e-14 ***
prior_offenceY  -0.3677     0.4051  -0.908    0.364    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 237.06  on 245  degrees of freedom
Residual deviance: 236.20  on 244  degrees of freedom
  (4 observations deleted due to missingness)
AIC: 240.2

Number of Fisher Scoring iterations: 4

new_data <- data.frame(id = factor(1:100))
[1] 80
new_data$speed <- runif(100, 30, 30)
[1] 81
new_data$bac <- runif(100, 0, 0)
[1] 82
new_data$nighttime <- "day"
[1] 83
new_data$prior_offence <- "N"
[1] 84
new_data$age <- sample(c(18:60), 100, replace = TRUE)
[1] 85
model <- glm(fine ~ speed + bac + age + nighttime + prior_offence, 
    data = drinkdriving)
[1] 86
new_data$probs <- predict(model, newdata = new_data)
[1] 87
with(new_data, plot(jitter(age, 20), (probs), xlab = "Ages (from 18 to 60)", 
    ylab = "Probability", main = "Probability of getting a fine by age", 
    col = c("slateblue"), bty = "n", pch = 20))
[1] 88
all_data <- merge(drinkdriving, officer_inc)
[1] 89
all_data$incident_id <- sort(all_data$incident_id)
[1] 90
class(all_data$officer)
[1] 91
[1] "factor"
levels(all_data$officer)
[1] 92
[1] "AS" "IT" "NP"
off_as <- with(all_data, ifelse(officer == "AS", 1, 0))
[1] 93
off_it <- with(all_data, ifelse(officer == "IT", 1, 0))
[1] 94
off_np <- with(all_data, ifelse(officer == "NP", 1, 0))
[1] 95
m_as <- glm(outcome ~ off_as * age, data = all_data, family = "binomial")
[1] 96
summary(m_as)
[1] 97

Call:
glm(formula = outcome ~ off_as * age, family = "binomial", data = all_data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.4089  -0.5248  -0.2939  -0.0642   2.6568  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -4.68913    0.98492  -4.761 1.93e-06 ***
off_as      -4.88007    2.22537  -2.193 0.028312 *  
age          0.06610    0.01816   3.640 0.000272 ***
off_as:age   0.09513    0.03912   2.431 0.015041 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 222.38  on 224  degrees of freedom
Residual deviance: 146.62  on 221  degrees of freedom
  (25 observations deleted due to missingness)
AIC: 154.62

Number of Fisher Scoring iterations: 7

anova(m_as, test = "Chisq")
[1] 98
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


           Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                         224     222.38              
off_as      1    0.088       223     222.29  0.767248    
age         1   68.219       222     154.07 < 2.2e-16 ***
off_as:age  1    7.458       221     146.62  0.006315 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m_it <- glm(outcome ~ off_it * age, data = all_data, family = "binomial")
[1] 99
summary(m_it)
[1] 100

Call:
glm(formula = outcome ~ off_it * age, family = "binomial", data = all_data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.9429  -0.5524  -0.2809  -0.1244   3.2300  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -7.32660    1.16045  -6.314 2.73e-10 ***
off_it       2.80276    1.76231   1.590    0.112    
age          0.11753    0.02041   5.758 8.49e-09 ***
off_it:age  -0.05243    0.03202  -1.638    0.102    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 222.38  on 224  degrees of freedom
Residual deviance: 152.17  on 221  degrees of freedom
  (25 observations deleted due to missingness)
AIC: 160.17

Number of Fisher Scoring iterations: 6

anova(m_it, test = "Chisq")
[1] 101
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


           Df Deviance Resid. Df Resid. Dev Pr(>Chi)    
NULL                         224     222.38             
off_it      1    0.063       223     222.32   0.8014    
age         1   67.665       222     154.65   <2e-16 ***
off_it:age  1    2.484       221     152.17   0.1150    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m_np <- glm(outcome ~ off_np * age, data = all_data, family = "binomial")
[1] 102
summary(m_np)
[1] 103

Call:
glm(formula = outcome ~ off_np * age, family = "binomial", data = all_data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.4116  -0.5025  -0.2879  -0.1292   2.9435  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -7.09475    1.12271  -6.319 2.63e-10 ***
off_np       2.21021    1.86354   1.186    0.236    
age          0.11566    0.02025   5.712 1.11e-08 ***
off_np:age  -0.04809    0.03390  -1.418    0.156    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 222.38  on 224  degrees of freedom
Residual deviance: 152.00  on 221  degrees of freedom
  (25 observations deleted due to missingness)
AIC: 160

Number of Fisher Scoring iterations: 6

anova(m_np, test = "Chisq")
[1] 104
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


           Df Deviance Resid. Df Resid. Dev Pr(>Chi)    
NULL                         224     222.38             
off_np      1    0.354       223     222.03   0.5521    
age         1   68.121       222     153.91   <2e-16 ***
off_np:age  1    1.905       221     152.00   0.1675    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
