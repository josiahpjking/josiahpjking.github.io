

	####### B157651 R script #######

library(ggplot2, quietly = T)
[1] 1
[1] "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(psych, quietly = T)
[1] 2
 [1] "psych"     "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(GGally, quietly = T)
[1] 3
 [1] "GGally"    "psych"     "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
library(ggpubr, quietly = T)
[1] 4
 [1] "ggpubr"    "magrittr"  "GGally"    "psych"     "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"    
[11] "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 5
 [1] "car"       "carData"   "ggpubr"    "magrittr"  "GGally"    "psych"     "ggplot2"   "readr"     "stats"     "graphics" 
[11] "grDevices" "utils"     "datasets"  "methods"   "base"     
load(url("https://edin.ac/2QCZNVu"))
[1] 6
[1] "drinkdriving" "officer_inc" 
describe(drinkdriving)
[1] 7
               vars   n mean    sd median trimmed   mad min  max range skew kurtosis   se
age               1 228   46 33.35   40.5   42.34 18.53  14  297   283  5.5    38.49 2.21
nighttime*        2 250  NaN    NA     NA     NaN    NA Inf -Inf  -Inf   NA       NA   NA
prior_offence*    3 250  NaN    NA     NA     NaN    NA Inf -Inf  -Inf   NA       NA   NA
 [ reached 'max' / getOption("max.print") -- omitted 4 rows ]
table(drinkdriving$age)
[1] 8

14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 
 1  5  2  3  1  2  3  6  2  5  8  3  2  2  5  4  4  4  6  5  9  8  3  4  2 10  5  6  5  3  2  3  4  5  2  3  3  3  6  3  5  4  3  4  4 
59 60 61 62 63 
 1  5  3  3  2 
 [ reached getOption("max.print") -- omitted 15 entries ]
drinkdriving$age[drinkdriving$age >= 293] <- NA
[1] 9
class(drinkdriving$age)
[1] 10
[1] "numeric"
hist(drinkdriving$age)
[1] 11
class(drinkdriving$nighttime)
[1] 12
[1] "character"
table(drinkdriving$nighttime)
[1] 13

18:25  2:05   day night 
    1     2    78   169 
drinkdriving$nighttime[drinkdriving$nighttime == "18:25" | drinkdriving$nighttime == 
    "2:05"] <- NA
[1] 14
drinkdriving$nighttime <- as.factor(drinkdriving$nighttime)
[1] 15
class(drinkdriving$nighttime)
[1] 16
[1] "factor"
levels(drinkdriving$nighttime)
[1] 17
[1] "day"   "night"
class(drinkdriving$prior_offence)
[1] 18
[1] "character"
table(drinkdriving$prior_offence)
[1] 19

          CD10           CD60 CD60,CD10,DR80      CD60,CD60           DD20           DR50           DR80              N           PL10 
             2              1              1              1              4             43              4            185              2 
          SP50           SP60           TS70      TS70,DR50 
             2              1              3              1 
drinkdriving$prior_offence[drinkdriving$prior_offence == "DD20"] <- NA
[1] 20
drinkdriving$prior_recode <- drinkdriving$prior_offence
[1] 21
table(drinkdriving$prior_recode)
[1] 22

          CD10           CD60 CD60,CD10,DR80      CD60,CD60           DR50           DR80              N           PL10           SP50 
             2              1              1              1             43              4            185              2              2 
          SP60           TS70      TS70,DR50 
             1              3              1 
drinkdriving$prior_recode[drinkdriving$prior_recode == "CD10" | 
    drinkdriving$prior_recode == "CD60"] <- "CD"
[1] 23
drinkdriving$prior_recode[drinkdriving$prior_recode == "SP50" | 
    drinkdriving$prior_recode == "SP60"] <- "SP"
[1] 24
drinkdriving$prior_recode[drinkdriving$prior_recode == "CD60,CD10,DR80" | 
    drinkdriving$prior_recode == "CD60,CD60" | drinkdriving$prior_recode == 
    "TS70,DR50"] <- "Multiple"
[1] 25
drinkdriving$prior_recode <- as.factor(drinkdriving$prior_recode)
[1] 26
class(drinkdriving$prior_recode)
[1] 27
[1] "factor"
levels(drinkdriving$prior_recode)
[1] 28
[1] "CD"       "DR50"     "DR80"     "Multiple" "N"        "PL10"     "SP"       "TS70"    
drinkdriving$speed[drinkdriving$speed == 0] <- NA
[1] 29
class(drinkdriving$speed)
[1] 30
[1] "numeric"
hist(drinkdriving$speed)
[1] 31
class(drinkdriving$bac)
[1] 32
[1] "numeric"
hist(drinkdriving$bac)
[1] 33
table(drinkdriving$outcome)
[1] 34

   fine    Fine    FINE warning Warning WARNING 
    191       2       9      43       2       3 
class(drinkdriving$outcome)
[1] 35
[1] "character"
drinkdriving$outcome[drinkdriving$outcome == "Fine" | drinkdriving$outcome == 
    "FINE"] <- "fine"
[1] 36
drinkdriving$outcome[drinkdriving$outcome == "Warning" | drinkdriving$outcome == 
    "WARNING"] <- "warning"
[1] 37
table(drinkdriving$outcome)
[1] 38

   fine warning 
    202      48 
drinkdriving$outcome <- as.factor(drinkdriving$outcome)
[1] 39
class(drinkdriving$outcome)
[1] 40
[1] "factor"
levels(drinkdriving$outcome)
[1] 41
[1] "fine"    "warning"
drinkdriving$outcome <- as.factor(ifelse(drinkdriving$outcome == 
    "fine", 1, 0))
[1] 42
levels(drinkdriving$outcome) <- c("warning", "fine")
[1] 43
table(drinkdriving$outcome)
[1] 44

warning    fine 
     48     202 
class(drinkdriving$incident_id)
[1] 45
[1] "character"
drinkdriving$incident_id <- as.factor(drinkdriving$incident_id)
[1] 46
describe(officer_inc)
[1] 47
             vars   n  mean    sd median trimmed   mad min max range skew kurtosis   se
officer*        1 249   1.8  0.84    2.0    1.76  1.48   1   3     2 0.38    -1.47 0.05
incident_id*    2 250 125.5 72.31  125.5  125.50 92.66   1 250   249 0.00    -1.21 4.57
class(officer_inc$officer)
[1] 48
[1] "factor"
levels(officer_inc$officer)
[1] 49
[1] "AS" "IT" "NP"
class(officer_inc$incident_id)
[1] 50
[1] "factor"
length(levels(drinkdriving$incident_id)) == length(levels(officer_inc$incident_id))
[1] 51
[1] TRUE
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 52
summary(m1)
[1] 53

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.719  -4.516  -0.861   3.849  42.785 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 29.29455    1.25564  23.330  < 2e-16 ***
age         -0.14353    0.02741  -5.236 3.86e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.82 on 218 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1117,	Adjusted R-squared:  0.1076 
F-statistic: 27.41 on 1 and 218 DF,  p-value: 3.863e-07

cor(drinkdriving$age, drinkdriving$bac, use = "complete.obs")
[1] 54
[1] -0.3342105
plot(drinkdriving$age, drinkdriving$bac)
[1] 55
a <- subset(drinkdriving, incident_id != "inc_154" & incident_id != 
    "inc_110")
[1] 56
cor(a$age, a$bac, use = "complete.obs")
[1] 57
[1] -0.3719763
plot(a$age, a$bac)
[1] 58
plot(m1)
[1] 59
m2 <- lm(bac ~ age, data = subset(drinkdriving, incident_id != 
    "inc_154" & incident_id != "inc_110"))
[1] 60
summary(m2)
[1] 61

Call:
lm(formula = bac ~ age, data = subset(drinkdriving, incident_id != 
    "inc_154" & incident_id != "inc_110"))

Residuals:
     Min       1Q   Median       3Q      Max 
-15.3270  -4.1824  -0.5698   3.9975  14.9487 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 28.68503    1.06949   26.82  < 2e-16 ***
age         -0.13730    0.02331   -5.89 1.47e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.791 on 216 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1384,	Adjusted R-squared:  0.1344 
F-statistic: 34.69 on 1 and 216 DF,  p-value: 1.469e-08

plot(m2)
[1] 62
summary(m2)
[1] 63

Call:
lm(formula = bac ~ age, data = subset(drinkdriving, incident_id != 
    "inc_154" & incident_id != "inc_110"))

Residuals:
     Min       1Q   Median       3Q      Max 
-15.3270  -4.1824  -0.5698   3.9975  14.9487 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 28.68503    1.06949   26.82  < 2e-16 ***
age         -0.13730    0.02331   -5.89 1.47e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.791 on 216 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1384,	Adjusted R-squared:  0.1344 
F-statistic: 34.69 on 1 and 216 DF,  p-value: 1.469e-08

m2$coefficients[1] + m2$coefficients[2] * 50
[1] 64
(Intercept) 
   21.81983 
predict(m2, newdata = data.frame(age = 50))
[1] 65
       1 
21.81983 
diag2 <- fortify(m2)
[1] 66
head(diag2)
[1] 67
       bac age        .hat   .sigma      .cooksd  .fitted    .resid  .stdresid
1 17.71374  39 0.004806521 5.791502 0.0022826353 23.33018 -5.616442 -0.9722358
2 22.13440  28 0.008079518 5.801257 0.0008966522 24.84052 -2.706120 -0.4692159
3 32.78940  38 0.004941985 5.769119 0.0064671524 23.46748  9.321915  1.6137826
4 20.47576  51 0.005709417 5.803629 0.0001254037 21.68253 -1.206767 -0.2089926
5 29.36736  56 0.007463312 5.775856 0.0079163976 20.99601  8.371349  1.4510630
6 19.12717  36 0.005310162 5.795631 0.0017043490 23.74209 -4.614918 -0.7990689
p1 <- ggplot(diag2, aes(sample = .stdresid)) + stat_qq() + geom_abline() + 
    xlab("Theoretical Quantiles") + ylab("Standardised Residuals") + 
    theme_classic()
[1] 68
p1



ggpairs(drinkdriving[, c(1:2, 4:5)])
[1] 70
m3 <- lm(bac ~ age + nighttime, data = subset(drinkdriving, incident_id != 
    "inc_154" & incident_id != "inc_110"))
[1] 71
summary(m3)
[1] 72

Call:
lm(formula = bac ~ age + nighttime, data = subset(drinkdriving, 
    incident_id != "inc_154" & incident_id != "inc_110"))

Residuals:
     Min       1Q   Median       3Q      Max 
-16.3421  -4.3987   0.2997   3.7390  14.4090 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    26.00346    1.18497  21.944  < 2e-16 ***
age            -0.13690    0.02209  -6.199 2.91e-09 ***
nighttimenight  3.86857    0.79364   4.874 2.13e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.417 on 213 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.2422,	Adjusted R-squared:  0.235 
F-statistic: 34.03 on 2 and 213 DF,  p-value: 1.498e-13

anova(m3)
[1] 73
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1300.0 1299.99  44.298 2.349e-10 ***
nighttime   1  697.3  697.27  23.760 2.131e-06 ***
Residuals 213 6250.8   29.35                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m4 <- lm(bac ~ age + speed, data = subset(drinkdriving, incident_id != 
    "inc_154" & incident_id != "inc_110"))
[1] 74
summary(m4)
[1] 75

Call:
lm(formula = bac ~ age + speed, data = subset(drinkdriving, incident_id != 
    "inc_154" & incident_id != "inc_110"))

Residuals:
     Min       1Q   Median       3Q      Max 
-15.4126  -3.9597  -0.5979   4.0894  14.3787 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 25.69629    2.81054   9.143  < 2e-16 ***
age         -0.11272    0.03188  -3.536 0.000498 ***
speed        0.04991    0.04329   1.153 0.250202    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.798 on 214 degrees of freedom
  (31 observations deleted due to missingness)
Multiple R-squared:  0.1442,	Adjusted R-squared:  0.1362 
F-statistic: 18.03 on 2 and 214 DF,  p-value: 5.782e-08

anova(m4)
[1] 76
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1167.7 1167.70 34.7384 1.452e-08 ***
speed       1   44.7   44.69  1.3294    0.2502    
Residuals 214 7193.4   33.61                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m5 <- lm(bac ~ age + nighttime + speed, data = subset(drinkdriving, 
    incident_id != "inc_154" & incident_id != "inc_110"))
[1] 77
summary(m5)
[1] 78

Call:
lm(formula = bac ~ age + nighttime + speed, data = subset(drinkdriving, 
    incident_id != "inc_154" & incident_id != "inc_110"))

Residuals:
     Min       1Q   Median       3Q      Max 
-15.5449  -4.3884   0.5332   3.5881  14.2799 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    23.28482    2.72172   8.555 2.42e-15 ***
age            -0.11424    0.03020  -3.783 0.000202 ***
nighttimenight  3.85847    0.79604   4.847 2.43e-06 ***
speed           0.04550    0.04084   1.114 0.266497    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.426 on 211 degrees of freedom
  (33 observations deleted due to missingness)
Multiple R-squared:  0.2467,	Adjusted R-squared:  0.236 
F-statistic: 23.03 on 3 and 211 DF,  p-value: 6.166e-13

anova(m5)
[1] 79
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1305.1 1305.14 44.3228 2.367e-10 ***
nighttime   1  692.7  692.69 23.5238 2.393e-06 ***
speed       1   36.6   36.55  1.2413    0.2665    
Residuals 211 6213.2   29.45                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m6 <- lm(bac ~ age * nighttime * speed, data = subset(drinkdriving, 
    c(incident_id != "inc_154" & incident_id != "inc_110")))
[1] 80
summary(m6)
[1] 81

Call:
lm(formula = bac ~ age * nighttime * speed, data = subset(drinkdriving, 
    c(incident_id != "inc_154" & incident_id != "inc_110")))

Residuals:
     Min       1Q   Median       3Q      Max 
-16.3688  -4.1551   0.3091   3.5912  14.8915 

Coefficients:
                           Estimate Std. Error t value Pr(>|t|)  
(Intercept)               38.303066  21.588571   1.774   0.0775 .
age                       -0.289033   0.202843  -1.425   0.1557  
nighttimenight           -15.157844  22.025246  -0.688   0.4921  
speed                     -0.194146   0.366459  -0.530   0.5968  
age:nighttimenight         0.262406   0.218628   1.200   0.2314  
age:speed                  0.001181   0.003416   0.346   0.7300  
nighttimenight:speed       0.314728   0.378471   0.832   0.4066  
age:nighttimenight:speed  -0.002903   0.003967  -0.732   0.4651  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.439 on 207 degrees of freedom
  (33 observations deleted due to missingness)
Multiple R-squared:  0.2576,	Adjusted R-squared:  0.2325 
F-statistic: 10.26 on 7 and 207 DF,  p-value: 5.018e-11

anova(m6)
[1] 82
Analysis of Variance Table

Response: bac
                     Df Sum Sq Mean Sq F value    Pr(>F)    
age                   1 1305.1 1305.14 44.1251 2.667e-10 ***
nighttime             1  692.7  692.69 23.4189 2.544e-06 ***
speed                 1   36.6   36.55  1.2357    0.2676    
age:nighttime         1   55.0   55.02  1.8600    0.1741    
age:speed             1    7.7    7.68  0.2595    0.6110    
nighttime:speed       1   11.9   11.94  0.4037    0.5259    
age:nighttime:speed   1   15.8   15.84  0.5356    0.4651    
Residuals           207 6122.7   29.58                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m7 <- lm(bac ~ age + nighttime + speed, data = drinkdriving)
[1] 83
summary(m7)
[1] 84

Call:
lm(formula = bac ~ age + nighttime + speed, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-13.393  -4.641   0.071   3.827  32.746 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    14.00382    2.76431   5.066 8.80e-07 ***
age            -0.03642    0.03237  -1.125    0.262    
nighttimenight  3.78108    0.90143   4.195 4.01e-05 ***
speed           0.20778    0.03908   5.317 2.66e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.182 on 213 degrees of freedom
  (33 observations deleted due to missingness)
Multiple R-squared:  0.277,	Adjusted R-squared:  0.2669 
F-statistic: 27.21 on 3 and 213 DF,  p-value: 6.163e-15

anova(m7)
[1] 85
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1422.1 1422.05  37.213 4.927e-09 ***
nighttime   1  616.8  616.79  16.140 8.155e-05 ***
speed       1 1080.2 1080.24  28.268 2.660e-07 ***
Residuals 213 8139.6   38.21                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m3)
[1] 86

Call:
lm(formula = bac ~ age + nighttime, data = subset(drinkdriving, 
    incident_id != "inc_154" & incident_id != "inc_110"))

Residuals:
     Min       1Q   Median       3Q      Max 
-16.3421  -4.3987   0.2997   3.7390  14.4090 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    26.00346    1.18497  21.944  < 2e-16 ***
age            -0.13690    0.02209  -6.199 2.91e-09 ***
nighttimenight  3.86857    0.79364   4.874 2.13e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.417 on 213 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.2422,	Adjusted R-squared:  0.235 
F-statistic: 34.03 on 2 and 213 DF,  p-value: 1.498e-13

plot(m3)
[1] 87
sqrt(vif(m3))
[1] 88
      age nighttime 
 1.003934  1.003934 
summary(m3)
[1] 89

Call:
lm(formula = bac ~ age + nighttime, data = subset(drinkdriving, 
    incident_id != "inc_154" & incident_id != "inc_110"))

Residuals:
     Min       1Q   Median       3Q      Max 
-16.3421  -4.3987   0.2997   3.7390  14.4090 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    26.00346    1.18497  21.944  < 2e-16 ***
age            -0.13690    0.02209  -6.199 2.91e-09 ***
nighttimenight  3.86857    0.79364   4.874 2.13e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.417 on 213 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.2422,	Adjusted R-squared:  0.235 
F-statistic: 34.03 on 2 and 213 DF,  p-value: 1.498e-13

summary(m5)
[1] 90

Call:
lm(formula = bac ~ age + nighttime + speed, data = subset(drinkdriving, 
    incident_id != "inc_154" & incident_id != "inc_110"))

Residuals:
     Min       1Q   Median       3Q      Max 
-15.5449  -4.3884   0.5332   3.5881  14.2799 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    23.28482    2.72172   8.555 2.42e-15 ***
age            -0.11424    0.03020  -3.783 0.000202 ***
nighttimenight  3.85847    0.79604   4.847 2.43e-06 ***
speed           0.04550    0.04084   1.114 0.266497    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.426 on 211 degrees of freedom
  (33 observations deleted due to missingness)
Multiple R-squared:  0.2467,	Adjusted R-squared:  0.236 
F-statistic: 23.03 on 3 and 211 DF,  p-value: 6.166e-13

mean(drinkdriving$speed[drinkdriving$nighttime == "night"], na.rm = T) - 
    mean(drinkdriving$speed[drinkdriving$nighttime == "day"], 
        na.rm = T)
[1] 91
[1] 1.790916
t.test(drinkdriving$speed ~ drinkdriving$nighttime, alternative = "greater")
[1] 92

	Welch Two Sample t-test

data:  drinkdriving$speed by drinkdriving$nighttime
t = -0.89687, df = 154.35, p-value = 0.8144
alternative hypothesis: true difference in means is greater than 0
95 percent confidence interval:
 -5.09527      Inf
sample estimates:
  mean in group day mean in group night 
           39.30514            41.09606 

t.test(drinkdriving$speed ~ drinkdriving$nighttime, alternitive = "greater")$conf.int
[1] 93
[1] -5.735592  2.153760
attr(,"conf.level")
[1] 0.95
glm1 <- glm(family = "binomial", data = drinkdriving, outcome ~ 
    bac + speed + age + prior_recode + nighttime)
[1] 94
summary(glm1)
[1] 95

Call:
glm(formula = outcome ~ bac + speed + age + prior_recode + nighttime, 
    family = "binomial", data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-4.2511   0.0034   0.0392   0.2089   1.8515  

Coefficients:
                       Estimate Std. Error z value Pr(>|z|)    
(Intercept)             1.74571    3.49095   0.500 0.617029    
bac                     0.28738    0.07634   3.765 0.000167 ***
speed                   0.15135    0.04598   3.292 0.000996 ***
age                    -0.13793    0.03756  -3.672 0.000240 ***
prior_recodeDR50       -1.33748    2.17194  -0.616 0.538027    
prior_recodeDR80       -8.25489    2.98748  -2.763 0.005724 ** 
prior_recodeMultiple   -9.90592 2381.62790  -0.004 0.996681    
prior_recodeN          -3.70590    1.92021  -1.930 0.053614 .  
prior_recodePL10       -1.67928   45.32136  -0.037 0.970443    
prior_recodeSP         -8.79237    2.87938  -3.054 0.002261 ** 
 [ reached getOption("max.print") -- omitted 2 rows ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 205.761  on 212  degrees of freedom
Residual deviance:  63.939  on 201  degrees of freedom
  (37 observations deleted due to missingness)
AIC: 87.939

Number of Fisher Scoring iterations: 16

anova(glm1, test = "Chisq")
[1] 96
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


             Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                           212    205.761              
bac           1   45.832       211    159.929 1.288e-11 ***
speed         1   65.962       210     93.967 4.598e-16 ***
age           1   10.053       209     83.914  0.001521 ** 
prior_recode  7   19.718       202     64.196  0.006213 ** 
nighttime     1    0.258       201     63.939  0.611771    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
glm2 <- glm(family = "binomial", data = drinkdriving, outcome ~ 
    bac + speed + age + prior_recode)
[1] 97
summary(glm2)
[1] 98

Call:
glm(formula = outcome ~ bac + speed + age + prior_recode, family = "binomial", 
    data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-4.2857   0.0034   0.0394   0.1995   1.7696  

Coefficients:
                       Estimate Std. Error z value Pr(>|z|)    
(Intercept)             1.59985    3.49153   0.458 0.646802    
bac                     0.27583    0.07184   3.839 0.000123 ***
speed                   0.15525    0.04583   3.387 0.000706 ***
age                    -0.13493    0.03717  -3.630 0.000283 ***
prior_recodeDR50       -1.58959    2.09133  -0.760 0.447202    
prior_recodeDR80       -8.29959    2.91784  -2.844 0.004449 ** 
prior_recodeMultiple   -9.82184 2388.94538  -0.004 0.996720    
prior_recodeN          -3.83221    1.89056  -2.027 0.042660 *  
prior_recodePL10       -1.66137   42.60751  -0.039 0.968896    
prior_recodeSP         -8.79327    2.90042  -3.032 0.002432 ** 
 [ reached getOption("max.print") -- omitted 1 row ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 206.589  on 214  degrees of freedom
Residual deviance:  64.204  on 204  degrees of freedom
  (35 observations deleted due to missingness)
AIC: 86.204

Number of Fisher Scoring iterations: 16

anova(glm2, test = "Chisq")
[1] 99
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


             Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                           214    206.589              
bac           1   45.811       213    160.778 1.302e-11 ***
speed         1   66.800       212     93.979 3.006e-16 ***
age           1   10.024       211     83.954  0.001545 ** 
prior_recode  7   19.751       204     64.204  0.006135 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
glm2s <- glm(family = "binomial", data = drinkdriving, outcome ~ 
    scale(bac) + scale(speed) + scale(age) + prior_recode)
[1] 100
summary(glm2s)
[1] 101

Call:
glm(formula = outcome ~ scale(bac) + scale(speed) + scale(age) + 
    prior_recode, family = "binomial", data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-4.2857   0.0034   0.0394   0.1995   1.7696  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)             8.6632     2.2953   3.774 0.000160 ***
scale(bac)              2.0647     0.5378   3.839 0.000123 ***
scale(speed)            2.2854     0.6747   3.387 0.000706 ***
scale(age)             -2.2627     0.6233  -3.630 0.000283 ***
prior_recodeDR50       -1.5896     2.0913  -0.760 0.447202    
prior_recodeDR80       -8.2996     2.9178  -2.844 0.004449 ** 
prior_recodeMultiple   -9.8218  2388.9454  -0.004 0.996720    
prior_recodeN          -3.8322     1.8906  -2.027 0.042660 *  
prior_recodePL10       -1.6614    42.6075  -0.039 0.968896    
prior_recodeSP         -8.7933     2.9004  -3.032 0.002432 ** 
 [ reached getOption("max.print") -- omitted 1 row ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 206.589  on 214  degrees of freedom
Residual deviance:  64.204  on 204  degrees of freedom
  (35 observations deleted due to missingness)
AIC: 86.204

Number of Fisher Scoring iterations: 16

drinkdriving$DR50 <- drinkdriving$prior_offence
[1] 102
drinkdriving$DR50 <- as.character(drinkdriving$DR50)
[1] 103
class(drinkdriving$DR50)
[1] 104
[1] "character"
table(drinkdriving$DR50)
[1] 105

          CD10           CD60 CD60,CD10,DR80      CD60,CD60           DR50           DR80              N           PL10           SP50 
             2              1              1              1             43              4            185              2              2 
          SP60           TS70      TS70,DR50 
             1              3              1 
drinkdriving$DR50[drinkdriving$DR50 == "TS70,DR50"] <- "DR50"
[1] 106
drinkdriving$DR50[drinkdriving$DR50 == "CD10" | drinkdriving$DR50 == 
    "CD60" | drinkdriving$DR50 == "CD60,CD10,DR80" | drinkdriving$DR50 == 
    "CD60,CD60" | drinkdriving$DR50 == "DR80" | drinkdriving$DR50 == 
    "PL10" | drinkdriving$DR50 == "SP50" | drinkdriving$DR50 == 
    "SP60" | drinkdriving$DR50 == "TS70"] <- "other"
[1] 107
table(drinkdriving$DR50)
[1] 108

 DR50     N other 
   44   185    17 
drinkdriving$DR50 <- as.factor(drinkdriving$DR50)
[1] 109
class(drinkdriving$DR50)
[1] 110
[1] "factor"
levels(drinkdriving$DR50)
[1] 111
[1] "DR50"  "N"     "other"
contrasts(drinkdriving$DR50) <- cbind(otherVDR50 = c(1/2, 0, 
    -1/2), otherDR50VN = c(1/3, -2/3, 1/3))
[1] 112
contrasts(drinkdriving$DR50)
[1] 113
      otherVDR50 otherDR50VN
DR50         0.5   0.3333333
N            0.0  -0.6666667
other       -0.5   0.3333333
colSums(contrasts(drinkdriving$DR50))
[1] 114
 otherVDR50 otherDR50VN 
          0           0 
sum(apply(contrasts(drinkdriving$DR50), 1, prod))
[1] 115
[1] 0
glm3 <- glm(family = "binomial", data = drinkdriving, outcome ~ 
    DR50)
[1] 116
summary(glm3)
[1] 117

Call:
glm(formula = outcome ~ DR50, family = "binomial", data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1899   0.4366   0.6681   0.6681   0.8346  

Coefficients:
                Estimate Std. Error z value Pr(>|z|)    
(Intercept)       1.5214     0.2565   5.932 2.99e-09 ***
DR50otherVDR50    1.4271     0.7471   1.910   0.0561 .  
DR50otherDR50VN   0.2027     0.4163   0.487   0.6263    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 237.06  on 245  degrees of freedom
Residual deviance: 232.55  on 243  degrees of freedom
  (4 observations deleted due to missingness)
AIC: 238.55

Number of Fisher Scoring iterations: 4

describe(drinkdriving$age)
[1] 118
   vars   n  mean    sd median trimmed   mad min max range skew kurtosis   se
X1    1 225 42.68 16.77     40   41.93 17.79  14  90    76  0.4    -0.52 1.12
length(14:90)
[1] 119
[1] 77
age <- c(14:90)
[1] 120
dat4 <- data.frame(age)
[1] 121
dat4$speed <- as.integer(sample("30", 77, replace = T))
[1] 122
dat4$bac <- as.integer(sample("0", 77, replace = T))
[1] 123
dat4$prior_recode <- as.factor(sample("N", 77, replace = T))
[1] 124
pred <- predict(glm2, newdata = dat4)
[1] 125
predodds <- exp(pred)
[1] 126
predprob <- predodds/(predodds + 1)
[1] 127
plot(dat4$age, predprob)
[1] 128
p2 <- ggplot(dat4, aes(x = age, y = predprob)) + geom_point() + 
    xlab("Age of Driver") + ylab("Probability of Fine") + theme_classic()
[1] 129
p2



cdata <- merge(drinkdriving, officer_inc, by = "incident_id")
[1] 131
plot(cdata$age, cdata$outcome, col = as.numeric(cdata$officer))
[1] 132
p3 <- ggplot(cdata[!is.na(cdata$officer), ], aes(x = age, y = officer, 
    colour = outcome)) + geom_jitter(height = 0.1) + xlab("Age of Driver") + 
    ylab("Officer") + theme_classic()
[1] 133
p3



glm5 <- glm(family = "binomial", data = cdata, outcome ~ officer * 
    age)
[1] 135
summary(glm5)
[1] 136

Call:
glm(formula = outcome ~ officer * age, family = "binomial", data = cdata)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.7179   0.0642   0.2741   0.5454   2.4089  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept)    9.56920    1.99554   4.795 1.62e-06 ***
officerIT     -5.04535    2.39610  -2.106   0.0352 *  
officerNP     -4.68465    2.48887  -1.882   0.0598 .  
age           -0.16122    0.03466  -4.652 3.29e-06 ***
officerIT:age  0.09612    0.04254   2.260   0.0238 *  
officerNP:age  0.09365    0.04405   2.126   0.0335 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 222.38  on 224  degrees of freedom
Residual deviance: 146.41  on 219  degrees of freedom
  (25 observations deleted due to missingness)
AIC: 158.41

Number of Fisher Scoring iterations: 7

anova(glm5, test = "Chisq")
[1] 137
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


            Df Deviance Resid. Df Resid. Dev Pr(>Chi)    
NULL                          224     222.38             
officer      2    0.356       222     222.03  0.83699    
age          1   68.233       221     153.79  < 2e-16 ***
officer:age  2    7.383       219     146.41  0.02494 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
prediction <- predict(glm5, newdata = cdata)
[1] 138
prediction_odds <- exp(prediction)
[1] 139
prediction_prob <- prediction_odds/(prediction_odds + 1)
[1] 140
cdata$predicted <- prediction_prob
[1] 141
p4 <- ggplot(cdata[!is.na(cdata$officer), ], aes(x = age, y = predicted, 
    col = officer)) + geom_line() + xlab("Age of Driver") + ylab("Probability of Fine") + 
    theme_classic()
[1] 142
p4



ggarrange(p3, p4)
[1] 144
