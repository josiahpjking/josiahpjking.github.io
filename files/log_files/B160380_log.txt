

	####### B160380 R script #######

load(url("https://edin.ac/2QCZNVu"))
[1] 1
[1] "drinkdriving" "officer_inc" 
drinkdriving$nighttime <- as.factor(drinkdriving$nighttime)
[1] 2
levels(drinkdriving$nighttime)
[1] 3
[1] "18:25" "2:05"  "day"   "night"
levels(drinkdriving$nighttime)[levels(drinkdriving$nighttime) == 
    "18:25"] <- NA
[1] 4
levels(drinkdriving$nighttime)[levels(drinkdriving$nighttime) == 
    "2:05"] <- NA
[1] 5
drinkdriving$outcome <- as.factor(drinkdriving$outcome)
[1] 6
levels(drinkdriving$outcome)
[1] 7
[1] "fine"    "Fine"    "FINE"    "warning" "Warning" "WARNING"
levels(drinkdriving$outcome)[levels(drinkdriving$outcome) == 
    "Fine"] <- "fine"
[1] 8
levels(drinkdriving$outcome)[levels(drinkdriving$outcome) == 
    "FINE"] <- "fine"
[1] 9
levels(drinkdriving$outcome)[levels(drinkdriving$outcome) == 
    "Warning"] <- "warning"
[1] 10
levels(drinkdriving$outcome)[levels(drinkdriving$outcome) == 
    "WARNING"] <- "warning"
[1] 11
drinkdriving$prior_offence <- as.factor(drinkdriving$prior_offence)
[1] 12
drinkdriving$has_prior_offence <- ifelse(drinkdriving$prior_offence == 
    "N", 0, 1)
[1] 13
drinkdriving[224, "age"] = NA
[1] 14
drinkdriving[114, "age"] = NA
[1] 15
drinkdriving[51, "age"] = NA
[1] 16
drinkdriving <- drinkdriving[-c(110, 154), ]
[1] 17
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 18
summary(m1)
[1] 19

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.3270  -4.1824  -0.5698   3.9975  14.9487 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 28.68503    1.06949   26.82  < 2e-16 ***
age         -0.13730    0.02331   -5.89 1.47e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.791 on 216 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1384,	Adjusted R-squared:  0.1344 
F-statistic: 34.69 on 1 and 216 DF,  p-value: 1.469e-08

predict(m1, data.frame(age = 50))
[1] 20
       1 
21.81983 
plot(m1, which = 2)
[1] 21
m2 <- lm(bac ~ age + nighttime, data = drinkdriving)
[1] 22
anova(m2)
[1] 23
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1300.0 1299.99  44.298 2.349e-10 ***
nighttime   1  697.3  697.27  23.760 2.131e-06 ***
Residuals 213 6250.8   29.35                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m2)
[1] 24

Call:
lm(formula = bac ~ age + nighttime, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.3421  -4.3987   0.2997   3.7390  14.4090 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    26.00346    1.18497  21.944  < 2e-16 ***
age            -0.13690    0.02209  -6.199 2.91e-09 ***
nighttimenight  3.86857    0.79364   4.874 2.13e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.417 on 213 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.2422,	Adjusted R-squared:  0.235 
F-statistic: 34.03 on 2 and 213 DF,  p-value: 1.498e-13

m3 <- lm(bac ~ age + speed, data = drinkdriving)
[1] 25
anova(m3)
[1] 26
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1163.1 1163.14 34.6961 1.471e-08 ***
speed       1   35.5   35.50  1.0589    0.3046    
Residuals 215 7207.6   33.52                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m3)
[1] 27

Call:
lm(formula = bac ~ age + speed, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.4118  -3.8926  -0.6094   4.1298  14.4229 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 26.08699    2.74183   9.514  < 2e-16 ***
age         -0.11540    0.03156  -3.656 0.000322 ***
speed        0.04320    0.04198   1.029 0.304616    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.79 on 215 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1426,	Adjusted R-squared:  0.1346 
F-statistic: 17.88 on 2 and 215 DF,  p-value: 6.574e-08

m4 <- lm(bac ~ nighttime + age + speed, data = drinkdriving)
[1] 28
summary(m4)
[1] 29

Call:
lm(formula = bac ~ nighttime + age + speed, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.6457  -4.3757   0.5792   3.5662  14.2890 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    23.52651    2.66327   8.834 3.89e-16 ***
nighttimenight  3.87648    0.79353   4.885 2.04e-06 ***
age            -0.11596    0.02990  -3.878 0.000141 ***
speed           0.04110    0.03958   1.038 0.300244    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.416 on 212 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.246,	Adjusted R-squared:  0.2353 
F-statistic: 23.05 on 3 and 212 DF,  p-value: 5.894e-13

drinkdriving$recieved_fine <- ifelse(drinkdriving$outcome == 
    "fine", 1, 0)
[1] 30
m5 <- lm(recieved_fine ~ speed + bac + nighttime + age, data = drinkdriving)
[1] 31
anova(m5)
[1] 32
Analysis of Variance Table

Response: recieved_fine
           Df  Sum Sq Mean Sq  F value    Pr(>F)    
speed       1 10.4624 10.4624 107.1294 < 2.2e-16 ***
bac         1  2.5095  2.5095  25.6962 8.723e-07 ***
nighttime   1  0.0043  0.0043   0.0444  0.833301    
age         1  0.8571  0.8571   8.7759  0.003402 ** 
Residuals 211 20.6065  0.0977                       
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m5)
[1] 33

Call:
lm(formula = recieved_fine ~ speed + bac + nighttime + age, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.08476 -0.16206  0.06802  0.22048  0.67534 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.279515   0.179737   1.555 0.121411    
speed           0.010326   0.002290   4.510 1.08e-05 ***
bac             0.015599   0.003963   3.936 0.000112 ***
nighttimenight -0.007871   0.048294  -0.163 0.870689    
age            -0.005289   0.001785  -2.962 0.003402 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.3125 on 211 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.4017,	Adjusted R-squared:  0.3903 
F-statistic: 35.41 on 4 and 211 DF,  p-value: < 2.2e-16

m6 <- lm(recieved_fine ~ scale(speed) + scale(bac), data = drinkdriving)
[1] 34
summary(m6)
[1] 35

Call:
lm(formula = recieved_fine ~ scale(speed) + scale(bac), data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.29504 -0.15823  0.07909  0.23667  0.58921 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)   0.80668    0.02050  39.343  < 2e-16 ***
scale(speed)  0.17052    0.02275   7.494 1.28e-12 ***
scale(bac)    0.10645    0.02265   4.701 4.37e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.3196 on 240 degrees of freedom
  (5 observations deleted due to missingness)
Multiple R-squared:  0.3532,	Adjusted R-squared:  0.3478 
F-statistic: 65.54 on 2 and 240 DF,  p-value: < 2.2e-16

prioroffenders <- subset(drinkdriving, has_prior_offence == "1")
[1] 36
levels(prioroffenders$prior_offence)
[1] 37
 [1] "CD10"           "CD60"           "CD60,CD10,DR80" "CD60,CD60"      "DD20"           "DR50"           "DR80"          
 [8] "N"              "PL10"           "SP50"           "SP60"           "TS70"           "TS70,DR50"     
prioroffenders$prior_drinkdrive <- ifelse(prioroffenders$prior_offence == 
    "DR50", 1, 0)
[1] 38
prioroffenders[39, "prior_drinkdrive"] = 1
[1] 39
mdrink <- lm(recieved_fine ~ prior_drinkdrive, data = prioroffenders)
[1] 40
summary(mdrink)
[1] 41

Call:
lm(formula = recieved_fine ~ prior_drinkdrive, data = prioroffenders)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.90909  0.09091  0.09091  0.09091  0.36842 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.63158    0.08338   7.575 2.37e-10 ***
prior_drinkdrive  0.27751    0.09977   2.782  0.00719 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.3634 on 61 degrees of freedom
Multiple R-squared:  0.1126,	Adjusted R-squared:  0.09801 
F-statistic: 7.737 on 1 and 61 DF,  p-value: 0.007189

anova(mdrink)
[1] 42
Analysis of Variance Table

Response: recieved_fine
                 Df Sum Sq Mean Sq F value   Pr(>F)   
prior_drinkdrive  1 1.0219 1.02195  7.7368 0.007189 **
Residuals        61 8.0574 0.13209                    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m7 <- lm(recieved_fine ~ has_prior_offence, data = drinkdriving)
[1] 43
summary(m7)
[1] 44

Call:
lm(formula = recieved_fine ~ has_prior_offence, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.8254  0.1746  0.2000  0.2000  0.2000 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)        0.80000    0.02915  27.441   <2e-16 ***
has_prior_offence  0.02540    0.05784   0.439    0.661    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.3965 on 246 degrees of freedom
Multiple R-squared:  0.0007831,	Adjusted R-squared:  -0.003279 
F-statistic: 0.1928 on 1 and 246 DF,  p-value: 0.661

anova(m7)
[1] 45
Analysis of Variance Table

Response: recieved_fine
                   Df Sum Sq  Mean Sq F value Pr(>F)
has_prior_offence   1  0.030 0.030312  0.1928  0.661
Residuals         246 38.679 0.157233               
m8 <- lm(recieved_fine ~ age + nighttime + speed + bac + has_prior_offence, 
    data = drinkdriving)
[1] 46
age <- c(17:100)
[1] 47
nighttime <- "day"
[1] 48
speed <- 30
[1] 49
bac <- 0
[1] 50
has_prior_offence <- 0
[1] 51
predictiondata <- data.frame(age, nighttime, speed, bac, has_prior_offence)
[1] 52
predictiondata$chanceoffine <- predict(m8, predictiondata)
[1] 53
with(predictiondata, plot(chanceoffine, age, xlab = "Chance of Fine", 
    ylab = "Age", main = "A Graph Showing Predictions of Fines Using Age", 
    pch = 16))
[1] 54
abline(lm(age ~ chanceoffine, data = predictiondata))
[1] 55
total <- merge(x = drinkdriving, y = officer_inc, by = "incident_id", 
    all.x = TRUE)
[1] 56
dfIT <- subset(total, officer == "IT")
[1] 57
dfAS <- subset(total, officer == "AS")
[1] 58
dfNP <- subset(total, officer == "NP")
[1] 59
mIT <- lm(recieved_fine ~ age + nighttime + speed + bac + has_prior_offence, 
    data = dfIT)
[1] 60
summary(mIT)
[1] 61

Call:
lm(formula = recieved_fine ~ age + nighttime + speed + bac + 
    has_prior_offence, data = dfIT)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.97610 -0.26483  0.09295  0.27573  0.57671 

Coefficients:
                    Estimate Std. Error t value Pr(>|t|)  
(Intercept)       -0.1226446  0.4214069  -0.291   0.7723  
age               -0.0005506  0.0041363  -0.133   0.8947  
nighttimenight     0.0450353  0.1202017   0.375   0.7095  
speed              0.0115716  0.0049853   2.321   0.0245 *
bac                0.0177380  0.0094432   1.878   0.0663 .
has_prior_offence  0.1163586  0.1074398   1.083   0.2841  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.3641 on 49 degrees of freedom
  (10 observations deleted due to missingness)
Multiple R-squared:  0.3078,	Adjusted R-squared:  0.2371 
F-statistic: 4.357 on 5 and 49 DF,  p-value: 0.002327

mAS <- lm(recieved_fine ~ age + nighttime + speed + bac + has_prior_offence, 
    data = dfAS)
[1] 62
summary(mAS)
[1] 63

Call:
lm(formula = recieved_fine ~ age + nighttime + speed + bac + 
    has_prior_offence, data = dfAS)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.73450 -0.16194  0.01915  0.16976  0.48285 

Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)        0.462633   0.220272   2.100  0.03830 *  
age               -0.009363   0.002144  -4.367 3.16e-05 ***
nighttimenight     0.069938   0.059320   1.179  0.24128    
speed              0.008580   0.002791   3.074  0.00274 ** 
bac                0.014319   0.004878   2.935  0.00416 ** 
has_prior_offence  0.044516   0.061313   0.726  0.46956    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.2656 on 97 degrees of freedom
  (12 observations deleted due to missingness)
Multiple R-squared:  0.5906,	Adjusted R-squared:  0.5695 
F-statistic: 27.98 on 5 and 97 DF,  p-value: < 2.2e-16

mNP <- lm(recieved_fine ~ age + nighttime + speed + bac + has_prior_offence, 
    data = dfNP)
[1] 64
summary(mNP)
[1] 65

Call:
lm(formula = recieved_fine ~ age + nighttime + speed + bac + 
    has_prior_offence, data = dfNP)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.0323 -0.1216  0.1145  0.2131  0.4100 

Coefficients:
                    Estimate Std. Error t value Pr(>|t|)   
(Intercept)        0.0844094  0.4114800   0.205  0.83827   
age               -0.0006175  0.0042239  -0.146  0.88433   
nighttimenight    -0.1196684  0.0978657  -1.223  0.22693   
speed              0.0145718  0.0054380   2.680  0.00985 **
bac                0.0137622  0.0081515   1.688  0.09734 . 
has_prior_offence -0.0365591  0.1052121  -0.347  0.72963   
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.3328 on 52 degrees of freedom
  (9 observations deleted due to missingness)
Multiple R-squared:  0.3039,	Adjusted R-squared:  0.237 
F-statistic: 4.541 on 5 and 52 DF,  p-value: 0.001645

