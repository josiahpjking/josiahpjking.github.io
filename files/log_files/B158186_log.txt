

	####### B158186 R script #######

library(psych, quietly = T)
[1] 1
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(ggplot2, quietly = T)
[1] 2
 [1] "ggplot2"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 3
 [1] "car"       "carData"   "ggplot2"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[11] "methods"   "base"     
load(url("https://edin.ac/2QCZNVu"))
[1] 4
[1] "drinkdriving" "officer_inc" 
summary(drinkdriving)
[1] 5
      age          nighttime         prior_offence          speed             bac           outcome          incident_id       
 Min.   : 14.00   Length:250         Length:250         Min.   :  0.00   Min.   : 3.987   Length:250         Length:250        
 1st Qu.: 30.00   Class :character   Class :character   1st Qu.: 30.92   1st Qu.:19.264   Class :character   Class :character  
 Median : 40.50   Mode  :character   Mode  :character   Median : 40.64   Median :23.609   Mode  :character   Mode  :character  
 Mean   : 46.00                                         Mean   : 40.49   Mean   :23.605                                        
 3rd Qu.: 55.25                                         3rd Qu.: 48.84   3rd Qu.:27.898                                        
 Max.   :297.00                                         Max.   :120.34   Max.   :65.764                                        
 NA's   :22                                                              NA's   :5                                             
describe(drinkdriving)
[1] 6
               vars   n mean    sd median trimmed   mad min  max range skew kurtosis   se
age               1 228   46 33.35   40.5   42.34 18.53  14  297   283  5.5    38.49 2.21
nighttime*        2 250  NaN    NA     NA     NaN    NA Inf -Inf  -Inf   NA       NA   NA
prior_offence*    3 250  NaN    NA     NA     NaN    NA Inf -Inf  -Inf   NA       NA   NA
 [ reached 'max' / getOption("max.print") -- omitted 4 rows ]
table(drinkdriving$nighttime)
[1] 7

18:25  2:05   day night 
    1     2    78   169 
table(drinkdriving$prior_offence)
[1] 8

          CD10           CD60 CD60,CD10,DR80      CD60,CD60           DD20           DR50           DR80              N           PL10 
             2              1              1              1              4             43              4            185              2 
          SP50           SP60           TS70      TS70,DR50 
             2              1              3              1 
table(drinkdriving$outcome)
[1] 9

   fine    Fine    FINE warning Warning WARNING 
    191       2       9      43       2       3 
summary(officer_inc)
[1] 10
 officer     incident_id 
 AS  :116   inc_1  :  1  
 IT  : 66   inc_10 :  1  
 NP  : 67   inc_100:  1  
 NA's:  1   inc_101:  1  
            inc_102:  1  
            inc_103:  1  
            (Other):244  
describe(officer_inc)
[1] 11
             vars   n  mean    sd median trimmed   mad min max range skew kurtosis   se
officer*        1 249   1.8  0.84    2.0    1.76  1.48   1   3     2 0.38    -1.47 0.05
incident_id*    2 250 125.5 72.31  125.5  125.50 92.66   1 250   249 0.00    -1.21 4.57
drinkdriving$age[drinkdriving$age > 120 | drinkdriving$age < 
    17] <- NA
[1] 12
drinkdriving$nighttime[drinkdriving$nighttime == "18:25"] <- NA
[1] 13
drinkdriving$nighttime[drinkdriving$nighttime == "2:05"] <- NA
[1] 14
drinkdriving$prior_offence[drinkdriving$prior_offence == "DD20"] <- NA
[1] 15
drinkdriving$outcome <- tolower(drinkdriving$outcome)
[1] 16
drinkdriving$nighttime <- as.factor(drinkdriving$nighttime)
[1] 17
drinkdriving$outcome <- as.factor(drinkdriving$outcome)
[1] 18
summary(drinkdriving)
[1] 19
      age        nighttime   prior_offence          speed             bac            outcome    incident_id       
 Min.   :17.00   day  : 78   Length:250         Min.   :  0.00   Min.   : 3.987   fine   :202   Length:250        
 1st Qu.:32.00   night:169   Class :character   1st Qu.: 30.92   1st Qu.:19.264   warning: 48   Class :character  
 Median :41.00   NA's :  3   Mode  :character   Median : 40.64   Median :23.609                 Mode  :character  
 Mean   :43.69                                  Mean   : 40.49   Mean   :23.605                                   
 3rd Qu.:55.00                                  3rd Qu.: 48.84   3rd Qu.:27.898                                   
 Max.   :90.00                                  Max.   :120.34   Max.   :65.764                                   
 NA's   :33                                                      NA's   :5                                        
describe(drinkdriving)
[1] 20
               vars   n  mean    sd median trimmed   mad min  max range  skew kurtosis   se
age               1 217 43.69 16.20     41   42.85 17.79  17   90    73  0.46    -0.49 1.10
nighttime*        2 247  1.68  0.47      2    1.73  0.00   1    2     1 -0.79    -1.38 0.03
prior_offence*    3 246   NaN    NA     NA     NaN    NA Inf -Inf  -Inf    NA       NA   NA
 [ reached 'max' / getOption("max.print") -- omitted 4 rows ]
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 21
summary(m1)
[1] 22

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.567  -4.490  -0.993   3.833  42.860 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 28.84428    1.36250  21.170  < 2e-16 ***
age         -0.13501    0.02926  -4.614 6.86e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.899 on 210 degrees of freedom
  (38 observations deleted due to missingness)
Multiple R-squared:  0.09205,	Adjusted R-squared:  0.08773 
F-statistic: 21.29 on 1 and 210 DF,  p-value: 6.86e-06

plot(drinkdriving$age, drinkdriving$bac, xlab = "age", ylab = "blood alcohol content")
[1] 23
abline(m1)
[1] 24
predict(m1, data.frame(age = 50))
[1] 25
       1 
22.09395 
plot(m1, which = 2)
[1] 26
mod_speed <- lm(bac ~ age + speed, data = drinkdriving)
[1] 27
anova(mod_speed)
[1] 28
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1013.5 1013.51  23.454 2.487e-06 ***
speed       1  965.1  965.07  22.333 4.206e-06 ***
Residuals 209 9031.3   43.21                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
mod_time <- lm(bac ~ age + nighttime, data = drinkdriving)
[1] 29
anova(mod_time)
[1] 30
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1146.1 1146.13  26.013 7.646e-07 ***
nighttime   1  586.5  586.54  13.312 0.0003337 ***
Residuals 207 9120.4   44.06                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(mod_speed)
[1] 31

Call:
lm(formula = bac ~ age + speed, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.842  -4.488  -0.730   4.075  34.539 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 16.96460    2.82919   5.996 8.76e-09 ***
age         -0.03450    0.03506  -0.984    0.326    
speed        0.19472    0.04120   4.726 4.21e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.574 on 209 degrees of freedom
  (38 observations deleted due to missingness)
Multiple R-squared:  0.1797,	Adjusted R-squared:  0.1719 
F-statistic: 22.89 on 2 and 209 DF,  p-value: 1.022e-09

summary(mod_time)
[1] 32

Call:
lm(formula = bac ~ age + nighttime, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-16.528  -5.013  -0.006   3.522  41.730 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)     26.4710     1.5250  17.358  < 2e-16 ***
age             -0.1368     0.0285  -4.800 3.04e-06 ***
nighttimenight   3.5825     0.9819   3.649 0.000334 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.638 on 207 degrees of freedom
  (40 observations deleted due to missingness)
Multiple R-squared:  0.1596,	Adjusted R-squared:  0.1515 
F-statistic: 19.66 on 2 and 207 DF,  p-value: 1.52e-08

mod_refit <- lm(bac ~ age + speed + nighttime, data = drinkdriving)
[1] 33
summary(mod_refit)
[1] 34

Call:
lm(formula = bac ~ age + speed + nighttime, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-13.289  -4.666   0.127   3.999  33.067 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    14.07515    2.83823   4.959 1.48e-06 ***
age            -0.03240    0.03391  -0.955     0.34    
speed           0.20065    0.03958   5.070 8.85e-07 ***
nighttimenight  3.78904    0.92895   4.079 6.47e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.274 on 206 degrees of freedom
  (40 observations deleted due to missingness)
Multiple R-squared:  0.2529,	Adjusted R-squared:  0.242 
F-statistic: 23.24 on 3 and 206 DF,  p-value: 5.341e-13

plot(mod_refit, which = 1)
[1] 35
plot(mod_refit, which = 2)
[1] 36
plot(mod_refit, which = 3)
[1] 37
plot(mod_refit, which = 4)
[1] 38
vif(mod_refit)
[1] 39
      age     speed nighttime 
 1.594108  1.584653  1.008063 
boxplot(drinkdriving$speed ~ drinkdriving$nighttime, xlab = "time of day", 
    ylab = "speed")
[1] 40
qqnorm(drinkdriving$speed)
[1] 41
$x
 [1]  0.55338472  0.22754498  0.48454378 -1.60724789 -2.32634787  0.07526986 -2.51214433 -0.43991317  1.60724789 -2.19728638
[11]  0.77896556  0.51865693  0.39614237 -0.38532047  0.38532047  0.13577393  1.36580556 -0.12566135  0.32127764 -0.51865693
[21]  1.82500682  1.39174378 -0.97009328  0.75208491 -0.34246630  0.67448975  0.28975981 -0.41792767 -0.25852728 -1.14550506
[31] -1.77438191 -1.53819886  0.04513463 -0.28975981  1.16504692 -0.71275076  0.37454350  0.10547362  0.98627130  0.45098550
[41] -1.24808481  0.95416525  0.11556160 -0.10547362  0.08532879 -0.61281299  1.50626172 -0.07526986 -2.01409081  1.64485363
 [ reached getOption("max.print") -- omitted 200 entries ]

$y
 [1] 47.957110 43.826353 47.260707 17.221097  1.945818 41.399468  1.012149 34.377506 63.748159  2.533468 50.049472 47.658553 46.209515
[14] 35.044348 45.911152 41.971790 59.500756 38.544314 45.294085 33.660408 66.359756 59.538043 26.205563 49.692191 35.759413 48.880880
[27] 44.464566 34.639220 36.609294 24.917257 13.069805 19.008994 41.009485 36.335035 56.428161 30.141277 45.716490 41.609061 53.768251
[40] 46.424053 23.599427 52.982425 41.674665 38.867482 41.537199 32.599695 61.109335 39.685430 12.246206 64.659834
 [ reached getOption("max.print") -- omitted 200 entries ]

leveneTest(drinkdriving$speed ~ drinkdriving$nighttime)
[1] 42
Levene's Test for Homogeneity of Variance (center = median)
       Df F value Pr(>F)
group   1  2.5125 0.1142
      245               
t_test <- t.test(speed ~ nighttime, data = drinkdriving, var.equal = T)
[1] 43
t_test$statistic
[1] 44
         t 
-0.7569677 
t_test$parameter
[1] 45
 df 
245 
t_test$p.value
[1] 46
[1] 0.4497965
outcome_mod1 <- glm(outcome ~ age + nighttime + prior_offence + 
    speed + bac, data = drinkdriving, family = binomial)
[1] 47
summary(outcome_mod1)
[1] 48

Call:
glm(formula = outcome ~ age + nighttime + prior_offence + speed + 
    bac, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.0822  -0.0578  -0.0046  -0.0001   3.9570  

Coefficients:
                              Estimate Std. Error z value Pr(>|z|)    
(Intercept)                 -2.624e+01  7.002e+03  -0.004 0.997010    
age                          2.490e-01  7.275e-02   3.422 0.000622 ***
nighttimenight               2.540e-01  1.007e+00   0.252 0.800757    
prior_offenceCD60            5.624e+01  1.283e+04   0.004 0.996503    
prior_offenceCD60,CD10,DR80  4.338e+01  1.283e+04   0.003 0.997303    
prior_offenceCD60,CD60       5.140e+01  1.283e+04   0.004 0.996804    
prior_offenceDR50            2.418e+01  7.002e+03   0.003 0.997244    
prior_offenceDR80            3.500e+01  7.002e+03   0.005 0.996012    
prior_offenceN               2.739e+01  7.002e+03   0.004 0.996879    
prior_offencePL10            2.361e+01  7.036e+03   0.003 0.997323    
 [ reached getOption("max.print") -- omitted 6 rows ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 205.610  on 205  degrees of freedom
Residual deviance:  35.984  on 190  degrees of freedom
  (44 observations deleted due to missingness)
AIC: 67.984

Number of Fisher Scoring iterations: 18

outcome_mod2 <- glm(outcome ~ age + speed + bac, data = drinkdriving, 
    family = binomial)
[1] 49
summary(outcome_mod2)
[1] 50

Call:
glm(formula = outcome ~ age + speed + bac, family = binomial, 
    data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.3361  -0.3832  -0.1614  -0.0351   3.5372  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  4.87332    2.16739   2.248   0.0245 *  
age          0.04552    0.01999   2.277   0.0228 *  
speed       -0.13847    0.03342  -4.143 3.42e-05 ***
bac         -0.19204    0.04882  -3.934 8.36e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 213.82  on 211  degrees of freedom
Residual deviance: 106.28  on 208  degrees of freedom
  (38 observations deleted due to missingness)
AIC: 114.28

Number of Fisher Scoring iterations: 7

outcome_mod3 <- glm(outcome ~ scale(speed) + scale(bac), data = drinkdriving, 
    family = binomial)
[1] 51
summary(outcome_mod3)
[1] 52

Call:
glm(formula = outcome ~ scale(speed) + scale(bac), family = binomial, 
    data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.9536  -0.4434  -0.1852  -0.0436   4.0812  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept)   -2.8600     0.3706  -7.717 1.19e-14 ***
scale(speed)  -2.1932     0.3850  -5.696 1.23e-08 ***
scale(bac)    -1.2910     0.3076  -4.197 2.71e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 239.55  on 244  degrees of freedom
Residual deviance: 130.13  on 242  degrees of freedom
  (5 observations deleted due to missingness)
AIC: 136.13

Number of Fisher Scoring iterations: 7

table(drinkdriving$outcome, drinkdriving$prior_offence)
[1] 53
         
          CD10 CD60 CD60,CD10,DR80 CD60,CD60 DR50 DR80   N PL10 SP50 SP60 TS70 TS70,DR50
  fine       2    0              1         1   40    3 148    1    2    0    2         0
  warning    0    1              0         0    3    1  37    1    0    1    1         1
driving_drink <- drinkdriving[drinkdriving$prior_offence == "DR50" | 
    drinkdriving$prior_offence == "TS70,DR50", ]
[1] 54
drink <- c(fine = sum(driving_drink$outcome == "fine", na.rm = T), 
    warning = sum(driving_drink$outcome == "warning", na.rm = T))
[1] 55
driving_nondrink <- drinkdriving[drinkdriving$prior_offence != 
    "N" & drinkdriving$prior_offence != "DR50", ]
[1] 56
nondrink <- c(fine = sum(driving_nondrink$outcome == "fine", 
    na.rm = T), warning = sum(driving_nondrink$outcome == "warning", 
    na.rm = T))
[1] 57
offence_type <- data.frame(drink, nondrink)
[1] 58
offence_type

        drink nondrink
fine       40       12
warning     4        6


chi_test <- chisq.test(offence_type, correct = T)
[1] 60
chi_test


	Pearson's Chi-squared test with Yates' continuity correction

data:  offence_type
X-squared = 3.9022, df = 1, p-value = 0.04822



chi_test$residuals
[1] 62
             drink   nondrink
fine     0.5097736 -0.7970168
warning -1.1624628  1.8174779
driving_nonoffence <- drinkdriving[drinkdriving$prior_offence == 
    "N", ]
[1] 63
nonoffence <- c(fine = sum(driving_nonoffence$outcome == "fine", 
    na.rm = T), warning = sum(driving_nonoffence$outcome == "warning", 
    na.rm = T))
[1] 64
driving_offence <- drinkdriving[!is.na(drinkdriving$prior_offence), 
    ]
[1] 65
anyoffence <- c(fine = sum(driving_offence$outcome == "fine", 
    na.rm = T) - sum(driving_nonoffence$outcome == "fine", na.rm = T), 
    warning = sum(driving_offence$outcome == "warning", na.rm = T) - 
        sum(driving_nonoffence$outcome == "warning", na.rm = T))
[1] 66
offence <- data.frame(nonoffence, anyoffence)
[1] 67
offence

        nonoffence anyoffence
fine           148         52
warning         37          9


chi_test2 <- chisq.test(offence, correct = F)
[1] 69
chi_test2


	Pearson's Chi-squared test

data:  offence
X-squared = 0.8304, df = 1, p-value = 0.3622



chi_test2$residuals
[1] 71
        nonoffence anyoffence
fine    -0.1962245  0.3417230
warning  0.4091564 -0.7125418
drinkdriving$fine_prob <- ifelse(drinkdriving$outcome == "warning", 
    0, 1)
[1] 72
prob_model <- glm(fine_prob ~ age + nighttime + prior_offence + 
    speed + bac, data = drinkdriving, family = binomial)
[1] 73
summary(prob_model)
[1] 74

Call:
glm(formula = fine_prob ~ age + nighttime + prior_offence + speed + 
    bac, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.9570   0.0001   0.0046   0.0578   2.0822  

Coefficients:
                              Estimate Std. Error z value Pr(>|z|)    
(Intercept)                  2.624e+01  7.002e+03   0.004 0.997010    
age                         -2.490e-01  7.275e-02  -3.422 0.000622 ***
nighttimenight              -2.540e-01  1.007e+00  -0.252 0.800757    
prior_offenceCD60           -5.624e+01  1.283e+04  -0.004 0.996503    
prior_offenceCD60,CD10,DR80 -4.338e+01  1.283e+04  -0.003 0.997303    
prior_offenceCD60,CD60      -5.140e+01  1.283e+04  -0.004 0.996804    
prior_offenceDR50           -2.418e+01  7.002e+03  -0.003 0.997244    
prior_offenceDR80           -3.500e+01  7.002e+03  -0.005 0.996012    
prior_offenceN              -2.739e+01  7.002e+03  -0.004 0.996879    
prior_offencePL10           -2.361e+01  7.036e+03  -0.003 0.997323    
 [ reached getOption("max.print") -- omitted 6 rows ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 205.610  on 205  degrees of freedom
Residual deviance:  35.984  on 190  degrees of freedom
  (44 observations deleted due to missingness)
AIC: 67.984

Number of Fisher Scoring iterations: 18

ages <- c(min(drinkdriving$age, na.rm = T):max(drinkdriving$age, 
    na.rm = T))
[1] 75
drivers <- data.frame(age = ages, prior_offence = "N", nighttime = "day", 
    speed = 30, bac = 0)
[1] 76
predictions <- predict(prob_model, newdata = drivers, type = "response")
[1] 77
predictions

           1            2            3            4            5            6            7            8            9           10 
6.797798e-01 6.233526e-01 5.633687e-01 5.014720e-01 4.395301e-01 3.794163e-01 3.227890e-01 2.709237e-01 2.246277e-01 1.842437e-01 
          11           12           13           14           15           16           17           18           19           20 
1.497181e-01 1.207050e-01 9.667495e-02 7.700983e-02 6.107444e-02 4.826407e-02 3.803185e-02 2.990075e-02 2.346565e-02 1.838923e-02 
          21           22           23           24           25           26           27           28           29           30 
1.439483e-02 1.125811e-02 8.798805e-03 6.872993e-03 5.366405e-03 4.188674e-03 3.268563e-03 2.550052e-03 1.989172e-03 1.551465e-03 
          31           32           33           34           35           36           37           38           39           40 
1.209956e-03 9.435495e-04 7.357567e-04 5.736987e-04 4.473196e-04 3.487707e-04 2.719271e-04 2.120107e-04 1.652941e-04 1.288701e-04 
          41           42           43           44           45           46           47           48           49           50 
1.004717e-04 7.833081e-05 6.106879e-05 4.761068e-05 3.711830e-05 2.893816e-05 2.256071e-05 1.758872e-05 1.371245e-05 1.069044e-05 
 [ reached getOption("max.print") -- omitted 24 entries ]


plot(x = ages, y = predictions, type = "l", xlab = "age", ylab = "probablity of receiving a fine")
[1] 79
bias <- merge(drinkdriving, officer_inc, all = T)
[1] 80
bias2 <- bias[(!is.na(bias$officer)) & (!is.na(bias$age)), c("age", 
    "outcome", "officer")]
[1] 81
summary(bias2)
[1] 82
      age           outcome    officer 
 Min.   :17.00   fine   :173   AS:103  
 1st Qu.:32.00   warning: 44   IT: 55  
 Median :41.00                 NP: 59  
 Mean   :43.69                         
 3rd Qu.:55.00                         
 Max.   :90.00                         
table(bias$outcome, bias$age, bias$officer)
[1] 83
 [ reached getOption("max.print") -- omitted 3 matrix slice(s) ]
ggplot(data = bias2) + geom_point(aes(x = age, y = outcome)) + 
    facet_grid(~officer) + theme_minimal()
[1] 84
AS <- bias2[bias2$officer == "AS", ]
[1] 85
IT <- bias2[bias2$officer == "IT", ]
[1] 86
NP <- bias2[bias2$officer == "NP", ]
[1] 87
AS_mod <- glm(outcome ~ age, data = AS, family = binomial)
[1] 88
IT_mod <- glm(outcome ~ age, data = IT, family = binomial)
[1] 89
NP_mod <- glm(outcome ~ age, data = NP, family = binomial)
[1] 90
summary(AS_mod)
[1] 91

Call:
glm(formula = outcome ~ age, family = binomial, data = AS)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.40753  -0.29450  -0.12257  -0.06196   2.12621  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -9.55712    2.00043  -4.778 1.77e-06 ***
age          0.16102    0.03474   4.635 3.57e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 106.848  on 102  degrees of freedom
Residual deviance:  50.039  on 101  degrees of freedom
AIC: 54.039

Number of Fisher Scoring iterations: 6

summary(IT_mod)
[1] 92

Call:
glm(formula = outcome ~ age, family = binomial, data = IT)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.6286  -0.6701  -0.5012  -0.3232   2.4283  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)   
(Intercept) -4.40869    1.35749  -3.248  0.00116 **
age          0.06310    0.02517   2.506  0.01219 * 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 57.706  on 54  degrees of freedom
Residual deviance: 49.961  on 53  degrees of freedom
AIC: 53.961

Number of Fisher Scoring iterations: 4

summary(NP_mod)
[1] 93

Call:
glm(formula = outcome ~ age, family = binomial, data = NP)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.1125  -0.6138  -0.4065  -0.2653   2.7179  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)   
(Intercept) -4.88454    1.48737  -3.284  0.00102 **
age          0.06757    0.02719   2.485  0.01296 * 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 53.699  on 58  degrees of freedom
Residual deviance: 46.224  on 57  degrees of freedom
AIC: 50.224

Number of Fisher Scoring iterations: 5

contrasts(bias2$officer) <- cbind(AvIN = c(2/3, -1/3, -1/3), 
    IvN = c(0, 1/2, -1/2))
[1] 94
bias_mod <- glm(outcome ~ age * officer, data = bias2, family = binomial)
[1] 95
summary(bias_mod)
[1] 96

Call:
glm(formula = outcome ~ age * officer, family = binomial, data = bias2)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.4075  -0.5638  -0.3183  -0.0757   2.7179  

Coefficients:
                 Estimate Std. Error z value Pr(>|z|)    
(Intercept)     -6.283452   0.946170  -6.641 3.12e-11 ***
age              0.097229   0.016931   5.742 9.33e-09 ***
officerAvIN     -4.910502   2.239549  -2.193   0.0283 *  
officerIvN       0.475849   2.013808   0.236   0.8132    
age:officerAvIN  0.095686   0.039371   2.430   0.0151 *  
age:officerIvN  -0.004475   0.037058  -0.121   0.9039    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 218.83  on 216  degrees of freedom
Residual deviance: 146.22  on 211  degrees of freedom
AIC: 158.22

Number of Fisher Scoring iterations: 6

