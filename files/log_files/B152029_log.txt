

	####### B152029 R script #######

library(ggplot2, quietly = T)
[1] 1
[1] "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(psych, quietly = T)
[1] 2
 [1] "psych"     "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(plotly, quietly = T)
[1] 3
 [1] "plotly"    "psych"     "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
load(url("https://edin.ac/2QCZNVu"))
[1] 4
[1] "drinkdriving" "officer_inc" 
drinkdriving <- merge(drinkdriving, officer_inc, all = T)
[1] 5
sum(!complete.cases(drinkdriving))
[1] 6
[1] 27
boxplot(drinkdriving$age)
[1] 7
drinkdriving$age[drinkdriving$age > 100] <- NA
[1] 8
table(drinkdriving$nighttime)
[1] 9

18:25  2:05   day night 
    1     2    78   169 
drinkdriving$nighttime[drinkdriving$nighttime == "18:25"] <- NA
[1] 10
drinkdriving$nighttime[drinkdriving$nighttime == "2:05"] <- NA
[1] 11
drinkdriving$nighttime <- as.factor(drinkdriving$nighttime)
[1] 12
table(drinkdriving$prior_offence)
[1] 13

          CD10           CD60 CD60,CD10,DR80      CD60,CD60           DD20           DR50           DR80              N           PL10 
             2              1              1              1              4             43              4            185              2 
          SP50           SP60           TS70      TS70,DR50 
             2              1              3              1 
drinkdriving$prior_offence_binary <- TRUE
[1] 14
drinkdriving$prior_offence_binary[drinkdriving$prior_offence == 
    "N"] <- FALSE
[1] 15
drinkdriving$prior_offence_binary <- as.factor(drinkdriving$prior_offence_binary)
[1] 16
table(drinkdriving$prior_offence_binary)
[1] 17

FALSE  TRUE 
  185    65 
drinkdriving$drinking_offence <- FALSE
[1] 18
drinkdriving$drinking_offence[drinkdriving$prior_offence == "DR50"] <- TRUE
[1] 19
drinkdriving$drinking_offence[drinkdriving$prior_offence == "TS70,DR50"] <- TRUE
[1] 20
drinkdriving$drinking_offence <- as.factor(drinkdriving$drinking_offence)
[1] 21
table(drinkdriving$drinking_offence)
[1] 22

FALSE  TRUE 
  206    44 
boxplot(drinkdriving$speed)
[1] 23
drinkdriving$bac <- drinkdriving$bac/100
[1] 24
boxplot(drinkdriving$bac)
[1] 25
drinkdriving$bac[drinkdriving$bac > 0.5] <- NA
[1] 26
boxplot(drinkdriving$bac)
[1] 27
drinkdriving$outcome <- as.factor(tolower(drinkdriving$outcome))
[1] 28
drinkdriving$incident_id <- as.factor(drinkdriving$incident_id)
[1] 29
sum(!complete.cases(drinkdriving))
[1] 30
[1] 34
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 31
plot(bac ~ age, data = drinkdriving)
[1] 32
abline(lm(m1))
[1] 33
summary(m1)
[1] 34

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.153270 -0.041824 -0.005698  0.039975  0.149487 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.2868503  0.0106949   26.82  < 2e-16 ***
age         -0.0013730  0.0002331   -5.89 1.47e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05791 on 216 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.1384,	Adjusted R-squared:  0.1344 
F-statistic: 34.69 on 1 and 216 DF,  p-value: 1.469e-08

age <- c(50)
[1] 35
new.ages <- data.frame(age)
[1] 36
predict(object = m1, newdata = new.ages)
[1] 37
        1 
0.2181983 
plot(m1, which = 2)
[1] 38
plot(density(residuals(m1)))
[1] 39
m2 <- lm(bac ~ age + nighttime, data = drinkdriving)
[1] 40
anova(m2)
[1] 41
Analysis of Variance Table

Response: bac
           Df  Sum Sq  Mean Sq F value    Pr(>F)    
age         1 0.13000 0.129999  44.298 2.349e-10 ***
nighttime   1 0.06973 0.069727  23.760 2.131e-06 ***
Residuals 213 0.62508 0.002935                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m3 <- lm(bac ~ age + speed, data = drinkdriving)
[1] 42
anova(m3)
[1] 43
Analysis of Variance Table

Response: bac
           Df  Sum Sq  Mean Sq F value    Pr(>F)    
age         1 0.11631 0.116314 34.6961 1.471e-08 ***
speed       1 0.00355 0.003550  1.0589    0.3046    
Residuals 215 0.72076 0.003352                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m2)
[1] 44

Call:
lm(formula = bac ~ age + nighttime, data = drinkdriving)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.163421 -0.043987  0.002997  0.037390  0.144090 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.2600346  0.0118497  21.944  < 2e-16 ***
age            -0.0013690  0.0002209  -6.199 2.91e-09 ***
nighttimenight  0.0386857  0.0079364   4.874 2.13e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05417 on 213 degrees of freedom
  (34 observations deleted due to missingness)
Multiple R-squared:  0.2422,	Adjusted R-squared:  0.235 
F-statistic: 34.03 on 2 and 213 DF,  p-value: 1.498e-13

summary(m3)
[1] 45

Call:
lm(formula = bac ~ age + speed, data = drinkdriving)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.154118 -0.038926 -0.006094  0.041298  0.144229 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.2608699  0.0274183   9.514  < 2e-16 ***
age         -0.0011540  0.0003156  -3.656 0.000322 ***
speed        0.0004320  0.0004198   1.029 0.304616    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.0579 on 215 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.1426,	Adjusted R-squared:  0.1346 
F-statistic: 17.88 on 2 and 215 DF,  p-value: 6.574e-08

drinkdriving$speed_adjusted <- drinkdriving$speed
[1] 46
drinkdriving$speed_adjusted[drinkdriving$speed > 76] <- NA
[1] 47
m4 <- lm(bac ~ age + speed_adjusted, data = drinkdriving)
[1] 48
anova(m4)
[1] 49
Analysis of Variance Table

Response: bac
                Df  Sum Sq  Mean Sq F value    Pr(>F)    
age              1 0.11631 0.116314 34.6961 1.471e-08 ***
speed_adjusted   1 0.00355 0.003550  1.0589    0.3046    
Residuals      215 0.72076 0.003352                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m4)
[1] 50

Call:
lm(formula = bac ~ age + speed_adjusted, data = drinkdriving)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.154118 -0.038926 -0.006094  0.041298  0.144229 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.2608699  0.0274183   9.514  < 2e-16 ***
age            -0.0011540  0.0003156  -3.656 0.000322 ***
speed_adjusted  0.0004320  0.0004198   1.029 0.304616    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.0579 on 215 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.1426,	Adjusted R-squared:  0.1346 
F-statistic: 17.88 on 2 and 215 DF,  p-value: 6.574e-08

c(drinkdriving$speed[164], drinkdriving$age[164], drinkdriving$bac[164])
[1] 51
[1] 36.8212502 70.0000000  0.3402245
c(drinkdriving$speed[176], drinkdriving$age[176], drinkdriving$bac[176])
[1] 52
[1] 13.06980491 59.00000000  0.05452951
c(drinkdriving$speed[196], drinkdriving$age[196], drinkdriving$bac[196])
[1] 53
[1]  1.9458178 56.0000000  0.2936736
drinkdriving$speed_adjusted <- drinkdriving$speed
[1] 54
drinkdriving$speed_adjusted[164] <- NA
[1] 55
drinkdriving$speed_adjusted[176] <- NA
[1] 56
drinkdriving$speed_adjusted[196] <- NA
[1] 57
m4 <- lm(bac ~ age + speed_adjusted, data = drinkdriving)
[1] 58
m5 <- lm(speed ~ nighttime, data = drinkdriving)
[1] 59
m6 <- lm(speed_adjusted ~ nighttime, data = drinkdriving)
[1] 60
summary(m5)
[1] 61

Call:
lm(formula = speed ~ nighttime, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-40.853  -9.305   0.157   8.213  81.032 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)      39.305      1.691  23.240   <2e-16 ***
nighttimenight    1.548      2.045   0.757     0.45    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 14.94 on 245 degrees of freedom
  (3 observations deleted due to missingness)
Multiple R-squared:  0.002333,	Adjusted R-squared:  -0.001739 
F-statistic: 0.573 on 1 and 245 DF,  p-value: 0.4498

summary(m6)
[1] 62

Call:
lm(formula = speed_adjusted ~ nighttime, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-41.252  -9.164   0.185   7.817  81.032 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)      39.305      1.662  23.650   <2e-16 ***
nighttimenight    1.947      2.013   0.967    0.334    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 14.68 on 243 degrees of freedom
  (5 observations deleted due to missingness)
Multiple R-squared:  0.003836,	Adjusted R-squared:  -0.0002639 
F-statistic: 0.9356 on 1 and 243 DF,  p-value: 0.3344

drinkdriving$fine <- 0
[1] 63
drinkdriving$fine[drinkdriving$outcome == "fine"] <- 1
[1] 64
with(drinkdriving, plot(jitter(fine) ~ speed, axes = F))
[1] 65
axis(2, at = c(0, 1), labels = c("warning", "fine"))
[1] 66
[1] 0 1
axis(1)
[1] 67
[1]   0  20  40  60  80 100 120
with(drinkdriving, plot(jitter(fine) ~ bac, axes = F))
[1] 68
axis(2, at = c(0, 1), labels = c("warning", "fine"))
[1] 69
[1] 0 1
axis(1)
[1] 70
[1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35
with(drinkdriving, plot(jitter(fine) ~ age, axes = F))
[1] 71
axis(2, at = c(0, 1), labels = c("warning", "fine"))
[1] 72
[1] 0 1
axis(1)
[1] 73
[1] 20 40 60 80
m7 <- glm(outcome ~ speed, data = drinkdriving, family = binomial)
[1] 74
anova(m7, test = "Chisq")
[1] 75
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


      Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                    249     244.56              
speed  1   91.149       248     153.41 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m7)
[1] 76

Call:
glm(formula = outcome ~ speed, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.8448  -0.5194  -0.2415  -0.0740   3.4793  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  3.98066    0.76467   5.206 1.93e-07 ***
speed       -0.15929    0.02387  -6.673 2.50e-11 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 244.56  on 249  degrees of freedom
Residual deviance: 153.41  on 248  degrees of freedom
AIC: 157.41

Number of Fisher Scoring iterations: 6

m8 <- glm(outcome ~ age, data = drinkdriving, family = binomial)
[1] 77
anova(m8, test = "Chisq")
[1] 78
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


     Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                   224     222.38              
age   1   67.728       223     154.65 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m8)
[1] 79

Call:
glm(formula = outcome ~ age, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1778  -0.5106  -0.2993  -0.1488   3.0363  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -6.41889    0.87727  -7.317 2.54e-13 ***
age          0.10107    0.01577   6.408 1.48e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 222.38  on 224  degrees of freedom
Residual deviance: 154.65  on 223  degrees of freedom
  (25 observations deleted due to missingness)
AIC: 158.65

Number of Fisher Scoring iterations: 6

m9 <- glm(outcome ~ bac, data = drinkdriving, family = binomial)
[1] 80
anova(m9, test = "Chisq")
[1] 81
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


     Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                   242     238.69              
bac   1   51.656       241     187.04 6.613e-13 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m9)
[1] 82

Call:
glm(formula = outcome ~ bac, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.6648  -0.6491  -0.4045  -0.2070   2.9866  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)   2.8175     0.6844   4.117 3.84e-05 ***
bac         -20.1053     3.3411  -6.018 1.77e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 238.69  on 242  degrees of freedom
Residual deviance: 187.04  on 241  degrees of freedom
  (7 observations deleted due to missingness)
AIC: 191.04

Number of Fisher Scoring iterations: 5

m10 <- glm(outcome ~ speed + bac + age, data = drinkdriving, 
    family = binomial)
[1] 83
anova(m10, test = "Chisq")
[1] 84
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


      Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                    217     216.50              
speed  1   78.643       216     137.86 < 2.2e-16 ***
bac    1   26.067       215     111.79 3.298e-07 ***
age    1    5.484       214     106.31   0.01919 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m10)
[1] 85

Call:
glm(formula = outcome ~ speed + bac + age, family = binomial, 
    data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.3380  -0.3674  -0.1570  -0.0329   3.5396  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept)   4.87364    2.16854   2.247   0.0246 *  
speed        -0.13857    0.03343  -4.146 3.39e-05 ***
bac         -19.23137    4.88005  -3.941 8.12e-05 ***
age           0.04566    0.01996   2.287   0.0222 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 216.50  on 217  degrees of freedom
Residual deviance: 106.31  on 214  degrees of freedom
  (32 observations deleted due to missingness)
AIC: 114.31

Number of Fisher Scoring iterations: 7

m20 <- glm(outcome ~ nighttime, data = drinkdriving, family = binomial)
[1] 86
anova(m20, test = "Chisq")
[1] 87
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


          Df Deviance Resid. Df Resid. Dev Pr(>Chi)  
NULL                        246     243.27           
nighttime  1   2.7093       245     240.56  0.09976 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m30 <- glm(outcome ~ prior_offence_binary, data = drinkdriving, 
    family = binomial)
[1] 88
anova(m30, test = "Chisq")
[1] 89
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


                     Df Deviance Resid. Df Resid. Dev Pr(>Chi)
NULL                                   249     244.56         
prior_offence_binary  1  0.29974       248     244.25    0.584
m40 <- glm(outcome ~ prior_offence, data = drinkdriving, family = binomial)
[1] 90
anova(m40, test = "Chisq")
[1] 91
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


              Df Deviance Resid. Df Resid. Dev Pr(>Chi)  
NULL                            249     244.56           
prior_offence 12   21.009       237     223.55  0.05024 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
dummy.drivers <- data.frame(speed = c(20, 20 + sd(drinkdriving$speed), 
    20), age = c(25, 25, 25), bac = c(0.5, 0.5, 0.5 + sd(drinkdriving$bac, 
    na.rm = T)))
[1] 92
predict.glm(m10, newdata = dummy.drivers)
[1] 93
        1         2         3 
-6.371982 -8.438709 -7.652774 
m50 <- glm(outcome ~ drinking_offence, data = drinkdriving, family = binomial)
[1] 94
summary(m50)
[1] 95

Call:
glm(formula = outcome ~ drinking_offence, family = binomial, 
    data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.6932  -0.6932  -0.6932  -0.4366   2.1899  

Coefficients:
                     Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -1.3034     0.1700  -7.667 1.76e-14 ***
drinking_offenceTRUE  -0.9992     0.5512  -1.813   0.0699 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 244.56  on 249  degrees of freedom
Residual deviance: 240.50  on 248  degrees of freedom
AIC: 244.5

Number of Fisher Scoring iterations: 4

anova(m50, test = "Chisq")
[1] 96
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


                 Df Deviance Resid. Df Resid. Dev Pr(>Chi)  
NULL                               249     244.56           
drinking_offence  1    4.052       248     240.50  0.04412 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m11 <- glm(outcome ~ prior_offence_binary, data = drinkdriving, 
    family = binomial)
[1] 97
summary(m11)
[1] 98

Call:
glm(formula = outcome ~ prior_offence_binary, family = binomial, 
    data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.6681  -0.6681  -0.6681  -0.6089   1.8849  

Coefficients:
                         Estimate Std. Error z value Pr(>|z|)    
(Intercept)               -1.3863     0.1838  -7.542 4.62e-14 ***
prior_offence_binaryTRUE  -0.2048     0.3784  -0.541    0.588    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 244.56  on 249  degrees of freedom
Residual deviance: 244.26  on 248  degrees of freedom
AIC: 248.26

Number of Fisher Scoring iterations: 4

anova(m11, test = "Chisq")
[1] 99
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


                     Df Deviance Resid. Df Resid. Dev Pr(>Chi)
NULL                                   249     244.56         
prior_offence_binary  1  0.29974       248     244.25    0.584
new.data <- data.frame(age = c(17:100), speed = replicate(84, 
    30), bac = replicate(84, 0))
[1] 100
new.data$prediction <- predict(m10, newdata = new.data, type = "response")
[1] 101
new.data$fine_prob <- replicate(84, 1) - new.data$prediction
[1] 102
plot(new.data$age, new.data$fine_prob, xlab = "age", ylab = "probability of fine", 
    type = "l", )
[1] 103
spec_pro <- ggplot(data = drinkdriving, aes(x = speed, y = age, 
    colour = outcome))
[1] 104
spec_pro + geom_point() + theme_minimal() + facet_grid(. ~ officer)
[1] 105
spec_pro <- ggplot(data = drinkdriving, aes(x = bac, y = age, 
    colour = outcome))
[1] 106
spec_pro + geom_point() + theme_minimal() + facet_grid(. ~ officer)
[1] 107
m1 <- glm(outcome ~ age, data = drinkdriving, family = binomial)
[1] 108
anova(m1, test = "Chisq")
[1] 109
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


     Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                   224     222.38              
age   1   67.728       223     154.65 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m1 <- glm(outcome ~ officer, data = drinkdriving, family = binomial)
[1] 110
anova(m1, test = "Chisq")
[1] 111
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


        Df Deviance Resid. Df Resid. Dev Pr(>Chi)
NULL                      248     241.24         
officer  2   1.2692       246     239.97   0.5302
m1 <- glm(outcome ~ age + officer, data = drinkdriving, family = binomial)
[1] 112
anova(m1, test = "Chisq")
[1] 113
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


        Df Deviance Resid. Df Resid. Dev Pr(>Chi)    
NULL                      224     222.38             
age      1   67.728       223     154.65   <2e-16 ***
officer  2    0.861       221     153.79   0.6501    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
AS_data <- drinkdriving[which(drinkdriving$officer == "AS"), 
    ]
[1] 114
IT_data <- drinkdriving[which(drinkdriving$officer == "IT"), 
    ]
[1] 115
NP_data <- drinkdriving[which(drinkdriving$officer == "NP"), 
    ]
[1] 116
plot(drinkdriving$officer, drinkdriving$age, xlab = "officer", 
    ylab = "age")
[1] 117
table(drinkdriving$officer, drinkdriving$nighttime)
[1] 118
    
     day night
  AS  37    77
  IT  18    48
  NP  23    43
m1 <- glm(outcome ~ age, data = AS_data, family = binomial)
[1] 119
anova(m1, test = "Chisq")
[1] 120
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


     Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                   107    109.187              
age   1    59.14       106     50.047 1.468e-14 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m1)
[1] 121

Call:
glm(formula = outcome ~ age, family = binomial, data = AS_data)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.40895  -0.29394  -0.11748  -0.04562   2.12735  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -9.56920    1.99554  -4.795 1.62e-06 ***
age          0.16122    0.03466   4.652 3.29e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 109.187  on 107  degrees of freedom
Residual deviance:  50.047  on 106  degrees of freedom
  (8 observations deleted due to missingness)
AIC: 54.047

Number of Fisher Scoring iterations: 7

m2 <- glm(outcome ~ age, data = IT_data, family = binomial)
[1] 122
anova(m2, test = "Chisq")
[1] 123
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


     Df Deviance Resid. Df Resid. Dev Pr(>Chi)   
NULL                    57     59.139            
age   1        9        56     50.139   0.0027 **
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m2)
[1] 124

Call:
glm(formula = outcome ~ age, family = binomial, data = IT_data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.6544  -0.6404  -0.4630  -0.2422   2.4543  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -4.52384    1.32631  -3.411 0.000648 ***
age          0.06510    0.02467   2.639 0.008308 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 59.139  on 57  degrees of freedom
Residual deviance: 50.139  on 56  degrees of freedom
  (8 observations deleted due to missingness)
AIC: 54.139

Number of Fisher Scoring iterations: 5

m3 <- glm(outcome ~ age, data = NP_data, family = binomial)
[1] 125
anova(m3, test = "Chisq")
[1] 126
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


     Df Deviance Resid. Df Resid. Dev Pr(>Chi)   
NULL                    58     53.699            
age   1   7.4755        57     46.224 0.006254 **
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m3)
[1] 127

Call:
glm(formula = outcome ~ age, family = binomial, data = NP_data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.1125  -0.6138  -0.4065  -0.2653   2.7179  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)   
(Intercept) -4.88454    1.48737  -3.284  0.00102 **
age          0.06757    0.02719   2.485  0.01296 * 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 53.699  on 58  degrees of freedom
Residual deviance: 46.224  on 57  degrees of freedom
  (8 observations deleted due to missingness)
AIC: 50.224

Number of Fisher Scoring iterations: 5

m10_AS <- glm(outcome ~ speed + bac + age, data = AS_data, family = binomial)
[1] 128
anova(m10_AS, test = "Chisq")
[1] 129
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


      Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                    103    104.636              
speed  1   49.076       102     55.560 2.462e-12 ***
bac    1   20.826       101     34.734 5.029e-06 ***
age    1   15.402       100     19.332 8.690e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m10_AS)
[1] 130

Call:
glm(formula = outcome ~ speed + bac + age, family = binomial, 
    data = AS_data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.1274  -0.0588  -0.0086  -0.0006   3.2472  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)   
(Intercept)   5.98339    4.79296   1.248  0.21189   
speed        -0.23112    0.09458  -2.444  0.01454 * 
bac         -43.84774   15.94136  -2.751  0.00595 **
age           0.16875    0.06318   2.671  0.00756 **
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 104.636  on 103  degrees of freedom
Residual deviance:  19.332  on 100  degrees of freedom
  (12 observations deleted due to missingness)
AIC: 27.332

Number of Fisher Scoring iterations: 9

m10_IT <- glm(outcome ~ speed + bac + age, data = IT_data, family = binomial)
[1] 131
anova(m10_IT, test = "Chisq")
[1] 132
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


      Df Deviance Resid. Df Resid. Dev Pr(>Chi)    
NULL                     54     57.706             
speed  1  15.8189        53     41.887 6.97e-05 ***
bac    1   5.0608        52     36.826  0.02447 *  
age    1   0.0029        51     36.823  0.95721    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m10_NP <- glm(outcome ~ speed + bac + age, data = NP_data, family = binomial)
[1] 133
anova(m10_NP, test = "Chisq")
[1] 134
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


      Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                     58     53.699              
speed  1  15.7107        57     37.989 7.381e-05 ***
bac    1   2.7599        56     35.229   0.09666 .  
age    1   0.0048        55     35.224   0.94488    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
new.data$AS_prediction <- predict(m10_AS, newdata = new.data, 
    type = "response")
[1] 135
new.data$AS_fine_prob <- replicate(84, 1) - new.data$AS_prediction
[1] 136
new.data$IT_prediction <- predict(m10_IT, newdata = new.data, 
    type = "response")
[1] 137
new.data$IT_fine_prob <- replicate(84, 1) - new.data$IT_prediction
[1] 138
new.data$NP_prediction <- predict(m10_NP, newdata = new.data, 
    type = "response")
[1] 139
new.data$NP_fine_prob <- replicate(84, 1) - new.data$NP_prediction
[1] 140
plot(new.data$age, new.data$NP_fine_prob, xlab = "age", ylab = "probability of fine", 
    type = "l", col = "green", ylim = c(0, 0.25))
[1] 141
lines(new.data$age, new.data$AS_fine_prob, xlab = "age", ylab = "probability of fine", 
    type = "l", col = "red")
[1] 142
lines(new.data$age, new.data$IT_fine_prob, xlab = "age", ylab = "probability of fine", 
    type = "l", col = "blue")
[1] 143
legend("right", legend = c("AS", "IT", "NP"), col = c("red", 
    "blue", "green"), lty = 1, cex = 0.8)
[1] 144
$rect
$rect$w
[1] 12.17514

$rect$h
[1] 0.04034241

$rect$left
[1] 91.14486

$rect$top
[1] 0.1451712


$text
$text$x
[1] 99.17794 99.17794 99.17794

$text$y
[1] 0.1350856 0.1250000 0.1149144


