

	####### B157100 R script #######

library(ggplot2, quietly = T)
[1] 1
[1] "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 2
 [1] "car"       "carData"   "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
load(url("https://edin.ac/2QCZNVu"))
[1] 3
[1] "drinkdriving" "officer_inc" 
head(drinkdriving)
[1] 4
# A tibble: 6 x 7
    age nighttime prior_offence speed   bac outcome incident_id
  <dbl> <chr>     <chr>         <dbl> <dbl> <chr>   <chr>      
1    39 night     N             48.0   17.7 fine    inc_1      
2    28 day       N             43.8   22.1 fine    inc_2      
3    38 night     DR50          47.3   32.8 fine    inc_3      
4    51 night     N             17.2   20.5 warning inc_4      
5    56 night     N              1.95  29.4 warning inc_5      
6    36 day       N             41.4   19.1 fine    inc_6      
summary(drinkdriving)
[1] 5
      age          nighttime         prior_offence          speed             bac           outcome          incident_id       
 Min.   : 14.00   Length:250         Length:250         Min.   :  0.00   Min.   : 3.987   Length:250         Length:250        
 1st Qu.: 30.00   Class :character   Class :character   1st Qu.: 30.92   1st Qu.:19.264   Class :character   Class :character  
 Median : 40.50   Mode  :character   Mode  :character   Median : 40.64   Median :23.609   Mode  :character   Mode  :character  
 Mean   : 46.00                                         Mean   : 40.49   Mean   :23.605                                        
 3rd Qu.: 55.25                                         3rd Qu.: 48.84   3rd Qu.:27.898                                        
 Max.   :297.00                                         Max.   :120.34   Max.   :65.764                                        
 NA's   :22                                                              NA's   :5                                             
table(drinkdriving$age)
[1] 6

14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 
 1  5  2  3  1  2  3  6  2  5  8  3  2  2  5  4  4  4  6  5  9  8  3  4  2 10  5  6  5  3  2  3  4  5  2  3  3  3  6  3  5  4  3  4  4 
59 60 61 62 63 
 1  5  3  3  2 
 [ reached getOption("max.print") -- omitted 15 entries ]
drinkdriving$age[drinkdriving$age > 100] <- NA
[1] 7
drinkdriving$age <- as.integer(drinkdriving$age)
[1] 8
table(drinkdriving$nighttime)
[1] 9

18:25  2:05   day night 
    1     2    78   169 
drinkdriving$nighttime[!xor(drinkdriving$nighttime != "day", 
    drinkdriving$nighttime != "night")] <- NA
[1] 10
table(drinkdriving$prior_offence)
[1] 11

          CD10           CD60 CD60,CD10,DR80      CD60,CD60           DD20           DR50           DR80              N           PL10 
             2              1              1              1              4             43              4            185              2 
          SP50           SP60           TS70      TS70,DR50 
             2              1              3              1 
drinkdriving$prior_offence[drinkdriving$prior_offence == "CD60,CD60"] <- "CD60"
[1] 12
drinkdriving$prior_offence[drinkdriving$prior_offence == "DD20"] <- NA
[1] 13
table(drinkdriving$speed)
[1] 14

               0 1.01214942316415 1.94581782932169 2.53346827328845  11.225704630299 12.2462058630265 12.8128465751594 
               1                1                1                1                1                1                1 
12.9030158165279 12.9155695510693 13.0698049123235 14.3668291368723 15.5710258293839 17.0590138838127  17.221097497513 
               1                1                1                1                1                1                1 
18.2934932399405 19.0089940620951 19.2697316282316 20.2107015627382 21.3069195145607 21.4908339004998 21.8064434744078 
               1                1                1                1                1                1                1 
 22.568562604335 22.5952898516689 22.6424298724575  23.182415928645 23.5805503449787 23.5994274112678 24.4877988273931 
               1                1                1                1                1                1                1 
24.5215840561896 24.5611037960359 24.8285320808304 24.9172566024629 24.9907200841348 25.0453443973611 25.0548611219096 
               1                1                1                1                1                1                1 
25.2710211226397 25.5417854203194 25.5936767268247 25.7485090547557 25.9105706027961   25.98459487588 26.2055631685057 
               1                1                1                1                1                1                1 
 26.414446768112 26.6813905027214 26.6979134850146 27.0661842358492 28.5530416886726 28.6993802422867 28.7242755318064 
               1                1                1                1                1                1                1 
28.8107670431613 
               1 
 [ reached getOption("max.print") -- omitted 200 entries ]
table(drinkdriving$bac)
[1] 15

3.98678518191804 5.45295079276351 5.61849660215689 6.39815180420771 6.45232354218363 8.55241944417923 9.16715954067682 
               1                1                1                1                1                1                1 
9.25348198083096 9.49752435423211 9.81747807144744 10.0454646939566 10.2699286970084 10.4971185812798 10.6649017352481 
               1                1                1                1                1                1                1 
 11.199644560097 11.8177151563139  12.383382856562 12.7426098538045 13.5320753875597 13.8631845587114 14.1159208271656 
               1                1                1                1                1                1                1 
14.2071322668145 14.3140134442539  14.817899748919 14.9946701515397 15.2439189096081 15.5051277092158  15.989616149418 
               1                1                1                1                1                1                1 
16.0452635279057 16.0927774247029 16.1947203748598 16.2228619659442 16.3696120796151 16.4455909694064 16.6523626858628 
               1                1                1                1                1                1                1 
16.8576234110825 17.1063627259339 17.3301216655205 17.4520816674849 17.6730177261954 17.7137353516994 17.7755921387512 
               1                1                1                1                1                1                1 
17.8183606022586 17.8201747803163 17.8501485665444 17.9707079305316 17.9844835229676 18.0186086871637 18.0696136795774 
               1                1                1                1                1                1                1 
 18.247052539074 
               1 
 [ reached getOption("max.print") -- omitted 191 entries ]
drinkdriving$bac[drinkdriving$bac > 40] <- NA
[1] 16
drinkdriving$outcome[drinkdriving$outcome == "Fine" | drinkdriving$outcome == 
    "FINE"] <- "fine"
[1] 17
drinkdriving$outcome[drinkdriving$outcome == "Warning" | drinkdriving$outcome == 
    "WARNING"] <- "warning"
[1] 18
drinkdriving[, c(2, 3, 6, 7)] <- lapply(drinkdriving[, c(2, 3, 
    6, 7)], factor)
[1] 19
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 20
par(mfrow = c(2, 2))
[1] 21
$mfrow
[1] 2 2

plot(m1, which = c(1:4))
[1] 22
summary(m1)
[1] 23

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.3270  -4.1824  -0.5698   3.9975  14.9487 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 28.68503    1.06949   26.82  < 2e-16 ***
age         -0.13730    0.02331   -5.89 1.47e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.791 on 216 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.1384,	Adjusted R-squared:  0.1344 
F-statistic: 34.69 on 1 and 216 DF,  p-value: 1.469e-08

new_driver <- data.frame(age = 50)
[1] 24
predict(m1, newdata = new_driver)
[1] 25
       1 
21.81983 
par(mfrow = c(1, 1))
[1] 26
$mfrow
[1] 2 2

plot(m1, which = 2)
[1] 27
add_nighttime <- lm(bac ~ age + nighttime, data = drinkdriving)
[1] 28
anova(add_nighttime)
[1] 29
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1300.0 1299.99  44.298 2.349e-10 ***
nighttime   1  697.3  697.27  23.760 2.131e-06 ***
Residuals 213 6250.8   29.35                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(add_nighttime)
[1] 30

Call:
lm(formula = bac ~ age + nighttime, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.3421  -4.3987   0.2997   3.7390  14.4090 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    26.00346    1.18497  21.944  < 2e-16 ***
age            -0.13690    0.02209  -6.199 2.91e-09 ***
nighttimenight  3.86857    0.79364   4.874 2.13e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.417 on 213 degrees of freedom
  (34 observations deleted due to missingness)
Multiple R-squared:  0.2422,	Adjusted R-squared:  0.235 
F-statistic: 34.03 on 2 and 213 DF,  p-value: 1.498e-13

add_speed <- lm(bac ~ age + speed, data = drinkdriving)
[1] 31
anova(add_speed)
[1] 32
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1163.1 1163.14 34.6961 1.471e-08 ***
speed       1   35.5   35.50  1.0589    0.3046    
Residuals 215 7207.6   33.52                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(add_speed)
[1] 33

Call:
lm(formula = bac ~ age + speed, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.4118  -3.8926  -0.6094   4.1298  14.4229 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 26.08699    2.74183   9.514  < 2e-16 ***
age         -0.11540    0.03156  -3.656 0.000322 ***
speed        0.04320    0.04198   1.029 0.304616    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.79 on 215 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.1426,	Adjusted R-squared:  0.1346 
F-statistic: 17.88 on 2 and 215 DF,  p-value: 6.574e-08

par(mfrow = c(2, 2))
[1] 34
$mfrow
[1] 1 1

plot(add_nighttime, which = c(1:4))
[1] 35
vif(add_nighttime)
[1] 36
      age nighttime 
 1.007883  1.007883 
plot(add_speed, which = c(1:4))
[1] 37
vif(add_speed)
[1] 38
    age   speed 
1.83361 1.83361 
final_model <- lm(bac ~ speed + age + nighttime, data = drinkdriving)
[1] 39
anova(final_model)
[1] 40
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
speed       1  801.6  801.60  27.325 4.109e-07 ***
age         1  527.2  527.24  17.973 3.345e-05 ***
nighttime   1  700.1  700.06  23.864 2.036e-06 ***
Residuals 212 6219.1   29.34                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(final_model)
[1] 41

Call:
lm(formula = bac ~ speed + age + nighttime, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.6457  -4.3757   0.5792   3.5662  14.2890 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    23.52651    2.66327   8.834 3.89e-16 ***
speed           0.04110    0.03958   1.038 0.300244    
age            -0.11596    0.02990  -3.878 0.000141 ***
nighttimenight  3.87648    0.79353   4.885 2.04e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.416 on 212 degrees of freedom
  (34 observations deleted due to missingness)
Multiple R-squared:  0.246,	Adjusted R-squared:  0.2353 
F-statistic: 23.05 on 3 and 212 DF,  p-value: 5.894e-13

plot(final_model, which = c(1:4))
[1] 42
vif(final_model)
[1] 43
    speed       age nighttime 
 1.838954  1.848306  1.007976 
t.test(speed ~ nighttime, data = drinkdriving, alternative = "less")
[1] 44

	Welch Two Sample t-test

data:  speed by nighttime
t = -0.7709, df = 156.78, p-value = 0.221
alternative hypothesis: true difference in means is less than 0
95 percent confidence interval:
     -Inf 1.774294
sample estimates:
  mean in group day mean in group night 
           39.30514            40.85289 

outcome_model <- glm(relevel(outcome, "warning") ~ nighttime + 
    age + speed + bac + prior_offence, data = drinkdriving, family = binomial)
[1] 45
anova(outcome_model, test = "Chisq")
[1] 46
Analysis of Deviance Table

Model: binomial, link: logit

Response: relevel(outcome, "warning")

Terms added sequentially (first to last)


              Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                            211    208.231              
nighttime      1    3.141       210    205.090   0.07634 .  
age            1   77.984       209    127.105 < 2.2e-16 ***
speed          1   24.976       208    102.130 5.806e-07 ***
bac            1   18.165       207     83.965 2.026e-05 ***
prior_offence  9   47.981       198     35.984 2.575e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(outcome_model)
[1] 47

Call:
glm(formula = relevel(outcome, "warning") ~ nighttime + age + 
    speed + bac + prior_offence, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.9570   0.0001   0.0039   0.0545   2.0822  

Coefficients:
                         Estimate Std. Error z value Pr(>|z|)    
(Intercept)              25.24239 4256.39930   0.006 0.995268    
nighttimenight           -0.25402    1.00657  -0.252 0.800757    
age                      -0.24896    0.07275  -3.422 0.000622 ***
speed                     0.20473    0.06244   3.279 0.001043 ** 
bac                       0.47632    0.12466   3.821 0.000133 ***
prior_offenceCD60       -54.24740 7788.56519  -0.007 0.994443    
prior_offenceDR50       -23.18791 4256.39742  -0.005 0.995653    
prior_offenceDR80       -34.00646 4256.39923  -0.008 0.993625    
prior_offenceN          -26.39917 4256.39740  -0.006 0.995051    
prior_offencePL10       -22.61234 4311.68237  -0.005 0.995816    
 [ reached getOption("max.print") -- omitted 4 rows ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 208.231  on 211  degrees of freedom
Residual deviance:  35.984  on 198  degrees of freedom
  (38 observations deleted due to missingness)
AIC: 63.984

Number of Fisher Scoring iterations: 17

scaled_model <- glm(relevel(outcome, "warning") ~ nighttime + 
    age + scale(speed) + scale(bac) + prior_offence, data = drinkdriving, 
    family = binomial)
[1] 48
anova(scaled_model, test = "Chisq")
[1] 49
Analysis of Deviance Table

Model: binomial, link: logit

Response: relevel(outcome, "warning")

Terms added sequentially (first to last)


              Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                            211    208.231              
nighttime      1    3.141       210    205.090   0.07634 .  
age            1   77.984       209    127.105 < 2.2e-16 ***
scale(speed)   1   24.976       208    102.130 5.806e-07 ***
scale(bac)     1   18.165       207     83.965 2.026e-05 ***
prior_offence  9   47.981       198     35.984 2.575e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(scaled_model)
[1] 50

Call:
glm(formula = relevel(outcome, "warning") ~ nighttime + age + 
    scale(speed) + scale(bac) + prior_offence, family = binomial, 
    data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.9570   0.0001   0.0039   0.0545   2.0822  

Coefficients:
                         Estimate Std. Error z value Pr(>|z|)    
(Intercept)              44.62565 4256.40187   0.010 0.991635    
nighttimenight           -0.25402    1.00657  -0.252 0.800757    
age                      -0.24896    0.07275  -3.422 0.000622 ***
scale(speed)              3.05343    0.93133   3.279 0.001043 ** 
scale(bac)                3.17226    0.83025   3.821 0.000133 ***
prior_offenceCD60       -54.24740 7788.56518  -0.007 0.994443    
prior_offenceDR50       -23.18791 4256.39741  -0.005 0.995653    
prior_offenceDR80       -34.00646 4256.39922  -0.008 0.993625    
prior_offenceN          -26.39917 4256.39739  -0.006 0.995051    
prior_offencePL10       -22.61234 4311.68236  -0.005 0.995816    
 [ reached getOption("max.print") -- omitted 4 rows ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 208.231  on 211  degrees of freedom
Residual deviance:  35.984  on 198  degrees of freedom
  (38 observations deleted due to missingness)
AIC: 63.984

Number of Fisher Scoring iterations: 17

drinkdriving$drink <- "non-drink-ralated"
[1] 51
drinkdriving$drink[drinkdriving$prior_offence == "DR50"] <- "drink driving"
[1] 52
drinkdriving$drink[drinkdriving$prior_offence == "TS70,DR50"] <- "drink driving"
[1] 53
drinkdriving$drink[drinkdriving$prior_offence == "N"] <- NA
[1] 54
drinkdriving$drink <- factor(drinkdriving$drink)
[1] 55
model3_2 <- glm(relevel(outcome, "warning") ~ drink, data = drinkdriving, 
    family = binomial)
[1] 56
anova(model3_2, test = "Chisq")
[1] 57
Analysis of Deviance Table

Model: binomial, link: logit

Response: relevel(outcome, "warning")

Terms added sequentially (first to last)


      Df Deviance Resid. Df Resid. Dev Pr(>Chi)  
NULL                     64     59.106           
drink  1   5.5648        63     53.542  0.01833 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(model3_2)
[1] 58

Call:
glm(formula = relevel(outcome, "warning") ~ drink, family = binomial, 
    data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1899   0.4366   0.4366   0.4366   0.9005  

Coefficients:
                       Estimate Std. Error z value Pr(>|z|)    
(Intercept)              2.3026     0.5244   4.391 1.13e-05 ***
drinknon-drink-ralated  -1.6094     0.6995  -2.301   0.0214 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 59.106  on 64  degrees of freedom
Residual deviance: 53.542  on 63  degrees of freedom
  (185 observations deleted due to missingness)
AIC: 57.542

Number of Fisher Scoring iterations: 5

drinkdriving$prior <- "Y"
[1] 59
drinkdriving$prior[drinkdriving$prior_offence == "N"] <- "N"
[1] 60
drinkdriving$prior <- factor(drinkdriving$prior)
[1] 61
table(drinkdriving$prior)
[1] 62

  N   Y 
185  65 
model3_3 <- glm(relevel(outcome, "warning") ~ prior, data = drinkdriving, 
    family = binomial)
[1] 63
anova(model3_3, test = "Chisq")
[1] 64
Analysis of Deviance Table

Model: binomial, link: logit

Response: relevel(outcome, "warning")

Terms added sequentially (first to last)


      Df Deviance Resid. Df Resid. Dev Pr(>Chi)
NULL                    249     244.56         
prior  1  0.29974       248     244.25    0.584
contrasts(drinkdriving$nighttime) <- cbind(night = c(0, 1))
[1] 65
contrasts(drinkdriving$prior) <- cbind(Y = c(0, 1))
[1] 66
m4 <- glm(relevel(outcome, "warning") ~ speed + bac + age + nighttime + 
    prior, data = drinkdriving, family = binomial)
[1] 67
summary(m4)
[1] 68

Call:
glm(formula = relevel(outcome, "warning") ~ speed + bac + age + 
    nighttime + prior, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.6056   0.0336   0.1439   0.3888   2.2047  

Coefficients:
               Estimate Std. Error z value Pr(>|z|)    
(Intercept)    -4.80581    2.21298  -2.172 0.029882 *  
speed           0.13554    0.03361   4.033 5.51e-05 ***
bac             0.19644    0.05236   3.752 0.000176 ***
age            -0.04682    0.02054  -2.280 0.022630 *  
nighttimenight -0.14089    0.56396  -0.250 0.802727    
priorY          0.37610    0.60754   0.619 0.535884    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 215.62  on 215  degrees of freedom
Residual deviance: 105.82  on 210  degrees of freedom
  (34 observations deleted due to missingness)
AIC: 117.82

Number of Fisher Scoring iterations: 7

coef(m4)
[1] 69
   (Intercept)          speed            bac            age nighttimenight         priorY 
   -4.80580907     0.13554091     0.19643924    -0.04682472    -0.14088871     0.37609783 
log_odds <- coef(m4)[1] + coef(m4)[2] * 30 + coef(m4)[4] * drinkdriving$age
[1] 70
drinkdriving$model_prediction <- exp(log_odds)/(1 + exp(log_odds))
[1] 71
table(drinkdriving$model_prediction)
[1] 72

0.00700705002619844 0.00805533589630959 0.00843823660821377  0.0106405633460857  0.0111449690592654  0.0128043235691427 
                  1                   1                   1                   1                   2                   1 
 0.0154012353319185  0.0176829655838263  0.0185149621486001  0.0193853322453528  0.0212480433816259  0.0222439811231777 
                  2                   5                   2                   4                   4                   4 
 0.0232854898315889   0.024374548428418  0.0255132116206726  0.0267036118205733  0.0279479610117744   0.029248552548301 
                  1                   2                   3                   3                   5                   1 
 0.0306077628711227  0.0320280531258622  0.0335119706636385  0.0350621504054676  0.0366813160489928  0.0383722810945947 
                  4                   4                   3                   4                   5                   3 
 0.0401379496661492  0.0419813170998554  0.0439054702726706  0.0459135876399653  0.0480089389500647   0.050194884601401 
                  6                   3                   3                   3                   2                   5 
 0.0524748746060692  0.0548524471216927   0.057331226511689  0.0599149208923088  0.0626073191232432   0.065412287197195 
                  4                   3                   2                   3                   5                   6 
 0.0683337639826267  0.0713757562729978  0.0745423330952192  0.0778376192298589  0.0812657878958903  0.0848310525535405 
                  5                  10                   2                   4                   3                   8 
 0.0885376577801563  0.0923898691760232  0.0963919622598311   0.100548210317048   0.104862871168926   0.109340172835298 
                  9                   5                   6                   4                   4                   4 
  0.113984298070774   0.118799367761528 
                  5                   2 
 [ reached getOption("max.print") -- omitted 13 entries ]
ggplot() + geom_point(data = drinkdriving, aes(age, model_prediction)) + 
    labs(x = "Age(years)", y = "Predicted probabilities of receiving fine")
[1] 73
drinkdriving <- merge(drinkdriving, officer_inc)
[1] 74
ggplot(data = subset(drinkdriving, !is.na(officer)), aes(x = age, 
    y = outcome)) + geom_jitter() + theme_minimal() + facet_grid(. ~ 
    officer)
[1] 75
contrasts(drinkdriving$officer) <- cbind(AvIN = c(-2, 1, 1)/3, 
    IvN = c(0, -1, 1)/2)
[1] 76
m5 <- glm(relevel(outcome, "warning") ~ age * officer, data = drinkdriving, 
    family = binomial)
[1] 77
summary(m5)
[1] 78

Call:
glm(formula = relevel(outcome, "warning") ~ age * officer, family = binomial, 
    data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.7179   0.0642   0.2741   0.5454   2.4089  

Coefficients:
                Estimate Std. Error z value Pr(>|z|)    
(Intercept)      6.32586    0.94007   6.729 1.71e-11 ***
age             -0.09796    0.01683  -5.821 5.84e-09 ***
officerAvIN     -4.86500    2.23048  -2.181   0.0292 *  
officerIvN       0.36070    1.99283   0.181   0.8564    
age:officerAvIN  0.09489    0.03922   2.419   0.0155 *  
age:officerIvN  -0.00247    0.03671  -0.067   0.9464    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 222.38  on 224  degrees of freedom
Residual deviance: 146.41  on 219  degrees of freedom
  (25 observations deleted due to missingness)
AIC: 158.41

Number of Fisher Scoring iterations: 7

