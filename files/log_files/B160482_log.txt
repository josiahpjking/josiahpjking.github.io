

	####### B160482 R script #######

library(psych, quietly = T)
[1] 1
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(ggplot2, quietly = T)
[1] 2
 [1] "ggplot2"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(plotly, quietly = T)
[1] 3
 [1] "plotly"    "ggplot2"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
load(url("https://edin.ac/2QCZNVu"))
[1] 4
[1] "drinkdriving" "officer_inc" 
describe(drinkdriving)
[1] 5
               vars   n mean    sd median trimmed   mad min  max range skew kurtosis   se
age               1 228   46 33.35   40.5   42.34 18.53  14  297   283  5.5    38.49 2.21
nighttime*        2 250  NaN    NA     NA     NaN    NA Inf -Inf  -Inf   NA       NA   NA
prior_offence*    3 250  NaN    NA     NA     NaN    NA Inf -Inf  -Inf   NA       NA   NA
 [ reached 'max' / getOption("max.print") -- omitted 4 rows ]
summary(drinkdriving)
[1] 6
      age          nighttime         prior_offence          speed             bac           outcome          incident_id       
 Min.   : 14.00   Length:250         Length:250         Min.   :  0.00   Min.   : 3.987   Length:250         Length:250        
 1st Qu.: 30.00   Class :character   Class :character   1st Qu.: 30.92   1st Qu.:19.264   Class :character   Class :character  
 Median : 40.50   Mode  :character   Mode  :character   Median : 40.64   Median :23.609   Mode  :character   Mode  :character  
 Mean   : 46.00                                         Mean   : 40.49   Mean   :23.605                                        
 3rd Qu.: 55.25                                         3rd Qu.: 48.84   3rd Qu.:27.898                                        
 Max.   :297.00                                         Max.   :120.34   Max.   :65.764                                        
 NA's   :22                                                              NA's   :5                                             
drinkdriving <- drinkdriving[, c(7, 1, 2, 3, 4, 5, 6)]
[1] 7
drinkdriving$nighttime <- as.factor(drinkdriving$nighttime)
[1] 8
is.factor(drinkdriving$nighttime)
[1] 9
[1] TRUE
drinkdriving$prior_offence <- as.factor(drinkdriving$prior_offence)
[1] 10
is.factor(drinkdriving$prior_offence)
[1] 11
[1] TRUE
drinkdriving$outcome <- as.factor(drinkdriving$outcome)
[1] 12
is.factor(drinkdriving$outcome)
[1] 13
[1] TRUE
drinkdriving$incident_id <- as.factor(drinkdriving$incident_id)
[1] 14
is.factor(drinkdriving$incident_id)
[1] 15
[1] TRUE
summary(drinkdriving)
[1] 16
  incident_id       age         nighttime   prior_offence     speed             bac            outcome   
 inc_1  :  1   Min.   : 14.00   18:25:  1   N      :185   Min.   :  0.00   Min.   : 3.987   fine   :191  
 inc_10 :  1   1st Qu.: 30.00   2:05 :  2   DR50   : 43   1st Qu.: 30.92   1st Qu.:19.264   Fine   :  2  
 inc_100:  1   Median : 40.50   day  : 78   DD20   :  4   Median : 40.64   Median :23.609   FINE   :  9  
 inc_101:  1   Mean   : 46.00   night:169   DR80   :  4   Mean   : 40.49   Mean   :23.605   warning: 43  
 inc_102:  1   3rd Qu.: 55.25               TS70   :  3   3rd Qu.: 48.84   3rd Qu.:27.898   Warning:  2  
 inc_103:  1   Max.   :297.00               CD10   :  2   Max.   :120.34   Max.   :65.764   WARNING:  3  
 (Other):244   NA's   :22                   (Other):  9                    NA's   :5                     
plot(drinkdriving$age)
[1] 17
drinkdriving$age[drinkdriving$age > 100] <- NA
[1] 18
drinkdriving$age[drinkdriving$age < 17] <- NA
[1] 19
summary(drinkdriving$age)
[1] 20
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
  17.00   32.00   41.00   43.69   55.00   90.00      33 
sum(is.na(drinkdriving$age))
[1] 21
[1] 33
plot(drinkdriving$bac)
[1] 22
drinkdriving$bac <- drinkdriving$bac/100
[1] 23
drinkdriving$bac[drinkdriving$bac > 0.5] <- NA
[1] 24
plot(drinkdriving$prior_offence)
[1] 25
summary(drinkdriving$prior_offence)
[1] 26
          CD10           CD60 CD60,CD10,DR80      CD60,CD60           DD20           DR50           DR80              N           PL10 
             2              1              1              1              4             43              4            185              2 
          SP50           SP60           TS70      TS70,DR50 
             2              1              3              1 
drinkdriving$prior_offence[drinkdriving$prior_offence == "DD20"] <- NA
[1] 27
drinkdriving$prior_offence <- droplevels(drinkdriving$prior_offence)
[1] 28
plot(drinkdriving$nighttime)
[1] 29
drinkdriving$nighttime[drinkdriving$nighttime == "18:25"] <- "night"
[1] 30
drinkdriving$nighttime[drinkdriving$nighttime == "2:05"] <- "night"
[1] 31
drinkdriving$nighttime <- droplevels(drinkdriving$nighttime)
[1] 32
plot(drinkdriving$outcome)
[1] 33
drinkdriving$outcome[drinkdriving$outcome == "Fine"] <- "fine"
[1] 34
drinkdriving$outcome[drinkdriving$outcome == "FINE"] <- "fine"
[1] 35
drinkdriving$outcome[drinkdriving$outcome == "Warning"] <- "warning"
[1] 36
drinkdriving$outcome[drinkdriving$outcome == "WARNING"] <- "warning"
[1] 37
drinkdriving$outcome <- droplevels(drinkdriving$outcome)
[1] 38
plot(drinkdriving$speed)
[1] 39
summary(officer_inc)
[1] 40
 officer     incident_id 
 AS  :116   inc_1  :  1  
 IT  : 66   inc_10 :  1  
 NP  : 67   inc_100:  1  
 NA's:  1   inc_101:  1  
            inc_102:  1  
            inc_103:  1  
            (Other):244  
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 41
summary(m1)
[1] 42

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.151959 -0.041261 -0.008169  0.040809  0.147662 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.2811832  0.0115626  24.318  < 2e-16 ***
age         -0.0012660  0.0002479  -5.107 7.37e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05834 on 208 degrees of freedom
  (40 observations deleted due to missingness)
Multiple R-squared:  0.1114,	Adjusted R-squared:  0.1072 
F-statistic: 26.09 on 1 and 208 DF,  p-value: 7.366e-07

m1_scaled <- lm(bac ~ I(age - mean(age, na.rm = T)), data = drinkdriving)
[1] 43
summary(m1_scaled)
[1] 44

Call:
lm(formula = bac ~ I(age - mean(age, na.rm = T)), data = drinkdriving)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.151959 -0.041261 -0.008169  0.040809  0.147662 

Coefficients:
                                Estimate Std. Error t value Pr(>|t|)    
(Intercept)                    0.2258698  0.0040257  56.107  < 2e-16 ***
I(age - mean(age, na.rm = T)) -0.0012660  0.0002479  -5.107 7.37e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05834 on 208 degrees of freedom
  (40 observations deleted due to missingness)
Multiple R-squared:  0.1114,	Adjusted R-squared:  0.1072 
F-statistic: 26.09 on 1 and 208 DF,  p-value: 7.366e-07

with(drinkdriving, plot(bac ~ I(age - mean(age, na.rm = T))))
[1] 45
abline(m1, col = "green")
[1] 46
hist(residuals(m1), main = "Histogram of Residuals", breaks = 20)
[1] 47
plot(density(residuals(m1)), main = "Normality of Residuals")
[1] 48
par(mfrow = c(2, 2))
[1] 49
$mfrow
[1] 1 1

plot(m1, which = c(1:4))
[1] 50
par(mfrow = c(1, 1))
[1] 51
$mfrow
[1] 2 2

plot(m1, which = 5)
[1] 52
predict_BAC_50 <- data.frame(age = 50)
[1] 53
predict(m1_scaled, newdata = predict_BAC_50)
[1] 54
        1 
0.2258698 
plot(m1, which = 2)
[1] 55
m2_nighttime <- lm(bac ~ I(age - mean(age, na.rm = T)) + nighttime, 
    data = drinkdriving)
[1] 56
summary(m2_nighttime)
[1] 57

Call:
lm(formula = bac ~ I(age - mean(age, na.rm = T)) + nighttime, 
    data = drinkdriving)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.165793 -0.047183  0.003282  0.037481  0.143344 

Coefficients:
                                Estimate Std. Error t value Pr(>|t|)    
(Intercept)                    0.1993468  0.0068050  29.294  < 2e-16 ***
I(age - mean(age, na.rm = T)) -0.0011738  0.0002369  -4.954 1.50e-06 ***
nighttimenight                 0.0389448  0.0082547   4.718 4.38e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05557 on 207 degrees of freedom
  (40 observations deleted due to missingness)
Multiple R-squared:  0.1977,	Adjusted R-squared:   0.19 
F-statistic: 25.51 on 2 and 207 DF,  p-value: 1.254e-10

anova(m2_nighttime)
[1] 58
Analysis of Variance Table

Response: bac
                               Df  Sum Sq  Mean Sq F value    Pr(>F)    
I(age - mean(age, na.rm = T))   1 0.08878 0.088777  28.752 2.189e-07 ***
nighttime                       1 0.06873 0.068726  22.258 4.381e-06 ***
Residuals                     207 0.63915 0.003088                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m3_speed <- lm(bac ~ I(age - mean(age, na.rm = T)) + speed, data = drinkdriving)
[1] 59
summary(m3_speed)
[1] 60

Call:
lm(formula = bac ~ I(age - mean(age, na.rm = T)) + speed, data = drinkdriving)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.152141 -0.039350 -0.006521  0.041645  0.143229 

Coefficients:
                                Estimate Std. Error t value Pr(>|t|)    
(Intercept)                    0.2118542  0.0169663  12.487  < 2e-16 ***
I(age - mean(age, na.rm = T)) -0.0010824  0.0003289  -3.291  0.00117 ** 
speed                          0.0003698  0.0004349   0.850  0.39608    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05838 on 207 degrees of freedom
  (40 observations deleted due to missingness)
Multiple R-squared:  0.1145,	Adjusted R-squared:  0.106 
F-statistic: 13.39 on 2 and 207 DF,  p-value: 3.407e-06

anova(m3_speed)
[1] 61
Analysis of Variance Table

Response: bac
                               Df  Sum Sq  Mean Sq F value    Pr(>F)    
I(age - mean(age, na.rm = T))   1 0.08878 0.088777 26.0514 7.512e-07 ***
speed                           1 0.00246 0.002464  0.7232    0.3961    
Residuals                     207 0.70541 0.003408                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
par(mfrow = c(2, 2))
[1] 62
$mfrow
[1] 1 1

plot(m2_nighttime, which = c(1:4))
[1] 63
par(mfrow = c(1, 1))
[1] 64
$mfrow
[1] 2 2

hist(residuals(m2_nighttime), main = "Histogram of Residuals", 
    breaks = 20)
[1] 65
par(mfrow = c(2, 2))
[1] 66
$mfrow
[1] 1 1

plot(m3_speed, which = c(1:4))
[1] 67
m4 <- lm(bac ~ nighttime + I(age - mean(age, na.rm = T)) + speed, 
    data = drinkdriving)
[1] 68
plot(m4, which = c(1:4))
[1] 69
summary(m4)
[1] 70

Call:
lm(formula = bac ~ nighttime + I(age - mean(age, na.rm = T)) + 
    speed, data = drinkdriving)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.159430 -0.045540  0.003923  0.036445  0.142265 

Coefficients:
                                Estimate Std. Error t value Pr(>|t|)    
(Intercept)                    0.1853518  0.0171074  10.835  < 2e-16 ***
nighttimenight                 0.0389429  0.0082588   4.715 4.44e-06 ***
I(age - mean(age, na.rm = T)) -0.0009904  0.0003138  -3.156  0.00184 ** 
speed                          0.0003693  0.0004141   0.892  0.37358    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05559 on 206 degrees of freedom
  (40 observations deleted due to missingness)
Multiple R-squared:  0.2008,	Adjusted R-squared:  0.1892 
F-statistic: 17.25 on 3 and 206 DF,  p-value: 4.942e-10

drive_faster_test <- t.test(formula = speed ~ nighttime, data = drinkdriving, 
    var.equal = T, alternative = "greater")
[1] 71
drive_faster_test$statistic
[1] 72
         t 
-0.8427971 
drive_faster_test$p.value
[1] 73
[1] 0.799923
drive_faster_test


	Two Sample t-test

data:  speed by nighttime
t = -0.8428, df = 248, p-value = 0.7999
alternative hypothesis: true difference in means is greater than 0
95 percent confidence interval:
 -5.080287       Inf
sample estimates:
  mean in group day mean in group night 
           39.30514            41.02205 



drinkdriving$fine <- ifelse(drinkdriving$outcome == "fine", 1, 
    0)
[1] 75
m5 <- glm(fine ~ scale(bac) + scale(age) + speed + prior_offence + 
    nighttime, data = drinkdriving, family = binomial)
[1] 76
summary(m5)
[1] 77

Call:
glm(formula = fine ~ scale(bac) + scale(age) + speed + prior_offence + 
    nighttime, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.9572   0.0001   0.0050   0.0577   2.0824  

Coefficients:
                         Estimate Std. Error z value Pr(>|z|)    
(Intercept)              25.45677 4248.49187   0.006 0.995219    
scale(bac)                3.17272    0.82995   3.823 0.000132 ***
scale(age)               -4.03346    1.17864  -3.422 0.000621 ***
speed                     0.20475    0.06244   3.279 0.001041 ** 
prior_offenceCD60       -54.24535 7784.24746  -0.007 0.994440    
prior_offenceDR50       -23.18438 4248.49148  -0.005 0.995646    
prior_offenceDR80       -34.00417 4248.49329  -0.008 0.993614    
prior_offenceN          -26.39639 4248.49146  -0.006 0.995043    
prior_offencePL10       -22.60908 4303.94623  -0.005 0.995809    
prior_offenceSP50       -19.43877 5935.63073  -0.003 0.997387    
 [ reached getOption("max.print") -- omitted 4 rows ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 205.610  on 205  degrees of freedom
Residual deviance:  35.984  on 192  degrees of freedom
  (44 observations deleted due to missingness)
AIC: 63.984

Number of Fisher Scoring iterations: 17

coef(m5)
[1] 78
           (Intercept)             scale(bac)             scale(age)                  speed      prior_offenceCD60 
            25.4567670              3.1727186             -4.0334591              0.2047484            -54.2453470 
     prior_offenceDR50      prior_offenceDR80         prior_offenceN      prior_offencePL10      prior_offenceSP50 
           -23.1843754            -34.0041704            -26.3963935            -22.6090848            -19.4387656 
     prior_offenceSP60      prior_offenceTS70 prior_offenceTS70,DR50         nighttimenight 
           -51.3390104             -4.5356672            -41.3026751             -0.2540993 
drinkdriving$DR50 <- ifelse(drinkdriving$prior_offence == "DR50", 
    "drink", "other")
[1] 79
drinkdriving$DR50[drinkdriving$prior_offence == "N"] <- "non-offence"
[1] 80
drinkdriving$DR50 <- factor(drinkdriving$DR50, levels = c("drink", 
    "other", "non-offence"))
[1] 81
drinkD_offence <- glm(fine ~ DR50, data = drinkdriving, family = binomial)
[1] 82
summary(drinkD_offence)
[1] 83

Call:
glm(formula = fine ~ DR50, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.3076   0.3803   0.6681   0.6681   0.9005  

Coefficients:
                Estimate Std. Error z value Pr(>|z|)    
(Intercept)       2.5903     0.5986   4.327 1.51e-05 ***
DR50other        -1.8971     0.7800  -2.432   0.0150 *  
DR50non-offence  -1.2040     0.6262  -1.923   0.0545 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 237.06  on 245  degrees of freedom
Residual deviance: 229.82  on 243  degrees of freedom
  (4 observations deleted due to missingness)
AIC: 235.82

Number of Fisher Scoring iterations: 5

levels(drinkdriving$prior_offence)
[1] 84
 [1] "CD10"           "CD60"           "CD60,CD10,DR80" "CD60,CD60"      "DR50"           "DR80"           "N"             
 [8] "PL10"           "SP50"           "SP60"           "TS70"           "TS70,DR50"     
drinkdriving$all_offences <- ifelse(drinkdriving$prior_offence == 
    "N", "non-offence", "offence")
[1] 85
motor_offence <- glm(fine ~ all_offences, data = drinkdriving, 
    family = binomial)
[1] 86
summary(motor_offence)
[1] 87

Call:
glm(formula = fine ~ all_offences, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.9564   0.5650   0.6681   0.6681   0.6681  

Coefficients:
                    Estimate Std. Error z value Pr(>|z|)    
(Intercept)           1.3863     0.1838   7.542 4.62e-14 ***
all_offencesoffence   0.3677     0.4051   0.908    0.364    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 237.06  on 245  degrees of freedom
Residual deviance: 236.20  on 244  degrees of freedom
  (4 observations deleted due to missingness)
AIC: 240.2

Number of Fisher Scoring iterations: 4

predprob_fine <- data.frame(age = 17:100, prior_offence = "N", 
    speed = 30, nighttime = "day", bac = 0)
[1] 88
mPredict_Fine <- glm(fine ~ bac + I(age - mean(age, na.rm = T)) + 
    speed + prior_offence + nighttime, data = drinkdriving, family = binomial)
[1] 89
summary(mPredict_Fine)
[1] 90

Call:
glm(formula = fine ~ bac + I(age - mean(age, na.rm = T)) + speed + 
    prior_offence + nighttime, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.9572   0.0001   0.0050   0.0577   2.0824  

Coefficients:
                                Estimate Std. Error z value Pr(>|z|)    
(Intercept)                     14.36056 4248.49158   0.003 0.997303    
bac                             47.63905   12.46187   3.823 0.000132 ***
I(age - mean(age, na.rm = T))   -0.24897    0.07275  -3.422 0.000621 ***
speed                            0.20475    0.06244   3.279 0.001041 ** 
prior_offenceCD60              -54.24535 7784.24747  -0.007 0.994440    
prior_offenceDR50              -23.18438 4248.49149  -0.005 0.995646    
prior_offenceDR80              -34.00417 4248.49330  -0.008 0.993614    
prior_offenceN                 -26.39639 4248.49147  -0.006 0.995043    
prior_offencePL10              -22.60908 4303.94624  -0.005 0.995809    
prior_offenceSP50              -19.43877 5935.63073  -0.003 0.997387    
 [ reached getOption("max.print") -- omitted 4 rows ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 205.610  on 205  degrees of freedom
Residual deviance:  35.984  on 192  degrees of freedom
  (44 observations deleted due to missingness)
AIC: 63.984

Number of Fisher Scoring iterations: 17

predprob_fine$probability_fine <- predict(mPredict_Fine, newdata = predprob_fine, 
    type = "response")
[1] 91
par(mfrow = c(1, 1))
[1] 92
$mfrow
[1] 2 2

qplot(data = predprob_fine, age, probability_fine, main = "Predicted Probabilities of Recieving a Fine \nBased on Age", 
    xlab = "Age", ylab = "Probability of Recieving a Fine")
[1] 93
summary(officer_inc)
[1] 94
 officer     incident_id 
 AS  :116   inc_1  :  1  
 IT  : 66   inc_10 :  1  
 NP  : 67   inc_100:  1  
 NA's:  1   inc_101:  1  
            inc_102:  1  
            inc_103:  1  
            (Other):244  
describe(officer_inc)
[1] 95
             vars   n  mean    sd median trimmed   mad min max range skew kurtosis   se
officer*        1 249   1.8  0.84    2.0    1.76  1.48   1   3     2 0.38    -1.47 0.05
incident_id*    2 250 125.5 72.31  125.5  125.50 92.66   1 250   249 0.00    -1.21 4.57
drinkDofficer <- merge(drinkdriving, officer_inc, by = "incident_id")
[1] 96
summary(drinkDofficer)
[1] 97
  incident_id       age        nighttime   prior_offence     speed             bac             outcome         fine      
 inc_1  :  1   Min.   :17.00   day  : 78   N      :185   Min.   :  0.00   Min.   :0.03987   fine   :202   Min.   :0.000  
 inc_10 :  1   1st Qu.:32.00   night:172   DR50   : 43   1st Qu.: 30.92   1st Qu.:0.19215   warning: 48   1st Qu.:1.000  
 inc_100:  1   Median :41.00               DR80   :  4   Median : 40.64   Median :0.23504                 Median :1.000  
 inc_101:  1   Mean   :43.69               TS70   :  3   Mean   : 40.49   Mean   :0.23292                 Mean   :0.808  
          DR50     all_offences       officer   
 drink      : 43   Length:250         AS  :116  
 other      : 18   Class :character   IT  : 66  
 non-offence:185   Mode  :character   NP  : 67  
 NA's       :  4                      NA's:  1  
 [ reached getOption("max.print") -- omitted 3 rows ]
drinkDofficer <- na.exclude(drinkDofficer)
[1] 98
with(drinkDofficer, plot_ly(x = ~officer, y = ~fine, z = ~age, 
    color = factor(fine, labels = c("fine", "warning"))))
[1] 99
officer_bias <- glm(fine ~ officer + age + age * officer, data = drinkDofficer, 
    family = binomial)
[1] 100
summary(officer_bias)
[1] 101

Call:
glm(formula = fine ~ officer + age + age * officer, family = binomial, 
    data = drinkDofficer)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.8329   0.0665   0.2561   0.4931   2.4841  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept)   10.01092    2.17226   4.609 4.06e-06 ***
officerIT     -4.63970    2.73318  -1.698   0.0896 .  
officerNP     -3.21043    2.94256  -1.091   0.2753    
age           -0.16947    0.03770  -4.495 6.96e-06 ***
officerIT:age  0.08974    0.04817   1.863   0.0625 .  
officerNP:age  0.06925    0.05102   1.357   0.1746    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 205.61  on 205  degrees of freedom
Residual deviance: 125.22  on 200  degrees of freedom
AIC: 137.22

Number of Fisher Scoring iterations: 7

coef(officer_bias)
[1] 102
  (Intercept)     officerIT     officerNP           age officerIT:age officerNP:age 
  10.01091806   -4.63970130   -3.21042825   -0.16947460    0.08973728    0.06925270 
qplot(data = drinkDofficer, officer, age, colour = factor(outcome, 
    labels = c("fine", "warning"))) + labs(colour = "Outcome") + 
    ggtitle("Cop Biases In Giving Fines and Warnings \nConcerning Driver's Age") + 
    xlab("Officer") + ylab("Age")
[1] 103
anova(officer_bias, test = "Chisq")
[1] 104
Analysis of Deviance Table

Model: binomial, link: logit

Response: fine

Terms added sequentially (first to last)


            Df Deviance Resid. Df Resid. Dev Pr(>Chi)    
NULL                          205     205.61             
officer      2    0.880       203     204.73   0.6442    
age          1   75.473       202     129.26   <2e-16 ***
officer:age  2    4.036       200     125.22   0.1329    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
