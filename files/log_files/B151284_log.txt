

	####### B151284 R script #######

library(psych, quietly = T)
[1] 1
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(plyr, quietly = T)
[1] 2
 [1] "plyr"      "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(ggplot2, quietly = T)
[1] 3
 [1] "ggplot2"   "plyr"      "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
library(car, quietly = T)
[1] 4
 [1] "car"       "carData"   "ggplot2"   "plyr"      "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"    
[11] "datasets"  "methods"   "base"     
library(gvlma, quietly = T)
[1] 5
 [1] "gvlma"     "car"       "carData"   "ggplot2"   "plyr"      "psych"     "readr"     "stats"     "graphics"  "grDevices"
[11] "utils"     "datasets"  "methods"   "base"     
library(tidymv, quietly = T)
[1] 6
 [1] "tidymv"    "gvlma"     "car"       "carData"   "ggplot2"   "plyr"      "psych"     "readr"     "stats"     "graphics" 
[11] "grDevices" "utils"     "datasets"  "methods"   "base"     
load(url("https://edin.ac/2QCZNVu"))
[1] 7
[1] "drinkdriving" "officer_inc" 
data <- merge(drinkdriving, officer_inc)
[1] 8
describe(data)
[1] 9
             vars   n mean    sd median trimmed   mad min  max range skew kurtosis   se
incident_id*    1 250  NaN    NA     NA     NaN    NA Inf -Inf  -Inf   NA       NA   NA
age             2 228   46 33.35   40.5   42.34 18.53  14  297   283  5.5    38.49 2.21
nighttime*      3 250  NaN    NA     NA     NaN    NA Inf -Inf  -Inf   NA       NA   NA
 [ reached 'max' / getOption("max.print") -- omitted 5 rows ]
summary(data)
[1] 10
 incident_id             age          nighttime         prior_offence          speed             bac           outcome         
 Length:250         Min.   : 14.00   Length:250         Length:250         Min.   :  0.00   Min.   : 3.987   Length:250        
 Class :character   1st Qu.: 30.00   Class :character   Class :character   1st Qu.: 30.92   1st Qu.:19.264   Class :character  
 Mode  :character   Median : 40.50   Mode  :character   Mode  :character   Median : 40.64   Median :23.609   Mode  :character  
                    Mean   : 46.00                                         Mean   : 40.49   Mean   :23.605                     
                    3rd Qu.: 55.25                                         3rd Qu.: 48.84   3rd Qu.:27.898                     
                    Max.   :297.00                                         Max.   :120.34   Max.   :65.764                     
 officer   
 AS  :116  
 IT  : 66  
 NP  : 67  
 NA's:  1  
           
           
 [ reached getOption("max.print") -- omitted 1 row ]
data$nighttime <- as.factor(data$nighttime)
[1] 11
data$outcome <- as.factor(data$outcome)
[1] 12
data$prior_offence <- as.factor(data$prior_offence)
[1] 13
data$incident_id <- as.factor(data$incident_id)
[1] 14
data$officer <- as.factor(data$officer)
[1] 15
outliers <- function(obs, x = 2.5) {
    return(abs(obs - mean(obs, na.rm = T)) > (sd(obs, na.rm = T) * 
        x))
}
[1] 16
which(outliers(data$speed))
[1] 17
[1]   2  14  62  70 196 218
data$speed[c(2, 14, 62, 70, 196, 218)] <- NA
[1] 18
describe(data$speed)
[1] 19
   vars   n  mean    sd median trimmed   mad   min   max range skew kurtosis   se
X1    1 244 40.63 13.03  40.68   40.46 12.33 11.23 75.87 64.65 0.11    -0.26 0.83
which(outliers(data$bac))
[1] 20
[1]  14  62 198
data$bac[c(14, 62, 198)] <- NA
[1] 21
describe(data$bac)
[1] 22
   vars   n  mean   sd median trimmed mad  min   max range  skew kurtosis   se
X1    1 242 23.37 6.56  23.56   23.58 6.4 5.45 36.14 30.69 -0.29    -0.08 0.42
which(outliers(data$age))
[1] 23
[1]  18 140 198
data$age[c(18, 140, 198)] <- NA
[1] 24
describe(data$age)
[1] 25
   vars   n  mean    sd median trimmed   mad min max range skew kurtosis   se
X1    1 225 42.68 16.77     40   41.93 17.79  14  90    76  0.4    -0.52 1.12
data$age[data$age > 100] <- NA
[1] 26
data$age[data$age < 17] <- NA
[1] 27
boxplot(data$age)
[1] 28
describe(data$age)
[1] 29
   vars   n  mean   sd median trimmed   mad min max range skew kurtosis  se
X1    1 217 43.69 16.2     41   42.85 17.79  17  90    73 0.46    -0.49 1.1
table(data$nighttime)
[1] 30

18:25  2:05   day night 
    1     2    78   169 
data$nighttime[data$nighttime == "18:25"] <- NA
[1] 31
data$nighttime[data$nighttime == "2:05"] <- NA
[1] 32
data$nighttime <- droplevels(data$nighttime)
[1] 33
levels(data$nighttime)
[1] 34
[1] "day"   "night"
table(data$prior_offence)
[1] 35

          CD10           CD60 CD60,CD10,DR80      CD60,CD60           DD20           DR50           DR80              N           PL10 
             2              1              1              1              4             43              4            185              2 
          SP50           SP60           TS70      TS70,DR50 
             2              1              3              1 
data$prior_offence <- revalue(data$prior_offence, c(CD10 = "CD", 
    CD60 = "CD", `CD60,CD10,DR80` = NA, `CD60,CD60` = "CD", DD20 = NA, 
    DR50 = "DR50", DR80 = "DR80", N = "N", PL10 = "PL", SP50 = "SP", 
    SP60 = "SP", TS70 = "TS", `TS70,DR50` = NA))
[1] 36
table(data$outcome)
[1] 37

   fine    Fine    FINE warning Warning WARNING 
    191       2       9      43       2       3 
data$outcome <- revalue(data$outcome, c(Fine = "fine", FINE = "fine", 
    fine = "fine", Warning = "warning", WARNING = "warning", 
    warning = "warning"))
[1] 38
data$incident_id <- order(data$incident_id, na.last = F, decreasing = F)
[1] 39
m1 <- lm(bac ~ age, data = data)
[1] 40
summary(m1)
[1] 41

Call:
lm(formula = bac ~ age, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.1959  -4.1261  -0.8169   4.0809  14.7662 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 28.11832    1.15626  24.318  < 2e-16 ***
age         -0.12660    0.02479  -5.107 7.37e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.834 on 208 degrees of freedom
  (40 observations deleted due to missingness)
Multiple R-squared:  0.1114,	Adjusted R-squared:  0.1072 
F-statistic: 26.09 on 1 and 208 DF,  p-value: 7.366e-07

gvmodel <- gvlma(m1)
[1] 42
summary(gvmodel)
[1] 43

Call:
lm(formula = bac ~ age, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.1959  -4.1261  -0.8169   4.0809  14.7662 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 28.11832    1.15626  24.318  < 2e-16 ***
age         -0.12660    0.02479  -5.107 7.37e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.834 on 208 degrees of freedom
  (40 observations deleted due to missingness)
Multiple R-squared:  0.1114,	Adjusted R-squared:  0.1072 
F-statistic: 26.09 on 1 and 208 DF,  p-value: 7.366e-07


ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
Level of Significance =  0.05 

Call:
 gvlma(x = m1) 

                    Value p-value                Decision
Global Stat        3.0425  0.5507 Assumptions acceptable.
Skewness           0.1588  0.6903 Assumptions acceptable.
Kurtosis           1.4162  0.2340 Assumptions acceptable.
Link Function      0.2277  0.6332 Assumptions acceptable.
Heteroscedasticity 1.2397  0.2655 Assumptions acceptable.
                       Value   p-value                Decision
Global Stat        3.0424655 0.5507442 Assumptions acceptable.
Skewness           0.1587915 0.6902716 Assumptions acceptable.
Kurtosis           1.4161932 0.2340310 Assumptions acceptable.
Link Function      0.2277488 0.6331981 Assumptions acceptable.
Heteroscedasticity 1.2397321 0.2655227 Assumptions acceptable.
bac_50 <- data.frame(age = c(50))
[1] 44
predict(m1, newdata = bac_50)
[1] 45
       1 
21.78828 
summary(m1)
[1] 46

Call:
lm(formula = bac ~ age, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.1959  -4.1261  -0.8169   4.0809  14.7662 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 28.11832    1.15626  24.318  < 2e-16 ***
age         -0.12660    0.02479  -5.107 7.37e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.834 on 208 degrees of freedom
  (40 observations deleted due to missingness)
Multiple R-squared:  0.1114,	Adjusted R-squared:  0.1072 
F-statistic: 26.09 on 1 and 208 DF,  p-value: 7.366e-07

par(mfrow = c(2, 2))
[1] 47
$mfrow
[1] 1 1

plot(m1, which = c(2, 4))
[1] 48
model.b <- lm(bac ~ age + speed, data = data)
[1] 49
summary(model.b)
[1] 50

Call:
lm(formula = bac ~ age + speed, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.2503  -3.9663  -0.6632   3.8675  14.1797 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 23.64084    3.03200   7.797 3.25e-13 ***
age         -0.09604    0.03347  -2.869  0.00455 ** 
speed        0.07943    0.04777   1.663  0.09790 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.821 on 203 degrees of freedom
  (44 observations deleted due to missingness)
Multiple R-squared:  0.1308,	Adjusted R-squared:  0.1222 
F-statistic: 15.27 on 2 and 203 DF,  p-value: 6.639e-07

model.c <- lm(bac ~ age + nighttime, data = data)
[1] 51
summary(model.c)
[1] 52

Call:
lm(formula = bac ~ age + nighttime, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.3916  -4.7154   0.2886   3.6969  14.3952 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    25.50352    1.26617  20.142  < 2e-16 ***
age            -0.12702    0.02354  -5.395 1.88e-07 ***
nighttimenight  3.83516    0.81438   4.709 4.58e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.468 on 205 degrees of freedom
  (42 observations deleted due to missingness)
Multiple R-squared:  0.2146,	Adjusted R-squared:  0.2069 
F-statistic: 28.01 on 2 and 205 DF,  p-value: 1.765e-11

par(mfrow = c(2, 2))
[1] 53
$mfrow
[1] 2 2

plot(model.b)
[1] 54
plot(model.c)
[1] 55
gvlma(x = model.b)
[1] 56

Call:
lm(formula = bac ~ age + speed, data = data)

Coefficients:
(Intercept)          age        speed  
   23.64084     -0.09604      0.07943  


ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
Level of Significance =  0.05 

Call:
 gvlma(x = model.b) 

                    Value p-value                Decision
Global Stat        5.0944  0.2777 Assumptions acceptable.
Skewness           0.5096  0.4753 Assumptions acceptable.
Kurtosis           1.5369  0.2151 Assumptions acceptable.
Link Function      1.7214  0.1895 Assumptions acceptable.
Heteroscedasticity 1.3265  0.2494 Assumptions acceptable.
gvlma(x = model.c)
[1] 57

Call:
lm(formula = bac ~ age + nighttime, data = data)

Coefficients:
   (Intercept)             age  nighttimenight  
        25.504          -0.127           3.835  


ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
Level of Significance =  0.05 

Call:
 gvlma(x = model.c) 

                      Value p-value                Decision
Global Stat        4.035400  0.4012 Assumptions acceptable.
Skewness           0.008835  0.9251 Assumptions acceptable.
Kurtosis           1.638849  0.2005 Assumptions acceptable.
Link Function      1.910423  0.1669 Assumptions acceptable.
Heteroscedasticity 0.477293  0.4897 Assumptions acceptable.
anova(model.b)
[1] 58
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1  941.3  941.28 27.7753 3.469e-07 ***
speed       1   93.7   93.70  2.7649    0.0979 .  
Residuals 203 6879.5   33.89                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(model.b)$r.squared
[1] 59
[1] 0.1307708
anova(model.c)
[1] 60
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1011.9  1011.9  33.836 2.278e-08 ***
nighttime   1  663.2   663.2  22.177 4.576e-06 ***
Residuals 205 6130.4    29.9                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(model.c)$r.squared
[1] 61
[1] 0.2145998
t.test(data = data, speed ~ nighttime, paired = FALSE)
[1] 62

	Welch Two Sample t-test

data:  speed by nighttime
t = -2.0001, df = 180.57, p-value = 0.04699
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -6.5915244 -0.0445995
sample estimates:
  mean in group day mean in group night 
           38.25278            41.57084 

gm1 <- glm(outcome == "fine" ~ age + bac + speed + nighttime + 
    prior_offence, data = data, family = binomial)
[1] 63
summary(gm1)
[1] 64

Call:
glm(formula = outcome == "fine" ~ age + bac + speed + nighttime + 
    prior_offence, family = binomial, data = data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-4.2742   0.0053   0.0467   0.2303   1.8114  

Coefficients:
                    Estimate Std. Error z value Pr(>|z|)    
(Intercept)          2.35869    3.59356   0.656 0.511588    
age                 -0.14163    0.03816  -3.711 0.000206 ***
bac                  0.29159    0.07687   3.793 0.000149 ***
speed                0.13505    0.05048   2.676 0.007460 ** 
nighttimenight      -0.39744    0.74750  -0.532 0.594935    
prior_offenceDR50   -1.25986    2.18127  -0.578 0.563546    
prior_offenceDR80   -8.25692    2.95791  -2.791 0.005247 ** 
prior_offenceN      -3.66727    1.92277  -1.907 0.056483 .  
prior_offencePL     -1.67255   43.54395  -0.038 0.969360    
prior_offenceSP     -8.82633    2.89988  -3.044 0.002337 ** 
 [ reached getOption("max.print") -- omitted 1 row ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 191.556  on 199  degrees of freedom
Residual deviance:  63.261  on 189  degrees of freedom
  (50 observations deleted due to missingness)
AIC: 85.261

Number of Fisher Scoring iterations: 15

gm2 <- glm(outcome == "fine" ~ scale(speed), data = data, family = binomial)
[1] 65
summary(gm2)
[1] 66

Call:
glm(formula = outcome == "fine" ~ scale(speed), family = binomial, 
    data = data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.4656   0.0921   0.2571   0.5255   1.8321  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept)    2.4805     0.3108   7.981 1.45e-15 ***
scale(speed)   2.0543     0.3156   6.509 7.55e-11 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 230.28  on 243  degrees of freedom
Residual deviance: 153.22  on 242  degrees of freedom
  (6 observations deleted due to missingness)
AIC: 157.22

Number of Fisher Scoring iterations: 6

gm3 <- glm(outcome == "fine" ~ scale(bac), data = data, family = binomial)
[1] 67
summary(gm3)
[1] 68

Call:
glm(formula = outcome == "fine" ~ scale(bac), family = binomial, 
    data = data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.9764   0.2110   0.4071   0.6493   1.6523  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)   1.8779     0.2214   8.482  < 2e-16 ***
scale(bac)    1.3043     0.2210   5.901 3.61e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 235.39  on 241  degrees of freedom
Residual deviance: 186.78  on 240  degrees of freedom
  (8 observations deleted due to missingness)
AIC: 190.78

Number of Fisher Scoring iterations: 5

mgm <- glm(outcome == "fine" ~ prior_offence == "DR50", data = data, 
    family = binomial)
[1] 69
summary(mgm)
[1] 70

Call:
glm(formula = outcome == "fine" ~ prior_offence == "DR50", family = binomial, 
    data = data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.3076   0.3803   0.6847   0.6847   0.6847  

Coefficients:
                            Estimate Std. Error z value Pr(>|z|)    
(Intercept)                   1.3312     0.1735   7.673 1.68e-14 ***
prior_offence == "DR50"TRUE   1.2590     0.6232   2.020   0.0434 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 233.28  on 243  degrees of freedom
Residual deviance: 227.81  on 242  degrees of freedom
  (6 observations deleted due to missingness)
AIC: 231.81

Number of Fisher Scoring iterations: 5

mgm2 <- glm(outcome == "fine" ~ prior_offence != c("DR50", "N"), 
    data = data, family = binomial)
[1] 71
summary(mgm2)
[1] 72

Call:
glm(formula = outcome == "fine" ~ prior_offence != c("DR50", 
    "N"), family = binomial, data = data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.9418   0.5738   0.5738   0.6905   0.6905  

Coefficients:
                                    Estimate Std. Error z value Pr(>|z|)    
(Intercept)                           1.3122     0.2129   6.163 7.13e-10 ***
prior_offence != c("DR50", "N")TRUE   0.4085     0.3386   1.206    0.228    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 233.28  on 243  degrees of freedom
Residual deviance: 231.80  on 242  degrees of freedom
  (6 observations deleted due to missingness)
AIC: 235.8

Number of Fisher Scoring iterations: 4

mgm3 <- glm(outcome == "fine" ~ prior_offence == "N", data = data, 
    family = binomial)
[1] 73
summary(mgm3)
[1] 74

Call:
glm(formula = outcome == "fine" ~ prior_offence == "N", family = binomial, 
    data = data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.9990   0.5398   0.6681   0.6681   0.6681  

Coefficients:
                         Estimate Std. Error z value Pr(>|z|)    
(Intercept)                1.8524     0.3803   4.871 1.11e-06 ***
prior_offence == "N"TRUE  -0.4661     0.4224  -1.104     0.27    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 233.28  on 243  degrees of freedom
Residual deviance: 231.98  on 242  degrees of freedom
  (6 observations deleted due to missingness)
AIC: 235.98

Number of Fisher Scoring iterations: 4

mgm4 <- glm(outcome == "fine" ~ prior_offence != "N", data = data, 
    family = binomial)
[1] 75
summary(mgm4)
[1] 76

Call:
glm(formula = outcome == "fine" ~ prior_offence != "N", family = binomial, 
    data = data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.9990   0.5398   0.6681   0.6681   0.6681  

Coefficients:
                         Estimate Std. Error z value Pr(>|z|)    
(Intercept)                1.3863     0.1838   7.542 4.62e-14 ***
prior_offence != "N"TRUE   0.4661     0.4224   1.104     0.27    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 233.28  on 243  degrees of freedom
Residual deviance: 231.98  on 242  degrees of freedom
  (6 observations deleted due to missingness)
AIC: 235.98

Number of Fisher Scoring iterations: 4

gml1 <- glm(outcome == "fine" ~ age + speed + nighttime + bac + 
    prior_offence, data = data, family = binomial)
[1] 77
summary(gml1)
[1] 78

Call:
glm(formula = outcome == "fine" ~ age + speed + nighttime + bac + 
    prior_offence, family = binomial, data = data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-4.2742   0.0053   0.0467   0.2303   1.8114  

Coefficients:
                    Estimate Std. Error z value Pr(>|z|)    
(Intercept)          2.35869    3.59356   0.656 0.511588    
age                 -0.14163    0.03816  -3.711 0.000206 ***
speed                0.13505    0.05048   2.676 0.007460 ** 
nighttimenight      -0.39744    0.74750  -0.532 0.594935    
bac                  0.29159    0.07687   3.793 0.000149 ***
prior_offenceDR50   -1.25986    2.18127  -0.578 0.563546    
prior_offenceDR80   -8.25692    2.95791  -2.791 0.005247 ** 
prior_offenceN      -3.66727    1.92277  -1.907 0.056483 .  
prior_offencePL     -1.67255   43.54395  -0.038 0.969360    
prior_offenceSP     -8.82633    2.89988  -3.044 0.002337 ** 
 [ reached getOption("max.print") -- omitted 1 row ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 191.556  on 199  degrees of freedom
Residual deviance:  63.261  on 189  degrees of freedom
  (50 observations deleted due to missingness)
AIC: 85.261

Number of Fisher Scoring iterations: 15

model_prediction <- data.frame(age = c(17:90), bac = c(0), speed = c(30), 
    nighttime = c("day"), prior_offence = c("N"), stringsAsFactors = T)
[1] 79
predict(gml1, newdata = model_prediction)
[1] 80
          1           2           3           4           5           6           7           8           9          10          11 
 0.33539722  0.19376989  0.05214257 -0.08948475 -0.23111208 -0.37273940 -0.51436673 -0.65599405 -0.79762138 -0.93924870 -1.08087603 
         12          13          14          15          16          17          18          19          20          21          22 
-1.22250335 -1.36413067 -1.50575800 -1.64738532 -1.78901265 -1.93063997 -2.07226730 -2.21389462 -2.35552194 -2.49714927 -2.63877659 
         23          24          25          26          27          28          29          30          31          32          33 
-2.78040392 -2.92203124 -3.06365857 -3.20528589 -3.34691322 -3.48854054 -3.63016786 -3.77179519 -3.91342251 -4.05504984 -4.19667716 
         34          35          36          37          38          39          40          41          42          43          44 
-4.33830449 -4.47993181 -4.62155914 -4.76318646 -4.90481378 -5.04644111 -5.18806843 -5.32969576 -5.47132308 -5.61295041 -5.75457773 
         45          46          47          48          49          50 
-5.89620506 -6.03783238 -6.17945970 -6.32108703 -6.46271435 -6.60434168 
 [ reached getOption("max.print") -- omitted 24 entries ]
ages_fine <- predict(gml1, newdata = model_prediction)
[1] 81
summary(ages_fine)
[1] 82
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-10.0034  -7.4187  -4.8340  -4.8340  -2.2493   0.3354 
plot(ages_fine, main = "Outcome Predicted by Age", xlab = "Fine Probability", 
    ylab = "Age")
[1] 83
chisq.test(table(data$officer, data$outcome))
[1] 84

	Pearson's Chi-squared test

data:  table(data$officer, data$outcome)
X-squared = 1.246, df = 2, p-value = 0.5363

plot(data$officer, data$outcome, main = "Relationship between Officer and Outcome", 
    xlab = "Officer", ylab = "Outcome")
[1] 85
plot(data$officer, data$age)
[1] 86
chisq.test(data$officer, data$outcome == "fine")
[1] 87

	Pearson's Chi-squared test

data:  data$officer and data$outcome == "fine"
X-squared = 1.246, df = 2, p-value = 0.5363

chisqq <- chisq.test(data$officer, data$outcome == "fine")
[1] 88
chisqq$observed
[1] 89
            data$outcome == "fine"
data$officer FALSE TRUE
          AS    25   91
          IT    12   54
          NP    10   57
chisqq$expected
[1] 90
            data$outcome == "fine"
data$officer    FALSE     TRUE
          AS 21.89558 94.10442
          IT 12.45783 53.54217
          NP 12.64659 54.35341
chisq.test(data$officer, data$age)
[1] 91

	Pearson's Chi-squared test

data:  data$officer and data$age
X-squared = 124.3, df = 118, p-value = 0.3277

chisqq2 <- chisq.test(data$officer, data$age)
[1] 92
chisqq2$observed
[1] 93
            data$age
data$officer 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56
            data$age
data$officer 57 58 59 60 61 62 63 64 65 66 68 69 70 73 77 80 81 86 87 90
 [ reached getOption("max.print") -- omitted 3 rows ]
ggplot(data = na.omit(data)) + geom_point(mapping = aes(x = officer, 
    y = age, color = outcome)) + ggtitle("Relationship between Officer, Age and Outcome")
[1] 94
ggplot(data = na.omit(data)) + geom_point(mapping = aes(x = officer, 
    y = age)) + facet_wrap(~outcome, nrow = 2)
[1] 95
off5 <- glm(outcome == "fine" ~ officer:age, data = data, family = binomial)
[1] 96
summary(off5)
[1] 97

Call:
glm(formula = outcome == "fine" ~ officer:age, family = binomial, 
    data = data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.0670   0.1765   0.3102   0.5206   2.0904  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept)    6.37830    0.88305   7.223 5.09e-13 ***
officerAS:age -0.10591    0.01653  -6.409 1.46e-10 ***
officerIT:age -0.09818    0.01725  -5.690 1.27e-08 ***
officerNP:age -0.09356    0.01669  -5.606 2.08e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 218.83  on 216  degrees of freedom
Residual deviance: 152.45  on 213  degrees of freedom
  (33 observations deleted due to missingness)
AIC: 160.45

Number of Fisher Scoring iterations: 5

coef(off5)
[1] 98
  (Intercept) officerAS:age officerIT:age officerNP:age 
   6.37829678   -0.10590988   -0.09818433   -0.09356037 
