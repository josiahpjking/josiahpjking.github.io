

	####### B149712 R script #######

library(ggplot2, quietly = T)
[1] 1
[1] "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
load(url("https://edin.ac/2QCZNVu"))
[1] 2
[1] "drinkdriving" "officer_inc" 
summary(drinkdriving)
[1] 3
      age          nighttime         prior_offence          speed             bac           outcome          incident_id       
 Min.   : 14.00   Length:250         Length:250         Min.   :  0.00   Min.   : 3.987   Length:250         Length:250        
 1st Qu.: 30.00   Class :character   Class :character   1st Qu.: 30.92   1st Qu.:19.264   Class :character   Class :character  
 Median : 40.50   Mode  :character   Mode  :character   Median : 40.64   Median :23.609   Mode  :character   Mode  :character  
 Mean   : 46.00                                         Mean   : 40.49   Mean   :23.605                                        
 3rd Qu.: 55.25                                         3rd Qu.: 48.84   3rd Qu.:27.898                                        
 Max.   :297.00                                         Max.   :120.34   Max.   :65.764                                        
 NA's   :22                                                              NA's   :5                                             
summary(officer_inc)
[1] 4
 officer     incident_id 
 AS  :116   inc_1  :  1  
 IT  : 66   inc_10 :  1  
 NP  : 67   inc_100:  1  
 NA's:  1   inc_101:  1  
            inc_102:  1  
            inc_103:  1  
            (Other):244  
drinkdriving$age[drinkdriving$age == 297] <- NA
[1] 5
drinkdriving$age[drinkdriving$age == 293] <- NA
[1] 6
table(drinkdriving$age)
[1] 7

14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 
 1  5  2  3  1  2  3  6  2  5  8  3  2  2  5  4  4  4  6  5  9  8  3  4  2 10  5  6  5  3  2  3  4  5  2  3  3  3  6  3  5  4  3  4  4 
59 60 61 62 63 
 1  5  3  3  2 
 [ reached getOption("max.print") -- omitted 13 entries ]
table(drinkdriving$nighttime)
[1] 8

18:25  2:05   day night 
    1     2    78   169 
drinkdriving$nighttime[drinkdriving$nighttime == "18:25"] <- "day"
[1] 9
drinkdriving$nighttime[drinkdriving$nighttime == "2:05"] <- "night"
[1] 10
table(drinkdriving$prior_offence)
[1] 11

          CD10           CD60 CD60,CD10,DR80      CD60,CD60           DD20           DR50           DR80              N           PL10 
             2              1              1              1              4             43              4            185              2 
          SP50           SP60           TS70      TS70,DR50 
             2              1              3              1 
drinkdriving$prior_offence[drinkdriving$prior_offence == "DD20"] <- NA
[1] 12
table(drinkdriving$speed)
[1] 13

               0 1.01214942316415 1.94581782932169 2.53346827328845  11.225704630299 12.2462058630265 12.8128465751594 
               1                1                1                1                1                1                1 
12.9030158165279 12.9155695510693 13.0698049123235 14.3668291368723 15.5710258293839 17.0590138838127  17.221097497513 
               1                1                1                1                1                1                1 
18.2934932399405 19.0089940620951 19.2697316282316 20.2107015627382 21.3069195145607 21.4908339004998 21.8064434744078 
               1                1                1                1                1                1                1 
 22.568562604335 22.5952898516689 22.6424298724575  23.182415928645 23.5805503449787 23.5994274112678 24.4877988273931 
               1                1                1                1                1                1                1 
24.5215840561896 24.5611037960359 24.8285320808304 24.9172566024629 24.9907200841348 25.0453443973611 25.0548611219096 
               1                1                1                1                1                1                1 
25.2710211226397 25.5417854203194 25.5936767268247 25.7485090547557 25.9105706027961   25.98459487588 26.2055631685057 
               1                1                1                1                1                1                1 
 26.414446768112 26.6813905027214 26.6979134850146 27.0661842358492 28.5530416886726 28.6993802422867 28.7242755318064 
               1                1                1                1                1                1                1 
28.8107670431613 
               1 
 [ reached getOption("max.print") -- omitted 200 entries ]
table(drinkdriving$bac)
[1] 14

3.98678518191804 5.45295079276351 5.61849660215689 6.39815180420771 6.45232354218363 8.55241944417923 9.16715954067682 
               1                1                1                1                1                1                1 
9.25348198083096 9.49752435423211 9.81747807144744 10.0454646939566 10.2699286970084 10.4971185812798 10.6649017352481 
               1                1                1                1                1                1                1 
 11.199644560097 11.8177151563139  12.383382856562 12.7426098538045 13.5320753875597 13.8631845587114 14.1159208271656 
               1                1                1                1                1                1                1 
14.2071322668145 14.3140134442539  14.817899748919 14.9946701515397 15.2439189096081 15.5051277092158  15.989616149418 
               1                1                1                1                1                1                1 
16.0452635279057 16.0927774247029 16.1947203748598 16.2228619659442 16.3696120796151 16.4455909694064 16.6523626858628 
               1                1                1                1                1                1                1 
16.8576234110825 17.1063627259339 17.3301216655205 17.4520816674849 17.6730177261954 17.7137353516994 17.7755921387512 
               1                1                1                1                1                1                1 
17.8183606022586 17.8201747803163 17.8501485665444 17.9707079305316 17.9844835229676 18.0186086871637 18.0696136795774 
               1                1                1                1                1                1                1 
 18.247052539074 
               1 
 [ reached getOption("max.print") -- omitted 191 entries ]
drinkdriving$bac[drinkdriving$bac == "57.33"] <- NA
[1] 15
drinkdriving$bac[drinkdriving$bac == "65.764"] <- NA
[1] 16
table(drinkdriving$incident_id)
[1] 17

  inc_1  inc_10 inc_100 inc_101 inc_102 inc_103 inc_104 inc_105 inc_106 inc_107 inc_108 inc_109  inc_11 inc_110 inc_111 inc_112 
      1       1       1       1       1       1       1       1       1       1       1       1       1       1       1       1 
inc_113 inc_114 inc_115 inc_116 inc_117 inc_118 inc_119  inc_12 inc_120 inc_121 inc_122 inc_123 inc_124 inc_125 inc_126 inc_127 
      1       1       1       1       1       1       1       1       1       1       1       1       1       1       1       1 
inc_128 inc_129  inc_13 inc_130 inc_131 inc_132 inc_133 inc_134 inc_135 inc_136 inc_137 inc_138 inc_139  inc_14 inc_140 inc_141 
      1       1       1       1       1       1       1       1       1       1       1       1       1       1       1       1 
inc_142 inc_143 
      1       1 
 [ reached getOption("max.print") -- omitted 200 entries ]
table(drinkdriving$outcome)
[1] 18

   fine    Fine    FINE warning Warning WARNING 
    191       2       9      43       2       3 
drinkdriving$outcome[drinkdriving$outcome == "Fine"] <- "fine"
[1] 19
drinkdriving$outcome[drinkdriving$outcome == "FINE"] <- "fine"
[1] 20
drinkdriving$outcome[drinkdriving$outcome == "Warning"] <- "warning"
[1] 21
drinkdriving$outcome[drinkdriving$outcome == "WARNING"] <- "warning"
[1] 22
table(drinkdriving$outcome)
[1] 23

   fine warning 
    202      48 
table(officer_inc$officer)
[1] 24

 AS  IT  NP 
116  66  67 
table(officer_inc$incident_id)
[1] 25

  inc_1  inc_10 inc_100 inc_101 inc_102 inc_103 inc_104 inc_105 inc_106 inc_107 inc_108 inc_109  inc_11 inc_110 inc_111 inc_112 
      1       1       1       1       1       1       1       1       1       1       1       1       1       1       1       1 
inc_113 inc_114 inc_115 inc_116 inc_117 inc_118 inc_119  inc_12 inc_120 inc_121 inc_122 inc_123 inc_124 inc_125 inc_126 inc_127 
      1       1       1       1       1       1       1       1       1       1       1       1       1       1       1       1 
inc_128 inc_129  inc_13 inc_130 inc_131 inc_132 inc_133 inc_134 inc_135 inc_136 inc_137 inc_138 inc_139  inc_14 inc_140 inc_141 
      1       1       1       1       1       1       1       1       1       1       1       1       1       1       1       1 
inc_142 inc_143 
      1       1 
 [ reached getOption("max.print") -- omitted 200 entries ]
sd(drinkdriving$age, na.rm = TRUE)
[1] 26
[1] 16.76909
sd(drinkdriving$speed, na.rm = TRUE)
[1] 27
[1] 14.91462
sd(drinkdriving$bac, na.rm = TRUE)
[1] 28
[1] 6.659911
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 29
summary(m1)
[1] 30

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.3270  -4.1824  -0.5698   3.9975  14.9487 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 28.68503    1.06949   26.82  < 2e-16 ***
age         -0.13730    0.02331   -5.89 1.47e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.791 on 216 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.1384,	Adjusted R-squared:  0.1344 
F-statistic: 34.69 on 1 and 216 DF,  p-value: 1.469e-08

with(drinkdriving, plot(bac ~ age))
[1] 31
abline(lm(bac ~ age, data = drinkdriving))
[1] 32
hist(resid(m1))
[1] 33
logit_mod <- glm(bac ~ age, data = drinkdriving)
[1] 34
coef(logit_mod)
[1] 35
(Intercept)         age 
 28.6850287  -0.1373039 
predict(m1, data.frame(age = 50))
[1] 36
       1 
21.81983 
m2 <- lm(bac ~ nighttime, data = drinkdriving)
[1] 37
m2.1 <- lm(bac ~ speed, data = drinkdriving)
[1] 38
hist(resid(m2))
[1] 39
logit_mod <- glm(bac ~ nighttime, data = drinkdriving)
[1] 40
coef(logit_mod)
[1] 41
   (Intercept) nighttimenight 
     20.066692       4.721762 
hist(resid(m2.1))
[1] 42
logit_mod <- glm(bac ~ speed, data = drinkdriving)
[1] 43
coef(logit_mod)
[1] 44
(Intercept)       speed 
  15.159646    0.203351 
summary(m2)
[1] 45

Call:
lm(formula = bac ~ nighttime, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-20.8017  -4.2043   0.3896   4.4979  13.2271 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)     20.0667     0.7178  27.956  < 2e-16 ***
nighttimenight   4.7218     0.8685   5.437 1.33e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.299 on 241 degrees of freedom
  (7 observations deleted due to missingness)
Multiple R-squared:  0.1093,	Adjusted R-squared:  0.1056 
F-statistic: 29.56 on 1 and 241 DF,  p-value: 1.327e-07

summary(m2.1)
[1] 46

Call:
lm(formula = bac ~ speed, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.1525  -3.9441  -0.3248   4.2172  13.8120 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 15.15965    1.19495  12.686  < 2e-16 ***
speed        0.20335    0.02826   7.197 7.79e-12 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.055 on 241 degrees of freedom
  (7 observations deleted due to missingness)
Multiple R-squared:  0.1769,	Adjusted R-squared:  0.1735 
F-statistic: 51.79 on 1 and 241 DF,  p-value: 7.789e-12

m2.2 <- lm(bac ~ age, data = drinkdriving)
[1] 47
summary(m2.2)
[1] 48

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.3270  -4.1824  -0.5698   3.9975  14.9487 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 28.68503    1.06949   26.82  < 2e-16 ***
age         -0.13730    0.02331   -5.89 1.47e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.791 on 216 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.1384,	Adjusted R-squared:  0.1344 
F-statistic: 34.69 on 1 and 216 DF,  p-value: 1.469e-08

m3 <- lm(bac ~ outcome, data = drinkdriving)
[1] 49
logit_mod <- glm(bac ~ outcome, data = drinkdriving)
[1] 50
coef(logit_mod)
[1] 51
   (Intercept) outcomewarning 
     24.754580      -7.560515 
m3.1 <- lm(speed ~ outcome, data = drinkdriving)
[1] 52
logit_mod <- glm(speed ~ outcome, data = drinkdriving)
[1] 53
coef(logit_mod)
[1] 54
   (Intercept) outcomewarning 
      44.28552      -19.78723 
table(drinkdriving$prior_offence)
[1] 55

          CD10           CD60 CD60,CD10,DR80      CD60,CD60           DR50           DR80              N           PL10           SP50 
             2              1              1              1             43              4            185              2              2 
          SP60           TS70      TS70,DR50 
             1              3              1 
predicted_probs <- exp(drinkdriving$speed)/(1 + exp(drinkdriving$speed))
[1] 56
predicted_probs <- exp(drinkdriving$bac)/(1 + exp(drinkdriving$bac))
[1] 57
m3.2 <- glm(bac ~ outcome + prior_offence + nighttime + speed + 
    age, data = drinkdriving)
[1] 58
summary(m3.2)
[1] 59

Call:
glm(formula = bac ~ outcome + prior_offence + nighttime + speed + 
    age, data = drinkdriving)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-13.5926   -3.9547   -0.1023    3.3815   12.5112  

Coefficients:
                       Estimate Std. Error t value Pr(>|t|)    
(Intercept)            18.04390    4.86525   3.709  0.00027 ***
outcomewarning         -5.89065    1.30568  -4.512 1.10e-05 ***
prior_offenceCD60      12.18583    6.98080   1.746  0.08241 .  
prior_offenceDR50       5.93194    4.04383   1.467  0.14397    
prior_offenceDR80       6.88716    4.90867   1.403  0.16215    
prior_offenceN          6.36810    3.98674   1.597  0.11177    
prior_offencePL10       2.41611    5.42312   0.446  0.65643    
prior_offenceSP50       6.50797    5.61608   1.159  0.24792    
prior_offenceSP60      14.97900    6.81071   2.199  0.02900 *  
prior_offenceTS70       8.62327    5.42752   1.589  0.11368    
 [ reached getOption("max.print") -- omitted 4 rows ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for gaussian family taken to be 28.70565)

    Null deviance: 8364.1  on 213  degrees of freedom
Residual deviance: 5741.1  on 200  degrees of freedom
  (36 observations deleted due to missingness)
AIC: 1341.2

Number of Fisher Scoring iterations: 2

with(drinkdriving, plot(m3.2))
[1] 60
abline(lm(m3.2, data = drinkdriving))
[1] 61
data2 <- data.frame(age = c(17, 18, 19, 20, 21, 22), nighttime = "day", 
    speed = 30, bac = 0, prior_offence = "none")
[1] 62
data2 <- lm(age ~ outcome, data = drinkdriving)
[1] 63
summary(data2)
[1] 64

Call:
lm(formula = age ~ outcome, data = drinkdriving)

Residuals:
   Min     1Q Median     3Q    Max 
-42.59  -9.32  -0.32   8.68  47.68 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)      38.320      1.061  36.119   <2e-16 ***
outcomewarning   22.270      2.399   9.283   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 14.27 on 223 degrees of freedom
  (25 observations deleted due to missingness)
Multiple R-squared:  0.2787,	Adjusted R-squared:  0.2755 
F-statistic: 86.16 on 1 and 223 DF,  p-value: < 2.2e-16

with(drinkdriving, plot(data2))
[1] 65
abline(lm(age ~ outcome, data = drinkdriving))
[1] 66
data3 <- data.frame(drinkdriving, officer_inc)
[1] 67
summary(data3)
[1] 68
      age         nighttime         prior_offence          speed             bac           outcome          incident_id       
 Min.   :14.00   Length:250         Length:250         Min.   :  0.00   Min.   : 3.987   Length:250         Length:250        
 1st Qu.:30.00   Class :character   Class :character   1st Qu.: 30.92   1st Qu.:19.215   Class :character   Class :character  
 Median :40.00   Mode  :character   Mode  :character   Median : 40.64   Median :23.504   Mode  :character   Mode  :character  
 Mean   :42.68                                         Mean   : 40.49   Mean   :23.292                                        
 3rd Qu.:55.00                                         3rd Qu.: 48.84   3rd Qu.:27.789                                        
 officer    incident_id.1
 AS  :116   inc_1  :  1  
 IT  : 66   inc_10 :  1  
 NP  : 67   inc_100:  1  
 NA's:  1   inc_101:  1  
            inc_102:  1  
 [ reached getOption("max.print") -- omitted 2 rows ]
m4 <- lm(age ~ outcome + officer, data = data3)
[1] 69
summary(m4)
[1] 70

Call:
lm(formula = age ~ outcome + officer, data = data3)

Residuals:
    Min      1Q  Median      3Q     Max 
-44.381  -8.410  -0.911   7.779  49.503 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)      39.911      1.450  27.521   <2e-16 ***
outcomewarning   22.470      2.387   9.412   <2e-16 ***
officerIT        -3.414      2.345  -1.456    0.147    
officerNP        -3.171      2.270  -1.397    0.164    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 14.19 on 220 degrees of freedom
  (26 observations deleted due to missingness)
Multiple R-squared:  0.2927,	Adjusted R-squared:  0.2831 
F-statistic: 30.35 on 3 and 220 DF,  p-value: < 2.2e-16

anova(m4)
[1] 71
Analysis of Variance Table

Response: age
           Df Sum Sq Mean Sq F value Pr(>F)    
outcome     1  17735 17735.2 88.0514 <2e-16 ***
officer     2    605   302.4  1.5011 0.2252    
Residuals 220  44312   201.4                   
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
logit_mod <- glm(age ~ outcome + officer, data = data3)
[1] 72
coef(logit_mod)
[1] 73
   (Intercept) outcomewarning      officerIT      officerNP 
     39.911295      22.470138      -3.414358      -3.171162 
with(data3, plot(m4))
[1] 74
abline(lm(m4, data = data3))
[1] 75
