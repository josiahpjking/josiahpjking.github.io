

	####### B152882 R script #######

library(ggplot2, quietly = T)
[1] 1
[1] "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(psych, quietly = T)
[1] 2
 [1] "psych"     "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
load(url("https://edin.ac/2QCZNVu"))
[1] 3
[1] "drinkdriving" "officer_inc" 
table(drinkdriving$outcome)
[1] 4

   fine    Fine    FINE warning Warning WARNING 
    191       2       9      43       2       3 
drinkdriving$outcome[drinkdriving$outcome == "Fine"] <- "fine"
[1] 5
drinkdriving$outcome[drinkdriving$outcome == "FINE"] <- "fine"
[1] 6
drinkdriving$outcome[drinkdriving$outcome == "Warning"] <- "warning"
[1] 7
drinkdriving$outcome[drinkdriving$outcome == "WARNING"] <- "warning"
[1] 8
drinkdriving$outcome <- as.factor(drinkdriving$outcome)
[1] 9
is.factor(drinkdriving$outcome)
[1] 10
[1] TRUE
table(drinkdriving$nighttime)
[1] 11

18:25  2:05   day night 
    1     2    78   169 
drinkdriving$nighttime[drinkdriving$nighttime == "18:25"] <- NA
[1] 12
drinkdriving$nighttime[drinkdriving$nighttime == "2:05"] <- NA
[1] 13
drinkdriving$nighttime <- as.factor(drinkdriving$nighttime)
[1] 14
is.factor(drinkdriving$nighttime)
[1] 15
[1] TRUE
typeof(drinkdriving$nighttime)
[1] 16
[1] "integer"
table(drinkdriving$age)
[1] 17

14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 
 1  5  2  3  1  2  3  6  2  5  8  3  2  2  5  4  4  4  6  5  9  8  3  4  2 10  5  6  5  3  2  3  4  5  2  3  3  3  6  3  5  4 
56 57 58 59 60 61 62 63 
 3  4  4  1  5  3  3  2 
 [ reached getOption("max.print") -- omitted 15 entries ]
boxplot(drinkdriving$age)
[1] 18
typeof(drinkdriving$age)
[1] 19
[1] "double"
drinkdriving$age[drinkdriving$age > 100] <- NA
[1] 20
boxplot(drinkdriving$bac)
[1] 21
drinkdriving$bac <- drinkdriving$bac/100
[1] 22
table(drinkdriving$bac)
[1] 23

0.0398678518191804 0.0545295079276351 0.0561849660215689 0.0639815180420771 0.0645232354218363 0.0855241944417923 
                 1                  1                  1                  1                  1                  1 
0.0916715954067682 0.0925348198083096 0.0949752435423211 0.0981747807144744  0.100454646939566  0.102699286970084 
                 1                  1                  1                  1                  1                  1 
 0.104971185812798  0.106649017352481   0.11199644560097  0.118177151563139   0.12383382856562  0.127426098538045 
                 1                  1                  1                  1                  1                  1 
 0.135320753875597  0.138631845587114  0.141159208271656  0.142071322668145  0.143140134442539   0.14817899748919 
                 1                  1                  1                  1                  1                  1 
 0.149946701515397  0.152439189096081  0.155051277092158   0.15989616149418  0.160452635279057  0.160927774247029 
                 1                  1                  1                  1                  1                  1 
 0.161947203748598  0.162228619659442  0.163696120796151  0.164455909694064  0.166523626858628  0.168576234110825 
                 1                  1                  1                  1                  1                  1 
 0.171063627259339  0.173301216655205  0.174520816674849  0.176730177261954  0.177137353516994  0.177755921387512 
                 1                  1                  1                  1                  1                  1 
 0.178183606022586  0.178201747803163  0.178501485665444  0.179707079305316  0.179844835229676  0.180186086871637 
                 1                  1                  1                  1                  1                  1 
 0.180696136795774   0.18247052539074 
                 1                  1 
 [ reached getOption("max.print") -- omitted 191 entries ]
drinkdriving$outcome[drinkdriving$bac > 0.5]
[1] 24
[1] <NA> <NA> fine <NA> <NA> fine <NA>
Levels: fine warning
boxplot(drinkdriving$speed)
[1] 25
table(drinkdriving$speed)
[1] 26

               0 1.01214942316415 1.94581782932169 2.53346827328845  11.225704630299 12.2462058630265 12.8128465751594 
               1                1                1                1                1                1                1 
12.9030158165279 12.9155695510693 13.0698049123235 14.3668291368723 15.5710258293839 17.0590138838127  17.221097497513 
               1                1                1                1                1                1                1 
18.2934932399405 19.0089940620951 19.2697316282316 20.2107015627382 21.3069195145607 21.4908339004998 21.8064434744078 
               1                1                1                1                1                1                1 
 22.568562604335 22.5952898516689 22.6424298724575  23.182415928645 23.5805503449787 23.5994274112678 24.4877988273931 
               1                1                1                1                1                1                1 
24.5215840561896 24.5611037960359 24.8285320808304 24.9172566024629 24.9907200841348 25.0453443973611 25.0548611219096 
               1                1                1                1                1                1                1 
25.2710211226397 25.5417854203194 25.5936767268247 25.7485090547557 25.9105706027961   25.98459487588 26.2055631685057 
               1                1                1                1                1                1                1 
 26.414446768112 26.6813905027214 26.6979134850146 27.0661842358492 28.5530416886726 28.6993802422867 28.7242755318064 
               1                1                1                1                1                1                1 
28.8107670431613 
               1 
 [ reached getOption("max.print") -- omitted 200 entries ]
drinkdriving$speed_orig <- drinkdriving$speed
[1] 27
drinkdriving$speed[drinkdriving$speed > 75] <- NA
[1] 28
drinkdriving$incident_id <- as.factor(drinkdriving$incident_id)
[1] 29
is.factor(drinkdriving$incident_id)
[1] 30
[1] TRUE
drinkdriving$incident_id
[1] 31
 [1] inc_1  inc_2  inc_3  inc_4  inc_5  inc_6  inc_7  inc_8  inc_9  inc_10 inc_11 inc_12 inc_13 inc_14 inc_15 inc_16 inc_17
[18] inc_18 inc_19 inc_20 inc_21 inc_22 inc_23 inc_24 inc_25 inc_26 inc_27 inc_28 inc_29 inc_30 inc_31 inc_32 inc_33 inc_34
[35] inc_35 inc_36 inc_37 inc_38 inc_39 inc_40 inc_41 inc_42 inc_43 inc_44 inc_45 inc_46 inc_47 inc_48 inc_49 inc_50
 [ reached getOption("max.print") -- omitted 200 entries ]
250 Levels: inc_1 inc_10 inc_100 inc_101 inc_102 inc_103 inc_104 inc_105 inc_106 inc_107 inc_108 inc_109 inc_11 ... inc_99
drinkdriving$prior_offence_binary <- TRUE
[1] 32
drinkdriving$prior_offence_binary[drinkdriving$prior_offence == 
    "N"] <- FALSE
[1] 33
table(drinkdriving$prior_offence_binary)
[1] 34

FALSE  TRUE 
  185    65 
drinkdriving$prior_offence_binary <- as.factor(drinkdriving$prior_offence_binary)
[1] 35
is.factor(drinkdriving$prior_offence_binary)
[1] 36
[1] TRUE
drinkdriving$drinking_offence_binary <- FALSE
[1] 37
drinkdriving$drinking_offence_binary[drinkdriving$prior_offence == 
    "DR50"] <- TRUE
[1] 38
drinkdriving$drinking_offence_binary[drinkdriving$prior_offence == 
    "TS70,DR50"] <- TRUE
[1] 39
table(drinkdriving$drinking_offence_binary)
[1] 40

FALSE  TRUE 
  206    44 
drinkdriving$drinking_offence_binary <- as.factor(drinkdriving$drinking_offence_binary)
[1] 41
is.factor(drinkdriving$drinking_offence_binary)
[1] 42
[1] TRUE
describe(drinkdriving)
[1] 43
               vars   n  mean    sd median trimmed   mad min  max range  skew kurtosis   se
age               1 225 42.68 16.77     40   41.93 17.79  14   90    76  0.40    -0.52 1.12
nighttime*        2 247  1.68  0.47      2    1.73  0.00   1    2     1 -0.79    -1.38 0.03
prior_offence*    3 250   NaN    NA     NA     NaN    NA Inf -Inf  -Inf    NA       NA   NA
 [ reached 'max' / getOption("max.print") -- omitted 7 rows ]
summary(drinkdriving)
[1] 44
      age        nighttime   prior_offence          speed            bac             outcome     incident_id    speed_orig    
 Min.   :14.00   day  : 78   Length:250         Min.   : 0.00   Min.   :0.03987   fine   :202   inc_1  :  1   Min.   :  0.00  
 1st Qu.:30.00   night:169   Class :character   1st Qu.:30.63   1st Qu.:0.19264   warning: 48   inc_10 :  1   1st Qu.: 30.92  
 Median :40.00   NA's :  3   Mode  :character   Median :40.49   Median :0.23609                 inc_100:  1   Median : 40.64  
 Mean   :42.68                                  Mean   :39.86   Mean   :0.23605                 inc_101:  1   Mean   : 40.49  
 3rd Qu.:55.00                                  3rd Qu.:48.65   3rd Qu.:0.27898                 inc_102:  1   3rd Qu.: 48.84  
 prior_offence_binary drinking_offence_binary
 FALSE:185            FALSE:206              
 TRUE : 65            TRUE : 44              
                                             
                                             
                                             
 [ reached getOption("max.print") -- omitted 2 rows ]
drinkdriving$incident_id[is.na(drinkdriving$officer)]
[1] 45
factor(0)
250 Levels: inc_1 inc_10 inc_100 inc_101 inc_102 inc_103 inc_104 inc_105 inc_106 inc_107 inc_108 inc_109 inc_11 ... inc_99
drinkdriving <- merge(drinkdriving, officer_inc, all = T)
[1] 46
officer_inc$officer[officer_inc$incident_id == "inc_125"]
[1] 47
[1] IT
Levels: AS IT NP
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 48
summary(m1)
[1] 49

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.15719 -0.04516 -0.00861  0.03849  0.42785 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.2929455  0.0125564  23.330  < 2e-16 ***
age         -0.0014353  0.0002741  -5.236 3.86e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.0682 on 218 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1117,	Adjusted R-squared:  0.1076 
F-statistic: 27.41 on 1 and 218 DF,  p-value: 3.863e-07

plot(m1)
[1] 50
plot(bac ~ age, data = drinkdriving)
[1] 51
abline(m1)
[1] 52
new.ages <- data.frame(age = c(50))
[1] 53
predict(m1, newdata = new.ages)
[1] 54
        1 
0.2211824 
plot(m1, which = 2)
[1] 55
plot(density(residuals(m1)))
[1] 56
m2 <- lm(bac ~ age + nighttime, data = drinkdriving)
[1] 57
m3 <- lm(bac ~ age + speed, data = drinkdriving)
[1] 58
m4 <- lm(bac ~ age + speed_orig, data = drinkdriving)
[1] 59
anova(m2)
[1] 60
Analysis of Variance Table

Response: bac
           Df  Sum Sq  Mean Sq F value    Pr(>F)    
age         1 0.14178 0.141777  33.059 3.042e-08 ***
nighttime   1 0.06205 0.062050  14.469 0.0001857 ***
Residuals 215 0.92205 0.004289                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
anova(m3)
[1] 61
Analysis of Variance Table

Response: bac
           Df  Sum Sq  Mean Sq F value    Pr(>F)    
age         1 0.11631 0.116314 34.6961 1.471e-08 ***
speed       1 0.00355 0.003550  1.0589    0.3046    
Residuals 215 0.72076 0.003352                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
anova(m4)
[1] 62
Analysis of Variance Table

Response: bac
            Df  Sum Sq  Mean Sq F value    Pr(>F)    
age          1 0.12748 0.127483  30.197 1.089e-07 ***
speed_orig   1 0.09774 0.097744  23.153 2.800e-06 ***
Residuals  217 0.91611 0.004222                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
[1] 2.2
[1] 63
[1] 2.2
summary(m2)
[1] 64

Call:
lm(formula = bac ~ age + nighttime, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.16496 -0.04662  0.00064  0.03580  0.41650 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.2684005  0.0142227  18.871  < 2e-16 ***
age            -0.0014435  0.0002664  -5.418 1.61e-07 ***
nighttimenight  0.0362565  0.0095318   3.804 0.000186 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.06549 on 215 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.181,	Adjusted R-squared:  0.1734 
F-statistic: 23.76 on 2 and 215 DF,  p-value: 4.741e-10

summary(m3)
[1] 65

Call:
lm(formula = bac ~ age + speed, data = drinkdriving)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.154118 -0.038926 -0.006094  0.041298  0.144229 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.2608699  0.0274183   9.514  < 2e-16 ***
age         -0.0011540  0.0003156  -3.656 0.000322 ***
speed        0.0004320  0.0004198   1.029 0.304616    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.0579 on 215 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.1426,	Adjusted R-squared:  0.1346 
F-statistic: 17.88 on 2 and 215 DF,  p-value: 6.574e-08

summary(m4)
[1] 66

Call:
lm(formula = bac ~ age + speed_orig, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.15970 -0.04446 -0.00690  0.04282  0.34575 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.1749660  0.0272820   6.413 8.78e-10 ***
age         -0.0004303  0.0003344  -1.287      0.2    
speed_orig   0.0019235  0.0003998   4.812 2.80e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.06497 on 217 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1973,	Adjusted R-squared:  0.1899 
F-statistic: 26.68 on 2 and 217 DF,  p-value: 4.384e-11

plot(m2)
[1] 67
plot(m3)
[1] 68
plot(m4)
[1] 69
plot(cooks.distance(m2))
[1] 70
plot(cooks.distance(m3))
[1] 71
plot(cooks.distance(m4))
[1] 72
m5 <- lm(speed_orig ~ nighttime, data = drinkdriving)
[1] 73
summary(m5)
[1] 74

Call:
lm(formula = speed_orig ~ nighttime, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-40.853  -9.305   0.157   8.213  81.032 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)      39.305      1.691  23.240   <2e-16 ***
nighttimenight    1.548      2.045   0.757     0.45    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 14.94 on 245 degrees of freedom
  (3 observations deleted due to missingness)
Multiple R-squared:  0.002333,	Adjusted R-squared:  -0.001739 
F-statistic: 0.573 on 1 and 245 DF,  p-value: 0.4498

plot(m5)
[1] 75
plot(density(residuals(m5)))
[1] 76
plot(speed_orig ~ nighttime, data = drinkdriving)
[1] 77
drinkdriving$outcome_num <- 0
[1] 78
drinkdriving$outcome_num[drinkdriving$outcome == "fine"] <- 1
[1] 79
with(drinkdriving, plot(jitter(outcome_num) ~ speed_orig, axes = F))
[1] 80
axis(2, at = c(0, 1), labels = c("warning", "fine"))
[1] 81
[1] 0 1
axis(1)
[1] 82
[1]   0  20  40  60  80 100 120
with(drinkdriving, plot(jitter(outcome_num) ~ bac, axes = F))
[1] 83
axis(2, at = c(0, 1), labels = c("warning", "fine"))
[1] 84
[1] 0 1
axis(1)
[1] 85
[1] 0.1 0.2 0.3 0.4 0.5 0.6
with(drinkdriving, plot(jitter(outcome_num) ~ age, axes = F))
[1] 86
axis(2, at = c(0, 1), labels = c("warning", "fine"))
[1] 87
[1] 0 1
axis(1)
[1] 88
[1] 20 40 60 80
m6 <- glm(outcome ~ speed_orig, data = drinkdriving, family = binomial)
[1] 89
summary(m6)
[1] 90

Call:
glm(formula = outcome ~ speed_orig, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.8448  -0.5194  -0.2415  -0.0740   3.4793  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  3.98066    0.76467   5.206 1.93e-07 ***
speed_orig  -0.15929    0.02387  -6.673 2.50e-11 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 244.56  on 249  degrees of freedom
Residual deviance: 153.41  on 248  degrees of freedom
AIC: 157.41

Number of Fisher Scoring iterations: 6

plot(m6)
[1] 91
y <- fitted(m6)
[1] 92
plot(y[order(drinkdriving$speed_orig)] ~ drinkdriving$speed_orig[order(drinkdriving$speed_orig)], 
    xlab = "speed", ylab = "p(outcome)", type = "l", col = "red", 
    lwd = 2)
[1] 93
points(drinkdriving$outcome_num ~ drinkdriving$speed_orig)
[1] 94
NULL
anova(m6)
[1] 95
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


           Df Deviance Resid. Df Resid. Dev
NULL                         249     244.56
speed_orig  1   91.149       248     153.41
m7 <- glm(outcome ~ age, data = drinkdriving, family = binomial)
[1] 96
y1 <- fitted(m7)
[1] 97
plot(y1[order(drinkdriving$age)] ~ drinkdriving$age[order(drinkdriving$age)], 
    xlab = "age", ylab = "p(outcome)", type = "l", col = "red", 
    lwd = 2)
[1] 98
points(drinkdriving$outcome_num ~ drinkdriving$age)
[1] 99
NULL
anova(m7)
[1] 100
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


     Df Deviance Resid. Df Resid. Dev
NULL                   224     222.38
age   1   67.728       223     154.65
anova(m7, test = "Chisq")
[1] 101
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


     Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                   224     222.38              
age   1   67.728       223     154.65 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m7)
[1] 102

Call:
glm(formula = outcome ~ age, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1778  -0.5106  -0.2993  -0.1488   3.0363  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -6.41889    0.87727  -7.317 2.54e-13 ***
age          0.10107    0.01577   6.408 1.48e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 222.38  on 224  degrees of freedom
Residual deviance: 154.65  on 223  degrees of freedom
  (25 observations deleted due to missingness)
AIC: 158.65

Number of Fisher Scoring iterations: 6

m8 <- glm(outcome ~ bac, data = drinkdriving, family = binomial)
[1] 103
y <- fitted(m8)
[1] 104
plot(y[order(drinkdriving$bac)] ~ drinkdriving$bac[order(drinkdriving$bac)], 
    xlab = "bac", ylab = "p(outcome)", type = "l", col = "red", 
    lwd = 2)
[1] 105
points(drinkdriving$outcome_num ~ drinkdriving$bac)
[1] 106
NULL
anova(m8)
[1] 107
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


     Df Deviance Resid. Df Resid. Dev
NULL                   244     239.55
bac   1   52.512       243     187.04
anova(m8, test = "Chisq")
[1] 108
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


     Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                   244     239.55              
bac   1   52.512       243     187.04 4.277e-13 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m8)
[1] 109

Call:
glm(formula = outcome ~ bac, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.6649  -0.6480  -0.4041  -0.2026   2.9866  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)   2.8177     0.6843   4.118 3.83e-05 ***
bac         -20.1061     3.3405  -6.019 1.76e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 239.55  on 244  degrees of freedom
Residual deviance: 187.04  on 243  degrees of freedom
  (5 observations deleted due to missingness)
AIC: 191.04

Number of Fisher Scoring iterations: 5

m9 <- glm(outcome ~ speed + bac + age + nighttime + prior_offence_binary, 
    data = drinkdriving, family = binomial)
[1] 110
anova(m9, test = "Chisq")
[1] 111
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


                     Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                                   215     215.62              
speed                 1   78.016       214     137.60 < 2.2e-16 ***
bac                   1   25.836       213     111.77 3.717e-07 ***
age                   1    5.522       212     106.24   0.01878 *  
nighttime             1    0.029       211     106.22   0.86589    
prior_offence_binary  1    0.392       210     105.82   0.53112    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m9)
[1] 112

Call:
glm(formula = outcome ~ speed + bac + age + nighttime + prior_offence_binary, 
    family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.2047  -0.3888  -0.1439  -0.0336   3.6056  

Coefficients:
                          Estimate Std. Error z value Pr(>|z|)    
(Intercept)                4.80581    2.21298   2.172 0.029882 *  
speed                     -0.13554    0.03361  -4.033 5.51e-05 ***
bac                      -19.64392    5.23600  -3.752 0.000176 ***
age                        0.04682    0.02054   2.280 0.022630 *  
nighttimenight             0.14089    0.56396   0.250 0.802727    
prior_offence_binaryTRUE  -0.37610    0.60754  -0.619 0.535884    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 215.62  on 215  degrees of freedom
Residual deviance: 105.82  on 210  degrees of freedom
  (34 observations deleted due to missingness)
AIC: 117.82

Number of Fisher Scoring iterations: 7

m9_mod <- glm(outcome ~ speed + bac + age, data = drinkdriving, 
    family = binomial)
[1] 113
anova(m9_mod, test = "Chisq")
[1] 114
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


      Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                    217     216.50              
speed  1   78.643       216     137.86 < 2.2e-16 ***
bac    1   26.067       215     111.79 3.298e-07 ***
age    1    5.484       214     106.31   0.01919 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m9_mod)
[1] 115

Call:
glm(formula = outcome ~ speed + bac + age, family = binomial, 
    data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.3380  -0.3674  -0.1570  -0.0329   3.5396  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept)   4.87364    2.16854   2.247   0.0246 *  
speed        -0.13857    0.03343  -4.146 3.39e-05 ***
bac         -19.23137    4.88005  -3.941 8.12e-05 ***
age           0.04566    0.01996   2.287   0.0222 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 216.50  on 217  degrees of freedom
Residual deviance: 106.31  on 214  degrees of freedom
  (32 observations deleted due to missingness)
AIC: 114.31

Number of Fisher Scoring iterations: 7

m12 <- glm(outcome_num ~ scale(speed_orig), data = drinkdriving, 
    family = binomial)
[1] 116
summary(m12)
[1] 117

Call:
glm(formula = outcome_num ~ scale(speed_orig), family = binomial, 
    data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.4793   0.0740   0.2415   0.5194   1.8448  

Coefficients:
                  Estimate Std. Error z value Pr(>|z|)    
(Intercept)          2.469      0.308   8.016 1.09e-15 ***
scale(speed_orig)    2.376      0.356   6.673 2.50e-11 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 244.56  on 249  degrees of freedom
Residual deviance: 153.41  on 248  degrees of freedom
AIC: 157.41

Number of Fisher Scoring iterations: 6

m13 <- glm(outcome_num ~ scale(bac), data = drinkdriving, family = binomial)
[1] 118
summary(m13)
[1] 119

Call:
glm(formula = outcome_num ~ scale(bac), family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.9866   0.2026   0.4041   0.6480   1.6649  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)   1.9283     0.2263   8.522  < 2e-16 ***
scale(bac)    1.5051     0.2501   6.019 1.76e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 239.55  on 244  degrees of freedom
Residual deviance: 187.04  on 243  degrees of freedom
  (5 observations deleted due to missingness)
AIC: 191.04

Number of Fisher Scoring iterations: 5

exp(coef(m12)[1])
[1] 120
(Intercept) 
   11.80561 
exp(coef(m12)[1] + coef(m12)[2])
[1] 121
(Intercept) 
   127.0251 
exp(coef(m13)[1])
[1] 122
(Intercept) 
   6.877745 
exp(coef(m13)[1] + coef(m13)[2])
[1] 123
(Intercept) 
   30.98026 
m10 <- glm(outcome ~ drinking_offence_binary, data = drinkdriving, 
    family = binomial)
[1] 124
anova(m10, test = "Chisq")
[1] 125
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


                        Df Deviance Resid. Df Resid. Dev Pr(>Chi)  
NULL                                      249     244.56           
drinking_offence_binary  1    4.052       248     240.50  0.04412 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m11 <- glm(outcome ~ prior_offence_binary, data = drinkdriving, 
    family = binomial)
[1] 126
anova(m11, test = "Chisq")
[1] 127
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


                     Df Deviance Resid. Df Resid. Dev Pr(>Chi)
NULL                                   249     244.56         
prior_offence_binary  1  0.29974       248     244.25    0.584
new.data <- data.frame(age = c(17:100), speed = replicate(84, 
    30), bac = replicate(84, 0))
[1] 128
new.data$warning_prob <- predict(m9_mod, newdata = new.data, 
    type = "response")
[1] 129
new.data$fine_prob <- replicate(84, 1) - new.data$warning_prob
[1] 130
plot(new.data$age, new.data$fine_prob, xlab = "age", ylab = "likelihood of fine", 
    type = "l")
[1] 131
m14 <- glm(outcome ~ age, data = drinkdriving, family = binomial)
[1] 132
anova(m14, test = "Chisq")
[1] 133
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


     Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                   224     222.38              
age   1   67.728       223     154.65 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m15 <- glm(outcome ~ age + officer, data = drinkdriving, family = binomial)
[1] 134
anova(m15, test = "Chisq")
[1] 135
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


        Df Deviance Resid. Df Resid. Dev Pr(>Chi)    
NULL                      224     222.38             
age      1   67.728       223     154.65   <2e-16 ***
officer  2    0.861       221     153.79   0.6501    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
ITdf <- drinkdriving[drinkdriving$officer == "IT", ]
[1] 136
ASdf <- drinkdriving[drinkdriving$officer == "AS", ]
[1] 137
NPdf <- drinkdriving[drinkdriving$officer == "NP", ]
[1] 138
summary(ITdf)
[1] 139
  incident_id      age       nighttime  prior_offence          speed            bac             outcome     speed_orig   
 inc_107: 1   Min.   :15.0   day  :18   Length:67          Min.   :12.25   Min.   :0.06398   fine   :54   Min.   :12.25  
 inc_108: 1   1st Qu.:34.0   night:48   Class :character   1st Qu.:30.11   1st Qu.:0.20548   warning:12   1st Qu.:30.11  
 inc_111: 1   Median :44.5   NA's : 1   Mode  :character   Median :40.16   Median :0.25094   NA's   : 1   Median :40.38  
 inc_112: 1   Mean   :44.6                                 Mean   :41.12   Mean   :0.24521                Mean   :42.25  
 prior_offence_binary drinking_offence_binary officer    outcome_num    
 FALSE:45             FALSE:52                AS  : 0   Min.   :0.0000  
 TRUE :21             TRUE :14                IT  :66   1st Qu.:1.0000  
 NA's : 1             NA's : 1                NP  : 0   Median :1.0000  
                                              NA's: 1   Mean   :0.8182  
 [ reached getOption("max.print") -- omitted 3 rows ]
summary(ASdf)
[1] 140
  incident_id       age        nighttime  prior_offence          speed             bac             outcome     speed_orig     
 inc_1  :  1   Min.   :14.00   day  :37   Length:117         Min.   : 1.012   Min.   :0.03987   fine   :91   Min.   :  1.012  
 inc_10 :  1   1st Qu.:27.00   night:77   Class :character   1st Qu.:30.341   1st Qu.:0.18531   warning:25   1st Qu.: 30.440  
 inc_100:  1   Median :39.00   NA's : 3   Mode  :character   Median :41.009   Median :0.22758   NA's   : 1   Median : 41.009  
 inc_102:  1   Mean   :40.94                                 Mean   :38.907   Mean   :0.22808                Mean   : 39.609  
 prior_offence_binary drinking_offence_binary officer     outcome_num    
 FALSE:88             FALSE:96                AS  :116   Min.   :0.0000  
 TRUE :28             TRUE :20                IT  :  0   1st Qu.:1.0000  
 NA's : 1             NA's : 1                NP  :  0   Median :1.0000  
                                              NA's:  1   Mean   :0.7845  
 [ reached getOption("max.print") -- omitted 3 rows ]
summary(NPdf)
[1] 141
  incident_id      age        nighttime  prior_offence          speed            bac             outcome     speed_orig   
 inc_101: 1   Min.   :17.00   day  :23   Length:68          Min.   : 0.00   Min.   :0.08552   fine   :57   Min.   : 0.00  
 inc_103: 1   1st Qu.:34.00   night:43   Class :character   1st Qu.:34.13   1st Qu.:0.19676   warning:10   1st Qu.:34.13  
 inc_104: 1   Median :41.00   NA's : 2   Mode  :character   Median :40.41   Median :0.23402   NA's   : 1   Median :40.41  
 inc_106: 1   Mean   :43.95                                 Mean   :39.93   Mean   :0.23886                Mean   :39.93  
 prior_offence_binary drinking_offence_binary officer    outcome_num    
 FALSE:52             FALSE:57                AS  : 0   Min.   :0.0000  
 TRUE :15             TRUE :10                IT  : 0   1st Qu.:1.0000  
 NA's : 1             NA's : 1                NP  :67   Median :1.0000  
                                              NA's: 1   Mean   :0.8507  
 [ reached getOption("max.print") -- omitted 3 rows ]
plot(age ~ officer, data = drinkdriving)
[1] 142
m16 <- glm(outcome ~ age, data = ASdf, family = binomial)
[1] 143
anova(m16, test = "Chisq")
[1] 144
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


     Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                   107    109.187              
age   1    59.14       106     50.047 1.468e-14 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
plot(m16, which = 4)
[1] 145
m17 <- glm(outcome ~ age, data = ITdf, family = binomial)
[1] 146
anova(m17, test = "Chisq")
[1] 147
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


     Df Deviance Resid. Df Resid. Dev Pr(>Chi)   
NULL                    57     59.139            
age   1        9        56     50.139   0.0027 **
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m18 <- glm(outcome ~ age, data = NPdf, family = binomial)
[1] 148
anova(m18, test = "Chisq")
[1] 149
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


     Df Deviance Resid. Df Resid. Dev Pr(>Chi)   
NULL                    58     53.699            
age   1   7.4755        57     46.224 0.006254 **
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
