

	####### B067733 R script #######

rm(list = ls())
[1] 1
outliers <- function(obs, x = 2.5) {
    return(which(abs(scale(obs)) > mean(scale(obs), na.rm = T) + 
        x * sd(scale(obs), na.rm = T)))
}
[1] 2
"%ni%" <- Negate("%in%")
[1] 3
package_list <- c("ggplot2", "tidyverse", "forcats", "gvlma")
[1] 4
for (package in package_list) {
    if (package %ni% installed.packages()) {
        print("intalling and loading")
        print(package)
        install.packages(package)
    }
    else {
        print(package)
        print("is already installed and will be loaded")
    }
}
[1] 5
[1] "ggplot2"
[1] "is already installed and will be loaded"
[1] "tidyverse"
[1] "is already installed and will be loaded"
[1] "forcats"
[1] "is already installed and will be loaded"
[1] "gvlma"
[1] "is already installed and will be loaded"
NULL
rm(package_list, package)
[1] 6
require(ggplot2, quietly = T)
[1] 7
[1] TRUE
require(tidyverse, quietly = T)
[1] 8
[1] TRUE
require(forcats, quietly = T)
[1] 9
[1] TRUE
require(gvlma, quietly = T)
[1] 10
[1] TRUE
load(url("https://edin.ac/2QCZNVu"))
[1] 11
[1] "drinkdriving" "officer_inc" 
drinkdriving <- as_tibble(drinkdriving)
[1] 12
officer_inc <- as_tibble(officer_inc)
[1] 13
summary(drinkdriving)
[1] 14
      age          nighttime         prior_offence          speed             bac           outcome          incident_id       
 Min.   : 14.00   Length:250         Length:250         Min.   :  0.00   Min.   : 3.987   Length:250         Length:250        
 1st Qu.: 30.00   Class :character   Class :character   1st Qu.: 30.92   1st Qu.:19.264   Class :character   Class :character  
 Median : 40.50   Mode  :character   Mode  :character   Median : 40.64   Median :23.609   Mode  :character   Mode  :character  
 Mean   : 46.00                                         Mean   : 40.49   Mean   :23.605                                        
 3rd Qu.: 55.25                                         3rd Qu.: 48.84   3rd Qu.:27.898                                        
 Max.   :297.00                                         Max.   :120.34   Max.   :65.764                                        
 NA's   :22                                                              NA's   :5                                             
summary(officer_inc)
[1] 15
 officer     incident_id 
 AS  :116   inc_1  :  1  
 IT  : 66   inc_10 :  1  
 NP  : 67   inc_100:  1  
 NA's:  1   inc_101:  1  
            inc_102:  1  
            inc_103:  1  
            (Other):244  
drinkdriving <- drinkdriving %>% mutate(nighttime = as.factor(nighttime), 
    nighttime = fct_recode(nighttime, day = "18:25", night = "2:05"), 
    prior_offence = as.factor(prior_offence), outcome = as.factor(outcome), 
    outcome = fct_recode(outcome, fine = "Fine", fine = "FINE", 
        warning = "Warning", warning = "WARNING"), incident_id = as.factor(incident_id), 
    bac = bac/100)
[1] 16
summary(drinkdriving)
[1] 17
      age         nighttime   prior_offence     speed             bac             outcome     incident_id 
 Min.   : 14.00   day  : 79   N      :185   Min.   :  0.00   Min.   :0.03987   fine   :202   inc_1  :  1  
 1st Qu.: 30.00   night:171   DR50   : 43   1st Qu.: 30.92   1st Qu.:0.19264   warning: 48   inc_10 :  1  
 Median : 40.50               DD20   :  4   Median : 40.64   Median :0.23609                 inc_100:  1  
 Mean   : 46.00               DR80   :  4   Mean   : 40.49   Mean   :0.23605                 inc_101:  1  
 3rd Qu.: 55.25               TS70   :  3   3rd Qu.: 48.84   3rd Qu.:0.27898                 inc_102:  1  
 Max.   :297.00               CD10   :  2   Max.   :120.34   Max.   :0.65764                 inc_103:  1  
 NA's   :22                   (Other):  9                    NA's   :5                       (Other):244  
dd_merged <- full_join(drinkdriving, officer_inc, by = "incident_id")
[1] 18
summary(dd_merged)
[1] 19
      age         nighttime   prior_offence     speed             bac             outcome     incident_id  officer   
 Min.   : 14.00   day  : 79   N      :185   Min.   :  0.00   Min.   :0.03987   fine   :202   inc_1  :  1   AS  :116  
 1st Qu.: 30.00   night:171   DR50   : 43   1st Qu.: 30.92   1st Qu.:0.19264   warning: 48   inc_10 :  1   IT  : 66  
 Median : 40.50               DD20   :  4   Median : 40.64   Median :0.23609                 inc_100:  1   NP  : 67  
 Mean   : 46.00               DR80   :  4   Mean   : 40.49   Mean   :0.23605                 inc_101:  1   NA's:  1  
 3rd Qu.: 55.25               TS70   :  3   3rd Qu.: 48.84   3rd Qu.:0.27898                 inc_102:  1             
 Max.   :297.00               CD10   :  2   Max.   :120.34   Max.   :0.65764                 inc_103:  1             
 [ reached getOption("max.print") -- omitted 1 row ]
outliers(dd_merged$age)
[1] 20
[1]  51 114 224
dd_merged$age[which(dd_merged$age < 17)] <- NA
[1] 21
dd_merged$age[which(dd_merged$age > 100)] <- NA
[1] 22
boxplot(dd_merged$speed)
[1] 23
dd_merged$speed[outliers(dd_merged$speed)] <- NA
[1] 24
boxplot(dd_merged$bac)
[1] 25
dd_merged$bac[outliers(dd_merged$bac)] <- NA
[1] 26
age_bac_mod <- lm(bac ~ age, data = dd_merged)
[1] 27
summary(age_bac_mod)
[1] 28

Call:
lm(formula = bac ~ age, data = dd_merged)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.151959 -0.041261 -0.008169  0.040809  0.147662 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.2811832  0.0115626  24.318  < 2e-16 ***
age         -0.0012660  0.0002479  -5.107 7.37e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05834 on 208 degrees of freedom
  (40 observations deleted due to missingness)
Multiple R-squared:  0.1114,	Adjusted R-squared:  0.1072 
F-statistic: 26.09 on 1 and 208 DF,  p-value: 7.366e-07

with(dd_merged, plot(age, bac, xlab = "age", ylab = "BAC", main = "Scatterplot"))
[1] 29
par(mfrow = c(2, 2))
[1] 30
$mfrow
[1] 2 2

plot(age_bac_mod)
[1] 31
mean(age_bac_mod$residuals)
[1] 32
[1] 1.479807e-18
par(mfrow = c(1, 1))
[1] 33
$mfrow
[1] 2 2

plot(age_bac_mod, which = 4)
[1] 34
acf(age_bac_mod$residuals)
[1] 35

Autocorrelations of series ‘age_bac_mod$residuals’, by lag

     0      1      2      3      4      5      6      7      8      9     10     11     12     13     14     15     16     17     18 
 1.000  0.018 -0.020  0.031 -0.048 -0.082 -0.080 -0.020 -0.280  0.018 -0.084  0.036 -0.048  0.117  0.177  0.059  0.068 -0.132 -0.038 
    19     20     21     22     23 
 0.007  0.045 -0.102 -0.088 -0.072 
gvlma(age_bac_mod)
[1] 36

Call:
lm(formula = bac ~ age, data = dd_merged)

Coefficients:
(Intercept)          age  
   0.281183    -0.001266  


ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
Level of Significance =  0.05 

Call:
 gvlma(x = age_bac_mod) 

                    Value p-value                Decision
Global Stat        4.7577 0.31308 Assumptions acceptable.
Skewness           0.1588 0.69027 Assumptions acceptable.
Kurtosis           1.4162 0.23403 Assumptions acceptable.
Link Function      0.2277 0.63320 Assumptions acceptable.
Heteroscedasticity 2.9550 0.08561 Assumptions acceptable.
cor.test(dd_merged$age[!is.na(dd_merged$age) & !is.na(dd_merged$bac)], 
    age_bac_mod$residuals)
[1] 37

	Pearson's product-moment correlation

data:  dd_merged$age[!is.na(dd_merged$age) & !is.na(dd_merged$bac)] and age_bac_mod$residuals
t = 1.6592e-15, df = 208, p-value = 1
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.1353904  0.1353904
sample estimates:
         cor 
1.150461e-16 

age_bac_mod$coefficients[[1]] + 50 * age_bac_mod$coefficients[[2]]
[1] 38
[1] 0.2178828
hist(age_bac_mod$residuals, prob = T, xlab = "Residuals of age model", 
    main = "Histograms of residuals")
[1] 39
lines(density(age_bac_mod$residuals), lwd = 2, col = "blue")
[1] 40
x <- seq(min(age_bac_mod$residuals), max(age_bac_mod$residuals), 
    length.out = 200)
[1] 41
dx = dnorm(x, mean = mean(age_bac_mod$residuals), sd = sd(age_bac_mod$residuals))
[1] 42
lines(x, dx, lty = "dashed", lwd = 2, col = "red")
[1] 43
par(mfrow = c(2, 2))
[1] 44
$mfrow
[1] 1 1

nested_data <- dd_merged %>% filter(!is.na(age), !is.na(bac), 
    !is.na(nighttime), !is.na(speed))
[1] 45
age_bac_mod_nested <- lm(bac ~ age, data = nested_data)
[1] 46
summary(age_bac_mod_nested)
[1] 47

Call:
lm(formula = bac ~ age, data = nested_data)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.150986 -0.040779 -0.007702  0.040516  0.150160 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.2829566  0.0116970  24.190  < 2e-16 ***
age         -0.0013270  0.0002529  -5.248 3.85e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05847 on 204 degrees of freedom
Multiple R-squared:  0.1189,	Adjusted R-squared:  0.1146 
F-statistic: 27.54 on 1 and 204 DF,  p-value: 3.85e-07

tsa_mod <- lm(bac ~ age + nighttime + speed, data = nested_data)
[1] 48
summary(tsa_mod)
[1] 49

Call:
lm(formula = bac ~ age + nighttime + speed, data = nested_data)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.151302 -0.043461  0.003672  0.036329  0.141756 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.2125537  0.0294780   7.211 1.09e-11 ***
age            -0.0008990  0.0003203  -2.807   0.0055 ** 
nighttimenight  0.0372808  0.0083312   4.475 1.28e-05 ***
speed           0.0006916  0.0004573   1.512   0.1320    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05566 on 202 degrees of freedom
Multiple R-squared:  0.2092,	Adjusted R-squared:  0.1974 
F-statistic: 17.81 on 3 and 202 DF,  p-value: 2.697e-10

gvlma(tsa_mod)
[1] 50

Call:
lm(formula = bac ~ age + nighttime + speed, data = nested_data)

Coefficients:
   (Intercept)             age  nighttimenight           speed  
     0.2125537      -0.0008990       0.0372808       0.0006916  


ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
Level of Significance =  0.05 

Call:
 gvlma(x = tsa_mod) 

                   Value p-value                Decision
Global Stat        8.918 0.06317 Assumptions acceptable.
Skewness           0.253 0.61497 Assumptions acceptable.
Kurtosis           2.035 0.15372 Assumptions acceptable.
Link Function      3.120 0.07734 Assumptions acceptable.
Heteroscedasticity 3.511 0.06097 Assumptions acceptable.
plot(tsa_mod)
[1] 51
sa_mod <- lm(bac ~ age + speed, data = nested_data)
[1] 52
summary(sa_mod)
[1] 53

Call:
lm(formula = bac ~ age + speed, data = nested_data)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.152503 -0.039663 -0.006632  0.038675  0.141797 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.2364084  0.0303200   7.797 3.25e-13 ***
age         -0.0009604  0.0003347  -2.869  0.00455 ** 
speed        0.0007943  0.0004777   1.663  0.09790 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05821 on 203 degrees of freedom
Multiple R-squared:  0.1308,	Adjusted R-squared:  0.1222 
F-statistic: 15.27 on 2 and 203 DF,  p-value: 6.639e-07

gvlma(sa_mod)
[1] 54

Call:
lm(formula = bac ~ age + speed, data = nested_data)

Coefficients:
(Intercept)          age        speed  
  0.2364084   -0.0009604    0.0007943  


ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
Level of Significance =  0.05 

Call:
 gvlma(x = sa_mod) 

                    Value p-value                Decision
Global Stat        6.6395 0.15621 Assumptions acceptable.
Skewness           0.5096 0.47531 Assumptions acceptable.
Kurtosis           1.5369 0.21508 Assumptions acceptable.
Link Function      1.7214 0.18951 Assumptions acceptable.
Heteroscedasticity 2.8715 0.09016 Assumptions acceptable.
plot(sa_mod)
[1] 55
ta_mod <- lm(bac ~ age + nighttime, data = nested_data)
[1] 56
summary(ta_mod)
[1] 57

Call:
lm(formula = bac ~ age + nighttime, data = nested_data)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.164193 -0.047066  0.002758  0.038264  0.143613 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.2525790  0.0130208  19.398  < 2e-16 ***
age            -0.0012164  0.0002428  -5.011 1.18e-06 ***
nighttimenight  0.0379129  0.0083471   4.542 9.55e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05584 on 203 degrees of freedom
Multiple R-squared:  0.2002,	Adjusted R-squared:  0.1923 
F-statistic: 25.41 on 2 and 203 DF,  p-value: 1.419e-10

gvlma(ta_mod)
[1] 58

Call:
lm(formula = bac ~ age + nighttime, data = nested_data)

Coefficients:
   (Intercept)             age  nighttimenight  
      0.252579       -0.001216        0.037913  


ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
Level of Significance =  0.05 

Call:
 gvlma(x = ta_mod) 

                    Value p-value                Decision
Global Stat        7.6629 0.10474 Assumptions acceptable.
Skewness           0.1506 0.69794 Assumptions acceptable.
Kurtosis           1.5191 0.21776 Assumptions acceptable.
Link Function      2.2018 0.13785 Assumptions acceptable.
Heteroscedasticity 3.7914 0.05152 Assumptions acceptable.
plot(ta_mod)
[1] 59
par(mfrow = c(1, 1))
[1] 60
$mfrow
[1] 2 2

anova(age_bac_mod_nested, ta_mod, test = "Chisq")
[1] 61
Analysis of Variance Table

Model 1: bac ~ age
Model 2: bac ~ age + nighttime
  Res.Df     RSS Df Sum of Sq  Pr(>Chi)    
1    204 0.69732                           
2    203 0.63299  1  0.064329 5.571e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
anova(age_bac_mod_nested, sa_mod, test = "Chisq")
[1] 62
Analysis of Variance Table

Model 1: bac ~ age
Model 2: bac ~ age + speed
  Res.Df     RSS Df Sum of Sq Pr(>Chi)  
1    204 0.69732                        
2    203 0.68795  1   0.00937  0.09635 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
anova(age_bac_mod_nested, tsa_mod, test = "Chisq")
[1] 63
Analysis of Variance Table

Model 1: bac ~ age
Model 2: bac ~ age + nighttime + speed
  Res.Df     RSS Df Sum of Sq Pr(>Chi)    
1    204 0.69732                          
2    202 0.62590  2  0.071415 9.89e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
anova(sa_mod, tsa_mod, test = "Chisq")
[1] 64
Analysis of Variance Table

Model 1: bac ~ age + speed
Model 2: bac ~ age + nighttime + speed
  Res.Df     RSS Df Sum of Sq  Pr(>Chi)    
1    203 0.68795                           
2    202 0.62590  1  0.062045 7.647e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
anova(ta_mod, tsa_mod, test = "Chisq")
[1] 65
Analysis of Variance Table

Model 1: bac ~ age + nighttime
Model 2: bac ~ age + nighttime + speed
  Res.Df     RSS Df Sum of Sq Pr(>Chi)
1    203 0.63299                      
2    202 0.62590  1 0.0070865   0.1305
summary(tsa_mod)
[1] 66

Call:
lm(formula = bac ~ age + nighttime + speed, data = nested_data)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.151302 -0.043461  0.003672  0.036329  0.141756 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.2125537  0.0294780   7.211 1.09e-11 ***
age            -0.0008990  0.0003203  -2.807   0.0055 ** 
nighttimenight  0.0372808  0.0083312   4.475 1.28e-05 ***
speed           0.0006916  0.0004573   1.512   0.1320    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05566 on 202 degrees of freedom
Multiple R-squared:  0.2092,	Adjusted R-squared:  0.1974 
F-statistic: 17.81 on 3 and 202 DF,  p-value: 2.697e-10

summary(ta_mod)
[1] 67

Call:
lm(formula = bac ~ age + nighttime, data = nested_data)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.164193 -0.047066  0.002758  0.038264  0.143613 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.2525790  0.0130208  19.398  < 2e-16 ***
age            -0.0012164  0.0002428  -5.011 1.18e-06 ***
nighttimenight  0.0379129  0.0083471   4.542 9.55e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05584 on 203 degrees of freedom
Multiple R-squared:  0.2002,	Adjusted R-squared:  0.1923 
F-statistic: 25.41 on 2 and 203 DF,  p-value: 1.419e-10

summary(sa_mod)
[1] 68

Call:
lm(formula = bac ~ age + speed, data = nested_data)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.152503 -0.039663 -0.006632  0.038675  0.141797 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.2364084  0.0303200   7.797 3.25e-13 ***
age         -0.0009604  0.0003347  -2.869  0.00455 ** 
speed        0.0007943  0.0004777   1.663  0.09790 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05821 on 203 degrees of freedom
Multiple R-squared:  0.1308,	Adjusted R-squared:  0.1222 
F-statistic: 15.27 on 2 and 203 DF,  p-value: 6.639e-07

summary(age_bac_mod_nested)
[1] 69

Call:
lm(formula = bac ~ age, data = nested_data)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.150986 -0.040779 -0.007702  0.040516  0.150160 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.2829566  0.0116970  24.190  < 2e-16 ***
age         -0.0013270  0.0002529  -5.248 3.85e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05847 on 204 degrees of freedom
Multiple R-squared:  0.1189,	Adjusted R-squared:  0.1146 
F-statistic: 27.54 on 1 and 204 DF,  p-value: 3.85e-07

speed_night_mod <- glm(nighttime ~ speed, data = dd_merged, family = "binomial")
[1] 70
summary(speed_night_mod)
[1] 71

Call:
glm(formula = nighttime ~ speed, family = "binomial", data = dd_merged)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.7025  -1.4224   0.8164   0.9025   1.0921  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)  
(Intercept) -0.01057    0.44857  -0.024   0.9812  
speed        0.01912    0.01081   1.769   0.0769 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 305.79  on 243  degrees of freedom
Residual deviance: 302.59  on 242  degrees of freedom
  (6 observations deleted due to missingness)
AIC: 306.59

Number of Fisher Scoring iterations: 4

anova(speed_night_mod, test = "Chisq")
[1] 72
Analysis of Deviance Table

Model: binomial, link: logit

Response: nighttime

Terms added sequentially (first to last)


      Df Deviance Resid. Df Resid. Dev Pr(>Chi)  
NULL                    243     305.79           
speed  1   3.1976       242     302.59  0.07375 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
t.test(dd_merged$speed[dd_merged$nighttime == "day"], dd_merged$speed[dd_merged$nighttime == 
    "night"])
[1] 73

	Welch Two Sample t-test

data:  dd_merged$speed[dd_merged$nighttime == "day"] and dd_merged$speed[dd_merged$nighttime == "night"]
t = -1.9173, df = 181.44, p-value = 0.05677
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -6.44500648  0.09251201
sample estimates:
mean of x mean of y 
 38.47328  41.64953 

dd_merged <- dd_merged %>% mutate(drink_offences = fct_collapse(prior_offence, 
    Drink = c("DR50", "TS70,DR50"), `No drink` = c("CD10", "CD60", 
        "CD60,CD10,DR80", "CD60,CD60", "DD20", "DR80", "PL10", 
        "SP50", "SP60", "TS70"), None = "N"), any_offences = fct_collapse(drink_offences, 
    Offence = c("Drink", "No drink"), None = "None"))
[1] 74
dd_merged$any_offences <- relevel(dd_merged$any_offences, ref = "None")
[1] 75
nested_data <- dd_merged %>% filter(!is.na(age), !is.na(bac), 
    !is.na(speed), !is.na(nighttime), !is.na(drink_offences)) %>% 
    mutate(outcome = fct_recode(outcome, `1` = "fine", `2` = "warning"))
[1] 76
fine_odd_mod_int <- glm(outcome ~ scale(speed) * scale(bac) * 
    scale(age) + nighttime + drink_offences, data = dd_merged, 
    family = "binomial")
[1] 77
summary(fine_odd_mod_int)
[1] 78

Call:
glm(formula = outcome ~ scale(speed) * scale(bac) * scale(age) + 
    nighttime + drink_offences, family = "binomial", data = dd_merged)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.5254  -0.3230  -0.1565  -0.0446   2.2371  

Coefficients:
                                   Estimate Std. Error z value Pr(>|z|)   
(Intercept)                         -2.8189     0.9771  -2.885  0.00391 **
scale(speed)                        -1.9489     0.6213  -3.137  0.00171 **
scale(bac)                          -1.8729     0.6745  -2.777  0.00549 **
scale(age)                          -0.2726     0.5677  -0.480  0.63109   
nighttimenight                       0.6386     0.6909   0.924  0.35536   
drink_offencesDrink                 -4.0258     1.5327  -2.627  0.00863 **
drink_offencesNone                  -1.7004     0.8420  -2.019  0.04344 * 
scale(speed):scale(bac)             -0.2577     0.6089  -0.423  0.67210   
scale(speed):scale(age)             -1.3965     0.5437  -2.568  0.01021 * 
scale(bac):scale(age)               -1.4105     0.5776  -2.442  0.01461 * 
 [ reached getOption("max.print") -- omitted 1 row ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 199.917  on 205  degrees of freedom
Residual deviance:  81.926  on 195  degrees of freedom
  (44 observations deleted due to missingness)
AIC: 103.93

Number of Fisher Scoring iterations: 7

anova(fine_odd_mod_int, test = "Chisq")
[1] 79
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


                                   Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                                                 205    199.917              
scale(speed)                        1   62.607       204    137.310 2.523e-15 ***
scale(bac)                          1   25.991       203    111.318 3.429e-07 ***
scale(age)                          1    5.840       202    105.478   0.01566 *  
nighttime                           1    0.029       201    105.449   0.86456    
drink_offences                      2    8.354       199     97.095   0.01535 *  
scale(speed):scale(bac)             1    2.416       198     94.679   0.12007    
scale(speed):scale(age)             1    6.738       197     87.941   0.00944 ** 
 [ reached getOption("max.print") -- omitted 2 rows ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
guesses <- round(predict(fine_odd_mod_int, type = "response") + 
    1)
[1] 80
hits <- ifelse(guesses == nested_data$outcome, 1, 0)
[1] 81
sum(hits)/length(guesses)
[1] 82
[1] 0.9466019
fine_odd_mod <- glm(outcome ~ scale(speed) + scale(bac) + scale(age) + 
    nighttime + drink_offences, data = dd_merged, family = "binomial")
[1] 83
summary(fine_odd_mod)
[1] 84

Call:
glm(formula = outcome ~ scale(speed) + scale(bac) + scale(age) + 
    nighttime + drink_offences, family = "binomial", data = dd_merged)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.92565  -0.39677  -0.14760  -0.03866   3.10947  

Coefficients:
                    Estimate Std. Error z value Pr(>|z|)    
(Intercept)          -2.0591     0.9026  -2.281  0.02253 *  
scale(speed)         -1.5926     0.5087  -3.130  0.00175 ** 
scale(bac)           -1.4605     0.3686  -3.963 7.41e-05 ***
scale(age)            0.8939     0.3671   2.435  0.01489 *  
nighttimenight        0.3898     0.5940   0.656  0.51168    
drink_offencesDrink  -3.3842     1.3360  -2.533  0.01131 *  
drink_offencesNone   -1.3867     0.8544  -1.623  0.10457    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 199.917  on 205  degrees of freedom
Residual deviance:  97.095  on 199  degrees of freedom
  (44 observations deleted due to missingness)
AIC: 111.1

Number of Fisher Scoring iterations: 7

anova(fine_odd_mod, test = "Chisq")
[1] 85
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


               Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                             205    199.917              
scale(speed)    1   62.607       204    137.310 2.523e-15 ***
scale(bac)      1   25.991       203    111.318 3.429e-07 ***
scale(age)      1    5.840       202    105.478   0.01566 *  
nighttime       1    0.029       201    105.449   0.86456    
drink_offences  2    8.354       199     97.095   0.01535 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
anova(fine_odd_mod, fine_odd_mod_int, test = "Chisq")
[1] 86
Analysis of Deviance Table

Model 1: outcome ~ scale(speed) + scale(bac) + scale(age) + nighttime + 
    drink_offences
Model 2: outcome ~ scale(speed) * scale(bac) * scale(age) + nighttime + 
    drink_offences
  Resid. Df Resid. Dev Df Deviance Pr(>Chi)   
1       199     97.095                        
2       195     81.926  4   15.169 0.004363 **
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
guesses <- round(predict(fine_odd_mod, type = "response") + 1)
[1] 87
hits <- ifelse(guesses == nested_data$outcome, 1, 0)
[1] 88
sum(hits)/length(guesses)
[1] 89
[1] 0.9368932
fine_odd_mod_int2 <- glm(outcome ~ scale(bac) + scale(speed) * 
    scale(age) + drink_offences, data = dd_merged, family = "binomial")
[1] 90
summary(fine_odd_mod_int2)
[1] 91

Call:
glm(formula = outcome ~ scale(bac) + scale(speed) * scale(age) + 
    drink_offences, family = "binomial", data = dd_merged)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.2810  -0.3711  -0.1688  -0.0534   2.6662  

Coefficients:
                        Estimate Std. Error z value Pr(>|z|)    
(Intercept)             -2.09338    0.81803  -2.559  0.01050 *  
scale(bac)              -1.53926    0.38783  -3.969 7.22e-05 ***
scale(speed)            -1.60031    0.54458  -2.939  0.00330 ** 
scale(age)              -0.03277    0.49876  -0.066  0.94761    
drink_offencesDrink     -3.21797    1.33495  -2.411  0.01593 *  
drink_offencesNone      -1.56824    0.85398  -1.836  0.06630 .  
scale(speed):scale(age) -1.27809    0.48326  -2.645  0.00818 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 199.917  on 205  degrees of freedom
Residual deviance:  90.851  on 199  degrees of freedom
  (44 observations deleted due to missingness)
AIC: 104.85

Number of Fisher Scoring iterations: 7

anova(fine_odd_mod_int2, test = "Chisq")
[1] 92
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


                        Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                                      205    199.917              
scale(bac)               1   45.393       204    154.524 1.612e-11 ***
scale(speed)             1   43.205       203    111.318 4.928e-11 ***
scale(age)               1    5.840       202    105.478  0.015661 *  
drink_offences           2    7.944       200     97.534  0.018832 *  
scale(speed):scale(age)  1    6.683       199     90.851  0.009733 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
anova(fine_odd_mod_int, fine_odd_mod_int2, test = "Chisq")
[1] 93
Analysis of Deviance Table

Model 1: outcome ~ scale(speed) * scale(bac) * scale(age) + nighttime + 
    drink_offences
Model 2: outcome ~ scale(bac) + scale(speed) * scale(age) + drink_offences
  Resid. Df Resid. Dev Df Deviance Pr(>Chi)  
1       195     81.926                       
2       199     90.851 -4  -8.9246  0.06301 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
guesses <- round(predict(fine_odd_mod_int2, type = "response") + 
    1)
[1] 94
hits <- ifelse(guesses == nested_data$outcome, 1, 0)
[1] 95
sum(hits)/length(guesses)
[1] 96
[1] 0.9271845
BIC(fine_odd_mod_int)
[1] 97
[1] 140.5326
BIC(fine_odd_mod_int2)
[1] 98
[1] 128.1457
AIC(fine_odd_mod_int)
[1] 99
[1] 103.9259
AIC(fine_odd_mod_int2)
[1] 100
[1] 104.8506
with(dd_merged, plot(drink_offences, outcome))
[1] 101
fine_offence_mod <- glm(outcome ~ drink_offences, data = dd_merged, 
    family = "binomial")
[1] 102
summary(fine_offence_mod)
[1] 103

Call:
glm(formula = outcome ~ drink_offences, family = "binomial", 
    data = dd_merged)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.9005  -0.6681  -0.6681  -0.4366   2.1899  

Coefficients:
                    Estimate Std. Error z value Pr(>|z|)  
(Intercept)          -0.6931     0.4629  -1.497   0.1343  
drink_offencesDrink  -1.6094     0.6994  -2.301   0.0214 *
drink_offencesNone   -0.6931     0.4981  -1.392   0.1640  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 244.56  on 249  degrees of freedom
Residual deviance: 238.69  on 247  degrees of freedom
AIC: 244.69

Number of Fisher Scoring iterations: 4

anova(fine_offence_mod, test = "Chisq")
[1] 104
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


               Df Deviance Resid. Df Resid. Dev Pr(>Chi)  
NULL                             249     244.56           
drink_offences  2   5.8645       247     238.69  0.05328 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
fine_offence_mod1 <- glm(outcome ~ drink_offences, data = nested_data, 
    family = "binomial")
[1] 105
anova(fine_offence_mod1, fine_odd_mod_int2, test = "Chisq")
[1] 106
Analysis of Deviance Table

Model 1: outcome ~ drink_offences
Model 2: outcome ~ scale(bac) + scale(speed) * scale(age) + drink_offences
  Resid. Df Resid. Dev Df Deviance  Pr(>Chi)    
1       203    194.573                          
2       199     90.851  4   103.72 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
with(dd_merged, plot(any_offences, outcome))
[1] 107
offence_mod <- glm(outcome ~ any_offences, data = dd_merged, 
    family = "binomial")
[1] 108
summary(offence_mod)
[1] 109

Call:
glm(formula = outcome ~ any_offences, family = "binomial", data = dd_merged)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.6681  -0.6681  -0.6681  -0.6089   1.8849  

Coefficients:
                    Estimate Std. Error z value Pr(>|z|)    
(Intercept)          -1.3863     0.1838  -7.542 4.62e-14 ***
any_offencesOffence  -0.2048     0.3784  -0.541    0.588    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 244.56  on 249  degrees of freedom
Residual deviance: 244.26  on 248  degrees of freedom
AIC: 248.26

Number of Fisher Scoring iterations: 4

fine_int <- glm(outcome ~ scale(bac) + scale(speed) * scale(age) + 
    any_offences, data = dd_merged, family = "binomial")
[1] 110
offence_mod1 <- glm(outcome ~ any_offences, data = nested_data, 
    family = "binomial")
[1] 111
anova(fine_int, offence_mod1, test = "Chisq")
[1] 112
Analysis of Deviance Table

Model 1: outcome ~ scale(bac) + scale(speed) * scale(age) + any_offences
Model 2: outcome ~ any_offences
  Resid. Df Resid. Dev Df Deviance  Pr(>Chi)    
1       200      97.86                          
2       204     199.67 -4  -101.81 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
anova(fine_int, test = "Chisq")
[1] 113
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


                        Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                                      205     199.92              
scale(bac)               1   45.393       204     154.52 1.612e-11 ***
scale(speed)             1   43.205       203     111.32 4.928e-11 ***
scale(age)               1    5.840       202     105.48  0.015661 *  
any_offences             1    0.403       201     105.08  0.525740    
scale(speed):scale(age)  1    7.216       200      97.86  0.007227 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(fine_int)
[1] 114

Call:
glm(formula = outcome ~ scale(bac) + scale(speed) * scale(age) + 
    any_offences, family = "binomial", data = dd_merged)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.60824  -0.39286  -0.21877  -0.08741   3.14678  

Coefficients:
                        Estimate Std. Error z value Pr(>|z|)    
(Intercept)             -3.51730    0.53918  -6.523 6.87e-11 ***
scale(bac)              -1.40041    0.35473  -3.948 7.89e-05 ***
scale(speed)            -1.50797    0.50616  -2.979  0.00289 ** 
scale(age)              -0.03091    0.45353  -0.068  0.94566    
any_offencesOffence     -0.15180    0.63937  -0.237  0.81233    
scale(speed):scale(age) -1.25485    0.45227  -2.775  0.00553 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 199.92  on 205  degrees of freedom
Residual deviance:  97.86  on 200  degrees of freedom
  (44 observations deleted due to missingness)
AIC: 109.86

Number of Fisher Scoring iterations: 6

predict_mod <- glm(outcome ~ age + nighttime + drink_offences + 
    speed + bac, data = dd_merged, family = "binomial")
[1] 115
summary(predict_mod)
[1] 116

Call:
glm(formula = outcome ~ age + nighttime + drink_offences + speed + 
    bac, family = "binomial", data = dd_merged)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.92565  -0.39677  -0.14760  -0.03866   3.10947  

Coefficients:
                     Estimate Std. Error z value Pr(>|z|)    
(Intercept)           5.70411    2.52800   2.256  0.02405 *  
age                   0.05518    0.02266   2.435  0.01489 *  
nighttimenight        0.38981    0.59402   0.656  0.51168    
drink_offencesDrink  -3.38420    1.33604  -2.533  0.01131 *  
drink_offencesNone   -1.38668    0.85435  -1.623  0.10457    
speed                -0.12225    0.03905  -3.130  0.00175 ** 
bac                 -22.27611    5.62148  -3.963 7.41e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 199.917  on 205  degrees of freedom
Residual deviance:  97.095  on 199  degrees of freedom
  (44 observations deleted due to missingness)
AIC: 111.1

Number of Fisher Scoring iterations: 7

predict_mod2 <- glm(outcome ~ age + nighttime + drink_offences + 
    speed + bac + speed * age, data = dd_merged, family = "binomial")
[1] 117
summary(predict_mod2)
[1] 118

Call:
glm(formula = outcome ~ age + nighttime + drink_offences + speed + 
    bac + speed * age, family = "binomial", data = dd_merged)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.2775  -0.3617  -0.1659  -0.0504   2.6339  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)          -2.671887   3.752552  -0.712  0.47645    
age                   0.252594   0.078272   3.227  0.00125 ** 
nighttimenight        0.586517   0.640140   0.916  0.35955    
drink_offencesDrink  -3.357060   1.361698  -2.465  0.01369 *  
drink_offencesNone   -1.607538   0.867771  -1.852  0.06396 .  
speed                 0.151523   0.096490   1.570  0.11634    
bac                 -25.747941   6.550384  -3.931 8.47e-05 ***
age:speed            -0.006188   0.002274  -2.721  0.00651 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 199.917  on 205  degrees of freedom
Residual deviance:  89.981  on 198  degrees of freedom
  (44 observations deleted due to missingness)
AIC: 105.98

Number of Fisher Scoring iterations: 7

anova(predict_mod, predict_mod2, test = "Chisq")
[1] 119
Analysis of Deviance Table

Model 1: outcome ~ age + nighttime + drink_offences + speed + bac
Model 2: outcome ~ age + nighttime + drink_offences + speed + bac + speed * 
    age
  Resid. Df Resid. Dev Df Deviance Pr(>Chi)   
1       199     97.095                        
2       198     89.981  1   7.1139 0.007649 **
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
new_data <- tibble(.rows = length(sort(unique(dd_merged$age))))
[1] 120
new_data <- new_data %>% mutate(age = sort(unique(dd_merged$age)), 
    nighttime = as.factor("day"), speed = 30, bac = 0, drink_offences = as.factor("None"))
[1] 121
new_data$predictions <- predict(predict_mod2, new_data, type = "response")
[1] 122
ggplot(new_data, aes(x = age, y = predictions)) + geom_point(col = "chocolate3", 
    size = 2, shape = 0) + geom_line(lwd = 0.8, col = "seagreen") + 
    theme_bw() + scale_y_continuous(labels = scales::percent_format(accuracy = 1)) + 
    labs(x = "age", title = "Probability of warning over fine") + 
    ylab(NULL)
[1] 123
nested_data <- dd_merged %>% filter(!is.na(age), !is.na(officer))
[1] 124
bias_cop_mod <- glm(outcome ~ age * officer, data = dd_merged, 
    family = "binomial")
[1] 125
summary(bias_cop_mod)
[1] 126

Call:
glm(formula = outcome ~ age * officer, family = "binomial", data = dd_merged)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.4075  -0.5638  -0.3183  -0.0757   2.7179  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept)   -9.55712    2.00043  -4.778 1.77e-06 ***
age            0.16102    0.03474   4.635 3.57e-06 ***
officerIT      5.14843    2.41761   2.130   0.0332 *  
officerNP      4.67258    2.49279   1.874   0.0609 .  
age:officerIT -0.09792    0.04290  -2.283   0.0225 *  
age:officerNP -0.09345    0.04412  -2.118   0.0342 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 218.83  on 216  degrees of freedom
Residual deviance: 146.22  on 211  degrees of freedom
  (33 observations deleted due to missingness)
AIC: 158.22

Number of Fisher Scoring iterations: 6

bias_cop_mod2 <- glm(outcome ~ age * relevel(officer, ref = "IT"), 
    data = dd_merged, family = "binomial")
[1] 127
summary(bias_cop_mod2)
[1] 128

Call:
glm(formula = outcome ~ age * relevel(officer, ref = "IT"), family = "binomial", 
    data = dd_merged)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.4075  -0.5638  -0.3183  -0.0757   2.7179  

Coefficients:
                                    Estimate Std. Error z value Pr(>|z|)   
(Intercept)                        -4.408694   1.357619  -3.247  0.00116 **
age                                 0.063096   0.025175   2.506  0.01220 * 
relevel(officer, ref = "IT")AS     -5.148426   2.417613  -2.130  0.03321 * 
relevel(officer, ref = "IT")NP     -0.475849   2.013808  -0.236  0.81321   
age:relevel(officer, ref = "IT")AS  0.097924   0.042901   2.283  0.02246 * 
age:relevel(officer, ref = "IT")NP  0.004475   0.037058   0.121  0.90388   
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 218.83  on 216  degrees of freedom
Residual deviance: 146.22  on 211  degrees of freedom
  (33 observations deleted due to missingness)
AIC: 158.22

Number of Fisher Scoring iterations: 6

predict_df <- tibble(age = rep(sort(unique(nested_data$age)), 
    3), officer = as.factor(c(rep("AS", 60), rep("IT", 60), rep("NP", 
    60))), probability = 0)
[1] 129
predict_df$probability[1:60] <- predict(bias_cop_mod, subset(predict_df, 
    officer == "AS"), type = "response")
[1] 130
predict_df$probability[61:120] <- predict(bias_cop_mod, subset(predict_df, 
    officer == "IT"), type = "response")
[1] 131
predict_df$probability[121:180] <- predict(bias_cop_mod, subset(predict_df, 
    officer == "NP"), type = "response")
[1] 132
ggplot(predict_df, aes(x = age, y = probability, colour = officer)) + 
    geom_point(alpha = 0.5, size = 2, aes(shape = officer)) + 
    geom_line(lwd = 0.5) + theme_bw() + scale_y_continuous(labels = scales::percent_format(accuracy = 1)) + 
    labs(x = "age", title = "Probability of warning over fine") + 
    ylab(NULL)
[1] 133
