

	####### B158924 R script #######

library(ggplot2, quietly = T)
[1] 1
[1] "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(psych, quietly = T)
[1] 2
 [1] "psych"     "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(broom, quietly = T)
[1] 3
 [1] "broom"     "psych"     "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
library(car, quietly = T)
[1] 4
 [1] "car"       "carData"   "broom"     "psych"     "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"    
[11] "datasets"  "methods"   "base"     
library(tidyverse, quietly = T)
[1] 5
 [1] "forcats"   "stringr"   "dplyr"     "purrr"     "tidyr"     "tibble"    "tidyverse" "car"       "carData"   "broom"    
[11] "psych"     "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(ggiraphExtra, quietly = T)
[1] 6
 [1] "ggiraphExtra" "forcats"      "stringr"      "dplyr"        "purrr"        "tidyr"        "tibble"       "tidyverse"   
 [9] "car"          "carData"      "broom"        "psych"        "ggplot2"      "readr"        "stats"        "graphics"    
[17] "grDevices"    "utils"        "datasets"     "methods"      "base"        
library(plotly, quietly = T)
[1] 7
 [1] "plotly"       "ggiraphExtra" "forcats"      "stringr"      "dplyr"        "purrr"        "tidyr"        "tibble"      
 [9] "tidyverse"    "car"          "carData"      "broom"        "psych"        "ggplot2"      "readr"        "stats"       
[17] "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
load(url("https://edin.ac/2QCZNVu"))
[1] 8
[1] "drinkdriving" "officer_inc" 
describe(drinkdriving)
[1] 9
               vars   n mean    sd median trimmed   mad min  max range skew kurtosis   se
age               1 228   46 33.35   40.5   42.34 18.53  14  297   283  5.5    38.49 2.21
nighttime*        2 250  NaN    NA     NA     NaN    NA Inf -Inf  -Inf   NA       NA   NA
prior_offence*    3 250  NaN    NA     NA     NaN    NA Inf -Inf  -Inf   NA       NA   NA
 [ reached 'max' / getOption("max.print") -- omitted 4 rows ]
table(drinkdriving$age)
[1] 10

14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 
 1  5  2  3  1  2  3  6  2  5  8  3  2  2  5  4  4  4  6  5  9  8  3  4  2 10  5  6  5  3  2  3  4  5  2  3  3  3  6  3  5  4  3  4  4 
59 60 61 62 63 
 1  5  3  3  2 
 [ reached getOption("max.print") -- omitted 15 entries ]
drinkdriving$age[drinkdriving$age > 90] <- NA
[1] 11
table(drinkdriving$nighttime)
[1] 12

18:25  2:05   day night 
    1     2    78   169 
drinkdriving$nighttime[drinkdriving$nighttime == "18:25"] <- NA
[1] 13
drinkdriving$nighttime[drinkdriving$nighttime == "2:05"] <- NA
[1] 14
table(drinkdriving$prior_offence)
[1] 15

          CD10           CD60 CD60,CD10,DR80      CD60,CD60           DD20           DR50           DR80              N           PL10 
             2              1              1              1              4             43              4            185              2 
          SP50           SP60           TS70      TS70,DR50 
             2              1              3              1 
drinkdriving$prior_offence[drinkdriving$prior_offence == "DD20"] <- NA
[1] 16
table(drinkdriving$speed)
[1] 17

               0 1.01214942316415 1.94581782932169 2.53346827328845  11.225704630299 12.2462058630265 12.8128465751594 
               1                1                1                1                1                1                1 
12.9030158165279 12.9155695510693 13.0698049123235 14.3668291368723 15.5710258293839 17.0590138838127  17.221097497513 
               1                1                1                1                1                1                1 
18.2934932399405 19.0089940620951 19.2697316282316 20.2107015627382 21.3069195145607 21.4908339004998 21.8064434744078 
               1                1                1                1                1                1                1 
 22.568562604335 22.5952898516689 22.6424298724575  23.182415928645 23.5805503449787 23.5994274112678 24.4877988273931 
               1                1                1                1                1                1                1 
24.5215840561896 24.5611037960359 24.8285320808304 24.9172566024629 24.9907200841348 25.0453443973611 25.0548611219096 
               1                1                1                1                1                1                1 
25.2710211226397 25.5417854203194 25.5936767268247 25.7485090547557 25.9105706027961   25.98459487588 26.2055631685057 
               1                1                1                1                1                1                1 
 26.414446768112 26.6813905027214 26.6979134850146 27.0661842358492 28.5530416886726 28.6993802422867 28.7242755318064 
               1                1                1                1                1                1                1 
28.8107670431613 
               1 
 [ reached getOption("max.print") -- omitted 200 entries ]
boxplot(drinkdriving$speed)
[1] 18
drinkdriving$speed[drinkdriving$speed < 2.6] <- NA
[1] 19
table(drinkdriving$bac)
[1] 20

3.98678518191804 5.45295079276351 5.61849660215689 6.39815180420771 6.45232354218363 8.55241944417923 9.16715954067682 
               1                1                1                1                1                1                1 
9.25348198083096 9.49752435423211 9.81747807144744 10.0454646939566 10.2699286970084 10.4971185812798 10.6649017352481 
               1                1                1                1                1                1                1 
 11.199644560097 11.8177151563139  12.383382856562 12.7426098538045 13.5320753875597 13.8631845587114 14.1159208271656 
               1                1                1                1                1                1                1 
14.2071322668145 14.3140134442539  14.817899748919 14.9946701515397 15.2439189096081 15.5051277092158  15.989616149418 
               1                1                1                1                1                1                1 
16.0452635279057 16.0927774247029 16.1947203748598 16.2228619659442 16.3696120796151 16.4455909694064 16.6523626858628 
               1                1                1                1                1                1                1 
16.8576234110825 17.1063627259339 17.3301216655205 17.4520816674849 17.6730177261954 17.7137353516994 17.7755921387512 
               1                1                1                1                1                1                1 
17.8183606022586 17.8201747803163 17.8501485665444 17.9707079305316 17.9844835229676 18.0186086871637 18.0696136795774 
               1                1                1                1                1                1                1 
 18.247052539074 
               1 
 [ reached getOption("max.print") -- omitted 191 entries ]
boxplot(drinkdriving$bac)
[1] 21
table(drinkdriving$outcome)
[1] 22

   fine    Fine    FINE warning Warning WARNING 
    191       2       9      43       2       3 
drinkdriving$outcome[drinkdriving$outcome == "Fine" | drinkdriving$outcome == 
    "FINE"] <- "fine"
[1] 23
drinkdriving$outcome[drinkdriving$outcome == "Warning" | drinkdriving$outcome == 
    "WARNING"] <- "warning"
[1] 24
drinkdriving$prior <- ifelse(drinkdriving$prior_offence == "N", 
    "No", "Yes") %>% factor()
[1] 25
is.factor(drinkdriving$nighttime)
[1] 26
[1] FALSE
drinkdriving$nighttime <- factor(drinkdriving$nighttime)
[1] 27
is.factor(drinkdriving$outcome)
[1] 28
[1] FALSE
drinkdriving$outcome <- factor(drinkdriving$outcome)
[1] 29
merged_data <- merge(drinkdriving, officer_inc)
[1] 30
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 31
summary(m1)
[1] 32

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.719  -4.516  -0.861   3.849  42.785 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 29.29455    1.25564  23.330  < 2e-16 ***
age         -0.14353    0.02741  -5.236 3.86e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.82 on 218 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1117,	Adjusted R-squared:  0.1076 
F-statistic: 27.41 on 1 and 218 DF,  p-value: 3.863e-07

m1.diag.metrics <- augment(m1)
[1] 33
head(m1.diag.metrics)
[1] 34
# A tibble: 6 x 10
  .rownames   bac   age .fitted .se.fit .resid    .hat .sigma  .cooksd .std.resid
  <chr>     <dbl> <dbl>   <dbl>   <dbl>  <dbl>   <dbl>  <dbl>    <dbl>      <dbl>
1 1          17.7    39    23.7   0.470  -5.98 0.00476   6.82 0.00185      -0.879
2 2          22.1    28    25.3   0.610  -3.14 0.00800   6.83 0.000863     -0.462
3 3          32.8    38    23.8   0.477   8.95 0.00489   6.81 0.00425       1.32 
4 4          20.5    51    22.0   0.514  -1.50 0.00568   6.83 0.000139     -0.220
5 5          29.4    56    21.3   0.588   8.11 0.00744   6.81 0.00534       1.19 
6 6          19.1    36    24.1   0.494  -5.00 0.00525   6.83 0.00143      -0.735
ggplot(m1.diag.metrics, aes(age, bac)) + geom_point() + stat_smooth(method = lm, 
    se = FALSE) + geom_segment(aes(xend = age, yend = .fitted), 
    color = "red", size = 0.3)
[1] 35
par(mfrow = c(2, 2))
[1] 36
$mfrow
[1] 1 1

plot(m1)
[1] 37
new.ages <- data.frame(age = c(50))
[1] 38
predict(m1, newdata = new.ages)
[1] 39
       1 
22.11824 
hist(x = residuals(m1), xlab = "Value of residual", main = "", 
    breaks = 20)
[1] 40
qqnorm(residuals(m1))
[1] 41
$x
 [1] -1.007621166 -0.428644689  1.472414089 -0.131405491  1.294610740 -0.786084163  0.639147053  0.755415026 -0.005696913  0.653186017
[11]  0.597760126  0.570731271 -1.823803278  1.086466335 -0.466428115  0.786084163 -0.517875045  0.988868932 -0.119921346  0.154427430
[21] -0.271035620 -0.899884315 -0.224038594  0.952370547  0.504889622 -0.051294427 -0.970458137 -1.321413172 -2.466702404  0.142906992
[31]  0.342707949  0.740344626 -1.107259340 -0.952370547  0.934589291  1.107259340 -0.212370265  0.247468774  1.543426728  0.584192348
[41]  0.189118426 -0.403794779 -0.416187607  0.259234199 -0.934589291  0.544113114  0.165968400  1.172717551 -0.235737507  0.849767170
 [ reached getOption("max.print") -- omitted 170 entries ]

$y
          1           2           3           4           5           6           7           8           9          10          11 
 -5.9832888  -3.1414135   8.9488449  -1.4989458   8.1102827  -5.0004319   3.7082761   4.5362633  -0.9075685   3.7363956   3.2152472 
         12          13          14          15          16          18          19          20          21          23          24 
  3.0477649 -10.0038286   6.5050648  -3.3154447   4.6696074  -3.5090222   5.6547746  -1.4930209   0.7459390  -2.2923230  -5.3314044 
         25          26          27          28          29          30          31          32          33          34          35 
 -1.9857760   5.5554306   2.8384417  -1.1441820  -5.7486229  -8.0040993 -15.3735476   0.7326933   1.9454088   4.1703043  -6.6390634 
         36          37          38          39          40          41          42          43          44          45          46 
 -5.7058936   5.5359896   6.6637848  -1.9499121   1.4670418   9.1979351   3.1347773   0.8120467  -3.0949423  -3.1261110   1.5363665 
         47          48          49          50          52          53 
 -5.6939180   2.9244695   0.7527462   7.2149613  -1.9863932   4.9609531 
 [ reached getOption("max.print") -- omitted 170 entries ]

m3 <- lm(bac ~ age + speed + nighttime, data = drinkdriving)
[1] 42
summary(m3)
[1] 43

Call:
lm(formula = bac ~ age + speed + nighttime, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-13.528  -4.437   0.052   3.775  31.558 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    12.44752    2.78245   4.474 1.26e-05 ***
age            -0.03046    0.03212  -0.948    0.344    
speed           0.24119    0.04026   5.991 8.94e-09 ***
nighttimenight  3.55604    0.89354   3.980 9.50e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.102 on 210 degrees of freedom
  (36 observations deleted due to missingness)
Multiple R-squared:  0.3029,	Adjusted R-squared:  0.2929 
F-statistic: 30.41 on 3 and 210 DF,  p-value: 2.285e-16

anova(m3)
[1] 44
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1482.7 1482.73  39.825 1.622e-09 ***
speed       1 1324.1 1324.13  35.565 1.033e-08 ***
nighttime   1  589.7  589.68  15.838 9.502e-05 ***
Residuals 210 7818.6   37.23                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
vif(m3)
[1] 45
      age     speed nighttime 
 1.627096  1.615992  1.010107 
par("mar")
[1] 46
[1] 5 7 1 1
par(mar = c(2, 2, 2, 2))
[1] 47
$mar
[1] 5 7 1 1

par(mfrow = c(2, 2))
[1] 48
$mfrow
[1] 2 2

plot(m3)
[1] 49
drinkdriving[c(110, 154, 72), ]
[1] 50
# A tibble: 3 x 8
    age nighttime prior_offence  speed   bac outcome incident_id prior
  <dbl> <fct>     <chr>          <dbl> <dbl> <fct>   <chr>       <fct>
1    29 day       CD60,CD60      120.   57.3 fine    inc_110     Yes  
2    44 night     CD60,CD10,DR80  81.0  65.8 fine    inc_154     Yes  
3    41 night     N               15.6  30.8 fine    inc_72      No   
df <- drinkdriving[-c(110, 154, 72), ]
[1] 51
m3.refit <- lm(bac ~ age + speed + nighttime, data = df)
[1] 52
summary(m3.refit)
[1] 53

Call:
lm(formula = bac ~ age + speed + nighttime, data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-14.4873  -4.1715   0.4004   3.4802  14.2095 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    21.06102    2.84671   7.398 3.39e-12 ***
age            -0.10006    0.03062  -3.268  0.00127 ** 
speed           0.08792    0.04405   1.996  0.04724 *  
nighttimenight  3.63337    0.79688   4.560 8.77e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.393 on 207 degrees of freedom
  (36 observations deleted due to missingness)
Multiple R-squared:  0.2598,	Adjusted R-squared:  0.2491 
F-statistic: 24.22 on 3 and 207 DF,  p-value: 1.788e-13

par(mfrow = c(2, 2))
[1] 54
$mfrow
[1] 2 2

plot(m3.refit)
[1] 55
drinkdriving_filter <- drinkdriving %>% filter(is.na(nighttime) == 
    FALSE) %>% filter(is.na(speed) == FALSE)
[1] 56
drinkdriving_compare <- drinkdriving_filter %>% group_by(nighttime) %>% 
    summarise(n = n(), mean_speed = mean(speed), sd_speed = sd(speed))
[1] 57
ggplot(drinkdriving_compare, aes(x = nighttime, y = mean_speed, 
    colour = nighttime)) + geom_errorbar(aes(ymin = mean_speed - 
    sd_speed, ymax = mean_speed + sd_speed), width = 0.2) + geom_line() + 
    geom_point()
[1] 58
mspeed_time <- lm(speed ~ nighttime, data = drinkdriving_filter)
[1] 59
contrasts(drinkdriving$nighttime)
[1] 60
      night
day       0
night     1
summary(mspeed_time)
[1] 61

Call:
lm(formula = speed ~ nighttime, data = drinkdriving_filter)

Residuals:
    Min      1Q  Median      3Q     Max 
-30.584  -9.183  -0.201   7.435  81.032 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)      39.305      1.603  24.527   <2e-16 ***
nighttimenight    2.505      1.945   1.288    0.199    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 14.15 on 241 degrees of freedom
Multiple R-squared:  0.006837,	Adjusted R-squared:  0.002716 
F-statistic: 1.659 on 1 and 241 DF,  p-value: 0.199

drinkdriving$outcome <- ifelse(drinkdriving$outcome == "fine", 
    1, 0)
[1] 62
mglm <- glm(outcome ~ age + nighttime + prior_offence + speed + 
    bac, data = drinkdriving, family = binomial)
[1] 63
summary(mglm)
[1] 64

Call:
glm(formula = outcome ~ age + nighttime + prior_offence + speed + 
    bac, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.8690   0.0001   0.0043   0.0482   2.0244  

Coefficients:
                              Estimate Std. Error z value Pr(>|z|)    
(Intercept)                   26.52296 4248.09481   0.006 0.995018    
age                           -0.25845    0.07438  -3.475 0.000511 ***
nighttimenight                -0.31593    1.00753  -0.314 0.753847    
prior_offenceCD60            -54.63445 7784.02986  -0.007 0.994400    
prior_offenceCD60,CD10,DR80  -42.68511 7784.03524  -0.005 0.995625    
prior_offenceCD60,CD60       -49.56081 7784.03758  -0.006 0.994920    
prior_offenceDR50            -23.02995 4248.09269  -0.005 0.995674    
prior_offenceDR80            -34.19203 4248.09447  -0.008 0.993578    
prior_offenceN               -26.44406 4248.09266  -0.006 0.995033    
prior_offencePL10            -22.66941 4302.22744  -0.005 0.995796    
 [ reached getOption("max.print") -- omitted 5 rows ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 195.538  on 209  degrees of freedom
Residual deviance:  35.006  on 195  degrees of freedom
  (40 observations deleted due to missingness)
AIC: 65.006

Number of Fisher Scoring iterations: 17

anova(mglm, test = "Chisq")
[1] 65
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


              Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                            209    195.538              
age            1   74.023       208    121.516 < 2.2e-16 ***
nighttime      1    2.265       207    119.251 0.1323436    
prior_offence 10   38.951       197     80.300 2.589e-05 ***
speed          1   13.194       196     67.106 0.0002809 ***
bac            1   32.100       195     35.006 1.465e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
mglm_scale <- glm(outcome ~ scale(speed) + scale(bac), data = drinkdriving, 
    family = binomial)
[1] 66
summary(mglm_scale)
[1] 67

Call:
glm(formula = outcome ~ scale(speed) + scale(bac), family = binomial, 
    data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-4.0447   0.0547   0.1942   0.4524   1.9388  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept)    2.9159     0.3804   7.666 1.77e-14 ***
scale(speed)   1.9926     0.3866   5.155 2.54e-07 ***
scale(bac)     1.3083     0.3089   4.235 2.28e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 226.06  on 240  degrees of freedom
Residual deviance: 129.46  on 238  degrees of freedom
  (9 observations deleted due to missingness)
AIC: 135.46

Number of Fisher Scoring iterations: 7

drinkdriving_prior <- drinkdriving %>% filter(prior_offence != 
    "N")
[1] 68
drinkdriving_prior$prior_offence <- ifelse(str_detect(drinkdriving_prior$prior_offence, 
    "DR50") == TRUE, "drink", "else")
[1] 69
drinkdriving_prior$prior_offence <- factor(drinkdriving_prior$prior_offence)
[1] 70
drinkdriving_prior <- drinkdriving_prior %>% mutate(prior_offence = relevel(prior_offence, 
    ref = "else"))
[1] 71
mglm_prior <- glm(outcome ~ prior_offence, data = drinkdriving_prior, 
    family = binomial)
[1] 72
anova(mglm_prior, test = "Chisq")
[1] 73
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


              Df Deviance Resid. Df Resid. Dev Pr(>Chi)  
NULL                             60     51.047           
prior_offence  1   3.6421        59     47.405  0.05633 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(mglm_prior)
[1] 74

Call:
glm(formula = outcome ~ prior_offence, family = binomial, data = drinkdriving_prior)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1899   0.4366   0.4366   0.4366   0.8346  

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)  
(Intercept)          0.8755     0.5323   1.645   0.1000  
prior_offencedrink   1.4271     0.7472   1.910   0.0561 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 51.047  on 60  degrees of freedom
Residual deviance: 47.405  on 59  degrees of freedom
AIC: 51.405

Number of Fisher Scoring iterations: 5

exp(coef(mglm_prior))
[1] 75
       (Intercept) prior_offencedrink 
          2.400000           4.166667 
mglm_p <- glm(outcome ~ prior, data = drinkdriving, family = binomial)
[1] 76
anova(mglm_p, test = "Chisq")
[1] 77
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


      Df Deviance Resid. Df Resid. Dev Pr(>Chi)
NULL                    245     237.06         
prior  1  0.86504       244     236.20   0.3523
mglm_age <- glm(outcome ~ age + prior + nighttime + speed + bac, 
    data = drinkdriving, family = binomial)
[1] 78
coef(mglm_age)
[1] 79
   (Intercept)            age       priorYes nighttimenight          speed            bac 
   -4.22207201    -0.07669222     1.14604679    -0.07078430     0.14444637     0.23324924 
predict_logodds <- coef(mglm_age)[1] + coef(mglm_age)[2] * drinkdriving$age + 
    coef(mglm_age)[3] * 0 + coef(mglm_age)[4] * 0 + coef(mglm_age)[5] * 
    30
[1] 80
drinkdriving$predict <- exp(predict_logodds)/(1 + exp(predict_logodds))
[1] 81
predict_age <- ggplot(data = drinkdriving, aes(x = age, y = predict, 
    color = predict)) + geom_point() + xlab("age (year)") + ylab("predicted probability")
[1] 82
predict_age



merged_data$outcome <- ifelse(merged_data$outcome == "fine", 
    1, 0)
[1] 84
mglm_officer <- glm(outcome ~ age * officer, data = merged_data, 
    family = binomial)
[1] 85
ggPredict(mglm_officer, se = FALSE, interactive = TRUE, digits = 3)
[1] 86
with(merged_data, plot_ly(x = ~age, y = ~officer, z = ~outcome))
[1] 87
plot(merged_data[, c("age", "officer", "outcome")])
[1] 88
table(merged_data$officer)
[1] 89

 AS  IT  NP 
116  66  67 
merged_data$officer_AS <- ifelse(merged_data$officer == "AS", 
    "AS", "NAS") %>% factor()
[1] 90
mglm_officer_AS <- glm(outcome ~ age * officer_AS, data = merged_data, 
    family = binomial)
[1] 91
summary(mglm_officer_AS)
[1] 92

Call:
glm(formula = outcome ~ age * officer_AS, family = binomial, 
    data = merged_data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.6568   0.0642   0.2939   0.5248   2.4089  

Coefficients:
                  Estimate Std. Error z value Pr(>|z|)    
(Intercept)        9.56920    1.99554   4.795 1.62e-06 ***
age               -0.16122    0.03466  -4.652 3.29e-06 ***
officer_ASNAS     -4.88007    2.22537  -2.193   0.0283 *  
age:officer_ASNAS  0.09513    0.03912   2.431   0.0150 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 222.38  on 224  degrees of freedom
Residual deviance: 146.62  on 221  degrees of freedom
  (25 observations deleted due to missingness)
AIC: 154.62

Number of Fisher Scoring iterations: 7

anova(mglm_officer_AS)
[1] 93
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


               Df Deviance Resid. Df Resid. Dev
NULL                             224     222.38
age             1   67.728       223     154.65
officer_AS      1    0.579       222     154.07
age:officer_AS  1    7.458       221     146.62
merged_data$officer_IT <- ifelse(merged_data$officer == "IT", 
    "IT", "NIT") %>% factor()
[1] 94
mglm_officer_IT <- glm(outcome ~ age * officer_IT, data = merged_data, 
    family = binomial)
[1] 95
summary(mglm_officer_IT)
[1] 96

Call:
glm(formula = outcome ~ age * officer_IT, family = binomial, 
    data = merged_data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.2300   0.1244   0.2809   0.5524   1.9429  

Coefficients:
                  Estimate Std. Error z value Pr(>|z|)    
(Intercept)        4.52384    1.32631   3.411 0.000648 ***
age               -0.06510    0.02467  -2.639 0.008308 ** 
officer_ITNIT      2.80276    1.76231   1.590 0.111747    
age:officer_ITNIT -0.05243    0.03202  -1.638 0.101509    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 222.38  on 224  degrees of freedom
Residual deviance: 152.17  on 221  degrees of freedom
  (25 observations deleted due to missingness)
AIC: 160.17

Number of Fisher Scoring iterations: 6

anova(mglm_officer_IT)
[1] 97
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


               Df Deviance Resid. Df Resid. Dev
NULL                             224     222.38
age             1   67.728       223     154.65
officer_IT      1    0.000       222     154.65
age:officer_IT  1    2.484       221     152.17
merged_data$officer_NP <- ifelse(merged_data$officer == "NP", 
    "NP", "NNP") %>% factor()
[1] 98
mglm_officer_NP <- glm(outcome ~ age * officer_NP, data = merged_data, 
    family = binomial)
[1] 99
summary(mglm_officer_NP)
[1] 100

Call:
glm(formula = outcome ~ age * officer_NP, family = binomial, 
    data = merged_data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.9435   0.1292   0.2879   0.5025   2.4116  

Coefficients:
                 Estimate Std. Error z value Pr(>|z|)    
(Intercept)       7.09475    1.12271   6.319 2.63e-10 ***
age              -0.11566    0.02025  -5.712 1.11e-08 ***
officer_NPNP     -2.21021    1.86354  -1.186    0.236    
age:officer_NPNP  0.04809    0.03390   1.418    0.156    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 222.38  on 224  degrees of freedom
Residual deviance: 152.00  on 221  degrees of freedom
  (25 observations deleted due to missingness)
AIC: 160

Number of Fisher Scoring iterations: 6

anova(mglm_officer_NP)
[1] 101
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


               Df Deviance Resid. Df Resid. Dev
NULL                             224     222.38
age             1   67.728       223     154.65
officer_NP      1    0.747       222     153.91
age:officer_NP  1    1.905       221     152.00
