

	####### B154021 R script #######

library(psych, quietly = T)
[1] 1
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(ggplot2, quietly = T)
[1] 2
 [1] "ggplot2"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
install.packages("car")
[1] 3
library(car, quietly = T)
[1] 4
 [1] "car"       "carData"   "ggplot2"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[11] "methods"   "base"     
load("C:/Users/49388/Desktop/R/course work/test folder/usmr_1920_assignment.RData")
[1] 5
[1] "Error in readChar(con, 5L, useBytes = TRUE) : cannot open the connection\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in readChar(con, 5L, useBytes = TRUE): cannot open the connection>


####################################################################################################

[1] "Error in readChar(con, 5L, useBytes = TRUE) : cannot open the connection\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in readChar(con, 5L, useBytes = TRUE): cannot open the connection>
####################################################################################################


describe(drinkdriving)
[1] 6
[1] "Error in describe(drinkdriving) : object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in describe(drinkdriving): object 'drinkdriving' not found>


####################################################################################################

[1] "Error in describe(drinkdriving) : object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in describe(drinkdriving): object 'drinkdriving' not found>
####################################################################################################


table(drinkdriving$age)
[1] 7
[1] "Error in table(drinkdriving$age) : object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in table(drinkdriving$age): object 'drinkdriving' not found>


####################################################################################################

[1] "Error in table(drinkdriving$age) : object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in table(drinkdriving$age): object 'drinkdriving' not found>
####################################################################################################


drinkdriving$age[drinkdriving$age > 100] <- NA
[1] 8


####################################################################################################

[1] "Error in drinkdriving$age[drinkdriving$age > 100] <- NA : \n  object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in drinkdriving$age[drinkdriving$age > 100] <- NA: object 'drinkdriving' not found>
####################################################################################################


drinkdriving$age <- as.integer(drinkdriving$age)
[1] 9


####################################################################################################

[1] "Error in eval(script[[ll]]) : object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in eval(script[[ll]]): object 'drinkdriving' not found>
####################################################################################################


table(drinkdriving$nighttime)
[1] 10
[1] "Error in table(drinkdriving$nighttime) : object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in table(drinkdriving$nighttime): object 'drinkdriving' not found>


####################################################################################################

[1] "Error in table(drinkdriving$nighttime) : object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in table(drinkdriving$nighttime): object 'drinkdriving' not found>
####################################################################################################


drinkdriving$nighttime[drinkdriving$nighttime == "18:25"] <- "night"
[1] 11


####################################################################################################

[1] "Error in drinkdriving$nighttime[drinkdriving$nighttime == \"18:25\"] <- \"night\" : \n  object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in drinkdriving$nighttime[drinkdriving$nighttime == "18:25"] <- "night": object 'drinkdriving' not found>
####################################################################################################


drinkdriving$nighttime[drinkdriving$nighttime == "2:05"] <- "night"
[1] 12


####################################################################################################

[1] "Error in drinkdriving$nighttime[drinkdriving$nighttime == \"2:05\"] <- \"night\" : \n  object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in drinkdriving$nighttime[drinkdriving$nighttime == "2:05"] <- "night": object 'drinkdriving' not found>
####################################################################################################


drinkdriving$nighttime <- factor(drinkdriving$nighttime)
[1] 13


####################################################################################################

[1] "Error in factor(drinkdriving$nighttime) : object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in factor(drinkdriving$nighttime): object 'drinkdriving' not found>
####################################################################################################


table(drinkdriving$outcome)
[1] 14
[1] "Error in table(drinkdriving$outcome) : object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in table(drinkdriving$outcome): object 'drinkdriving' not found>


####################################################################################################

[1] "Error in table(drinkdriving$outcome) : object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in table(drinkdriving$outcome): object 'drinkdriving' not found>
####################################################################################################


drinkdriving$outcome[drinkdriving$outcome == "Fine"] <- "fine"
[1] 15


####################################################################################################

[1] "Error in drinkdriving$outcome[drinkdriving$outcome == \"Fine\"] <- \"fine\" : \n  object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in drinkdriving$outcome[drinkdriving$outcome == "Fine"] <- "fine": object 'drinkdriving' not found>
####################################################################################################


drinkdriving$outcome[drinkdriving$outcome == "FINE"] <- "fine"
[1] 16


####################################################################################################

[1] "Error in drinkdriving$outcome[drinkdriving$outcome == \"FINE\"] <- \"fine\" : \n  object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in drinkdriving$outcome[drinkdriving$outcome == "FINE"] <- "fine": object 'drinkdriving' not found>
####################################################################################################


drinkdriving$outcome[drinkdriving$outcome == "Warning"] <- "warning"
[1] 17


####################################################################################################

[1] "Error in drinkdriving$outcome[drinkdriving$outcome == \"Warning\"] <- \"warning\" : \n  object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in drinkdriving$outcome[drinkdriving$outcome == "Warning"] <- "warning": object 'drinkdriving' not found>
####################################################################################################


drinkdriving$outcome[drinkdriving$outcome == "WARNING"] <- "warning"
[1] 18


####################################################################################################

[1] "Error in drinkdriving$outcome[drinkdriving$outcome == \"WARNING\"] <- \"warning\" : \n  object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in drinkdriving$outcome[drinkdriving$outcome == "WARNING"] <- "warning": object 'drinkdriving' not found>
####################################################################################################


drinkdriving$outcome <- tolower(drinkdriving$outcome)
[1] 19


####################################################################################################

[1] "Error in tolower(drinkdriving$outcome) : object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in tolower(drinkdriving$outcome): object 'drinkdriving' not found>
####################################################################################################


drinkdriving$outcome <- factor(drinkdriving$outcome)
[1] 20


####################################################################################################

[1] "Error in factor(drinkdriving$outcome) : object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in factor(drinkdriving$outcome): object 'drinkdriving' not found>
####################################################################################################


m1 <- lm(bac ~ age, data = drinkdriving)
[1] 21


####################################################################################################

[1] "Error in is.data.frame(data) : object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in is.data.frame(data): object 'drinkdriving' not found>
####################################################################################################


m1



####################################################################################################

[1] "Error in eval(script[[ll]]) : object 'm1' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in eval(script[[ll]]): object 'm1' not found>
####################################################################################################




par(mfrow = c(2, 2))
[1] 23
$mfrow
[1] 2 2

plot(m1)
[1] 24
summary(m1)
[1] 25
[1] "Error in summary(m1) : object 'm1' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m1): object 'm1' not found>


####################################################################################################

[1] "Error in summary(m1) : object 'm1' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m1): object 'm1' not found>
####################################################################################################


a <- data.frame(age = 50)
[1] 26
predict(m1, a)
[1] 27
[1] "Error in predict(m1, a) : object 'm1' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in predict(m1, a): object 'm1' not found>


####################################################################################################

[1] "Error in predict(m1, a) : object 'm1' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in predict(m1, a): object 'm1' not found>
####################################################################################################


par(mfrow = c(1, 2))
[1] 28
$mfrow
[1] 2 2

hist(resid(m1), main = NULL)
[1] 29
qqnorm(resid(m1), main = NULL)
[1] 30
[1] "Error in resid(m1) : object 'm1' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in resid(m1): object 'm1' not found>


####################################################################################################

[1] "Error in resid(m1) : object 'm1' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in resid(m1): object 'm1' not found>
####################################################################################################


qqline(resid(m1), col = "red")
[1] 31


####################################################################################################

[1] "Error in resid(m1) : object 'm1' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in resid(m1): object 'm1' not found>
####################################################################################################


m2 <- lm(bac ~ age + nighttime + speed, data = drinkdriving)
[1] 32


####################################################################################################

[1] "Error in is.data.frame(data) : object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in is.data.frame(data): object 'drinkdriving' not found>
####################################################################################################


summary(m2)
[1] 33
[1] "Error in summary(m2) : object 'm2' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m2): object 'm2' not found>


####################################################################################################

[1] "Error in summary(m2) : object 'm2' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m2): object 'm2' not found>
####################################################################################################


par(mfrow = c(2, 2))
[1] 34
$mfrow
[1] 1 2

plot(m2)
[1] 35
m2.1 <- lm(bac ~ nighttime + speed, data = drinkdriving)
[1] 36


####################################################################################################

[1] "Error in is.data.frame(data) : object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in is.data.frame(data): object 'drinkdriving' not found>
####################################################################################################


summary(m2.1)
[1] 37
[1] "Error in summary(m2.1) : object 'm2.1' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m2.1): object 'm2.1' not found>


####################################################################################################

[1] "Error in summary(m2.1) : object 'm2.1' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m2.1): object 'm2.1' not found>
####################################################################################################


bygroup = describeBy(drinkdriving$speed, drinkdriving$nighttime)
[1] 38


####################################################################################################

[1] "Error in describeBy(drinkdriving$speed, drinkdriving$nighttime) : \n  object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in describeBy(drinkdriving$speed, drinkdriving$nighttime): object 'drinkdriving' not found>
####################################################################################################


as.data.frame(bygroup$day)
[1] 39
[1] "Error in as.data.frame(bygroup$day) : object 'bygroup' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in as.data.frame(bygroup$day): object 'bygroup' not found>


####################################################################################################

[1] "Error in as.data.frame(bygroup$day) : object 'bygroup' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in as.data.frame(bygroup$day): object 'bygroup' not found>
####################################################################################################


as.data.frame(bygroup$night)
[1] 40
[1] "Error in as.data.frame(bygroup$night) : object 'bygroup' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in as.data.frame(bygroup$night): object 'bygroup' not found>


####################################################################################################

[1] "Error in as.data.frame(bygroup$night) : object 'bygroup' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in as.data.frame(bygroup$night): object 'bygroup' not found>
####################################################################################################


boxplot(drinkdriving$speed ~ drinkdriving$nighttime, main = "boxplot of test means", 
    xlab = "time", ylab = "speed")
[1] 41
speedplot <- ggplot(data = na.omit(drinkdriving), aes(x = nighttime, 
    y = speed))
[1] 42


####################################################################################################

[1] "Error in na.omit(drinkdriving) : object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in na.omit(drinkdriving): object 'drinkdriving' not found>
####################################################################################################


speedplot + geom_boxplot()
[1] 43
qqnorm(y = drinkdriving$speed)
[1] 44
[1] "Error in qqnorm(y = drinkdriving$speed) : object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in qqnorm(y = drinkdriving$speed): object 'drinkdriving' not found>


####################################################################################################

[1] "Error in qqnorm(y = drinkdriving$speed) : object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in qqnorm(y = drinkdriving$speed): object 'drinkdriving' not found>
####################################################################################################


shapiro.test(drinkdriving$speed)
[1] 45
[1] "Error : object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError: object 'drinkdriving' not found>


####################################################################################################

[1] "Error : object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError: object 'drinkdriving' not found>
####################################################################################################


leveneTest(drinkdriving$speed ~ drinkdriving$nighttime)
[1] 46
[1] "Error in eval(predvars, data, env) : object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in eval(predvars, data, env): object 'drinkdriving' not found>


####################################################################################################

[1] "Error in eval(predvars, data, env) : object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in eval(predvars, data, env): object 'drinkdriving' not found>
####################################################################################################


q2_3 = t.test(formula = speed ~ nighttime, data = drinkdriving, 
    var.equal = T)
[1] 47


####################################################################################################

[1] "Error in eval(m$data, parent.frame()) : object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in eval(m$data, parent.frame()): object 'drinkdriving' not found>
####################################################################################################


q2_3



####################################################################################################

[1] "Error in eval(script[[ll]]) : object 'q2_3' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in eval(script[[ll]]): object 'q2_3' not found>
####################################################################################################




drinkdriving$isFine <- ifelse(drinkdriving$outcome == "fine", 
    1, 0)
[1] 49


####################################################################################################

[1] "Error in ifelse(drinkdriving$outcome == \"fine\", 1, 0) : \n  object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in ifelse(drinkdriving$outcome == "fine", 1, 0): object 'drinkdriving' not found>
####################################################################################################


drinkdriving$isnight <- ifelse(drinkdriving$nighttime == "night", 
    1, 0)
[1] 50


####################################################################################################

[1] "Error in ifelse(drinkdriving$nighttime == \"night\", 1, 0) : \n  object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in ifelse(drinkdriving$nighttime == "night", 1, 0): object 'drinkdriving' not found>
####################################################################################################


m3 <- glm(isFine ~ speed + bac + age + isnight, data = drinkdriving, 
    family = binomial)
[1] 51


####################################################################################################

[1] "Error in is.data.frame(data) : object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in is.data.frame(data): object 'drinkdriving' not found>
####################################################################################################


summary(m3)
[1] 52
[1] "Error in summary(m3) : object 'm3' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m3): object 'm3' not found>


####################################################################################################

[1] "Error in summary(m3) : object 'm3' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m3): object 'm3' not found>
####################################################################################################


exp(0.1378)
[1] 53
[1] 1.147746
m3.fit <- ifelse(m3$fitted.values > 0.5, "fine", "warning")
[1] 54


####################################################################################################

[1] "Error in ifelse(m3$fitted.values > 0.5, \"fine\", \"warning\") : \n  object 'm3' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in ifelse(m3$fitted.values > 0.5, "fine", "warning"): object 'm3' not found>
####################################################################################################


table(pred = m3.fit, true = m3$data$outcome)
[1] 55
[1] "Error in table(pred = m3.fit, true = m3$data$outcome) : \n  object 'm3.fit' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in table(pred = m3.fit, true = m3$data$outcome): object 'm3.fit' not found>


####################################################################################################

[1] "Error in table(pred = m3.fit, true = m3$data$outcome) : \n  object 'm3.fit' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in table(pred = m3.fit, true = m3$data$outcome): object 'm3.fit' not found>
####################################################################################################


drinkdriving$prior_offence_drink <- NA
[1] 56


####################################################################################################

[1] "Error in drinkdriving$prior_offence_drink <- NA : \n  object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in drinkdriving$prior_offence_drink <- NA: object 'drinkdriving' not found>
####################################################################################################


drinkdriving$prior_offence_drink[drinkdriving$prior_offence != 
    "N"] <- 0
[1] 57


####################################################################################################

[1] "Error in drinkdriving$prior_offence_drink[drinkdriving$prior_offence !=  : \n  object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in drinkdriving$prior_offence_drink[drinkdriving$prior_offence !=     "N"] <- 0: object 'drinkdriving' not found>
####################################################################################################


drinkdriving$prior_offence_drink[grep("DR50", drinkdriving$prior_offence)] <- 1
[1] 58


####################################################################################################

[1] "Error in drinkdriving$prior_offence_drink[grep(\"DR50\", drinkdriving$prior_offence)] <- 1 : \n  object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in drinkdriving$prior_offence_drink[grep("DR50", drinkdriving$prior_offence)] <- 1: object 'drinkdriving' not found>
####################################################################################################


m4 <- glm(isFine ~ prior_offence_drink + speed + bac, data = drinkdriving, 
    family = binomial)
[1] 59


####################################################################################################

[1] "Error in is.data.frame(data) : object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in is.data.frame(data): object 'drinkdriving' not found>
####################################################################################################


summary(m4)
[1] 60
[1] "Error in summary(m4) : object 'm4' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m4): object 'm4' not found>


####################################################################################################

[1] "Error in summary(m4) : object 'm4' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m4): object 'm4' not found>
####################################################################################################


m4.fit <- ifelse(m4$fitted.values > 0.5, "fine", "warning")
[1] 61


####################################################################################################

[1] "Error in ifelse(m4$fitted.values > 0.5, \"fine\", \"warning\") : \n  object 'm4' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in ifelse(m4$fitted.values > 0.5, "fine", "warning"): object 'm4' not found>
####################################################################################################


table(pred = m4.fit, true = m4$data$outcome)
[1] 62
[1] "Error in table(pred = m4.fit, true = m4$data$outcome) : \n  object 'm4.fit' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in table(pred = m4.fit, true = m4$data$outcome): object 'm4.fit' not found>


####################################################################################################

[1] "Error in table(pred = m4.fit, true = m4$data$outcome) : \n  object 'm4.fit' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in table(pred = m4.fit, true = m4$data$outcome): object 'm4.fit' not found>
####################################################################################################


drinkdriving$prior_offence_whether <- 1
[1] 63


####################################################################################################

[1] "Error in drinkdriving$prior_offence_whether <- 1 : \n  object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in drinkdriving$prior_offence_whether <- 1: object 'drinkdriving' not found>
####################################################################################################


drinkdriving$prior_offence_whether[drinkdriving$prior_offence == 
    "N"] <- 0
[1] 64


####################################################################################################

[1] "Error in drinkdriving$prior_offence_whether[drinkdriving$prior_offence ==  : \n  object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in drinkdriving$prior_offence_whether[drinkdriving$prior_offence ==     "N"] <- 0: object 'drinkdriving' not found>
####################################################################################################


m5 <- glm(isFine ~ speed + bac + prior_offence_whether, data = drinkdriving, 
    family = binomial)
[1] 65


####################################################################################################

[1] "Error in is.data.frame(data) : object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in is.data.frame(data): object 'drinkdriving' not found>
####################################################################################################


summary(m5)
[1] 66
[1] "Error in summary(m5) : object 'm5' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m5): object 'm5' not found>


####################################################################################################

[1] "Error in summary(m5) : object 'm5' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m5): object 'm5' not found>
####################################################################################################


m5.fit <- ifelse(m5$fitted.values > 0.5, "fine", "warning")
[1] 67


####################################################################################################

[1] "Error in ifelse(m5$fitted.values > 0.5, \"fine\", \"warning\") : \n  object 'm5' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in ifelse(m5$fitted.values > 0.5, "fine", "warning"): object 'm5' not found>
####################################################################################################


table(pred = m5.fit, true = m5$data$outcome)
[1] 68
[1] "Error in table(pred = m5.fit, true = m5$data$outcome) : \n  object 'm5.fit' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in table(pred = m5.fit, true = m5$data$outcome): object 'm5.fit' not found>


####################################################################################################

[1] "Error in table(pred = m5.fit, true = m5$data$outcome) : \n  object 'm5.fit' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in table(pred = m5.fit, true = m5$data$outcome): object 'm5.fit' not found>
####################################################################################################


m6 <- glm(isFine ~ age + nighttime + speed + bac + prior_offence, 
    data = drinkdriving, family = binomial)
[1] 69


####################################################################################################

[1] "Error in is.data.frame(data) : object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in is.data.frame(data): object 'drinkdriving' not found>
####################################################################################################


df <- data.frame(age = seq(from = 17, to = 90, by = 1), speed = 30, 
    bac = 0, nighttime = "day", prior_offence = "N")
[1] 70
df$model_prediction <- predict(m6, newdata = df, type = "response")
[1] 71


####################################################################################################

[1] "Error in predict(m6, newdata = df, type = \"response\") : \n  object 'm6' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in predict(m6, newdata = df, type = "response"): object 'm6' not found>
####################################################################################################


df$model_prediction
[1] 72
NULL
plot(df$age, df$model_prediction, type = "l", main = "The Predicted Probabilities Vs Age", 
    xlab = "Age", ylab = "Probabilities")
[1] 73
drink <- merge(x = drinkdriving, y = officer_inc, by = "incident_id")
[1] 74


####################################################################################################

[1] "Error in merge(x = drinkdriving, y = officer_inc, by = \"incident_id\") : \n  object 'drinkdriving' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in merge(x = drinkdriving, y = officer_inc, by = "incident_id"): object 'drinkdriving' not found>
####################################################################################################


ggplot(data = drink, aes(x = officer, y = age, fill = outcome)) + 
    geom_boxplot() + theme_bw() + labs(title = "Boxplot of age Vs officer By outcome")
[1] 75
m7 <- glm(isFine ~ age:officer, data = drink, family = binomial)
[1] 76


####################################################################################################

[1] "Error in is.data.frame(data) : object 'drink' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in is.data.frame(data): object 'drink' not found>
####################################################################################################


summary(m7)
[1] 77
[1] "Error in summary(m7) : object 'm7' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m7): object 'm7' not found>


####################################################################################################

[1] "Error in summary(m7) : object 'm7' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m7): object 'm7' not found>
####################################################################################################


