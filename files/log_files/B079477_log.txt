

	####### B079477 R script #######

library("ggplot2", quietly = T)
[1] 1
[1] "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library("psych", quietly = T)
[1] 2
 [1] "psych"     "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library("car", quietly = T)
[1] 3
 [1] "car"       "carData"   "psych"     "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[11] "methods"   "base"     
library("olsrr", quietly = T)
[1] 4
 [1] "olsrr"     "car"       "carData"   "psych"     "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"    
[11] "datasets"  "methods"   "base"     
library("plotly", quietly = T)
[1] 5
 [1] "plotly"    "olsrr"     "car"       "carData"   "psych"     "ggplot2"   "readr"     "stats"     "graphics"  "grDevices"
[11] "utils"     "datasets"  "methods"   "base"     
load(url("https://edin.ac/2QCZNVu"))
[1] 6
[1] "drinkdriving" "officer_inc" 
drinkdriving$age[drinkdriving$age > 100] <- NA
[1] 7
drinkdriving$nighttime[drinkdriving$nighttime == "2:05"] <- NA
[1] 8
drinkdriving$nighttime[drinkdriving$nighttime == "18:25"] <- NA
[1] 9
drinkdriving$prior_offence[drinkdriving$prior_offence == "DD20"] <- NA
[1] 10
drinkdriving$outcome[drinkdriving$outcome == "Fine" | drinkdriving$outcome == 
    "FINE"] <- "fine"
[1] 11
drinkdriving$outcome[drinkdriving$outcome == "WARNING" | drinkdriving$outcome == 
    "Warning"] <- "warning"
[1] 12
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 13
plot(m1, which = c(1:4))
[1] 14
drinkdriving$bac[drinkdriving$bac > 50] <- NA
[1] 15
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 16
plot(m1, which = c(1:4))
[1] 17
ols_test_score(m1)
[1] 18

 Score Test for Heteroskedasticity
 ---------------------------------
 Ho: Variance is homogenous
 Ha: Variance is not homogenous

 Variables: fitted values of bac 

         Test Summary           
 -------------------------------
 DF            =    1 
 Chi2          =    11.43081 
 Prob > Chi2   =    0.0007223617 
summary(m1)
[1] 19

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.3270  -4.1824  -0.5698   3.9975  14.9487 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 28.68503    1.06949   26.82  < 2e-16 ***
age         -0.13730    0.02331   -5.89 1.47e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.791 on 216 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.1384,	Adjusted R-squared:  0.1344 
F-statistic: 34.69 on 1 and 216 DF,  p-value: 1.469e-08

fifty_year_old <- data.frame(age = 50)
[1] 20
predict(m1, newdata = fifty_year_old)
[1] 21
       1 
21.81983 
plot(m1, which = 2)
[1] 22
m2 <- lm(bac ~ age + nighttime, data = drinkdriving)
[1] 23
m3 <- lm(bac ~ age + speed, data = drinkdriving)
[1] 24
anova(m2)
[1] 25
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1300.0 1299.99  44.298 2.349e-10 ***
nighttime   1  697.3  697.27  23.760 2.131e-06 ***
Residuals 213 6250.8   29.35                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
anova(m3)
[1] 26
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1163.1 1163.14 34.6961 1.471e-08 ***
speed       1   35.5   35.50  1.0589    0.3046    
Residuals 215 7207.6   33.52                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
plot(m2, which = c(1:4))
[1] 27
plot(m3, which = c(1:4))
[1] 28
m4 <- lm(bac ~ age + nighttime + speed, data = drinkdriving)
[1] 29
plot(m4, which = c(1:4))
[1] 30
anova(m4)
[1] 31
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1300.0 1299.99 44.3147 2.354e-10 ***
nighttime   1  697.3  697.27 23.7690 2.128e-06 ***
speed       1   31.6   31.63  1.0784    0.3002    
Residuals 212 6219.1   29.34                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m5 <- lm(bac ~ age + speed + nighttime, data = drinkdriving)
[1] 32
anova(m5)
[1] 33
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1300.0 1299.99 44.3147 2.354e-10 ***
speed       1   28.8   28.85  0.9833    0.3225    
nighttime   1  700.1  700.06 23.8640 2.036e-06 ***
Residuals 212 6219.1   29.34                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m4)
[1] 34

Call:
lm(formula = bac ~ age + nighttime + speed, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.6457  -4.3757   0.5792   3.5662  14.2890 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    23.52651    2.66327   8.834 3.89e-16 ***
age            -0.11596    0.02990  -3.878 0.000141 ***
nighttimenight  3.87648    0.79353   4.885 2.04e-06 ***
speed           0.04110    0.03958   1.038 0.300244    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.416 on 212 degrees of freedom
  (34 observations deleted due to missingness)
Multiple R-squared:  0.246,	Adjusted R-squared:  0.2353 
F-statistic: 23.05 on 3 and 212 DF,  p-value: 5.894e-13

time_speed <- lm(speed ~ nighttime, data = drinkdriving)
[1] 35
summary(time_speed)
[1] 36

Call:
lm(formula = speed ~ nighttime, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-40.853  -9.305   0.157   8.213  81.032 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)      39.305      1.691  23.240   <2e-16 ***
nighttimenight    1.548      2.045   0.757     0.45    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 14.94 on 245 degrees of freedom
  (3 observations deleted due to missingness)
Multiple R-squared:  0.002333,	Adjusted R-squared:  -0.001739 
F-statistic: 0.573 on 1 and 245 DF,  p-value: 0.4498

par(mfrow = c(1, 1))
[1] 37
$mfrow
[1] 1 1

plot(time_speed, c(1:4))
[1] 38
hist(resid(time_speed))
[1] 39
drinkdriving$speed[drinkdriving$speed > 100] <- NA
[1] 40
time_speed <- lm(speed ~ nighttime, data = drinkdriving)
[1] 41
plot(time_speed)
[1] 42
hist(resid(time_speed))
[1] 43
shapiro.test(time_speed$residuals)
[1] 44

	Shapiro-Wilk normality test

data:  time_speed$residuals
W = 0.99485, p-value = 0.5753

leveneTest(time_speed)
[1] 45
Levene's Test for Homogeneity of Variance (center = median)
       Df F value  Pr(>F)  
group   1  6.6827 0.01032 *
      244                  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
with(drinkdriving, t.test(speed ~ nighttime))
[1] 46

	Welch Two Sample t-test

data:  speed by nighttime
t = -1.5101, df = 195.84, p-value = 0.1326
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -5.9957683  0.7955574
sample estimates:
  mean in group day mean in group night 
           38.25278            40.85289 

drinkdriving$fined <- ifelse(drinkdriving$outcome == "fine", 
    1, 0)
[1] 47
drinkdriving$prior_binary[drinkdriving$prior_offence == "N"] <- "no"
[1] 48
drinkdriving$prior_binary[drinkdriving$prior_offence != "N"] <- "yes"
[1] 49
drinkdriving$prior_binary <- as.factor(drinkdriving$prior_binary)
[1] 50
outcome_model.saturated <- glm(fined ~ prior_binary + scale(speed) * 
    scale(bac) + scale(age) * nighttime + scale(age):scale(speed) + 
    scale(age):scale(bac) + scale(speed):nighttime + scale(bac):nighttime + 
    prior_binary:scale(age) + prior_binary:scale(bac) + prior_binary:nighttime + 
    prior_binary:scale(speed), data = drinkdriving, family = binomial)
[1] 51
summary(outcome_model.saturated)
[1] 52

Call:
glm(formula = fined ~ prior_binary + scale(speed) * scale(bac) + 
    scale(age) * nighttime + scale(age):scale(speed) + scale(age):scale(bac) + 
    scale(speed):nighttime + scale(bac):nighttime + prior_binary:scale(age) + 
    prior_binary:scale(bac) + prior_binary:nighttime + prior_binary:scale(speed), 
    family = binomial, data = drinkdriving)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-3.009   0.000   0.000   0.000   1.018  

Coefficients:
                                 Estimate Std. Error z value Pr(>|z|)  
(Intercept)                      255.5271 39941.3765   0.006   0.9949  
prior_binaryyes                 -254.3422 39941.3772  -0.006   0.9949  
scale(speed)                     131.9879 44138.6949   0.003   0.9976  
scale(bac)                        98.6197 24385.8064   0.004   0.9968  
scale(age)                      -120.9967 23379.9632  -0.005   0.9959  
nighttimenight                    12.4480 28555.2234   0.000   0.9997  
scale(speed):scale(bac)            0.7628     1.4627   0.521   0.6020  
scale(age):nighttimenight          4.4954     6.1418   0.732   0.4642  
scale(speed):scale(age)           -0.3790     1.6436  -0.231   0.8176  
scale(bac):scale(age)              2.7741     1.3238   2.095   0.0361 *
 [ reached getOption("max.print") -- omitted 6 rows ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 208.231  on 211  degrees of freedom
Residual deviance:  21.026  on 196  degrees of freedom
  (38 observations deleted due to missingness)
AIC: 53.026

Number of Fisher Scoring iterations: 25

vif(outcome_model.saturated)
[1] 53
             prior_binary              scale(speed)                scale(bac)                scale(age)                 nighttime 
             2.066104e+02              4.236524e+09              1.959342e+09              2.234935e+09              5.345926e+08 
  scale(speed):scale(bac)      scale(age):nighttime   scale(speed):scale(age)     scale(bac):scale(age)    scale(speed):nighttime 
             7.860847e+00              7.038324e+01              1.178323e+01              1.360036e+01              2.161247e+02 
     scale(bac):nighttime   prior_binary:scale(age)   prior_binary:scale(bac)    prior_binary:nighttime prior_binary:scale(speed) 
             2.728688e+01              2.234935e+09              1.959342e+09              5.345926e+08              4.236524e+09 
outcome_model1 <- glm(fined ~ scale(speed) + scale(bac) + scale(age) + 
    nighttime + prior_binary, data = drinkdriving, family = binomial)
[1] 54
summary(outcome_model1)
[1] 55

Call:
glm(formula = fined ~ scale(speed) + scale(bac) + scale(age) + 
    nighttime + prior_binary, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-4.1762   0.0133   0.0866   0.2899   2.2983  

Coefficients:
                Estimate Std. Error z value Pr(>|z|)    
(Intercept)      3.82499    0.75766   5.048 4.45e-07 ***
scale(speed)     2.23083    0.56076   3.978 6.94e-05 ***
scale(bac)       1.55221    0.41664   3.726 0.000195 ***
scale(age)      -1.23326    0.42401  -2.909 0.003631 ** 
nighttimenight  -0.06794    0.64338  -0.106 0.915905    
prior_binaryyes  1.10337    0.75862   1.454 0.145823    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 208.23  on 211  degrees of freedom
Residual deviance:  81.66  on 206  degrees of freedom
  (38 observations deleted due to missingness)
AIC: 93.66

Number of Fisher Scoring iterations: 7

vif(outcome_model1)
[1] 56
scale(speed)   scale(bac)   scale(age)    nighttime prior_binary 
    1.262440     1.341733     1.158684     1.212980     1.059310 
drinkdriving$dd_offender <- ifelse(drinkdriving$prior_offence == 
    "DR50", 1, 0)
[1] 57
drinkdriving$dd_offender[drinkdriving$prior_offence == "TS70,DR50"] <- 1
[1] 58
drinkdriving$dd_offender[is.na(drinkdriving$prior_offence) == 
    T] <- NA
[1] 59
drinkdriving$dd_offender[drinkdriving$prior_offence == "N"] <- NA
[1] 60
outcome_model2 <- glm(fined ~ dd_offender, data = drinkdriving, 
    family = binomial)
[1] 61
summary(outcome_model2)
[1] 62

Call:
glm(formula = fined ~ dd_offender, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1899   0.4366   0.4366   0.4366   0.8346  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)  
(Intercept)   0.8755     0.5323   1.645   0.1000  
dd_offender   1.4271     0.7472   1.910   0.0561 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 51.047  on 60  degrees of freedom
Residual deviance: 47.405  on 59  degrees of freedom
  (189 observations deleted due to missingness)
AIC: 51.405

Number of Fisher Scoring iterations: 5

outcome_warning_table1 <- table(drinkdriving$dd_offender, drinkdriving$outcome)
[1] 63
chisq.test(outcome_warning_table1)
[1] 64

	Pearson's Chi-squared test with Yates' continuity correction

data:  outcome_warning_table1
X-squared = 2.5724, df = 1, p-value = 0.1087

outcome_model3 <- glm(fined ~ prior_binary, data = drinkdriving, 
    family = binomial)
[1] 65
summary(outcome_model3)
[1] 66

Call:
glm(formula = fined ~ prior_binary, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.9564   0.5650   0.6681   0.6681   0.6681  

Coefficients:
                Estimate Std. Error z value Pr(>|z|)    
(Intercept)       1.3863     0.1838   7.542 4.62e-14 ***
prior_binaryyes   0.3677     0.4051   0.908    0.364    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 237.06  on 245  degrees of freedom
Residual deviance: 236.20  on 244  degrees of freedom
  (4 observations deleted due to missingness)
AIC: 240.2

Number of Fisher Scoring iterations: 4

outcome_warning_table2 <- table(drinkdriving$prior_binary, drinkdriving$outcome)
[1] 67
chisq.test(outcome_warning_table2)
[1] 68

	Pearson's Chi-squared test with Yates' continuity correction

data:  outcome_warning_table2
X-squared = 0.52118, df = 1, p-value = 0.4703

sample_group <- data.frame(age = seq.int(14, 90), nighttime = rep("day", 
    77), speed = rep(30, 77), bac = rep(0, 77), prior_binary = "no")
[1] 69
sample_group$p.fine <- predict(outcome_model1, newdata = sample_group, 
    type = "response")
[1] 70
plot(sample_group$age, sample_group$p.fine)
[1] 71
plot(sample_group$age, sample_group$p.fine, type = "l", xlab = "Age", 
    ylab = "Probability of fine", main = "Probability of fine given age", 
    col = 4)
[1] 72
merged_dataset <- merge(officer_inc, drinkdriving)
[1] 73
model.as <- glm(fined ~ age, data = merged_dataset[merged_dataset$officer == 
    "AS", ], family = binomial, na.action = na.exclude)
[1] 74
model.np <- glm(fined ~ age, data = merged_dataset[merged_dataset$officer == 
    "NP", ], family = binomial, na.action = na.exclude)
[1] 75
model.it <- glm(fined ~ age, data = merged_dataset[merged_dataset$officer == 
    "IT", ], family = binomial, na.action = na.exclude)
[1] 76
with(merged_dataset, plot_ly(x = ~officer, y = ~age, z = ~speed))
[1] 77
par(mfrow = c(1, 1))
[1] 78
$mfrow
[1] 1 1

with(merged_dataset[merged_dataset$officer == "AS", ], plot(fitted(model.as)[order(age)] ~ 
    age[order(age)], type = "l", xlab = "age", ylab = "pfine", 
    main = "Prob of fine for AS"))
[1] 79
with(merged_dataset[merged_dataset$officer == "IT", ], plot(fitted(model.it)[order(age)] ~ 
    age[order(age)], type = "l", xlab = "age", ylab = "pfine", 
    main = "Prob of fine for IT"))
[1] 80
with(merged_dataset[merged_dataset$officer == "NP", ], plot(fitted(model.np)[order(age)] ~ 
    age[order(age)], type = "l", xlab = "age", ylab = "pfine", 
    main = "Prob of fine for NP"))
[1] 81
model.as2 <- glm(fined ~ speed + bac + prior_binary + age, data = merged_dataset[merged_dataset$officer == 
    "AS", ], family = binomial, na.action = na.exclude)
[1] 82
model.np2 <- glm(fined ~ speed + bac + prior_binary + age, data = merged_dataset[merged_dataset$officer == 
    "NP", ], family = binomial, na.action = na.exclude)
[1] 83
model.it2 <- glm(fined ~ speed + bac + prior_binary + age, data = merged_dataset[merged_dataset$officer == 
    "IT", ], family = binomial, na.action = na.exclude)
[1] 84
anova(model.as2, test = "Chisq")
[1] 85
Analysis of Deviance Table

Model: binomial, link: logit

Response: fined

Terms added sequentially (first to last)


             Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                           103    104.636              
speed         1   49.076       102     55.560 2.462e-12 ***
bac           1   20.826       101     34.734 5.029e-06 ***
prior_binary  1    0.099       100     34.635    0.7534    
age           1   15.315        99     19.320 9.098e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
anova(model.np2, test = "Chisq")
[1] 86
Analysis of Deviance Table

Model: binomial, link: logit

Response: fined

Terms added sequentially (first to last)


             Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                            56     49.723              
speed         1  18.6162        55     31.106 1.599e-05 ***
bac           1   3.3889        54     27.717   0.06563 .  
prior_binary  1   0.0142        53     27.703   0.90504    
age           1   0.8310        52     26.872   0.36197    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
anova(model.it2, test = "Chisq")
[1] 87
Analysis of Deviance Table

Model: binomial, link: logit

Response: fined

Terms added sequentially (first to last)


             Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                            52     54.133              
speed         1  19.5453        51     34.588 9.824e-06 ***
bac           1   6.1098        50     28.478   0.01344 *  
prior_binary  1   5.8494        49     22.629   0.01558 *  
age           1   0.0188        48     22.610   0.89109    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(model.as2)
[1] 88

Call:
glm(formula = fined ~ speed + bac + prior_binary + age, family = binomial, 
    data = merged_dataset[merged_dataset$officer == "AS", ], 
    na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.2239   0.0005   0.0085   0.0555   1.1119  

Coefficients:
                Estimate Std. Error z value Pr(>|z|)   
(Intercept)      -6.0903     4.8980  -1.243  0.21372   
speed             0.2360     0.1066   2.215  0.02678 * 
bac               0.4401     0.1613   2.728  0.00637 **
prior_binaryyes  -0.1608     1.4653  -0.110  0.91262   
age              -0.1692     0.0635  -2.665  0.00770 **
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 104.64  on 103  degrees of freedom
Residual deviance:  19.32  on  99  degrees of freedom
  (13 observations deleted due to missingness)
AIC: 29.32

Number of Fisher Scoring iterations: 9

summary(model.np2)
[1] 89

Call:
glm(formula = fined ~ speed + bac + prior_binary + age, family = binomial, 
    data = merged_dataset[merged_dataset$officer == "NP", ], 
    na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.6494   0.0578   0.2044   0.4014   1.1931  

Coefficients:
                Estimate Std. Error z value Pr(>|z|)  
(Intercept)     -3.53276    4.80194  -0.736   0.4619  
speed            0.14493    0.06513   2.225   0.0261 *
bac              0.13279    0.09883   1.344   0.1791  
prior_binaryyes  0.36212    1.31102   0.276   0.7824  
age             -0.04316    0.04824  -0.895   0.3710  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 49.723  on 56  degrees of freedom
Residual deviance: 26.872  on 52  degrees of freedom
  (11 observations deleted due to missingness)
AIC: 36.872

Number of Fisher Scoring iterations: 6

summary(model.it2)
[1] 90

Call:
glm(formula = fined ~ speed + bac + prior_binary + age, family = binomial, 
    data = merged_dataset[merged_dataset$officer == "IT", ], 
    na.action = na.exclude)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-3.08336   0.00226   0.06344   0.29625   1.52647  

Coefficients:
                  Estimate Std. Error z value Pr(>|z|)  
(Intercept)     -13.201807   6.889135  -1.916   0.0553 .
speed             0.251315   0.104638   2.402   0.0163 *
bac               0.266693   0.114955   2.320   0.0203 *
prior_binaryyes   3.293145   1.688744   1.950   0.0512 .
age               0.007365   0.053751   0.137   0.8910  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 54.133  on 52  degrees of freedom
Residual deviance: 22.610  on 48  degrees of freedom
  (14 observations deleted due to missingness)
AIC: 32.61

Number of Fisher Scoring iterations: 7

vif(model.as2)
[1] 91
       speed          bac prior_binary          age 
    1.864564     1.995233     1.272071     1.539752 
vif(model.np2)
[1] 92
       speed          bac prior_binary          age 
    1.267166     1.078067     1.072224     1.324657 
vif(model.it2)
[1] 93
       speed          bac prior_binary          age 
    1.770668     1.644432     1.473449     1.442657 
model.as3 <- glm(fined ~ speed + bac + prior_binary + speed:bac + 
    age, data = merged_dataset[merged_dataset$officer == "AS", 
    ], family = binomial, na.action = na.exclude)
[1] 94
model.np3 <- glm(fined ~ speed + bac + prior_binary + speed:bac + 
    age, data = merged_dataset[merged_dataset$officer == "NP", 
    ], family = binomial, na.action = na.exclude)
[1] 95
model.it3 <- glm(fined ~ speed + bac + prior_binary + speed:bac + 
    age, data = merged_dataset[merged_dataset$officer == "IT", 
    ], family = binomial, na.action = na.exclude)
[1] 96
vif(model.as3)
[1] 97
       speed          bac prior_binary          age    speed:bac 
   30.534238    19.804732     1.326817     1.566608    24.555603 
vif(model.np3)
[1] 98
       speed          bac prior_binary          age    speed:bac 
   59.781393    36.795395     1.231676     2.508373   142.278546 
vif(model.it3)
[1] 99
       speed          bac prior_binary          age    speed:bac 
   16.454950    22.947643     1.668273     1.528510    25.273529 
sample_group$prior_binary <- "no"
[1] 100
sample_group$as.fine <- predict(model.as2, newdata = sample_group, 
    type = "response")
[1] 101
sample_group$it.fine <- predict(model.it2, newdata = sample_group, 
    type = "response")
[1] 102
sample_group$np.fine <- predict(model.np2, newdata = sample_group, 
    type = "response")
[1] 103
par(mfrow = c(1, 3))
[1] 104
$mfrow
[1] 1 1

plot(sample_group$age, sample_group$np.fine, type = "l", xlab = "Age", 
    ylab = "Probability of fine", main = "Probability of fine by off. NP given age")
[1] 105
plot(sample_group$age, sample_group$it.fine, type = "l", xlab = "Age", 
    ylab = "Probability of fine", main = "Probability of fine by off. IT given age")
[1] 106
plot(sample_group$age, sample_group$as.fine, type = "l", xlab = "Age", 
    ylab = "Probability of fine", main = "Probability of fine by officer AS given age", 
    col = 3)
[1] 107
sample_group$as.fine2 <- predict(model.as3, newdata = sample_group, 
    type = "response")
[1] 108
sample_group$it.fine2 <- predict(model.it3, newdata = sample_group, 
    type = "response")
[1] 109
sample_group$np.fine2 <- predict(model.np3, newdata = sample_group, 
    type = "response")
[1] 110
plot(sample_group$age, sample_group$np.fine2, type = "l", xlab = "Age", 
    ylab = "Probability of fine", main = "Probability of fine by off. NP given age")
[1] 111
plot(sample_group$age, sample_group$it.fine2, type = "l", xlab = "Age", 
    ylab = "Probability of fine", main = "Probability of fine by off. IT given age")
[1] 112
plot(sample_group$age, sample_group$as.fine2, type = "l", xlab = "Age", 
    ylab = "Probability of fine", main = "Probability of fine by off. AS given age")
[1] 113
