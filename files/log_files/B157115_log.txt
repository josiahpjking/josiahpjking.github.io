

	####### B157115 R script #######

library(ggplot2, quietly = T)
[1] 1
[1] "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(magrittr, quietly = T)
[1] 2
 [1] "magrittr"  "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(psych, quietly = T)
[1] 3
 [1] "psych"     "magrittr"  "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
library(dplyr, quietly = T)
[1] 4
 [1] "dplyr"     "psych"     "magrittr"  "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[11] "methods"   "base"     
install.packages("ggpubr")
[1] 5
library(ggpubr, quietly = T)
[1] 6
 [1] "ggpubr"    "dplyr"     "psych"     "magrittr"  "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"    
[11] "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 7
 [1] "car"       "carData"   "ggpubr"    "dplyr"     "psych"     "magrittr"  "ggplot2"   "readr"     "stats"     "graphics" 
[11] "grDevices" "utils"     "datasets"  "methods"   "base"     
load(url("https://edin.ac/2QCZNVu"))
[1] 8
[1] "drinkdriving" "officer_inc" 
drinkdriving <- merge(drinkdriving, officer_inc, by = "incident_id")
[1] 9
summary(drinkdriving)
[1] 10
 incident_id             age          nighttime         prior_offence          speed             bac           outcome         
 Length:250         Min.   : 14.00   Length:250         Length:250         Min.   :  0.00   Min.   : 3.987   Length:250        
 Class :character   1st Qu.: 30.00   Class :character   Class :character   1st Qu.: 30.92   1st Qu.:19.264   Class :character  
 Mode  :character   Median : 40.50   Mode  :character   Mode  :character   Median : 40.64   Median :23.609   Mode  :character  
                    Mean   : 46.00                                         Mean   : 40.49   Mean   :23.605                     
                    3rd Qu.: 55.25                                         3rd Qu.: 48.84   3rd Qu.:27.898                     
                    Max.   :297.00                                         Max.   :120.34   Max.   :65.764                     
 officer   
 AS  :116  
 IT  : 66  
 NP  : 67  
 NA's:  1  
           
           
 [ reached getOption("max.print") -- omitted 1 row ]
as.factor(drinkdriving$time_of_day)
[1] 11
factor(0)
Levels: 
as.factor(drinkdriving$prior_offence)
[1] 12
 [1] N         N         N         N         N         N         DR50      N         N         TS70      DR50      N         DR80     
[14] CD60,CD60 N         N         N         N         PL10      N         N         DD20      N         N         SP60      N        
[27] N         N         N         N         DR50      DR50      N         N         N         N         DR80      N         N        
[40] N         N         N         CD60      N         N         N         DR50      N         DR50      N        
 [ reached getOption("max.print") -- omitted 200 entries ]
Levels: CD10 CD60 CD60,CD10,DR80 CD60,CD60 DD20 DR50 DR80 N PL10 SP50 SP60 TS70 TS70,DR50
as.factor(drinkdriving$outcome)
[1] 13
 [1] fine    warning warning fine    fine    fine    fine    fine    fine    fine    fine    fine    WARNING FINE    fine    fine   
[17] fine    warning warning warning warning fine    fine    FINE    Warning fine    fine    WARNING fine    fine    fine    fine   
[33] fine    fine    fine    fine    fine    fine    fine    fine    fine    warning warning fine    fine    fine    fine    FINE   
[49] fine    fine   
 [ reached getOption("max.print") -- omitted 200 entries ]
Levels: fine Fine FINE warning Warning WARNING
boxplot(drinkdriving$age, drinkdriving$bac)
[1] 14
drinkdriving$age[drinkdriving$age > 100] <- NA
[1] 15
drinkdriving$bac[drinkdriving$bac > 50] <- NA
[1] 16
names(drinkdriving)[3] <- "time_of_day"
[1] 17
drinkdriving$time_of_day[drinkdriving$time_of_day == "2:05"] <- "night"
[1] 18
drinkdriving$time_of_day[drinkdriving$time_of_day == "18:25"] <- "day"
[1] 19
drinkdriving$outcome[drinkdriving$outcome == "Fine"] <- "fine"
[1] 20
drinkdriving$outcome[drinkdriving$outcome == "FINE"] <- "fine"
[1] 21
drinkdriving$outcome[drinkdriving$outcome == "Warning"] <- "warning"
[1] 22
drinkdriving$outcome[drinkdriving$outcome == "WARNING"] <- "warning"
[1] 23
drinkdriving$outcome[drinkdriving$outcome == "warning"] <- 0
[1] 24
drinkdriving$outcome[drinkdriving$outcome == "fine"] <- 1
[1] 25
drinkdriving$outcome <- as.numeric(drinkdriving$outcome)
[1] 26
any(is.na(drinkdriving))
[1] 27
[1] TRUE
drinkdriving <- na.omit(drinkdriving)
[1] 28
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 29
summary(m1)
[1] 30

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.3270  -4.1824  -0.5698   3.9975  14.9487 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 28.68503    1.06949   26.82  < 2e-16 ***
age         -0.13730    0.02331   -5.89 1.47e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.791 on 216 degrees of freedom
Multiple R-squared:  0.1384,	Adjusted R-squared:  0.1344 
F-statistic: 34.69 on 1 and 216 DF,  p-value: 1.469e-08

plot(drinkdriving$age, drinkdriving$bac, sub = "Figure1.1 The relationship between blood alcohol content and age", 
    xlab = "age", ylab = "Blood Alcohol Content(%)")
[1] 31
abline(m1)
[1] 32
new.bac <- data.frame(age = 50)
[1] 33
predict(m1, newdata = new.bac)
[1] 34
       1 
21.81983 
plot(density(residuals(m1)))
[1] 35
shapiro.test(residuals(m1))
[1] 36

	Shapiro-Wilk normality test

data:  residuals(m1)
W = 0.99343, p-value = 0.4496

qqnorm(residuals(m1), sub = "Figure1.2 Diagnostic model of residuals")
[1] 37
$x
 [1] -1.001647727  0.660123917 -1.538799668 -2.834680338 -0.167505301 -0.703649019 -1.020820585  0.309579518  0.674489750  1.467640742
[11]  1.373088709  0.471036487  0.617815071  0.382844772  1.001647727  1.502269497 -1.956054659 -2.143037445 -1.819682699 -0.074808634
[21]  0.086344379  0.576584484  0.285541444 -1.101584840 -1.289432679  0.733419266 -0.645893045  0.040254901  0.297538989 -1.662910885
[31] -0.345979930  0.132618105 -0.483923211  0.763854208 -2.274502686  0.226129222  0.509942504 -1.144796229  1.144796229 -0.617815071
[41] -0.407710485 -1.467640742  1.577507059  1.316299930 -0.795013749  1.289432679 -0.779339391 -1.122928435 -0.445493297 -0.005749179
 [ reached getOption("max.print") -- omitted 168 entries ]

$y
          1           2           3           4           5           6           7           8           9          10          11 
 -5.6164416   3.9725724  -8.8512456 -15.3269731  -1.4753944  -4.2744562  -5.7576051   2.0901792   4.0057632   8.9758016   8.7662139 
         12          13          15          16          17          19          20          21          22          23          24 
  2.8598165   3.6505407   2.3150451   6.0051028   9.0562333  -9.8753551 -10.8119671  -9.8054939  -1.0139381   0.5152656   3.4021673 
         25          27          28          30          31          32          34          35          36          37          38 
  2.0076535  -6.2746631  -7.6820419   4.3697184  -4.1069895  -0.2255465   2.0685551  -9.5374231  -2.4666724   1.0075410  -3.0608643 
         39          42          43          44          45          46          47          48          50          51          52 
  4.4876948 -11.8288513   1.2771193   3.0234942  -6.4172722   6.8968016  -4.0276429  -2.7440776  -8.7952562   9.3808399   8.1798273 
         53          54          55          56          57          58 
 -4.6617784   8.1449966  -4.6547650  -6.3655044  -2.9485975  -0.6423747 
 [ reached getOption("max.print") -- omitted 168 entries ]

m2 <- lm(bac ~ age + speed + time_of_day, data = drinkdriving)
[1] 38
m3 <- lm(bac ~ time_of_day, data = drinkdriving)
[1] 39
m4 <- lm(bac ~ speed, data = drinkdriving)
[1] 40
m3_1 <- lm(bac ~ age + time_of_day, data = drinkdriving)
[1] 41
m4_1 <- lm(bac ~ age + speed, data = drinkdriving)
[1] 42
anova(m3)
[1] 43
Analysis of Variance Table

Response: bac
             Df Sum Sq Mean Sq F value    Pr(>F)    
time_of_day   1  881.1  881.07   25.29 1.036e-06 ***
Residuals   216 7525.2   34.84                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
anova(m4)
[1] 44
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
speed       1  750.5  750.52  21.175 7.144e-06 ***
Residuals 216 7655.7   35.44                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
anova(m3_1)
[1] 45
Analysis of Variance Table

Response: bac
             Df Sum Sq Mean Sq F value    Pr(>F)    
age           1 1163.1 1163.14  38.345 2.969e-09 ***
time_of_day   1  721.4  721.42  23.783 2.096e-06 ***
Residuals   215 6521.7   30.33                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
anova(m4_1)
[1] 46
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1163.1 1163.14 34.6961 1.471e-08 ***
speed       1   35.5   35.50  1.0589    0.3046    
Residuals 215 7207.6   33.52                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m3 <- lm(bac ~ time_of_day, data = drinkdriving)
[1] 47
m4 <- lm(bac ~ speed, data = drinkdriving)
[1] 48
summary(m3)
[1] 49

Call:
lm(formula = bac ~ time_of_day, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-18.7402  -3.8006   0.4598   3.7555  13.4230 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)       19.8708     0.7106  27.965  < 2e-16 ***
time_of_daynight   4.3223     0.8595   5.029 1.04e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.902 on 216 degrees of freedom
Multiple R-squared:  0.1048,	Adjusted R-squared:  0.1007 
F-statistic: 25.29 on 1 and 216 DF,  p-value: 1.036e-06

summary(m4)
[1] 50

Call:
lm(formula = bac ~ speed, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.1318  -3.6379  -0.5018   4.1370  12.3915 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 17.17701    1.29193  13.296  < 2e-16 ***
speed        0.14670    0.03188   4.602 7.14e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.953 on 216 degrees of freedom
Multiple R-squared:  0.08928,	Adjusted R-squared:  0.08506 
F-statistic: 21.18 on 1 and 216 DF,  p-value: 7.144e-06

anova(m2, m3, m3_1, m4, m4_1)
[1] 51
Analysis of Variance Table

Model 1: bac ~ age + speed + time_of_day
Model 2: bac ~ time_of_day
Model 3: bac ~ age + time_of_day
Model 4: bac ~ speed
Model 5: bac ~ age + speed
  Res.Df    RSS Df Sum of Sq      F    Pr(>F)    
1    214 6485.9                                  
2    216 7525.2 -2  -1039.33 17.146 1.239e-07 ***
3    215 6521.7  1   1003.50 33.110 2.989e-08 ***
4    216 7655.7 -1  -1134.05 37.418 4.477e-09 ***
5    215 7207.6  1    448.12 14.786 0.0001589 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m3_2 <- lm(bac ~ time_of_day + log(age + 1), data = drinkdriving)
[1] 52
anova(m3_1, m3_2)
[1] 53
Analysis of Variance Table

Model 1: bac ~ age + time_of_day
Model 2: bac ~ time_of_day + log(age + 1)
  Res.Df    RSS Df Sum of Sq F Pr(>F)
1    215 6521.7                      
2    215 6520.5  0    1.2344         
m5 <- lm(speed ~ time_of_day, data = drinkdriving)
[1] 54
summary(m5)
[1] 55

Call:
lm(formula = speed ~ time_of_day, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-38.992  -8.272   0.638   8.209  35.403 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)        37.441      1.527  24.516   <2e-16 ***
time_of_daynight    1.551      1.847   0.839    0.402    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 12.69 on 216 degrees of freedom
Multiple R-squared:  0.003251,	Adjusted R-squared:  -0.001363 
F-statistic: 0.7046 on 1 and 216 DF,  p-value: 0.4022

m6 <- glm(outcome ~ age + time_of_day + speed + bac + officer, 
    data = drinkdriving, family = binomial)
[1] 56
summary(m6)
[1] 57

Call:
glm(formula = outcome ~ age + time_of_day + speed + bac + officer, 
    family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.6264   0.0354   0.1546   0.3780   2.3868  

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)    
(Intercept)      -4.9900706  2.2050751  -2.263 0.023636 *  
age              -0.0454892  0.0200620  -2.267 0.023364 *  
time_of_daynight  0.0100571  0.5721341   0.018 0.985975    
speed             0.1378254  0.0335773   4.105 4.05e-05 ***
bac               0.1923131  0.0518623   3.708 0.000209 ***
officerIT         0.0005855  0.5922598   0.001 0.999211    
officerNP         0.4503322  0.6329677   0.711 0.476798    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 216.50  on 217  degrees of freedom
Residual deviance: 105.67  on 211  degrees of freedom
AIC: 119.67

Number of Fisher Scoring iterations: 7

m6_1 <- glm(outcome ~ scale(speed), data = drinkdriving)
[1] 58
m6_2 <- glm(outcome ~ scale(bac), data = drinkdriving)
[1] 59
summary(m6_1)
[1] 60

Call:
glm(formula = outcome ~ scale(speed), data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.0028  -0.1402   0.0807   0.2304   0.5944  

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)   0.80275    0.02260  35.516   <2e-16 ***
scale(speed)  0.21957    0.02265   9.692   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for gaussian family taken to be 0.111371)

    Null deviance: 34.518  on 217  degrees of freedom
Residual deviance: 24.056  on 216  degrees of freedom
AIC: 144.16

Number of Fisher Scoring iterations: 2

summary(m6_2)
[1] 61

Call:
glm(formula = outcome ~ scale(bac), data = drinkdriving)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-0.98126  -0.07584   0.12193   0.25413   0.58668  

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.80275    0.02450  32.768  < 2e-16 ***
scale(bac)   0.16983    0.02455   6.916 5.17e-11 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for gaussian family taken to be 0.1308327)

    Null deviance: 34.518  on 217  degrees of freedom
Residual deviance: 28.260  on 216  degrees of freedom
AIC: 179.27

Number of Fisher Scoring iterations: 2

df2 <- as.data.frame(drinkdriving[, c(4, 7)])
[1] 62
df2$prior_offence[df2$prior_offence == "N"] <- NA
[1] 63
df2 <- na.omit(df2)
[1] 64
df2$prior_offence[df2$prior_offence == "DR50"] <- "YES"
[1] 65
df2$prior_offence[df2$prior_offence == "TS70,DR50"] <- "YES"
[1] 66
df2$prior_offence[df2$prior_offence != "YES"] <- "NO"
[1] 67
as.factor(df2$prior_offence)
[1] 68
 [1] YES NO  YES NO  NO  NO  NO  YES YES NO  NO  YES YES YES YES YES YES NO  YES YES YES YES YES YES NO  NO  YES YES YES YES YES YES
[33] YES YES YES YES YES NO  YES YES YES YES NO  YES YES NO  YES YES YES YES
 [ reached getOption("max.print") -- omitted 7 entries ]
Levels: NO YES
df2$outcome <- as.numeric(df2$outcome)
[1] 69
xtabs(~outcome + prior_offence, data = df2)
[1] 70
       prior_offence
outcome NO YES
      0  6   4
      1 12  35
m7 <- glm(outcome ~ prior_offence, data = df2, family = binomial)
[1] 71
summary(m7)
[1] 72

Call:
glm(formula = outcome ~ prior_offence, family = binomial, data = df2)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1341   0.4652   0.4652   0.4652   0.9005  

Coefficients:
                 Estimate Std. Error z value Pr(>|z|)  
(Intercept)        0.6931     0.5000   1.386   0.1657  
prior_offenceYES   1.4759     0.7270   2.030   0.0423 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 52.942  on 56  degrees of freedom
Residual deviance: 48.708  on 55  degrees of freedom
AIC: 52.708

Number of Fisher Scoring iterations: 4

df3 <- as.data.frame(drinkdriving[, c(4, 7)])
[1] 73
df3$prior_offence[df3$prior_offence != "N"] <- "YES"
[1] 74
as.factor(df2$prior_offence)
[1] 75
 [1] YES NO  YES NO  NO  NO  NO  YES YES NO  NO  YES YES YES YES YES YES NO  YES YES YES YES YES YES NO  NO  YES YES YES YES YES YES
[33] YES YES YES YES YES NO  YES YES YES YES NO  YES YES NO  YES YES YES YES
 [ reached getOption("max.print") -- omitted 7 entries ]
Levels: NO YES
xtabs(~outcome + prior_offence, data = df3)
[1] 76
       prior_offence
outcome   N YES
      0  33  10
      1 128  47
df3$outcome <- as.numeric(df3$outcome)
[1] 77
m8 <- glm(outcome ~ prior_offence, data = df3, family = binomial)
[1] 78
summary(m8)
[1] 79

Call:
glm(formula = outcome ~ prior_offence, family = binomial, data = df3)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.8657   0.6211   0.6773   0.6773   0.6773  

Coefficients:
                 Estimate Std. Error z value Pr(>|z|)    
(Intercept)        1.3555     0.1952   6.943 3.83e-12 ***
prior_offenceYES   0.1920     0.3992   0.481    0.631    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 216.50  on 217  degrees of freedom
Residual deviance: 216.27  on 216  degrees of freedom
AIC: 220.27

Number of Fisher Scoring iterations: 4

df4_1 <- data.frame(age = c(17, 18, 19, 20, 21, 22), time_of_day = "day", 
    speed = 30, bac = 0, prior_offence = "None")
[1] 80
df4 <- as.data.frame(drinkdriving[, c(2, 3, 5, 6, 4, 7)])
[1] 81
any(is.na(df4))
[1] 82
[1] FALSE
df4 <- na.omit(df4)
[1] 83
df4$prior_offence[df4$prior_offence != "N"] <- "Yes"
[1] 84
df4$prior_offence[df4$prior_offence == "N"] <- "None"
[1] 85
as.factor(df4$prior_offence)
[1] 86
 [1] None None None None None None Yes  None None Yes  Yes  None Yes  None None None Yes  None None Yes  None None Yes  None None None
[27] Yes  Yes  None None None Yes  None None None Yes  None None None Yes  None None Yes  Yes  Yes  None Yes  None None None
 [ reached getOption("max.print") -- omitted 168 entries ]
Levels: None Yes
m9 <- glm(outcome ~ age + time_of_day + speed + bac + prior_offence, 
    data = df4, family = binomial)
[1] 87
df4_1$prob <- predict(m9, newdata = df4_1, type = "response")
[1] 88
df4_1

  age time_of_day speed bac prior_offence      prob
1  17         day    30   0          None 0.1739138
2  18         day    30   0          None 0.1673125
3  19         day    30   0          None 0.1609130
4  20         day    30   0          None 0.1547127
5  21         day    30   0          None 0.1487091
6  22         day    30   0          None 0.1428990


plot(df4_1$age, df4_1$prob, sub = "Figure4.1 Predicted probabilities of receiving a fine", 
    xlab = "age", ylab = "predicted prob of receiving a fine")
[1] 90
df5 <- as.data.frame(drinkdriving[, c(2, 7, 8)])
[1] 91
summary(df5)
[1] 92
      age           outcome       officer 
 Min.   :14.00   Min.   :0.0000   AS:104  
 1st Qu.:30.00   1st Qu.:1.0000   IT: 55  
 Median :40.00   Median :1.0000   NP: 59  
 Mean   :42.68   Mean   :0.8028           
 3rd Qu.:55.00   3rd Qu.:1.0000           
 Max.   :90.00   Max.   :1.0000           
AS <- df5[df5$officer == "AS", ]
[1] 93
AS1 <- drinkdriving[drinkdriving$officer == "AS", ]
[1] 94
NP1 <- drinkdriving[drinkdriving$officer == "NP", ]
[1] 95
IT1 <- drinkdriving[drinkdriving$officer == "IT", ]
[1] 96
xtabs(~outcome + age, data = AS)
[1] 97
       age
outcome 14 15 16 17 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 39 40 41 42 43 45 46 47 48 50 52 54 56 57 58 59 60 61 62 63
       age
outcome 65 66 68 69 70 77 80 81 90
 [ reached getOption("max.print") -- omitted 2 rows ]
mAS1 <- glm(outcome ~ age + bac + speed, data = AS1)
[1] 98
mAS <- glm(outcome ~ age, data = AS, family = binomial)
[1] 99
summary(mAS)
[1] 100

Call:
glm(formula = outcome ~ age, family = binomial, data = AS)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.15441   0.03906   0.10124   0.26117   2.48531  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) 10.02122    2.16729   4.624 3.77e-06 ***
age         -0.16965    0.03762  -4.509 6.50e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 104.636  on 103  degrees of freedom
Residual deviance:  45.125  on 102  degrees of freedom
AIC: 49.125

Number of Fisher Scoring iterations: 7

summary(mAS1)
[1] 101

Call:
glm(formula = outcome ~ age + bac + speed, data = AS1)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-0.75152  -0.17487   0.02789   0.18189   0.51351  

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.486081   0.217195   2.238 0.027439 *  
age         -0.009279   0.002123  -4.371 3.04e-05 ***
bac          0.016100   0.004503   3.575 0.000541 ***
speed        0.008324   0.002747   3.031 0.003106 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for gaussian family taken to be 0.069858)

    Null deviance: 16.7596  on 103  degrees of freedom
Residual deviance:  6.9858  on 100  degrees of freedom
AIC: 24.286

Number of Fisher Scoring iterations: 2

NP <- df5[df5$officer == "NP", ]
[1] 102
mNP1 <- glm(outcome ~ age + bac + speed, data = NP1)
[1] 103
mNP <- glm(outcome ~ age, data = NP, family = binomial)
[1] 104
summary(mNP1)
[1] 105

Call:
glm(formula = outcome ~ age + bac + speed, data = NP1)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.08535  -0.08788   0.09746   0.21434   0.42695  

Coefficients:
              Estimate Std. Error t value Pr(>|t|)   
(Intercept) -0.0192216  0.3741175  -0.051   0.9592   
age          0.0004177  0.0038721   0.108   0.9145   
bac          0.0107252  0.0072891   1.471   0.1469   
speed        0.0157305  0.0052037   3.023   0.0038 **
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for gaussian family taken to be 0.1082898)

    Null deviance: 8.3051  on 58  degrees of freedom
Residual deviance: 5.9559  on 55  degrees of freedom
AIC: 42.139

Number of Fisher Scoring iterations: 2

summary(mNP)
[1] 106

Call:
glm(formula = outcome ~ age, family = binomial, data = NP)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.7179   0.2653   0.4065   0.6138   1.1125  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)   
(Intercept)  4.88454    1.48737   3.284  0.00102 **
age         -0.06757    0.02719  -2.485  0.01296 * 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 53.699  on 58  degrees of freedom
Residual deviance: 46.224  on 57  degrees of freedom
AIC: 50.224

Number of Fisher Scoring iterations: 5

IT <- df5[df5$officer == "IT", ]
[1] 107
mIT <- glm(outcome ~ age, data = IT, family = binomial)
[1] 108
mIT1 <- glm(outcome ~ age + bac + speed, data = IT1)
[1] 109
summary(mIT)
[1] 110

Call:
glm(formula = outcome ~ age, family = binomial, data = IT)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.4092   0.2553   0.4675   0.6800   1.6320  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)   
(Intercept)  4.34399    1.32531   3.278  0.00105 **
age         -0.06243    0.02456  -2.542  0.01103 * 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 57.706  on 54  degrees of freedom
Residual deviance: 49.437  on 53  degrees of freedom
AIC: 53.437

Number of Fisher Scoring iterations: 5

summary(mIT1)
[1] 111

Call:
glm(formula = outcome ~ age + bac + speed, data = IT1)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.8897  -0.1887   0.1075   0.2547   0.6289  

Coefficients:
              Estimate Std. Error t value Pr(>|t|)  
(Intercept) -0.0191125  0.4084457  -0.047   0.9629  
age         -0.0009656  0.0040905  -0.236   0.8143  
bac          0.0178482  0.0089232   2.000   0.0508 .
speed        0.0111144  0.0049204   2.259   0.0282 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for gaussian family taken to be 0.1307016)

    Null deviance: 9.3818  on 54  degrees of freedom
Residual deviance: 6.6658  on 51  degrees of freedom
AIC: 50.014

Number of Fisher Scoring iterations: 2

coef(mAS1)
[1] 112
 (Intercept)          age          bac        speed 
 0.486080631 -0.009278721  0.016099768  0.008323883 
exp(coef(mAS1))
[1] 113
(Intercept)         age         bac       speed 
  1.6259311   0.9907642   1.0162301   1.0083586 
