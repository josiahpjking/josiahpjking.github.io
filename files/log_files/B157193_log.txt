

	####### B157193 R script #######

load(url("https://edin.ac/2QCZNVu"))
[1] 1
[1] "drinkdriving" "officer_inc" 
library(psych, quietly = T)
[1] 2
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 3
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
library(reghelper, quietly = T)
[1] 4
 [1] "reghelper" "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[11] "methods"   "base"     
library(lsr, quietly = T)
[1] 5
 [1] "lsr"       "reghelper" "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"    
[11] "datasets"  "methods"   "base"     
logit.to.p <- function(logits) {
    exp(logits)/(exp(logits) + 1)
}
[1] 6
head(drinkdriving)
[1] 7
# A tibble: 6 x 7
    age nighttime prior_offence speed   bac outcome incident_id
  <dbl> <chr>     <chr>         <dbl> <dbl> <chr>   <chr>      
1    39 night     N             48.0   17.7 fine    inc_1      
2    28 day       N             43.8   22.1 fine    inc_2      
3    38 night     DR50          47.3   32.8 fine    inc_3      
4    51 night     N             17.2   20.5 warning inc_4      
5    56 night     N              1.95  29.4 warning inc_5      
6    36 day       N             41.4   19.1 fine    inc_6      
describe(drinkdriving)
[1] 8
               vars   n mean    sd median trimmed   mad min  max range skew kurtosis   se
age               1 228   46 33.35   40.5   42.34 18.53  14  297   283  5.5    38.49 2.21
nighttime*        2 250  NaN    NA     NA     NaN    NA Inf -Inf  -Inf   NA       NA   NA
prior_offence*    3 250  NaN    NA     NA     NaN    NA Inf -Inf  -Inf   NA       NA   NA
 [ reached 'max' / getOption("max.print") -- omitted 4 rows ]
table(drinkdriving$nighttime)
[1] 9

18:25  2:05   day night 
    1     2    78   169 
table(drinkdriving$prior_offence)
[1] 10

          CD10           CD60 CD60,CD10,DR80      CD60,CD60           DD20           DR50           DR80              N           PL10 
             2              1              1              1              4             43              4            185              2 
          SP50           SP60           TS70      TS70,DR50 
             2              1              3              1 
table(drinkdriving$outcome)
[1] 11

   fine    Fine    FINE warning Warning WARNING 
    191       2       9      43       2       3 
table(drinkdriving$incident_id)
[1] 12

  inc_1  inc_10 inc_100 inc_101 inc_102 inc_103 inc_104 inc_105 inc_106 inc_107 inc_108 inc_109  inc_11 inc_110 inc_111 inc_112 
      1       1       1       1       1       1       1       1       1       1       1       1       1       1       1       1 
inc_113 inc_114 inc_115 inc_116 inc_117 inc_118 inc_119  inc_12 inc_120 inc_121 inc_122 inc_123 inc_124 inc_125 inc_126 inc_127 
      1       1       1       1       1       1       1       1       1       1       1       1       1       1       1       1 
inc_128 inc_129  inc_13 inc_130 inc_131 inc_132 inc_133 inc_134 inc_135 inc_136 inc_137 inc_138 inc_139  inc_14 inc_140 inc_141 
      1       1       1       1       1       1       1       1       1       1       1       1       1       1       1       1 
inc_142 inc_143 
      1       1 
 [ reached getOption("max.print") -- omitted 200 entries ]
hist(drinkdriving$age)
[1] 13
plot(density(drinkdriving$age, na.rm = T))
[1] 14
drinkdriving$age[drinkdriving$age > 100]
[1] 15
 [1]  NA  NA 293  NA  NA  NA  NA  NA  NA 297  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA 297  NA
drinkdriving$age[drinkdriving$age > 150] <- NA
[1] 16
drinkdriving$age[drinkdriving$age < 20]
[1] 17
 [1] NA NA 16 15 NA NA NA NA NA NA 16 NA 19 NA NA NA 17 NA NA 17 15 NA 17 NA NA NA 15 15 NA 14 NA NA 15 NA 19 NA NA NA 18
describe(drinkdriving$age)
[1] 18
   vars   n  mean    sd median trimmed   mad min max range skew kurtosis   se
X1    1 225 42.68 16.77     40   41.93 17.79  14  90    76  0.4    -0.52 1.12
hist(drinkdriving$speed)
[1] 19
plot(density(drinkdriving$speed, na.rm = T))
[1] 20
table(drinkdriving$nighttime)
[1] 21

18:25  2:05   day night 
    1     2    78   169 
is.factor(drinkdriving$nighttime)
[1] 22
[1] FALSE
drinkdriving$nighttime[drinkdriving$nighttime == "18:25"] <- "day"
[1] 23
drinkdriving$nighttime[drinkdriving$nighttime == "2:05"] <- "night"
[1] 24
drinkdriving$nighttime <- as.factor(drinkdriving$nighttime)
[1] 25
is.factor(drinkdriving$nighttime)
[1] 26
[1] TRUE
table(drinkdriving$outcome)
[1] 27

   fine    Fine    FINE warning Warning WARNING 
    191       2       9      43       2       3 
drinkdriving$outcome[drinkdriving$outcome == "Fine"] <- "fine"
[1] 28
drinkdriving$outcome[drinkdriving$outcome == "FINE"] <- "fine"
[1] 29
drinkdriving$outcome[drinkdriving$outcome == "Warning"] <- "warning"
[1] 30
drinkdriving$outcome[drinkdriving$outcome == "WARNING"] <- "warning"
[1] 31
drinkdriving$outcome <- as.factor(drinkdriving$outcome)
[1] 32
is.factor(drinkdriving$outcome)
[1] 33
[1] TRUE
table(drinkdriving$prior_offence)
[1] 34

          CD10           CD60 CD60,CD10,DR80      CD60,CD60           DD20           DR50           DR80              N           PL10 
             2              1              1              1              4             43              4            185              2 
          SP50           SP60           TS70      TS70,DR50 
             2              1              3              1 
drinkdriving$prior_offence[drinkdriving$prior_offence == "DD20"] <- NA
[1] 35
is.factor(drinkdriving$prior_offence)
[1] 36
[1] FALSE
drinkdriving$prior_offence <- as.factor(drinkdriving$prior_offence)
[1] 37
class(drinkdriving$age)
[1] 38
[1] "numeric"
class(drinkdriving$speed)
[1] 39
[1] "numeric"
class(drinkdriving$bac)
[1] 40
[1] "numeric"
class(drinkdriving$nighttime)
[1] 41
[1] "factor"
class(drinkdriving$prior_offence)
[1] 42
[1] "factor"
class(drinkdriving$outcome)
[1] 43
[1] "factor"
class(drinkdriving$incident_id)
[1] 44
[1] "character"
describe(drinkdriving)
[1] 45
               vars   n  mean    sd median trimmed   mad min max range  skew kurtosis   se
age               1 225 42.68 16.77     40   41.93 17.79  14  90    76  0.40    -0.52 1.12
nighttime*        2 250  1.68  0.47      2    1.73  0.00   1   2     1 -0.79    -1.39 0.03
prior_offence*    3 246  6.64  1.21      7    6.74  0.00   1  12    11 -0.55     6.75 0.08
 [ reached 'max' / getOption("max.print") -- omitted 4 rows ]
head(drinkdriving)
[1] 46
# A tibble: 6 x 7
    age nighttime prior_offence speed   bac outcome incident_id
  <dbl> <fct>     <fct>         <dbl> <dbl> <fct>   <chr>      
1    39 night     N             48.0   17.7 fine    inc_1      
2    28 day       N             43.8   22.1 fine    inc_2      
3    38 night     DR50          47.3   32.8 fine    inc_3      
4    51 night     N             17.2   20.5 warning inc_4      
5    56 night     N              1.95  29.4 warning inc_5      
6    36 day       N             41.4   19.1 fine    inc_6      
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 47
par(mfrow = c(1, 1))
[1] 48
$mfrow
[1] 2 2

with(drinkdriving, plot(age, bac, xlab = "age (in years)", ylab = "blood alcohol content (%)", 
    main = "Age and BAC", col = c("blue"), bty = "n", pch = 20, 
    bty = "L", font.lab = 2))
[1] 49
abline(m1, col = "red")
[1] 50
par(mfrow = c(2, 2))
[1] 51
$mfrow
[1] 1 1

plot(m1, which = c(1:4))
[1] 52
residualPlots(model = m1)
[1] 53
par(mfrow = c(1, 1))
[1] 54
$mfrow
[1] 2 2

hist(residuals(m1))
[1] 55
summary(m1)
[1] 56

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.719  -4.516  -0.861   3.849  42.785 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 29.29455    1.25564  23.330  < 2e-16 ***
age         -0.14353    0.02741  -5.236 3.86e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.82 on 218 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1117,	Adjusted R-squared:  0.1076 
F-statistic: 27.41 on 1 and 218 DF,  p-value: 3.863e-07

coef(m1)
[1] 57
(Intercept)         age 
 29.2945493  -0.1435263 
standardCoefs(m1)
[1] 58
             b       beta
age -0.1435263 -0.3342105
age_specification <- data.frame(age = 50)
[1] 59
predict(m1, newdata = age_specification)
[1] 60
       1 
22.11824 
par(mfrow = c(1, 1))
[1] 61
$mfrow
[1] 1 1

plot(m1, which = 2, bty = "L", font.lab = 2, font.sub = 2, cex.lab = 1)
[1] 62
hist(residuals(m1))
[1] 63
shapiro.test(residuals(m1))
[1] 64

	Shapiro-Wilk normality test

data:  residuals(m1)
W = 0.90861, p-value = 2.299e-10

m1_NightSpeed <- lm(bac ~ age + nighttime + speed, data = drinkdriving)
[1] 65
m2_SpeedNight <- lm(bac ~ age + speed + nighttime, data = drinkdriving)
[1] 66
anova(m1_NightSpeed)
[1] 67
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1274.8 1274.83  32.547 3.803e-08 ***
nighttime   1  641.3  641.31  16.373 7.244e-05 ***
speed       1 1036.8 1036.79  26.470 6.000e-07 ***
Residuals 216 8460.4   39.17                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m1_NightSpeed)
[1] 68

Call:
lm(formula = bac ~ age + nighttime + speed, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-13.291  -4.650   0.136   3.971  33.088 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    14.15205    2.74426   5.157 5.67e-07 ***
age            -0.03148    0.03233  -0.974    0.331    
nighttimenight  3.84615    0.90937   4.229 3.46e-05 ***
speed           0.19824    0.03853   5.145 6.00e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.258 on 216 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.2587,	Adjusted R-squared:  0.2484 
F-statistic: 25.13 on 3 and 216 DF,  p-value: 5.5e-14

anova(m2_SpeedNight)
[1] 69
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1274.8 1274.83  32.547 3.803e-08 ***
speed       1  977.4  977.44  24.955 1.210e-06 ***
nighttime   1  700.7  700.66  17.888 3.460e-05 ***
Residuals 216 8460.4   39.17                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m2_SpeedNight)
[1] 70

Call:
lm(formula = bac ~ age + speed + nighttime, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-13.291  -4.650   0.136   3.971  33.088 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    14.15205    2.74426   5.157 5.67e-07 ***
age            -0.03148    0.03233  -0.974    0.331    
speed           0.19824    0.03853   5.145 6.00e-07 ***
nighttimenight  3.84615    0.90937   4.229 3.46e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.258 on 216 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.2587,	Adjusted R-squared:  0.2484 
F-statistic: 25.13 on 3 and 216 DF,  p-value: 5.5e-14

standardCoefs(m1_NightSpeed)
[1] 71
                         b        beta
age            -0.03147858 -0.07329998
nighttimenight  3.84615407  0.24871588
speed           0.19823512  0.38616234
standardCoefs(m2_SpeedNight)
[1] 72
                         b        beta
age            -0.03147858 -0.07329998
speed           0.19823512  0.38616234
nighttimenight  3.84615407  0.24871588
par(mfrow = c(2, 2))
[1] 73
$mfrow
[1] 1 1

plot(m1_NightSpeed, which = c(1:4), bty = "L", font.lab = 2)
[1] 74
par(mfrow = c(1, 1))
[1] 75
$mfrow
[1] 2 2

hist(residuals(m1_NightSpeed))
[1] 76
shapiro.test(residuals(m1_NightSpeed))
[1] 77

	Shapiro-Wilk normality test

data:  residuals(m1_NightSpeed)
W = 0.96174, p-value = 1.226e-05

residualPlots(model = m1_NightSpeed)
[1] 78
vif(mod = m1_NightSpeed)
[1] 79
      age nighttime     speed 
 1.651227  1.007653  1.641581 
drinkdriving[154, ]
[1] 80
# A tibble: 1 x 7
    age nighttime prior_offence  speed   bac outcome incident_id
  <dbl> <fct>     <fct>          <dbl> <dbl> <fct>   <chr>      
1    44 night     CD60,CD10,DR80  81.0  65.8 fine    inc_154    
drinkdriving[110, ]
[1] 81
# A tibble: 1 x 7
    age nighttime prior_offence speed   bac outcome incident_id
  <dbl> <fct>     <fct>         <dbl> <dbl> <fct>   <chr>      
1    29 day       CD60,CD60      120.  57.3 fine    inc_110    
new_drinkdriving <- drinkdriving
[1] 82
new_drinkdriving <- new_drinkdriving[-154, ]
[1] 83
new_drinkdriving <- new_drinkdriving[-110, ]
[1] 84
New_NightSpeed <- lm(bac ~ age + nighttime + speed, data = new_drinkdriving)
[1] 85
anova(New_NightSpeed)
[1] 86
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1163.1 1163.14 38.3777 2.948e-09 ***
nighttime   1  721.4  721.42 23.8033 2.082e-06 ***
speed       1   35.8   35.83  1.1821    0.2782    
Residuals 214 6485.9   30.31                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
anova(m1_NightSpeed)
[1] 87
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1274.8 1274.83  32.547 3.803e-08 ***
nighttime   1  641.3  641.31  16.373 7.244e-05 ***
speed       1 1036.8 1036.79  26.470 6.000e-07 ***
Residuals 216 8460.4   39.17                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(New_NightSpeed)
[1] 88

Call:
lm(formula = bac ~ age + nighttime + speed, data = new_drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.7811  -4.6224   0.5195   3.7225  14.2190 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    22.99435    2.68293   8.571 2.06e-15 ***
age            -0.10600    0.03007  -3.525 0.000518 ***
nighttimenight  3.92649    0.80461   4.880 2.07e-06 ***
speed           0.04340    0.03992   1.087 0.278151    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.505 on 214 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.2284,	Adjusted R-squared:  0.2176 
F-statistic: 21.12 on 3 and 214 DF,  p-value: 5.044e-12

summary(m1_NightSpeed)
[1] 89

Call:
lm(formula = bac ~ age + nighttime + speed, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-13.291  -4.650   0.136   3.971  33.088 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    14.15205    2.74426   5.157 5.67e-07 ***
age            -0.03148    0.03233  -0.974    0.331    
nighttimenight  3.84615    0.90937   4.229 3.46e-05 ***
speed           0.19824    0.03853   5.145 6.00e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.258 on 216 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.2587,	Adjusted R-squared:  0.2484 
F-statistic: 25.13 on 3 and 216 DF,  p-value: 5.5e-14

par(mfrow = c(2, 2))
[1] 90
$mfrow
[1] 1 1

plot(New_NightSpeed, which = c(1:4))
[1] 91
par(mfrow = c(1, 1))
[1] 92
$mfrow
[1] 2 2

hist(residuals(New_NightSpeed))
[1] 93
shapiro.test(residuals(New_NightSpeed))
[1] 94

	Shapiro-Wilk normality test

data:  residuals(New_NightSpeed)
W = 0.9919, p-value = 0.2708

residualPlots(model = New_NightSpeed)
[1] 95
vif(mod = New_NightSpeed)
[1] 96
      age nighttime     speed 
 1.841167  1.007397  1.833612 
summary(New_NightSpeed)
[1] 97

Call:
lm(formula = bac ~ age + nighttime + speed, data = new_drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.7811  -4.6224   0.5195   3.7225  14.2190 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    22.99435    2.68293   8.571 2.06e-15 ***
age            -0.10600    0.03007  -3.525 0.000518 ***
nighttimenight  3.92649    0.80461   4.880 2.07e-06 ***
speed           0.04340    0.03992   1.087 0.278151    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.505 on 214 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.2284,	Adjusted R-squared:  0.2176 
F-statistic: 21.12 on 3 and 214 DF,  p-value: 5.044e-12

standardCoefs(New_NightSpeed)
[1] 98
                         b        beta
age            -0.10600084 -0.28717175
nighttimenight  3.92649260  0.29409847
speed           0.04340121  0.08840106
boxplot(speed ~ nighttime, data = drinkdriving)
[1] 99
with(drinkdriving, shapiro.test(speed[nighttime == "night"]))
[1] 100

	Shapiro-Wilk normality test

data:  speed[nighttime == "night"]
W = 0.994, p-value = 0.7127

with(drinkdriving, shapiro.test(speed[nighttime == "day"]))
[1] 101

	Shapiro-Wilk normality test

data:  speed[nighttime == "day"]
W = 0.85187, p-value = 2.148e-07

with(drinkdriving, hist(speed[nighttime == "night"]))
[1] 102
with(drinkdriving, hist(speed[nighttime == "day"]))
[1] 103
with(drinkdriving, qqnorm(y = speed[nighttime == "night"]))
[1] 104
$x
 [1]  0.47129946  0.39085227 -1.59321882 -2.18023878 -2.37510708  1.45308977 -2.04418097  0.67909760  0.43878309 -0.39085227
[11]  0.26699413  0.04399012  1.20534492 -0.50432205  1.70755309  1.23622681  0.58945580  0.20668316 -1.70755309 -1.49657867
[21]  0.00000000 -0.31286140  1.04020297  0.02932149  0.89943491  0.34380339 -1.17557167  0.87768081 -0.14711540 -0.60698683
[31]  1.37352034 -0.11753924 -1.84990332  1.49657867 -1.14680557 -0.19173062  0.14711540  1.77424041 -0.34380339 -1.09195291
[41] -1.06572116 -0.29750385 -0.83537114  0.62470644  0.50432205 -0.48774426  0.71649750  0.60698683 -1.64769534 -0.25183372
 [ reached getOption("max.print") -- omitted 121 entries ]

$y
 [1] 47.957110 47.260707 17.221097  1.945818  1.012149 63.748159  2.533468 50.049472 47.658553 35.044348 45.911152 41.971790 59.500756
[14] 33.660408 66.359756 59.538043 48.880880 44.464566 13.069805 19.008994 41.009485 36.335035 56.428161 41.609061 53.768251 46.424053
[27] 23.599427 52.982425 38.867482 32.599695 61.109335 39.685430 12.246206 64.659834 24.487799 37.870943 43.970933 67.448277 35.863871
[40] 24.561104 24.990720 36.576984 29.018013 49.062482 48.126988 33.965891 50.073730 48.930078 15.571026 37.038544
 [ reached getOption("max.print") -- omitted 121 entries ]

with(drinkdriving, qqnorm(y = speed[nighttime == "day"]))
[1] 105
$x
 [1]  0.42493223  0.22396465 -0.45992561  0.68448195 -0.03173480  0.53169579 -0.90194025  0.95066955 -0.32281488 -0.42493223
[11] -0.19154163 -1.31095367 -0.76707323  0.64490717  0.28956127  0.25662490  1.47862523  0.90194025 -0.53169579 -0.85526391
[21]  0.00000000 -1.17372217  0.09533262  0.49549158  1.05562573 -1.05562573 -0.28956127  0.39045174  0.45992561 -0.09533262
[31]  1.00176792  2.49324273 -2.49324273 -1.85714070 -0.68448195 -1.23942034 -0.25662490  1.31095367 -0.56861086 -0.12726056
[41] -0.22396465 -0.39045174  1.38990752 -0.95066955  0.06350160 -0.06350160 -1.00176792  1.58079879 -0.15931878  0.72515910
 [ reached getOption("max.print") -- omitted 29 entries ]

$y
 [1]  43.82635  41.39947  34.37751  46.20952  38.54431  45.29409  26.20556  49.69219  35.75941  34.63922  36.60929  24.91726  30.14128
[14]  45.71649  41.67467  41.53720  55.45155  49.31605  34.12046  26.68139  39.49010  25.05486  40.67786  45.16669  50.47164  25.74851
[27]  35.92294  43.23665  44.35755  37.07061  49.89957 120.33696  12.81285  14.36683  30.72692  25.04534  36.01675  55.25695  33.26215
[40]  36.94904  36.56302  34.64072  55.40192  25.98459  40.60026  37.72642  25.91057  56.75640  36.69207  47.85371
 [ reached getOption("max.print") -- omitted 29 entries ]

with(drinkdriving[drinkdriving$speed < 110, ], shapiro.test(speed[nighttime == 
    "day"]))
[1] 106

	Shapiro-Wilk normality test

data:  speed[nighttime == "day"]
W = 0.98687, p-value = 0.6076

with(drinkdriving[drinkdriving$speed < 110, ], qqnorm(y = speed[nighttime == 
    "day"]))
[1] 107
$x
 [1]  0.44842548  0.24340418 -0.44842548  0.71540476 -0.01606882  0.55788476 -0.89311634  0.99340460 -0.31019818 -0.41316302
[11] -0.17767992 -1.30378267 -0.75755413  0.67448975  0.31019818  0.27664686  1.57444497  0.94207577 -0.52071675 -0.84620947
[21]  0.01606882 -1.16606110  0.11271512  0.52071675  1.10483574 -1.04749401 -0.27664686  0.41316302  0.48425469 -0.08042727
[31]  1.04749401 -2.48871657 -1.85146584 -0.67448975 -1.23200098 -0.24340418  1.38299413 -0.55788476 -0.11271512 -0.21042839
[41] -0.37840709  1.47198236 -0.94207577  0.08042727 -0.04822307 -0.99340460  1.69675183 -0.14512094  0.75755413  2.48871657
 [ reached getOption("max.print") -- omitted 28 entries ]

$y
 [1] 43.82635 41.39947 34.37751 46.20952 38.54431 45.29409 26.20556 49.69219 35.75941 34.63922 36.60929 24.91726 30.14128 45.71649
[15] 41.67467 41.53720 55.45155 49.31605 34.12046 26.68139 39.49010 25.05486 40.67786 45.16669 50.47164 25.74851 35.92294 43.23665
[29] 44.35755 37.07061 49.89957 12.81285 14.36683 30.72692 25.04534 36.01675 55.25695 33.26215 36.94904 36.56302 34.64072 55.40192
[43] 25.98459 40.60026 37.72642 25.91057 56.75640 36.69207 47.85371 62.35337
 [ reached getOption("max.print") -- omitted 28 entries ]

par(mfrow = c(1, 1))
[1] 108
$mfrow
[1] 1 1

boxplot(speed[speed < 110] ~ nighttime[speed < 110], ylab = "Speed", 
    xlab = "Time of Day", data = drinkdriving)
[1] 109
t.test(speed[speed < 110] ~ nighttime[speed < 110], data = drinkdriving, 
    alternative = "less")
[1] 110

	Welch Two Sample t-test

data:  speed[speed < 110] by nighttime[speed < 110]
t = -1.4342, df = 196.74, p-value = 0.07656
alternative hypothesis: true difference in means is less than 0
95 percent confidence interval:
      -Inf 0.3754062
sample estimates:
  mean in group day mean in group night 
           38.47328            40.93767 

with(drinkdriving[drinkdriving$speed < 110, ], sd(speed[nighttime == 
    "day"]))
[1] 111
[1] 11.21228
with(drinkdriving[drinkdriving$speed < 110, ], sd(speed[nighttime == 
    "night"]))
[1] 112
[1] 15.14284
cohensD(speed[speed < 110] ~ nighttime[speed < 110], data = drinkdriving, 
    method = "unequal")
[1] 113
[1] 0.1849682
head(officer_inc)
[1] 114
  officer incident_id
1      AS     inc_189
2      IT      inc_50
3      IT     inc_159
4      AS     inc_178
5      IT     inc_184
6      AS     inc_198
describe(officer_inc)
[1] 115
             vars   n  mean    sd median trimmed   mad min max range skew kurtosis   se
officer*        1 249   1.8  0.84    2.0    1.76  1.48   1   3     2 0.38    -1.47 0.05
incident_id*    2 250 125.5 72.31  125.5  125.50 92.66   1 250   249 0.00    -1.21 4.57
table(officer_inc$officer)
[1] 116

 AS  IT  NP 
116  66  67 
class(officer_inc$officer)
[1] 117
[1] "factor"
table(officer_inc$incident_id)
[1] 118

  inc_1  inc_10 inc_100 inc_101 inc_102 inc_103 inc_104 inc_105 inc_106 inc_107 inc_108 inc_109  inc_11 inc_110 inc_111 inc_112 
      1       1       1       1       1       1       1       1       1       1       1       1       1       1       1       1 
inc_113 inc_114 inc_115 inc_116 inc_117 inc_118 inc_119  inc_12 inc_120 inc_121 inc_122 inc_123 inc_124 inc_125 inc_126 inc_127 
      1       1       1       1       1       1       1       1       1       1       1       1       1       1       1       1 
inc_128 inc_129  inc_13 inc_130 inc_131 inc_132 inc_133 inc_134 inc_135 inc_136 inc_137 inc_138 inc_139  inc_14 inc_140 inc_141 
      1       1       1       1       1       1       1       1       1       1       1       1       1       1       1       1 
inc_142 inc_143 
      1       1 
 [ reached getOption("max.print") -- omitted 200 entries ]
class(officer_inc$incident_id)
[1] 119
[1] "factor"
merged.data <- merge(drinkdriving, officer_inc, all = T)
[1] 120
describe(merged.data)
[1] 121
             vars   n  mean    sd median trimmed   mad min  max range  skew kurtosis   se
incident_id*    1 250   NaN    NA     NA     NaN    NA Inf -Inf  -Inf    NA       NA   NA
age             2 225 42.68 16.77     40   41.93 17.79  14   90    76  0.40    -0.52 1.12
nighttime*      3 250  1.68  0.47      2    1.73  0.00   1    2     1 -0.79    -1.39 0.03
 [ reached 'max' / getOption("max.print") -- omitted 5 rows ]
class(merged.data$incident_id)
[1] 122
[1] "character"
class(merged.data$officer)
[1] 123
[1] "factor"
merged.data$recoded.outcome <- ifelse(merged.data$outcome == 
    "fine", 1, 0)
[1] 124
logit_outcome <- glm(recoded.outcome ~ age + nighttime + relevel(prior_offence, 
    "N") + speed + bac + officer, family = binomial, data = merged.data)
[1] 125
anova(logit_outcome, test = "Chisq")
[1] 126
Analysis of Deviance Table

Model: binomial, link: logit

Response: recoded.outcome

Terms added sequentially (first to last)


                            Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                                          215    209.932              
age                          1   78.805       214    131.127 < 2.2e-16 ***
nighttime                    1    1.550       213    129.577    0.2132    
relevel(prior_offence, "N") 11   44.142       202     85.435 6.863e-06 ***
speed                        1   17.815       201     67.620 2.434e-05 ***
bac                          1   31.636       200     35.984 1.860e-08 ***
officer                      2    0.691       198     35.293    0.7078    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(logit_outcome)
[1] 127

Call:
glm(formula = recoded.outcome ~ age + nighttime + relevel(prior_offence, 
    "N") + speed + bac + officer, family = binomial, data = merged.data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.7769   0.0001   0.0031   0.0405   2.1237  

Coefficients:
                                            Estimate Std. Error z value Pr(>|z|)    
(Intercept)                                7.492e-02  4.403e+00   0.017 0.986424    
age                                       -2.679e-01  8.112e-02  -3.302 0.000959 ***
nighttimenight                            -3.967e-01  1.079e+00  -0.368 0.713160    
relevel(prior_offence, "N")CD10            2.793e+01  6.940e+03   0.004 0.996789    
relevel(prior_offence, "N")CD60           -2.914e+01  1.075e+04  -0.003 0.997838    
relevel(prior_offence, "N")CD60,CD10,DR80 -1.686e+01  1.075e+04  -0.002 0.998749    
relevel(prior_offence, "N")CD60,CD60      -2.612e+01  1.075e+04  -0.002 0.998062    
relevel(prior_offence, "N")DR50            3.195e+00  1.527e+00   2.092 0.036400 *  
relevel(prior_offence, "N")DR80           -8.629e+00  3.454e+00  -2.499 0.012470 *  
relevel(prior_offence, "N")PL10            3.355e+00  9.949e+02   0.003 0.997309    
 [ reached getOption("max.print") -- omitted 8 rows ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 209.932  on 215  degrees of freedom
Residual deviance:  35.293  on 198  degrees of freedom
  (34 observations deleted due to missingness)
AIC: 71.293

Number of Fisher Scoring iterations: 18

exp(coef(logit_outcome))
[1] 128
                              (Intercept)                                       age                            nighttimenight 
                             1.077796e+00                              7.649956e-01                              6.725289e-01 
          relevel(prior_offence, "N")CD10           relevel(prior_offence, "N")CD60 relevel(prior_offence, "N")CD60,CD10,DR80 
                             1.342927e+12                              2.213014e-13                              4.785850e-08 
     relevel(prior_offence, "N")CD60,CD60           relevel(prior_offence, "N")DR50           relevel(prior_offence, "N")DR80 
                             4.513166e-12                              2.441580e+01                              1.787643e-04 
          relevel(prior_offence, "N")PL10           relevel(prior_offence, "N")SP50           relevel(prior_offence, "N")SP60 
                             2.864950e+01                              8.880504e+02                              2.219445e-12 
          relevel(prior_offence, "N")TS70      relevel(prior_offence, "N")TS70,DR50                                     speed 
                             1.754916e+10                              2.047791e-07                              1.233816e+00 
                                      bac                                 officerIT                                 officerNP 
                             1.632541e+00                              4.825915e-01                              4.077957e-01 
exp(confint(logit_outcome))
[1] 129
                                                  2.5 %       97.5 %
(Intercept)                                1.772972e-04 9.682298e+03
age                                        6.239044e-01 8.690876e-01
nighttimenight                             7.330322e-02 5.649725e+00
relevel(prior_offence, "N")CD10            0.000000e+00           NA
relevel(prior_offence, "N")CD60                      NA          Inf
relevel(prior_offence, "N")CD60,CD10,DR80  0.000000e+00           NA
relevel(prior_offence, "N")CD60,CD60       0.000000e+00           NA
relevel(prior_offence, "N")DR50            2.021140e+00 1.137079e+03
relevel(prior_offence, "N")DR80            5.894164e-08 6.118045e-02
relevel(prior_offence, "N")PL10            9.908709e-23 8.283563e+24
relevel(prior_offence, "N")SP50           1.309393e-294           NA
relevel(prior_offence, "N")SP60                      NA          Inf
relevel(prior_offence, "N")TS70            0.000000e+00           NA
relevel(prior_offence, "N")TS70,DR50                 NA          Inf
speed                                      1.107281e+00 1.433628e+00
bac                                        1.308668e+00 2.232329e+00
officerIT                                  5.038093e-02 3.985426e+00
officerNP                                  2.723053e-02 4.671459e+00
guess <- fitted(logit_outcome)
[1] 130
guess <- ifelse(guess > 0.5, 1, 0)
[1] 131
hits <- sum(guess == merged.data$recoded.outcome)
[1] 132
hits/length(merged.data$recoded.outcome)
[1] 133
[1] 0.716
hits/length(fitted(logit_outcome))
[1] 134
[1] 0.8287037
Speed_v_Bac <- glm(recoded.outcome ~ speed + bac, data = merged.data, 
    family = binomial)
[1] 135
anova(Speed_v_Bac, test = "Chisq")
[1] 136
Analysis of Deviance Table

Model: binomial, link: logit

Response: recoded.outcome

Terms added sequentially (first to last)


      Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                    244     239.55              
speed  1   86.881       243     152.67 < 2.2e-16 ***
bac    1   22.541       242     130.13 2.058e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(Speed_v_Bac)
[1] 137

Call:
glm(formula = recoded.outcome ~ speed + bac, family = binomial, 
    data = merged.data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-4.0812   0.0436   0.1852   0.4434   1.9536  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -7.16443    1.24685  -5.746 9.14e-09 ***
speed        0.14705    0.02582   5.696 1.23e-08 ***
bac          0.17246    0.04110   4.197 2.71e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 239.55  on 244  degrees of freedom
Residual deviance: 130.13  on 242  degrees of freedom
  (5 observations deleted due to missingness)
AIC: 136.13

Number of Fisher Scoring iterations: 7

beta(Speed_v_Bac, x = TRUE, y = FALSE)
[1] 138

Call:
glm(formula = "recoded.outcome ~ speed.z + bac.z", family = binomial, 
    data = data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-4.0812   0.0436   0.1852   0.4434   1.9536  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)   2.8603     0.3707   7.717 1.19e-14 ***
speed.z       2.1875     0.3840   5.696 1.23e-08 ***
bac.z         1.2910     0.3076   4.197 2.71e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 239.55  on 244  degrees of freedom
Residual deviance: 130.13  on 242  degrees of freedom
AIC: 136.13

Number of Fisher Scoring iterations: 7

exp(2.1875)
[1] 139
[1] 8.912903
exp(1.291)
[1] 140
[1] 3.636421
table(drinkdriving$prior_offence)
[1] 141

          CD10           CD60 CD60,CD10,DR80      CD60,CD60           DR50           DR80              N           PL10           SP50 
             2              1              1              1             43              4            185              2              2 
          SP60           TS70      TS70,DR50 
             1              3              1 
merged.data$drinkdriving.related <- merged.data$prior_offence
[1] 142
all.equal(merged.data$drinkdriving.related, merged.data$prior_offence)
[1] 143
[1] TRUE
merged.data$recoded.outcome <- as.factor(merged.data$recoded.outcome)
[1] 144
is.factor(merged.data$recoded.outcome)
[1] 145
[1] TRUE
merged.data$drinkdriving.related[merged.data$drinkdriving.related == 
    "N"] <- NA
[1] 146
merged.data$drinkdriving.related <- droplevels(merged.data$drinkdriving.related)
[1] 147
table(merged.data$drinkdriving.related)
[1] 148

          CD10           CD60 CD60,CD10,DR80      CD60,CD60           DR50           DR80           PL10           SP50           SP60 
             2              1              1              1             43              4              2              2              1 
          TS70      TS70,DR50 
             3              1 
merged.data$drinkdriving.related <- as.character(merged.data$drinkdriving.related)
[1] 149
class(merged.data$drinkdriving.related)
[1] 150
[1] "character"
merged.data$drinkdriving.related[merged.data$drinkdriving.related == 
    "DR50"] <- "drinkdriving"
[1] 151
merged.data$drinkdriving.related[merged.data$drinkdriving.related == 
    "TS70,DR50"] <- "drinkdriving"
[1] 152
merged.data$drinkdriving.related[merged.data$drinkdriving.related != 
    "drinkdriving"] <- "non-drink"
[1] 153
table(merged.data$drinkdriving.related)
[1] 154

drinkdriving    non-drink 
          44           17 
merged.data$drinkdriving.related <- ifelse(merged.data$drinkdriving.related == 
    "drinkdriving", 1, 0)
[1] 155
merged.data$drinkdriving.related <- as.factor(merged.data$drinkdriving.related)
[1] 156
class(merged.data$drinkdriving.related)
[1] 157
[1] "factor"
logit_drink.v.nondrink <- glm(recoded.outcome ~ drinkdriving.related, 
    data = merged.data, family = binomial)
[1] 158
anova(logit_drink.v.nondrink, test = "Chisq")
[1] 159
Analysis of Deviance Table

Model: binomial, link: logit

Response: recoded.outcome

Terms added sequentially (first to last)


                     Df Deviance Resid. Df Resid. Dev Pr(>Chi)  
NULL                                    60     51.047           
drinkdriving.related  1   3.6421        59     47.405  0.05633 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(logit_drink.v.nondrink)
[1] 160

Call:
glm(formula = recoded.outcome ~ drinkdriving.related, family = binomial, 
    data = merged.data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1899   0.4366   0.4366   0.4366   0.8346  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)  
(Intercept)             0.8755     0.5323   1.645   0.1000  
drinkdriving.related1   1.4271     0.7472   1.910   0.0561 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 51.047  on 60  degrees of freedom
Residual deviance: 47.405  on 59  degrees of freedom
  (189 observations deleted due to missingness)
AIC: 51.405

Number of Fisher Scoring iterations: 5

exp(coef(logit_drink.v.nondrink))
[1] 161
          (Intercept) drinkdriving.related1 
             2.400000              4.166667 
merged.data$Motoring.Off <- merged.data$prior_offence
[1] 162
all.equal(merged.data$Motoring.Off, merged.data$prior_offence)
[1] 163
[1] TRUE
table(merged.data$Motoring.Off)
[1] 164

          CD10           CD60 CD60,CD10,DR80      CD60,CD60           DR50           DR80              N           PL10           SP50 
             2              1              1              1             43              4            185              2              2 
          SP60           TS70      TS70,DR50 
             1              3              1 
class(merged.data$Motoring.Off)
[1] 165
[1] "factor"
merged.data$Motoring.Off <- as.character(merged.data$Motoring.Off)
[1] 166
merged.data$Motoring.Off[merged.data$Motoring.Off != "N"] <- "motoring offence"
[1] 167
merged.data$Motoring.Off <- ifelse(merged.data$Motoring.Off == 
    "motoring offence", 1, 0)
[1] 168
logit_motoringoff <- glm(recoded.outcome ~ Motoring.Off, data = merged.data, 
    family = binomial)
[1] 169
anova(logit_motoringoff, test = "Chisq")
[1] 170
Analysis of Deviance Table

Model: binomial, link: logit

Response: recoded.outcome

Terms added sequentially (first to last)


             Df Deviance Resid. Df Resid. Dev Pr(>Chi)
NULL                           245     237.06         
Motoring.Off  1  0.86504       244     236.20   0.3523
summary(logit_motoringoff)
[1] 171

Call:
glm(formula = recoded.outcome ~ Motoring.Off, family = binomial, 
    data = merged.data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.9564   0.5650   0.6681   0.6681   0.6681  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept)    1.3863     0.1838   7.542 4.62e-14 ***
Motoring.Off   0.3677     0.4051   0.908    0.364    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 237.06  on 245  degrees of freedom
Residual deviance: 236.20  on 244  degrees of freedom
  (4 observations deleted due to missingness)
AIC: 240.2

Number of Fisher Scoring iterations: 4

exp(coef(logit_motoringoff))
[1] 172
 (Intercept) Motoring.Off 
    4.000000     1.444444 
logit_Age <- glm(recoded.outcome ~ age + relevel(prior_offence, 
    ref = "N") + nighttime + speed + bac, data = merged.data, 
    family = binomial)
[1] 173
anova(logit_Age, test = "Chisq")
[1] 174
Analysis of Deviance Table

Model: binomial, link: logit

Response: recoded.outcome

Terms added sequentially (first to last)


                                  Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                                                215    209.932              
age                                1   78.805       214    131.127 < 2.2e-16 ***
relevel(prior_offence, ref = "N") 11   44.537       203     86.589 5.851e-06 ***
nighttime                          1    1.154       202     85.435    0.2827    
speed                              1   17.815       201     67.620 2.434e-05 ***
bac                                1   31.636       200     35.984 1.860e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(logit_Age)
[1] 175

Call:
glm(formula = recoded.outcome ~ age + relevel(prior_offence, 
    ref = "N") + nighttime + speed + bac, family = binomial, 
    data = merged.data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.9572   0.0001   0.0038   0.0522   2.0824  

Coefficients:
                                                  Estimate Std. Error z value Pr(>|z|)    
(Intercept)                                     -1.158e+00  4.057e+00  -0.285 0.775334    
age                                             -2.490e-01  7.275e-02  -3.422 0.000621 ***
relevel(prior_offence, ref = "N")CD10            2.740e+01  7.020e+03   0.004 0.996886    
relevel(prior_offence, ref = "N")CD60           -2.885e+01  1.075e+04  -0.003 0.997860    
relevel(prior_offence, ref = "N")CD60,CD10,DR80 -1.599e+01  1.075e+04  -0.001 0.998814    
relevel(prior_offence, ref = "N")CD60,CD60      -2.401e+01  1.075e+04  -0.002 0.998219    
relevel(prior_offence, ref = "N")DR50            3.212e+00  1.588e+00   2.023 0.043083 *  
relevel(prior_offence, ref = "N")DR80           -7.608e+00  3.013e+00  -2.525 0.011572 *  
relevel(prior_offence, ref = "N")PL10            3.787e+00  6.887e+02   0.005 0.995612    
relevel(prior_offence, ref = "N")SP50            7.965e+00  6.859e+03   0.001 0.999073    
 [ reached getOption("max.print") -- omitted 6 rows ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 209.932  on 215  degrees of freedom
Residual deviance:  35.984  on 200  degrees of freedom
  (34 observations deleted due to missingness)
AIC: 67.984

Number of Fisher Scoring iterations: 18

coef(logit_Age)
[1] 176
                                    (Intercept)                                             age 
                                     -1.1579508                                      -0.2489718 
          relevel(prior_offence, ref = "N")CD10           relevel(prior_offence, ref = "N")CD60 
                                     27.4007847                                     -28.8489552 
relevel(prior_offence, ref = "N")CD60,CD10,DR80      relevel(prior_offence, ref = "N")CD60,CD60 
                                    -15.9868557                                     -24.0060720 
          relevel(prior_offence, ref = "N")DR50           relevel(prior_offence, ref = "N")DR80 
                                      3.2120184                                      -7.6077783 
          relevel(prior_offence, ref = "N")PL10           relevel(prior_offence, ref = "N")SP50 
                                      3.7873092                                       7.9649297 
          relevel(prior_offence, ref = "N")SP60           relevel(prior_offence, ref = "N")TS70 
                                    -25.9426179                                      22.8840193 
     relevel(prior_offence, ref = "N")TS70,DR50                                  nighttimenight 
                                    -15.9062814                                      -0.2540993 
                                          speed                                             bac 
                                      0.2047484                                       0.4763906 
x <- seq(14, 90, length.out = 200)
[1] 177
y <- logit.to.p(-1.1579508 + (-0.2489718 * x) + (0.2047484 * 
    30))
[1] 178
PLOTPredProbFine <- plot(y ~ x, type = "l", col = "red", lwd = 2.5, 
    xlab = "Age (in years)", ylab = "p(Fine)", main = "Predicted probabilities of receiving a fine by driver age", 
    bty = "L", font.lab = 2)
[1] 179
table(merged.data$officer)
[1] 180

 AS  IT  NP 
116  66  67 
logit_cops <- glm(outcome ~ age * officer, data = merged.data, 
    family = binomial)
[1] 181
anova(logit_cops, test = "Chisq")
[1] 182
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


            Df Deviance Resid. Df Resid. Dev Pr(>Chi)    
NULL                          224     222.38             
age          1   67.728       223     154.65  < 2e-16 ***
officer      2    0.861       221     153.79  0.65013    
age:officer  2    7.383       219     146.41  0.02494 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(logit_cops)
[1] 183

Call:
glm(formula = outcome ~ age * officer, family = binomial, data = merged.data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.4089  -0.5454  -0.2741  -0.0642   2.7179  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept)   -9.56920    1.99554  -4.795 1.62e-06 ***
age            0.16122    0.03466   4.652 3.29e-06 ***
officerIT      5.04535    2.39610   2.106   0.0352 *  
officerNP      4.68465    2.48887   1.882   0.0598 .  
age:officerIT -0.09612    0.04254  -2.260   0.0238 *  
age:officerNP -0.09365    0.04405  -2.126   0.0335 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 222.38  on 224  degrees of freedom
Residual deviance: 146.41  on 219  degrees of freedom
  (25 observations deleted due to missingness)
AIC: 158.41

Number of Fisher Scoring iterations: 7

exp(coef(logit_cops))
[1] 184
  (Intercept)           age     officerIT     officerNP age:officerIT age:officerNP 
 6.984753e-05  1.174947e+00  1.552992e+02  1.082727e+02  9.083530e-01  9.105991e-01 
exp(0.16122 - 0.09612)
[1] 185
[1] 1.067266
exp(0.16122 - 0.09365)
[1] 186
[1] 1.069905
