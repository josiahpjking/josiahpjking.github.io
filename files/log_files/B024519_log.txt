

	####### B024519 R script #######

library(ggplot2, quietly = T)
[1] 1
[1] "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(psych, quietly = T)
[1] 2
 [1] "psych"     "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(tidyr, quietly = T)
[1] 3
 [1] "tidyr"     "psych"     "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
load(url("https://edin.ac/2QCZNVu"))
[1] 4
[1] "drinkdriving" "officer_inc" 
summary(drinkdriving)
[1] 5
      age          nighttime         prior_offence          speed             bac           outcome          incident_id       
 Min.   : 14.00   Length:250         Length:250         Min.   :  0.00   Min.   : 3.987   Length:250         Length:250        
 1st Qu.: 30.00   Class :character   Class :character   1st Qu.: 30.92   1st Qu.:19.264   Class :character   Class :character  
 Median : 40.50   Mode  :character   Mode  :character   Median : 40.64   Median :23.609   Mode  :character   Mode  :character  
 Mean   : 46.00                                         Mean   : 40.49   Mean   :23.605                                        
 3rd Qu.: 55.25                                         3rd Qu.: 48.84   3rd Qu.:27.898                                        
 Max.   :297.00                                         Max.   :120.34   Max.   :65.764                                        
 NA's   :22                                                              NA's   :5                                             
plot(drinkdriving$age)
[1] 6
drinkdriving$age[drinkdriving$age > 100] <- NA
[1] 7
describe(drinkdriving$age)
[1] 8
   vars   n  mean    sd median trimmed   mad min max range skew kurtosis   se
X1    1 225 42.68 16.77     40   41.93 17.79  14  90    76  0.4    -0.52 1.12
drinkdriving$nighttime <- as.factor(drinkdriving$nighttime)
[1] 9
levels(drinkdriving$nighttime)
[1] 10
[1] "18:25" "2:05"  "day"   "night"
drinkdriving$nighttime[drinkdriving$nighttime == "18:25"] <- NA
[1] 11
drinkdriving$nighttime[drinkdriving$nighttime == "2:05"] <- NA
[1] 12
drinkdriving$nighttime <- droplevels(drinkdriving$nighttime)
[1] 13
drinkdriving$prior_offence <- as.factor(drinkdriving$prior_offence)
[1] 14
levels(drinkdriving$prior_offence)
[1] 15
 [1] "CD10"           "CD60"           "CD60,CD10,DR80" "CD60,CD60"      "DD20"           "DR50"           "DR80"          
 [8] "N"              "PL10"           "SP50"           "SP60"           "TS70"           "TS70,DR50"     
summary(drinkdriving$prior_offence)
[1] 16
          CD10           CD60 CD60,CD10,DR80      CD60,CD60           DD20           DR50           DR80              N           PL10 
             2              1              1              1              4             43              4            185              2 
          SP50           SP60           TS70      TS70,DR50 
             2              1              3              1 
drinkdriving$prior_offence[drinkdriving$prior_offence == "DD20"] <- NA
[1] 17
drinkdriving$prior_offence <- droplevels(drinkdriving$prior_offence)
[1] 18
plot(drinkdriving$speed)
[1] 19
summary(drinkdriving$speed)
[1] 20
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00   30.92   40.64   40.49   48.84  120.34 
drinkdriving$speed <- round(drinkdriving$speed, digits = 0)
[1] 21
plot(drinkdriving$bac)
[1] 22
drinkdriving$bac <- drinkdriving$bac/100
[1] 23
describe(drinkdriving$bac)
[1] 24
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis se
X1    1 245 0.24 0.07   0.24    0.24 0.06 0.04 0.66  0.62 0.77      4.7  0
drinkdriving$bac <- round(drinkdriving$bac, digits = 3)
[1] 25
drinkdriving$outcome <- as.factor(drinkdriving$outcome)
[1] 26
levels(drinkdriving$outcome)
[1] 27
[1] "fine"    "Fine"    "FINE"    "warning" "Warning" "WARNING"
drinkdriving$outcome[drinkdriving$outcome == "Fine" | drinkdriving$outcome == 
    "FINE"] <- "fine"
[1] 28
drinkdriving$outcome[drinkdriving$outcome == "Warning" | drinkdriving$outcome == 
    "WARNING"] <- "warning"
[1] 29
drinkdriving$outcome <- droplevels(drinkdriving$outcome)
[1] 30
drinkdriving$incident_id <- as.factor(drinkdriving$incident_id)
[1] 31
describe(drinkdriving)
[1] 32
               vars   n  mean    sd median trimmed   mad min max range  skew kurtosis   se
age               1 225 42.68 16.77     40   41.93 17.79  14  90    76  0.40    -0.52 1.12
nighttime*        2 247  1.68  0.47      2    1.73  0.00   1   2     1 -0.79    -1.38 0.03
prior_offence*    3 246  6.64  1.21      7    6.74  0.00   1  12    11 -0.55     6.75 0.08
 [ reached 'max' / getOption("max.print") -- omitted 4 rows ]
describe(officer_inc)
[1] 33
             vars   n  mean    sd median trimmed   mad min max range skew kurtosis   se
officer*        1 249   1.8  0.84    2.0    1.76  1.48   1   3     2 0.38    -1.47 0.05
incident_id*    2 250 125.5 72.31  125.5  125.50 92.66   1 250   249 0.00    -1.21 4.57
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 34
plot(m1)
[1] 35
plot(m1, which = 4)
[1] 36
m1a <- lm(bac ~ age, data = drinkdriving, subset = -154)
[1] 37
summary(m1a)
[1] 38

Call:
lm(formula = bac ~ age, data = drinkdriving, subset = -154)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.15485 -0.04312 -0.00718  0.03985  0.32349 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.2913502  0.0113882  25.584  < 2e-16 ***
age         -0.0014429  0.0002486  -5.805 2.27e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.06184 on 217 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1344,	Adjusted R-squared:  0.1304 
F-statistic: 33.69 on 1 and 217 DF,  p-value: 2.271e-08

m1b <- lm(bac ~ age, data = drinkdriving, subset = -110)
[1] 39
summary(m1b)
[1] 40

Call:
lm(formula = bac ~ age, data = drinkdriving, subset = -110)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.15471 -0.04365 -0.00680  0.03902  0.42954 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.2883832  0.0119559  24.120  < 2e-16 ***
age         -0.0013620  0.0002607  -5.225 4.08e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.06475 on 217 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1118,	Adjusted R-squared:  0.1077 
F-statistic:  27.3 on 1 and 217 DF,  p-value: 4.079e-07

m1c <- lm(bac ~ age, data = drinkdriving, subset = -115)
[1] 41
summary(m1c)
[1] 42

Call:
lm(formula = bac ~ age, data = drinkdriving, subset = -115)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.15660 -0.04505 -0.00841  0.03807  0.42759 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.2900017  0.0126738  22.882  < 2e-16 ***
age         -0.0013544  0.0002785  -4.863 2.22e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.06801 on 217 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.09827,	Adjusted R-squared:  0.09411 
F-statistic: 23.65 on 1 and 217 DF,  p-value: 2.22e-06

m1d <- lm(bac ~ age, data = drinkdriving, subset = -101)
[1] 43
summary(m1d)
[1] 44

Call:
lm(formula = bac ~ age, data = drinkdriving, subset = -101)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.15373 -0.04526 -0.00852  0.03742  0.42748 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.2944411  0.0124497   23.65  < 2e-16 ***
age         -0.0014528  0.0002715   -5.35 2.23e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.06752 on 217 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1165,	Adjusted R-squared:  0.1125 
F-statistic: 28.62 on 1 and 217 DF,  p-value: 2.228e-07

summary(m1)
[1] 45

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.15673 -0.04488 -0.00843  0.03834  0.42817 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.2928974  0.0125573  23.325   <2e-16 ***
age         -0.0014333  0.0002742  -5.228    4e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.0682 on 218 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1114,	Adjusted R-squared:  0.1073 
F-statistic: 27.33 on 1 and 218 DF,  p-value: 4.002e-07

new_age <- data.frame(age = 50)
[1] 46
predict(m1, newdata = new_age)
[1] 47
        1 
0.2212304 
hist(residuals(m1), breaks = 25)
[1] 48
hist(rstandard(model = m1), breaks = 20, main = "Figure 1: Histogram of Standardised Residuals from Model 1", 
    xlab = "Standardised Residuals")
[1] 49
m2 <- lm(bac ~ age + nighttime, data = drinkdriving)
[1] 50
summary(m2)
[1] 51

Call:
lm(formula = bac ~ age + nighttime, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.16456 -0.04683  0.00076  0.03565  0.41681 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.2683336  0.0142240  18.865  < 2e-16 ***
age            -0.0014415  0.0002665  -5.410 1.68e-07 ***
nighttimenight  0.0362763  0.0095326   3.805 0.000185 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.06549 on 215 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.1808,	Adjusted R-squared:  0.1732 
F-statistic: 23.72 on 2 and 215 DF,  p-value: 4.9e-10

anova(m2)
[1] 52
Analysis of Variance Table

Response: bac
           Df  Sum Sq  Mean Sq F value    Pr(>F)    
age         1 0.14140 0.141397  32.965 3.172e-08 ***
nighttime   1 0.06212 0.062118  14.482 0.0001845 ***
Residuals 215 0.92221 0.004289                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m3 <- lm(bac ~ age + speed, data = drinkdriving)
[1] 53
summary(m3)
[1] 54

Call:
lm(formula = bac ~ age + speed, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.15857 -0.04434 -0.00766  0.04223  0.34566 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.1743508  0.0273218   6.381 1.05e-09 ***
age         -0.0004266  0.0003342  -1.276    0.203    
speed        0.0019353  0.0004010   4.826 2.63e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.06496 on 217 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1975,	Adjusted R-squared:  0.1901 
F-statistic: 26.71 on 2 and 217 DF,  p-value: 4.265e-11

anova(m3)
[1] 55
Analysis of Variance Table

Response: bac
           Df  Sum Sq  Mean Sq F value    Pr(>F)    
age         1 0.12714 0.127142  30.129 1.123e-07 ***
speed       1 0.09828 0.098279  23.289 2.626e-06 ***
Residuals 217 0.91572 0.004220                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m4 <- lm(bac ~ age + nighttime + speed, data = drinkdriving)
[1] 56
summary(m4)
[1] 57

Call:
lm(formula = bac ~ age + nighttime + speed, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.13255 -0.04599  0.00114  0.03821  0.33103 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.1447737  0.0273686   5.290 3.02e-07 ***
age            -0.0003960  0.0003226  -1.228    0.221    
nighttimenight  0.0382983  0.0090148   4.248 3.21e-05 ***
speed           0.0019917  0.0003843   5.182 5.05e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.06188 on 214 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.2721,	Adjusted R-squared:  0.2619 
F-statistic: 26.67 on 3 and 214 DF,  p-value: 1.073e-14

anova(m4)
[1] 58
Analysis of Variance Table

Response: bac
           Df  Sum Sq  Mean Sq F value    Pr(>F)    
age         1 0.14140 0.141397  36.929 5.541e-09 ***
nighttime   1 0.06212 0.062118  16.224 7.818e-05 ***
speed       1 0.10283 0.102835  26.858 5.054e-07 ***
Residuals 214 0.81937 0.003829                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
plot(m4)
[1] 59
plot(m4, which = 4)
[1] 60
m4a <- lm(bac ~ age + speed + nighttime, data = drinkdriving, 
    subset = -c(154, 110))
[1] 61
summary(m4a)
[1] 62

Call:
lm(formula = bac ~ age + speed + nighttime, data = drinkdriving, 
    subset = -c(154, 110))

Residuals:
      Min        1Q    Median        3Q       Max 
-0.155909 -0.043940  0.005829  0.035693  0.142777 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.2348830  0.0266779   8.804 4.71e-16 ***
age            -0.0011555  0.0002989  -3.865 0.000147 ***
speed           0.0004169  0.0003971   1.050 0.295006    
nighttimenight  0.0387789  0.0079356   4.887 2.02e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05416 on 212 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.2458,	Adjusted R-squared:  0.2351 
F-statistic: 23.03 on 3 and 212 DF,  p-value: 6.078e-13

plot(m4a, which = 4)
[1] 63
drinkdriving$bac[drinkdriving$bac == 0.658 | drinkdriving$bac == 
    0.573] <- NA
[1] 64
m4 <- lm(bac ~ age + nighttime + speed, data = drinkdriving)
[1] 65
plot(m4)
[1] 66
summary(m4)
[1] 67

Call:
lm(formula = bac ~ age + nighttime + speed, data = drinkdriving)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.155909 -0.043940  0.005829  0.035693  0.142777 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.2348830  0.0266779   8.804 4.71e-16 ***
age            -0.0011555  0.0002989  -3.865 0.000147 ***
nighttimenight  0.0387789  0.0079356   4.887 2.02e-06 ***
speed           0.0004169  0.0003971   1.050 0.295006    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05416 on 212 degrees of freedom
  (34 observations deleted due to missingness)
Multiple R-squared:  0.2458,	Adjusted R-squared:  0.2351 
F-statistic: 23.03 on 3 and 212 DF,  p-value: 6.078e-13

anova(m4)
[1] 68
Analysis of Variance Table

Response: bac
           Df  Sum Sq  Mean Sq F value    Pr(>F)    
age         1 0.12965 0.129650 44.1932 2.478e-10 ***
nighttime   1 0.06977 0.069775 23.7838 2.113e-06 ***
speed       1 0.00323 0.003233  1.1021     0.295    
Residuals 212 0.62195 0.002934                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
plot(drinkdriving$speed ~ drinkdriving$nighttime, main = "Boxplot of Driving Speeds at Day and Night", 
    xlab = "Time of Day", ylab = "Speed (mph)")
[1] 69
t.test(drinkdriving$speed ~ drinkdriving$nighttime)
[1] 70

	Welch Two Sample t-test

data:  drinkdriving$speed by drinkdriving$nighttime
t = -0.78114, df = 157.3, p-value = 0.4359
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -5.512046  2.387786
sample estimates:
  mean in group day mean in group night 
           39.30769            40.86982 

levels(drinkdriving$prior_offence)
[1] 71
 [1] "CD10"           "CD60"           "CD60,CD10,DR80" "CD60,CD60"      "DR50"           "DR80"           "N"             
 [8] "PL10"           "SP50"           "SP60"           "TS70"           "TS70,DR50"     
drinkdriving$prior_offence <- as.character(drinkdriving$prior_offence)
[1] 72
class(drinkdriving$prior_offence)
[1] 73
[1] "character"
drinkdriving$prior_offence[drinkdriving$prior_offence == "CD10" | 
    drinkdriving$prior_offence == "CD60" | drinkdriving$prior_offence == 
    "CD60,CD60" | drinkdriving$prior_offence == "CD60,CD10,DR80"] <- "CD"
[1] 74
drinkdriving$prior_offence[drinkdriving$prior_offence == "SP50" | 
    drinkdriving$prior_offence == "SP60"] <- "SP"
[1] 75
drinkdriving$prior_offence[drinkdriving$prior_offence == "TS70,DR50"] <- "DR50"
[1] 76
drinkdriving$prior_offence <- as.factor(drinkdriving$prior_offence)
[1] 77
drinkdriving$prior_offence <- droplevels(drinkdriving$prior_offence)
[1] 78
levels(drinkdriving$prior_offence)
[1] 79
[1] "CD"   "DR50" "DR80" "N"    "PL10" "SP"   "TS70"
plot(drinkdriving$age ~ drinkdriving$outcome)
[1] 80
plot(drinkdriving$speed ~ drinkdriving$outcome)
[1] 81
plot(drinkdriving$bac ~ drinkdriving$outcome)
[1] 82
plot(drinkdriving$nighttime ~ drinkdriving$outcome)
[1] 83
plot(drinkdriving$prior_offence ~ drinkdriving$outcome)
[1] 84
m6 <- glm(relevel(outcome, "warning") ~ relevel(prior_offence, 
    "N") + age + nighttime + scale(bac) + scale(speed), data = drinkdriving, 
    family = binomial)
[1] 85
summary(m6)
[1] 86

Call:
glm(formula = relevel(outcome, "warning") ~ relevel(prior_offence, 
    "N") + age + nighttime + scale(bac) + scale(speed), family = binomial, 
    data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-4.2385   0.0030   0.0402   0.1982   1.8866  

Coefficients:
                                  Estimate Std. Error z value Pr(>|z|)    
(Intercept)                       10.77606    2.35715   4.572 4.84e-06 ***
relevel(prior_offence, "N")CD      3.74848    1.93659   1.936 0.052916 .  
relevel(prior_offence, "N")DR50    2.07322    1.06558   1.946 0.051699 .  
relevel(prior_offence, "N")DR80   -4.58069    2.14069  -2.140 0.032369 *  
relevel(prior_offence, "N")PL10    2.05862   48.88009   0.042 0.966407    
relevel(prior_offence, "N")SP     -5.08997    1.88609  -2.699 0.006961 ** 
relevel(prior_offence, "N")TS70   17.63484 1445.37313   0.012 0.990265    
age                               -0.13403    0.03699  -3.624 0.000290 ***
nighttimenight                    -0.33181    0.75431  -0.440 0.660016    
scale(bac)                         1.91560    0.50940   3.760 0.000170 ***
 [ reached getOption("max.print") -- omitted 1 row ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 208.231  on 211  degrees of freedom
Residual deviance:  64.237  on 201  degrees of freedom
  (38 observations deleted due to missingness)
AIC: 86.237

Number of Fisher Scoring iterations: 15

anova(m6, test = "Chisq")
[1] 87
Analysis of Deviance Table

Model: binomial, link: logit

Response: relevel(outcome, "warning")

Terms added sequentially (first to last)


                            Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                                          211    208.231              
relevel(prior_offence, "N")  6    4.885       205    203.346    0.5586    
age                          1   94.632       204    108.713 < 2.2e-16 ***
nighttime                    1    0.279       203    108.434    0.5972    
scale(bac)                   1   20.028       202     88.406 7.633e-06 ***
scale(speed)                 1   24.169       201     64.237 8.822e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
coef(m6)
[1] 88
                    (Intercept)   relevel(prior_offence, "N")CD relevel(prior_offence, "N")DR50 relevel(prior_offence, "N")DR80 
                     10.7760650                       3.7484783                       2.0732154                      -4.5806908 
relevel(prior_offence, "N")PL10   relevel(prior_offence, "N")SP relevel(prior_offence, "N")TS70                             age 
                      2.0586151                      -5.0899733                      17.6348446                      -0.1340267 
                 nighttimenight                      scale(bac)                    scale(speed) 
                     -0.3318146                       1.9155953                       2.4761891 
drinkdriving$offence_type <- drinkdriving$prior_offence
[1] 89
levels(drinkdriving$offence_type)
[1] 90
[1] "CD"   "DR50" "DR80" "N"    "PL10" "SP"   "TS70"
drinkdriving$offence_type[drinkdriving$offence_type == "N"] <- NA
[1] 91
drinkdriving$offence_type <- as.character(drinkdriving$offence_type)
[1] 92
drinkdriving$offence_type[drinkdriving$offence_type == "DR80" | 
    drinkdriving$offence_type == "CD" | drinkdriving$offence_type == 
    "PL10" | drinkdriving$offence_type == "SP" | drinkdriving$offence_type == 
    "TS70"] <- "Other"
[1] 93
drinkdriving$offence_type <- as.factor(drinkdriving$offence_type)
[1] 94
drinkdriving$offence_type <- droplevels(drinkdriving$offence_type)
[1] 95
levels(drinkdriving$offence_type)
[1] 96
[1] "DR50"  "Other"
summary(drinkdriving$offence_type)
[1] 97
 DR50 Other  NA's 
   44    17   189 
m7 <- glm(relevel(outcome, "warning") ~ offence_type, data = drinkdriving, 
    family = binomial)
[1] 98
summary(m7)
[1] 99

Call:
glm(formula = relevel(outcome, "warning") ~ offence_type, family = binomial, 
    data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1899   0.4366   0.4366   0.4366   0.8346  

Coefficients:
                  Estimate Std. Error z value Pr(>|z|)    
(Intercept)         2.3026     0.5244   4.391 1.13e-05 ***
offence_typeOther  -1.4271     0.7472  -1.910   0.0561 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 51.047  on 60  degrees of freedom
Residual deviance: 47.405  on 59  degrees of freedom
  (189 observations deleted due to missingness)
AIC: 51.405

Number of Fisher Scoring iterations: 5

drinkdriving$offence_yn <- ifelse(drinkdriving$prior_offence == 
    "N", 0, 1)
[1] 100
m8 <- glm(outcome ~ offence_yn, data = drinkdriving, family = binomial)
[1] 101
summary(m8)
[1] 102

Call:
glm(formula = outcome ~ offence_yn, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.6681  -0.6681  -0.6681  -0.5650   1.9564  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -1.3863     0.1838  -7.542 4.62e-14 ***
offence_yn   -0.3677     0.4051  -0.908    0.364    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 237.06  on 245  degrees of freedom
Residual deviance: 236.20  on 244  degrees of freedom
  (4 observations deleted due to missingness)
AIC: 240.2

Number of Fisher Scoring iterations: 4

pred_fine <- with(drinkdriving, data.frame(age = c(14:90), nighttime = "day", 
    speed = 30, bac = 0, prior_offence = "N"))
[1] 103
predict(m6, newdata = pred_fine, type = "response")
[1] 104
          1           2           3           4           5           6           7           8           9          10          11 
0.610661448 0.578365389 0.545384750 0.512001036 0.478509916 0.445210881 0.412396604 0.380342818 0.349299425 0.319483427 0.291074032 
         12          13          14          15          16          17          18          19          20          21          22 
0.264210069 0.238989626 0.215471621 0.193678930 0.173602611 0.155206779 0.138433725 0.123208953 0.109445882 0.097050045 0.085922703 
         23          24          25          26          27          28          29          30          31          32          33 
0.075963842 0.067074561 0.059158905 0.052125205 0.045886989 0.040363557 0.035480258 0.031168565 0.027365979 0.024015812 0.021066891 
         34          35          36          37          38          39          40          41          42          43          44 
0.018473217 0.016193584 0.014191195 0.012433279 0.010890717 0.009537687 0.008351335 0.007311459 0.006400228 0.005601924 0.004902701 
         45          46          47          48          49          50 
0.004290378 0.003754242 0.003284882 0.002874033 0.002514440 0.002199739 
 [ reached getOption("max.print") -- omitted 27 entries ]
pred_fine$model_prediction <- predict(m6, newdata = pred_fine, 
    type = "response")
[1] 105
pred_fine$model_prediction <- round(pred_fine$model_prediction, 
    2)
[1] 106
ggplot(pred_fine, aes(age, model_prediction)) + geom_point() + 
    geom_smooth() + labs(title = "Figure 2: Visualisation of Predicted Probabilities", 
    x = "Age of Driver", y = "Predicted Probability of Receiving a Fine")
[1] 107
drinkdriving <- merge(officer_inc, drinkdriving, all.x = T)
[1] 108
plot(drinkdriving$age ~ drinkdriving$officer)
[1] 109
(ggplot(drinkdriving) + geom_point(aes(x = jitter(as.numeric(officer)), 
    y = age, colour = outcome)) + xlim(c("AS", "NP", "IT")) + 
    labs(x = "Officer Initials", title = "Figure 3: Exploration of Outcome by Officer and Age of Driver") + 
    scale_y_continuous(name = "Age of Driver", limits = c(10, 
        90), breaks = c(10, 30, 50, 70, 90)) + scale_color_discrete(name = "Outcome", 
    labels = c("Fine", "Warning")))
[1] 110
m9 <- glm(relevel(outcome, "warning") ~ age * officer, data = drinkdriving, 
    family = binomial)
[1] 111
summary(m9)
[1] 112

Call:
glm(formula = relevel(outcome, "warning") ~ age * officer, family = binomial, 
    data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.7179   0.0642   0.2741   0.5454   2.4089  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept)    9.56920    1.99554   4.795 1.62e-06 ***
age           -0.16122    0.03466  -4.652 3.29e-06 ***
officerIT     -5.04535    2.39610  -2.106   0.0352 *  
officerNP     -4.68465    2.48887  -1.882   0.0598 .  
age:officerIT  0.09612    0.04254   2.260   0.0238 *  
age:officerNP  0.09365    0.04405   2.126   0.0335 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 222.38  on 224  degrees of freedom
Residual deviance: 146.41  on 219  degrees of freedom
  (25 observations deleted due to missingness)
AIC: 158.41

Number of Fisher Scoring iterations: 7

anova(m9, test = "Chisq")
[1] 113
Analysis of Deviance Table

Model: binomial, link: logit

Response: relevel(outcome, "warning")

Terms added sequentially (first to last)


            Df Deviance Resid. Df Resid. Dev Pr(>Chi)    
NULL                          224     222.38             
age          1   67.728       223     154.65  < 2e-16 ***
officer      2    0.861       221     153.79  0.65013    
age:officer  2    7.383       219     146.41  0.02494 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
pred_bias_AS <- with(drinkdriving, data.frame(age = c(14:90), 
    officer = "AS"))
[1] 114
pred_bias_AS$prediction <- round(predict(m9, newdata = pred_bias_AS, 
    type = "response"), 3)
[1] 115
pred_bias_AS

   age officer prediction
1   14      AS      0.999
2   15      AS      0.999
3   16      AS      0.999
4   17      AS      0.999
5   18      AS      0.999
6   19      AS      0.999
7   20      AS      0.998
8   21      AS      0.998
9   22      AS      0.998
10  23      AS      0.997
11  24      AS      0.997
12  25      AS      0.996
13  26      AS      0.995
14  27      AS      0.995
15  28      AS      0.994
16  29      AS      0.993
 [ reached 'max' / getOption("max.print") -- omitted 61 rows ]


pred_bias_NP <- with(drinkdriving, data.frame(age = c(14:90), 
    officer = "NP"))
[1] 117
pred_bias_NP$prediction <- round(predict(m9, newdata = pred_bias_NP, 
    type = "response"), 3)
[1] 118
pred_bias_NP

   age officer prediction
1   14      NP      0.981
2   15      NP      0.980
3   16      NP      0.978
4   17      NP      0.977
5   18      NP      0.975
6   19      NP      0.973
7   20      NP      0.972
8   21      NP      0.970
9   22      NP      0.968
10  23      NP      0.965
11  24      NP      0.963
12  25      NP      0.961
13  26      NP      0.958
14  27      NP      0.955
15  28      NP      0.952
16  29      NP      0.949
 [ reached 'max' / getOption("max.print") -- omitted 61 rows ]


pred_bias_IT <- with(drinkdriving, data.frame(age = c(14:90), 
    officer = "IT"))
[1] 120
pred_bias_IT$prediction <- round(predict(m9, newdata = pred_bias_IT, 
    type = "response"), 3)
[1] 121
pred_bias_IT

   age officer prediction
1   14      IT      0.974
2   15      IT      0.972
3   16      IT      0.970
4   17      IT      0.968
5   18      IT      0.966
6   19      IT      0.964
7   20      IT      0.962
8   21      IT      0.959
9   22      IT      0.957
10  23      IT      0.954
11  24      IT      0.951
12  25      IT      0.948
13  26      IT      0.944
14  27      IT      0.941
15  28      IT      0.937
16  29      IT      0.933
 [ reached 'max' / getOption("max.print") -- omitted 61 rows ]


pred_bias_all <- data.frame(age = c(14:90))
[1] 123
pred_bias_all$Pred_AS <- pred_bias_AS$prediction
[1] 124
pred_bias_all$Pred_NP <- pred_bias_NP$prediction
[1] 125
pred_bias_all$Pred_IT <- pred_bias_IT$prediction
[1] 126
pred_bias_all <- pred_bias_all %>% pivot_longer(-age, names_to = "officer")
[1] 127
(ggplot(pred_bias_all) + geom_point(aes(x = age, y = value, colour = officer)) + 
    geom_smooth(aes(x = age, y = value, colour = officer), span = 0.3) + 
    labs(x = "Age of Driver", y = "Probability", title = "Figure 4: Probability of receiving a fine by officer and age of driver") + 
    scale_x_continuous(limits = c(10, 90), breaks = c(10, 20, 
        30, 40, 50, 60, 70, 80, 90)) + scale_y_continuous(breaks = c(0, 
    0.25, 0.5, 0.75, 1)) + scale_color_discrete(name = "Officer", 
    labels = c("Officer AS", "Officer IT", "Officer NP")))
[1] 128
