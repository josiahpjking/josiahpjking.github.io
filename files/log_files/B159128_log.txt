

	####### B159128 R script #######

library(ggplot2, quietly = T)
[1] 1
[1] "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(scatterplot3d, quietly = T)
[1] 2
 [1] "scatterplot3d" "ggplot2"       "readr"         "stats"         "graphics"      "grDevices"     "utils"         "datasets"     
 [9] "methods"       "base"         
load(url("https://edin.ac/2QCZNVu"))
[1] 3
[1] "drinkdriving" "officer_inc" 
View(drinkdriving)
[1] 4
View(officer_inc)
[1] 5
summary(drinkdriving)
[1] 6
      age          nighttime         prior_offence          speed             bac           outcome          incident_id       
 Min.   : 14.00   Length:250         Length:250         Min.   :  0.00   Min.   : 3.987   Length:250         Length:250        
 1st Qu.: 30.00   Class :character   Class :character   1st Qu.: 30.92   1st Qu.:19.264   Class :character   Class :character  
 Median : 40.50   Mode  :character   Mode  :character   Median : 40.64   Median :23.609   Mode  :character   Mode  :character  
 Mean   : 46.00                                         Mean   : 40.49   Mean   :23.605                                        
 3rd Qu.: 55.25                                         3rd Qu.: 48.84   3rd Qu.:27.898                                        
 Max.   :297.00                                         Max.   :120.34   Max.   :65.764                                        
 NA's   :22                                                              NA's   :5                                             
summary(officer_inc)
[1] 7
 officer     incident_id 
 AS  :116   inc_1  :  1  
 IT  : 66   inc_10 :  1  
 NP  : 67   inc_100:  1  
 NA's:  1   inc_101:  1  
            inc_102:  1  
            inc_103:  1  
            (Other):244  
drinkdriving$age[drinkdriving$age > 100] <- NA
[1] 8
table(drinkdriving$nighttime)
[1] 9

18:25  2:05   day night 
    1     2    78   169 
drinkdriving$nighttime[drinkdriving$nighttime == "18:25"] <- "day"
[1] 10
drinkdriving$nighttime[drinkdriving$nighttime == "2:05"] <- "night"
[1] 11
drinkdriving$nighttime <- as.factor(drinkdriving$nighttime)
[1] 12
class(drinkdriving$prior_offence)
[1] 13
[1] "character"
length(unique(drinkdriving$prior_offence))
[1] 14
[1] 13
table(drinkdriving$prior_offence)
[1] 15

          CD10           CD60 CD60,CD10,DR80      CD60,CD60           DD20           DR50           DR80              N           PL10 
             2              1              1              1              4             43              4            185              2 
          SP50           SP60           TS70      TS70,DR50 
             2              1              3              1 
drinkdriving$bac <- drinkdriving$bac/100
[1] 16
class(drinkdriving$outcome)
[1] 17
[1] "character"
table(drinkdriving$outcome)
[1] 18

   fine    Fine    FINE warning Warning WARNING 
    191       2       9      43       2       3 
drinkdriving$outcome[drinkdriving$outcome == "Fine"] <- "fine"
[1] 19
drinkdriving$outcome[drinkdriving$outcome == "FINE"] <- "fine"
[1] 20
drinkdriving$outcome[drinkdriving$outcome == "Warning"] <- "warning"
[1] 21
drinkdriving$outcome[drinkdriving$outcome == "WARNING"] <- "warning"
[1] 22
drinkdriving <- merge(drinkdriving, officer_inc, by = "incident_id")
[1] 23
drinkdriving$officer <- as.factor(drinkdriving$officer)
[1] 24
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 25
summary(m1)
[1] 26

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.15719 -0.04516 -0.00861  0.03849  0.42785 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.2929455  0.0125564  23.330  < 2e-16 ***
age         -0.0014353  0.0002741  -5.236 3.86e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.0682 on 218 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1117,	Adjusted R-squared:  0.1076 
F-statistic: 27.41 on 1 and 218 DF,  p-value: 3.863e-07

with(drinkdriving, plot(bac ~ age, xlab = "age", ylab = "bac", 
    main = "Relationship between bac and age", pch = 20))
[1] 27
abline(m1)
[1] 28
predict(m1, newdata = data.frame(age = 50), interval = "prediction", 
    level = 0.95)
[1] 29
        fit       lwr       upr
1 0.2211824 0.0864104 0.3559543
hist(m1$residuals, xlab = "residuals", ylab = "frequency", main = "Histogram of residuals")
[1] 30
qqnorm(m1$residuals)
[1] 31
$x
 [1] -1.00762117  0.65318602 -1.47241409 -2.83759691 -0.16596840 -0.71069586 -1.02673459  0.30667480  0.62523295  1.43953147
[11]  1.32141317  0.44116865  0.59776013  2.46670240  0.36697675  1.04623067  1.37806954 -1.62320563 -2.14668733 -1.88751635
[21] -0.09699889  0.08555750  0.57073127  0.28287491 -1.12854243 -1.29461074  0.68165908 -0.63914705  0.03988875  0.27103562
[31] -1.82380328 -0.34270795  0.10845300 -0.47916931  0.72544053 -2.27798833  0.20073078  0.47916931 -1.17271755  1.08646633
[41] -0.66735492 -0.39146366 -1.58205785  1.50697064  1.26870737 -0.84976717  1.24362839 -0.86623074 -1.08646633 -0.46642812
 [ reached getOption("max.print") -- omitted 170 entries ]

$y
           1            2            3            4            5            6            7            8            9           10 
-0.059832888  0.037363956 -0.090376433 -0.157187099 -0.017924624 -0.046288586 -0.061431195  0.017419993  0.035269129  0.089014071 
          11           12           13           14           15           16           17           19           20           21 
 0.084367011  0.023685214  0.032152472  0.321977130  0.019730875  0.058000380  0.086893861 -0.099248600 -0.110419215 -0.100043364 
          22           23           24           25           27           28           30           31           32           34 
-0.014118973  0.001110840  0.030477649  0.016843631 -0.066539551 -0.079679979  0.038659785 -0.044116127 -0.004617233  0.016643735 
          35           36           37           38           39           42           43           44           45           46 
-0.100038286 -0.028086300  0.005535803 -0.033592651  0.041270700 -0.120899178  0.008604929  0.026068679 -0.069210121  0.065050648 
          47           48           50           51           52           53           54           55           56           57 
-0.045064932 -0.030300336 -0.092305498  0.090264375  0.077507561 -0.050224032  0.077159254 -0.051149481 -0.065767916 -0.033154447 
 [ reached getOption("max.print") -- omitted 170 entries ]

qqline(m1$residuals)
[1] 32
m2 <- lm(bac ~ age + nighttime, data = drinkdriving)
[1] 33
anova(m2)
[1] 34
Analysis of Variance Table

Response: bac
           Df  Sum Sq  Mean Sq F value    Pr(>F)    
age         1 0.12748 0.127483  29.128 1.769e-07 ***
nighttime   1 0.06413 0.064131  14.653  0.000169 ***
Residuals 217 0.94972 0.004377                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m2)
[1] 35

Call:
lm(formula = bac ~ age + nighttime, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.16676 -0.04765  0.00061  0.03480  0.41603 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.2644185  0.0142796  18.517  < 2e-16 ***
age            -0.0013542  0.0002668  -5.076 8.27e-07 ***
nighttimenight  0.0367726  0.0096063   3.828 0.000169 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.06616 on 217 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1679,	Adjusted R-squared:  0.1602 
F-statistic: 21.89 on 2 and 217 DF,  p-value: 2.187e-09

s3dm2 <- with(drinkdriving, scatterplot3d(age, nighttime, bac, 
    main = "bac by age and nighttime"))
[1] 36
s3dm2$plane3d(m2)
[1] 37
NULL
m3 <- lm(bac ~ age + speed, data = drinkdriving)
[1] 38
anova(m3)
[1] 39
Analysis of Variance Table

Response: bac
           Df  Sum Sq  Mean Sq F value    Pr(>F)    
age         1 0.12748 0.127483  30.197 1.089e-07 ***
speed       1 0.09774 0.097744  23.153 2.800e-06 ***
Residuals 217 0.91611 0.004222                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m3)
[1] 40

Call:
lm(formula = bac ~ age + speed, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.15970 -0.04446 -0.00690  0.04282  0.34575 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.1749660  0.0272820   6.413 8.78e-10 ***
age         -0.0004303  0.0003344  -1.287      0.2    
speed        0.0019235  0.0003998   4.812 2.80e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.06497 on 217 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1973,	Adjusted R-squared:  0.1899 
F-statistic: 26.68 on 2 and 217 DF,  p-value: 4.384e-11

s3dm3 <- with(drinkdriving, scatterplot3d(age, speed, bac, main = "bac by age and speed"))
[1] 41
s3dm2$plane3d(m3)
[1] 42
NULL
summary(m2)
[1] 43

Call:
lm(formula = bac ~ age + nighttime, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.16676 -0.04765  0.00061  0.03480  0.41603 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.2644185  0.0142796  18.517  < 2e-16 ***
age            -0.0013542  0.0002668  -5.076 8.27e-07 ***
nighttimenight  0.0367726  0.0096063   3.828 0.000169 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.06616 on 217 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1679,	Adjusted R-squared:  0.1602 
F-statistic: 21.89 on 2 and 217 DF,  p-value: 2.187e-09

summary(m3)
[1] 44

Call:
lm(formula = bac ~ age + speed, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.15970 -0.04446 -0.00690  0.04282  0.34575 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.1749660  0.0272820   6.413 8.78e-10 ***
age         -0.0004303  0.0003344  -1.287      0.2    
speed        0.0019235  0.0003998   4.812 2.80e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.06497 on 217 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1973,	Adjusted R-squared:  0.1899 
F-statistic: 26.68 on 2 and 217 DF,  p-value: 4.384e-11

shapiro.test(drinkdriving$speed[drinkdriving$nighttime == "day"])
[1] 45

	Shapiro-Wilk normality test

data:  drinkdriving$speed[drinkdriving$nighttime == "day"]
W = 0.85187, p-value = 2.148e-07

shapiro.test(drinkdriving$speed[drinkdriving$nighttime == "night"])
[1] 46

	Shapiro-Wilk normality test

data:  drinkdriving$speed[drinkdriving$nighttime == "night"]
W = 0.994, p-value = 0.7127

bartlett.test(speed ~ nighttime, data = drinkdriving)
[1] 47

	Bartlett test of homogeneity of variances

data:  speed by nighttime
Bartlett's K-squared = 0.22757, df = 1, p-value = 0.6333

t.test(drinkdriving$speed[drinkdriving$nighttime == "day"], drinkdriving$speed[drinkdriving$nighttime == 
    "night"], paired = F, var.equal = T)
[1] 48

	Two Sample t-test

data:  drinkdriving$speed[drinkdriving$nighttime == "day"] and drinkdriving$speed[drinkdriving$nighttime == "night"]
t = -0.70317, df = 248, p-value = 0.4826
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -5.428365  2.572089
sample estimates:
mean of x mean of y 
 39.50953  40.93767 

prior_offence2 <- factor(drinkdriving$prior_offence, levels = c("N", 
    "CD10", "CD60", "CD60,CD10,DR80", "CD60,CD60", "DD20", "DR50", 
    "DR80", "PL10", "SP50", "SP60", "TS70", "TS70,DR50"), labels = c(0, 
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1))
[1] 49
plot(drinkdriving$age ~ drinkdriving$outcome)
[1] 50


####################################################################################################

[1] "Error in plot.window(...) : need finite 'xlim' values\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in plot.window(...): need finite 'xlim' values>
####################################################################################################


plot(drinkdriving$speed ~ drinkdriving$outcome)
[1] 51


####################################################################################################

[1] "Error in plot.window(...) : need finite 'xlim' values\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in plot.window(...): need finite 'xlim' values>
####################################################################################################


plot(drinkdriving$bac ~ drinkdriving$outcome)
[1] 52


####################################################################################################

[1] "Error in plot.window(...) : need finite 'xlim' values\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in plot.window(...): need finite 'xlim' values>
####################################################################################################


plot(drinkdriving$nighttime ~ drinkdriving$outcome)
[1] 53


####################################################################################################

[1] "Error in hist.default(x = c(NA_real_, NA_real_, NA_real_, NA_real_, NA_real_,  : \n  invalid number of 'breaks'\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in hist.default(x = c(NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_), plot = FALSE): invalid number of 'breaks'>
####################################################################################################


plot(prior_offence2 ~ drinkdriving$outcome)
[1] 54


####################################################################################################

[1] "Error in hist.default(x = c(NA_real_, NA_real_, NA_real_, NA_real_, NA_real_,  : \n  invalid number of 'breaks'\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in hist.default(x = c(NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_), plot = FALSE): invalid number of 'breaks'>
####################################################################################################


m4 <- glm(drinkdriving$outcome ~ drinkdriving$age + drinkdriving$speed + 
    drinkdriving$bac + drinkdriving$nighttime + prior_offence2, 
    family = binomial)
[1] 55


####################################################################################################

[1] "Error in eval(family$initialize) : y values must be 0 <= y <= 1\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in eval(family$initialize): y values must be 0 <= y <= 1>
####################################################################################################


summary(m4)
[1] 56
[1] "Error in summary(m4) : object 'm4' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m4): object 'm4' not found>


####################################################################################################

[1] "Error in summary(m4) : object 'm4' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m4): object 'm4' not found>
####################################################################################################


m5 <- glm(drinkdriving$outcome ~ drinkdriving$age + drinkdriving$speed + 
    drinkdriving$bac, family = binomial)
[1] 57


####################################################################################################

[1] "Error in eval(family$initialize) : y values must be 0 <= y <= 1\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in eval(family$initialize): y values must be 0 <= y <= 1>
####################################################################################################


summary(m5)
[1] 58
[1] "Error in summary(m5) : object 'm5' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m5): object 'm5' not found>


####################################################################################################

[1] "Error in summary(m5) : object 'm5' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m5): object 'm5' not found>
####################################################################################################


coef(m5)
[1] 59
[1] "Error in coef(m5) : object 'm5' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in coef(m5): object 'm5' not found>


####################################################################################################

[1] "Error in coef(m5) : object 'm5' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in coef(m5): object 'm5' not found>
####################################################################################################


prior_offence3 <- factor(drinkdriving$prior_offence, levels = c("N", 
    "CD10", "CD60", "CD60,CD10,DR80", "CD60,CD60", "DD20", "DR50", 
    "DR80", "PL10", "SP50", "SP60", "TS70", "TS70,DR50"), labels = c(0, 
    0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1))
[1] 60
m6 <- glm(drinkdriving$outcome ~ prior_offence3, family = binomial)
[1] 61


####################################################################################################

[1] "Error in eval(family$initialize) : y values must be 0 <= y <= 1\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in eval(family$initialize): y values must be 0 <= y <= 1>
####################################################################################################


anova(m6, test = "Chisq")
[1] 62
[1] "Error in anova(m6, test = \"Chisq\") : object 'm6' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in anova(m6, test = "Chisq"): object 'm6' not found>


####################################################################################################

[1] "Error in anova(m6, test = \"Chisq\") : object 'm6' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in anova(m6, test = "Chisq"): object 'm6' not found>
####################################################################################################


summary(m6)
[1] 63
[1] "Error in summary(m6) : object 'm6' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m6): object 'm6' not found>


####################################################################################################

[1] "Error in summary(m6) : object 'm6' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m6): object 'm6' not found>
####################################################################################################


m7 <- glm(drinkdriving$outcome ~ prior_offence2, family = binomial)
[1] 64


####################################################################################################

[1] "Error in eval(family$initialize) : y values must be 0 <= y <= 1\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in eval(family$initialize): y values must be 0 <= y <= 1>
####################################################################################################


anova(m7, test = "Chisq")
[1] 65
[1] "Error in anova(m7, test = \"Chisq\") : object 'm7' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in anova(m7, test = "Chisq"): object 'm7' not found>


####################################################################################################

[1] "Error in anova(m7, test = \"Chisq\") : object 'm7' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in anova(m7, test = "Chisq"): object 'm7' not found>
####################################################################################################


outcome2 <- factor(drinkdriving$outcome, levels = c("warning", 
    "fine"), labels = c(0, 1))
[1] 66
y <- as.numeric(outcome2) - 1
[1] 67
x1 <- drinkdriving$age
[1] 68
x2 <- drinkdriving$nighttime
[1] 69
x3 <- drinkdriving$speed
[1] 70
x4 <- drinkdriving$bac
[1] 71
x5 <- prior_offence2
[1] 72
m9 <- lm(y ~ x1 + x2 + x3 + x4 + x5, family = "binomial")
[1] 73
m9


Call:
lm(formula = y ~ x1 + x2 + x3 + x4 + x5, family = "binomial")

Coefficients:
(Intercept)           x1      x2night           x3           x4          x51  
   0.636877    -0.007688     0.026165     0.006658     0.927320     0.009235  



predict(m9, newdata = data.frame(x1 = 14, x2 = "day", x3 = 30, 
    x4 = 0, x5 = "0"), interval = "prediction", level = 0.95)
[1] 75
      fit        lwr      upr
1 0.72899 0.06596464 1.392015
possibility <- c()
[1] 76
for (i in 14:90) possibility <- c(possibility, predict(m9, newdata = data.frame(x1 = i, 
    x2 = "day", x3 = 30, x4 = 0, x5 = "0"), interval = "prediction", 
    level = 0.95)[1])
[1] 77
NULL
print(possibility)
[1] 78
 [1] 0.7289900 0.7213020 0.7136139 0.7059259 0.6982378 0.6905498 0.6828617 0.6751737 0.6674856 0.6597976 0.6521095 0.6444215 0.6367334
[14] 0.6290454 0.6213573 0.6136693 0.6059812 0.5982932 0.5906052 0.5829171 0.5752291 0.5675410 0.5598530 0.5521649 0.5444769 0.5367888
[27] 0.5291008 0.5214127 0.5137247 0.5060366 0.4983486 0.4906605 0.4829725 0.4752844 0.4675964 0.4599083 0.4522203 0.4445323 0.4368442
[40] 0.4291562 0.4214681 0.4137801 0.4060920 0.3984040 0.3907159 0.3830279 0.3753398 0.3676518 0.3599637 0.3522757
 [ reached getOption("max.print") -- omitted 27 entries ]
 [1] 0.7289900 0.7213020 0.7136139 0.7059259 0.6982378 0.6905498 0.6828617 0.6751737 0.6674856 0.6597976 0.6521095 0.6444215 0.6367334
[14] 0.6290454 0.6213573 0.6136693 0.6059812 0.5982932 0.5906052 0.5829171 0.5752291 0.5675410 0.5598530 0.5521649 0.5444769 0.5367888
[27] 0.5291008 0.5214127 0.5137247 0.5060366 0.4983486 0.4906605 0.4829725 0.4752844 0.4675964 0.4599083 0.4522203 0.4445323 0.4368442
[40] 0.4291562 0.4214681 0.4137801 0.4060920 0.3984040 0.3907159 0.3830279 0.3753398 0.3676518 0.3599637 0.3522757
 [ reached getOption("max.print") -- omitted 27 entries ]
age <- c(14:90)
[1] 79
age_possibility <- data.frame(age, possibility)
[1] 80
age_possibility

   age possibility
1   14   0.7289900
2   15   0.7213020
3   16   0.7136139
4   17   0.7059259
5   18   0.6982378
6   19   0.6905498
7   20   0.6828617
8   21   0.6751737
9   22   0.6674856
10  23   0.6597976
11  24   0.6521095
12  25   0.6444215
13  26   0.6367334
14  27   0.6290454
15  28   0.6213573
16  29   0.6136693
17  30   0.6059812
18  31   0.5982932
19  32   0.5906052
20  33   0.5829171
21  34   0.5752291
22  35   0.5675410
23  36   0.5598530
24  37   0.5521649
25  38   0.5444769
 [ reached 'max' / getOption("max.print") -- omitted 52 rows ]


ggplot(data = age_possiblity, aes(x = age, y = possibility)) + 
    geom_line() + labs(title = "The predicted possibility of each age value")
[1] 82


####################################################################################################

[1] "Error in ggplot(data = age_possiblity, aes(x = age, y = possibility)) : \n  object 'age_possiblity' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in ggplot(data = age_possiblity, aes(x = age, y = possibility)): object 'age_possiblity' not found>
####################################################################################################


m10 <- lm(y ~ drinkdriving$age * drinkdriving$officer)
[1] 83
anova(m10)
[1] 84
Analysis of Variance Table

Response: y
                                       Df  Sum Sq Mean Sq F value  Pr(>F)    
drinkdriving$age                        1  9.8648  9.8648 87.6783 < 2e-16 ***
drinkdriving$officer                    2  0.2112  0.1056  0.9386 0.39274    
drinkdriving$age:drinkdriving$officer   2  0.6795  0.3397  3.0196 0.05086 .  
Residuals                             219 24.6400  0.1125                    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m10)
[1] 85

Call:
lm(formula = y ~ drinkdriving$age * drinkdriving$officer)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.05408 -0.11029  0.08377  0.20458  0.77134 

Coefficients:
                                         Estimate Std. Error t value Pr(>|t|)    
(Intercept)                              1.440906   0.081893  17.595  < 2e-16 ***
drinkdriving$age                        -0.015744   0.001838  -8.565 1.94e-15 ***
drinkdriving$officerIT                  -0.217448   0.152198  -1.429   0.1545    
drinkdriving$officerNP                  -0.231744   0.156676  -1.479   0.1405    
drinkdriving$age:drinkdriving$officerIT  0.006095   0.003267   1.865   0.0635 .  
drinkdriving$age:drinkdriving$officerNP  0.007128   0.003410   2.090   0.0377 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.3354 on 219 degrees of freedom
  (25 observations deleted due to missingness)
Multiple R-squared:  0.3039,	Adjusted R-squared:  0.288 
F-statistic: 19.12 on 5 and 219 DF,  p-value: 9.019e-16

