

	####### B152116 R script #######

library(car, quietly = T)
[1] 1
 [1] "car"       "carData"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(ggplot2, quietly = T)
[1] 2
 [1] "ggplot2"   "car"       "carData"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
library(psych, quietly = T)
[1] 3
 [1] "psych"     "ggplot2"   "car"       "carData"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[11] "methods"   "base"     
require(lsr, quietly = T)
[1] 4
[1] TRUE
load(url("https://edin.ac/2QCZNVu"))
[1] 5
[1] "drinkdriving" "officer_inc" 
describe(drinkdriving)
[1] 6
               vars   n mean    sd median trimmed   mad min  max range skew kurtosis   se
age               1 228   46 33.35   40.5   42.34 18.53  14  297   283  5.5    38.49 2.21
nighttime*        2 250  NaN    NA     NA     NaN    NA Inf -Inf  -Inf   NA       NA   NA
prior_offence*    3 250  NaN    NA     NA     NaN    NA Inf -Inf  -Inf   NA       NA   NA
 [ reached 'max' / getOption("max.print") -- omitted 4 rows ]
drinkdriving <- as.data.frame(drinkdriving)
[1] 7
drinkdriving$age[drinkdriving$age > 110] <- NA
[1] 8
drinkdriving$bac <- drinkdriving$bac/100
[1] 9
drinkdriving$outcome <- tolower(drinkdriving$outcome)
[1] 10
drinkdriving$nighttime[drinkdriving$nighttime == "18:25"] <- NA
[1] 11
drinkdriving$nighttime[drinkdriving$nighttime == "2:05"] <- NA
[1] 12
drinkdriving$prior_offence[drinkdriving$prior_offence == "DD20"] <- NA
[1] 13
drinkdriving$nighttime <- factor(drinkdriving$nighttime)
[1] 14
drinkdriving$outcome <- factor(drinkdriving$outcome, levels = c("warning", 
    "fine"))
[1] 15
drinkdriving.outliers <- drinkdriving
[1] 16
drinkdriving$bac[c(110, 154)] <- NA
[1] 17
drinkdriving$speed[c(110)] <- NA
[1] 18
m1.outliers <- lm(bac ~ age, data = drinkdriving.outliers)
[1] 19
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 20
summary(m1)
[1] 21

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.153270 -0.041824 -0.005698  0.039975  0.149487 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.2868503  0.0106949   26.82  < 2e-16 ***
age         -0.0013730  0.0002331   -5.89 1.47e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05791 on 216 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.1384,	Adjusted R-squared:  0.1344 
F-statistic: 34.69 on 1 and 216 DF,  p-value: 1.469e-08

summary(m1.outliers)
[1] 22

Call:
lm(formula = bac ~ age, data = drinkdriving.outliers)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.15719 -0.04516 -0.00861  0.03849  0.42785 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.2929455  0.0125564  23.330  < 2e-16 ***
age         -0.0014353  0.0002741  -5.236 3.86e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.0682 on 218 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1117,	Adjusted R-squared:  0.1076 
F-statistic: 27.41 on 1 and 218 DF,  p-value: 3.863e-07

par(mfrow = c(1, 1))
[1] 23
$mfrow
[1] 1 1

with(drinkdriving, plot(bac ~ age, main = "Age v BAC"))
[1] 24
par(mfrow = c(2, 2))
[1] 25
$mfrow
[1] 1 1

plot(m1, which = c(1:4))
[1] 26
m1.shapiro <- shapiro.test(residuals(m1))
[1] 27
m1.ncv <- ncvTest(m1)
[1] 28
m1.predicted.50 <- predict(m1, newdata = data.frame(age = c(50)))
[1] 29
m1.predicted.bac <- predict(m1, interval = "confidence")
[1] 30
m1.predicted.bac <- merge(drinkdriving, m1.predicted.bac, by = "row.names")
[1] 31
ggplot(m1.predicted.bac, aes(x = age)) + geom_point(aes(y = bac), 
    col = "slateblue") + geom_line(aes(y = fit)) + geom_ribbon(aes(ymin = lwr, 
    ymax = upr), fill = "orange", alpha = 0.4) + theme_minimal() + 
    labs(title = "BAC v Age", x = "Age", y = "BAC")
[1] 32
par(mfrow = c(1, 1))
[1] 33
$mfrow
[1] 2 2

plot(m1, which = 2)
[1] 34
plot(density(residuals(m1)), main = "")
[1] 35
hist(residuals(m1), main = "", breaks = 20)
[1] 36
m2.time <- lm(bac ~ age + nighttime + speed, data = drinkdriving)
[1] 37
m2.time.anova <- anova(m2.time)
[1] 38
m2.speed <- lm(bac ~ age + speed + nighttime, data = drinkdriving)
[1] 39
m2.speed.anova <- anova(m2.speed)
[1] 40
par(mfrow = c(2, 2))
[1] 41
$mfrow
[1] 1 1

plot(m2.speed, which = c(1:4))
[1] 42
plot(m2.time, which = c(1:4))
[1] 43
m2.speed.shapiro <- shapiro.test(residuals(m2.speed))
[1] 44
m2.speed.ncv <- ncvTest(m2.speed)
[1] 45
m2.speed.sum <- summary(m2.speed)
[1] 46
par(mfrow = c(1, 1))
[1] 47
$mfrow
[1] 2 2

m2.assoc.box <- with(drinkdriving, boxplot(speed ~ nighttime, 
    main = "Boxplot of Speed Means", xlab = "Time stopped", ylab = "Speed"))
[1] 48
with(drinkdriving, qqnorm(y = speed))
[1] 49
$x
 [1]  0.56173411  0.23364441  0.49232450 -1.60527302 -2.32484366  0.08062149 -2.51072965 -0.43625655  1.64290975 -2.19571359
[11]  0.78967281  0.52671204  0.40327356 -0.38152834  0.39237776  0.14140475  1.38957282 -0.12109668  0.32792035 -0.51518220
[21]  1.87902585  1.41650909 -0.96742157  0.76246398 -0.33856194  0.68399883  0.29621188 -0.41421746 -0.25438675 -1.14306393
[31] -1.77253844 -1.53616470  0.05035517 -0.28570980  1.18265024 -0.70966541  0.38152834  0.11096187  1.00008562  0.45850963
[41] -1.24576303  0.96742157  0.12109668 -0.10083844  0.09072533 -0.60953682  1.53616470 -0.07052588 -2.01241027  1.68302900
 [ reached getOption("max.print") -- omitted 200 entries ]

$y
 [1] 47.957110 43.826353 47.260707 17.221097  1.945818 41.399468  1.012149 34.377506 63.748159  2.533468 50.049472 47.658553 46.209515
[14] 35.044348 45.911152 41.971790 59.500756 38.544314 45.294085 33.660408 66.359756 59.538043 26.205563 49.692191 35.759413 48.880880
[27] 44.464566 34.639220 36.609294 24.917257 13.069805 19.008994 41.009485 36.335035 56.428161 30.141277 45.716490 41.609061 53.768251
[40] 46.424053 23.599427 52.982425 41.674665 38.867482 41.537199 32.599695 61.109335 39.685430 12.246206 64.659834
 [ reached getOption("max.print") -- omitted 200 entries ]

m2.assoc.shapiro <- with(drinkdriving, shapiro.test(speed))
[1] 50
m2.assoc.levene <- with(drinkdriving, leveneTest(speed ~ nighttime))
[1] 51
m2.assoc.t <- t.test(speed ~ nighttime, data = drinkdriving, 
    var.equal = F)
[1] 52
drinkdriving$offended <- as.factor(ifelse(drinkdriving$prior_offence == 
    "N", "N", "Y"))
[1] 53
m3 <- glm(outcome ~ scale(speed) + scale(age) + scale(bac) + 
    offended + nighttime, data = drinkdriving, family = binomial, 
    na.action = na.exclude)
[1] 54
m3.sum <- summary(m3)
[1] 55
m3.anova <- anova(m3, test = "Chisq")
[1] 56
m3.vif <- vif(m3)
[1] 57
m3.coef.logits <- coef(m3)
[1] 58
m3.coef.odds <- exp(m3.coef.logits)
[1] 59
m3.prob <- m3.coef.odds/(1 + m3.coef.odds)
[1] 60
summary(glm(outcome ~ scale(speed), data = drinkdriving, family = binomial, 
    na.action = na.exclude))
[1] 61

Call:
glm(formula = outcome ~ scale(speed), family = binomial, data = drinkdriving, 
    na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.4793   0.0796   0.2447   0.5220   1.8448  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept)    2.4175     0.3023   7.997 1.28e-15 ***
scale(speed)   2.2388     0.3355   6.673 2.50e-11 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 244.13  on 248  degrees of freedom
Residual deviance: 153.41  on 247  degrees of freedom
  (1 observation deleted due to missingness)
AIC: 157.41

Number of Fisher Scoring iterations: 6

summary(glm(outcome ~ scale(bac), data = drinkdriving, family = binomial, 
    na.action = na.exclude))
[1] 62

Call:
glm(formula = outcome ~ scale(bac), family = binomial, data = drinkdriving, 
    na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.9866   0.2070   0.4045   0.6491   1.6648  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)   1.8655     0.2205   8.462  < 2e-16 ***
scale(bac)    1.3390     0.2225   6.018 1.77e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 238.69  on 242  degrees of freedom
Residual deviance: 187.04  on 241  degrees of freedom
  (7 observations deleted due to missingness)
AIC: 191.04

Number of Fisher Scoring iterations: 5

summary(glm(outcome ~ scale(age), data = drinkdriving, family = binomial, 
    na.action = na.exclude))
[1] 63

Call:
glm(formula = outcome ~ scale(age), family = binomial, data = drinkdriving, 
    na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.0363   0.1488   0.2993   0.5106   2.1778  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)   2.1055     0.2719   7.745 9.58e-15 ***
scale(age)   -1.6949     0.2645  -6.408 1.48e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 222.38  on 224  degrees of freedom
Residual deviance: 154.65  on 223  degrees of freedom
  (25 observations deleted due to missingness)
AIC: 158.65

Number of Fisher Scoring iterations: 6

summary(glm(outcome ~ offended, data = drinkdriving, family = binomial, 
    na.action = na.exclude))
[1] 64

Call:
glm(formula = outcome ~ offended, family = binomial, data = drinkdriving, 
    na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.9564   0.5650   0.6681   0.6681   0.6681  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)   1.3863     0.1838   7.542 4.62e-14 ***
offendedY     0.3677     0.4051   0.908    0.364    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 237.06  on 245  degrees of freedom
Residual deviance: 236.20  on 244  degrees of freedom
  (4 observations deleted due to missingness)
AIC: 240.2

Number of Fisher Scoring iterations: 4

summary(glm(outcome ~ nighttime, data = drinkdriving, family = binomial, 
    na.action = na.exclude))
[1] 65

Call:
glm(formula = outcome ~ nighttime, family = binomial, data = drinkdriving, 
    na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.8962   0.6019   0.6019   0.6019   0.7698  

Coefficients:
               Estimate Std. Error z value Pr(>|z|)    
(Intercept)      1.0647     0.2593   4.106 4.03e-05 ***
nighttimenight   0.5518     0.3317   1.664   0.0962 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 243.27  on 246  degrees of freedom
Residual deviance: 240.56  on 245  degrees of freedom
  (3 observations deleted due to missingness)
AIC: 244.56

Number of Fisher Scoring iterations: 4

summary(glm(outcome ~ scale(speed) * scale(bac), data = drinkdriving, 
    family = binomial, na.action = na.exclude))
[1] 66

Call:
glm(formula = outcome ~ scale(speed) * scale(bac), family = binomial, 
    data = drinkdriving, na.action = na.exclude)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.81073   0.09498   0.24210   0.38868   2.54865  

Coefficients:
                        Estimate Std. Error z value Pr(>|z|)    
(Intercept)               2.8486     0.3542   8.041 8.90e-16 ***
scale(speed)              2.2174     0.3981   5.570 2.54e-08 ***
scale(bac)                0.3605     0.3184   1.132 0.257526    
scale(speed):scale(bac)  -1.3821     0.3838  -3.601 0.000317 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 238.69  on 242  degrees of freedom
Residual deviance: 118.18  on 239  degrees of freedom
  (7 observations deleted due to missingness)
AIC: 126.18

Number of Fisher Scoring iterations: 6

summary(glm(outcome ~ scale(speed) * scale(age), data = drinkdriving, 
    family = binomial, na.action = na.exclude))
[1] 67

Call:
glm(formula = outcome ~ scale(speed) * scale(age), family = binomial, 
    data = drinkdriving, na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.7000   0.1727   0.2566   0.3656   1.9478  

Coefficients:
                        Estimate Std. Error z value Pr(>|z|)    
(Intercept)               2.9202     0.3659   7.980 1.46e-15 ***
scale(speed)              1.4687     0.4267   3.442 0.000577 ***
scale(age)               -0.3856     0.3622  -1.065 0.286941    
scale(speed):scale(age)   1.0917     0.3698   2.953 0.003152 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 221.94  on 223  degrees of freedom
Residual deviance: 120.83  on 220  degrees of freedom
  (26 observations deleted due to missingness)
AIC: 128.83

Number of Fisher Scoring iterations: 6

summary(glm(outcome ~ scale(speed) * offended, data = drinkdriving, 
    family = binomial, na.action = na.exclude))
[1] 68

Call:
glm(formula = outcome ~ scale(speed) * offended, family = binomial, 
    data = drinkdriving, na.action = na.exclude)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.76417   0.02313   0.16117   0.45518   2.42911  

Coefficients:
                       Estimate Std. Error z value Pr(>|z|)    
(Intercept)              3.3307     0.5519   6.035 1.59e-09 ***
scale(speed)             3.5585     0.6280   5.667 1.46e-08 ***
offendedY               -1.2524     0.7178  -1.745  0.08100 .  
scale(speed):offendedY  -2.4986     0.7724  -3.235  0.00122 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 236.65  on 244  degrees of freedom
Residual deviance: 127.73  on 241  degrees of freedom
  (5 observations deleted due to missingness)
AIC: 135.73

Number of Fisher Scoring iterations: 7

summary(glm(outcome ~ scale(speed) * nighttime, data = drinkdriving, 
    family = binomial, na.action = na.exclude))
[1] 69

Call:
glm(formula = outcome ~ scale(speed) * nighttime, family = binomial, 
    data = drinkdriving, na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.2480   0.0553   0.2420   0.4892   1.9470  

Coefficients:
                            Estimate Std. Error z value Pr(>|z|)    
(Intercept)                   3.1807     0.7805   4.075 4.60e-05 ***
scale(speed)                  4.5698     1.1238   4.066 4.78e-05 ***
nighttimenight               -0.7871     0.8549  -0.921   0.3572    
scale(speed):nighttimenight  -2.7973     1.1746  -2.381   0.0172 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 242.83  on 245  degrees of freedom
Residual deviance: 140.46  on 242  degrees of freedom
  (4 observations deleted due to missingness)
AIC: 148.46

Number of Fisher Scoring iterations: 7

summary(glm(outcome ~ scale(bac) * scale(age), data = drinkdriving, 
    family = binomial, na.action = na.exclude))
[1] 70

Call:
glm(formula = outcome ~ scale(bac) * scale(age), family = binomial, 
    data = drinkdriving, na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.0503   0.1570   0.2864   0.4149   2.7819  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)             2.3855     0.3016   7.908 2.61e-15 ***
scale(bac)              0.4576     0.3478   1.316   0.1882    
scale(age)             -1.5028     0.2905  -5.173 2.30e-07 ***
scale(bac):scale(age)   0.8870     0.3484   2.546   0.0109 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 216.50  on 217  degrees of freedom
Residual deviance: 124.93  on 214  degrees of freedom
  (32 observations deleted due to missingness)
AIC: 132.93

Number of Fisher Scoring iterations: 6

summary(glm(outcome ~ scale(bac) * offended, data = drinkdriving, 
    family = binomial, na.action = na.exclude))
[1] 71

Call:
glm(formula = outcome ~ scale(bac) * offended, family = binomial, 
    data = drinkdriving, na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.7282   0.1606   0.3746   0.6204   2.0122  

Coefficients:
                     Estimate Std. Error z value Pr(>|z|)    
(Intercept)            2.0685     0.2915   7.095 1.29e-12 ***
scale(bac)             1.7853     0.3170   5.633 1.77e-08 ***
offendedY             -0.2185     0.5081  -0.430   0.6672    
scale(bac):offendedY  -1.0763     0.4680  -2.300   0.0215 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 231.22  on 238  degrees of freedom
Residual deviance: 171.79  on 235  degrees of freedom
  (11 observations deleted due to missingness)
AIC: 179.79

Number of Fisher Scoring iterations: 6

summary(glm(outcome ~ scale(bac) * nighttime, data = drinkdriving, 
    family = binomial, na.action = na.exclude))
[1] 72

Call:
glm(formula = outcome ~ scale(bac) * nighttime, family = binomial, 
    data = drinkdriving, na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.9047   0.2108   0.4220   0.6155   1.7345  

Coefficients:
                          Estimate Std. Error z value Pr(>|z|)    
(Intercept)                 2.1906     0.4691   4.669 3.02e-06 ***
scale(bac)                  1.5559     0.3897   3.993 6.54e-05 ***
nighttimenight             -0.4540     0.5311  -0.855    0.393    
scale(bac):nighttimenight  -0.2768     0.4891  -0.566    0.571    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 237.39  on 239  degrees of freedom
Residual deviance: 185.15  on 236  degrees of freedom
  (10 observations deleted due to missingness)
AIC: 193.15

Number of Fisher Scoring iterations: 5

summary(glm(outcome ~ scale(age) * offended, data = drinkdriving, 
    family = binomial, na.action = na.exclude))
[1] 73

Call:
glm(formula = outcome ~ scale(age) * offended, family = binomial, 
    data = drinkdriving, na.action = na.exclude)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.35932   0.01862   0.15446   0.41367   2.26762  

Coefficients:
                     Estimate Std. Error z value Pr(>|z|)    
(Intercept)            3.6030     0.6659   5.411 6.27e-08 ***
scale(age)            -3.7402     0.6963  -5.372 7.79e-08 ***
offendedY             -1.5445     0.8077  -1.912 0.055842 .  
scale(age):offendedY   2.9850     0.7745   3.854 0.000116 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 214.94  on 220  degrees of freedom
Residual deviance: 112.68  on 217  degrees of freedom
  (29 observations deleted due to missingness)
AIC: 120.68

Number of Fisher Scoring iterations: 7

summary(glm(outcome ~ scale(age) * nighttime, data = drinkdriving, 
    family = binomial, na.action = na.exclude))
[1] 74

Call:
glm(formula = outcome ~ scale(age) * nighttime, family = binomial, 
    data = drinkdriving, na.action = na.exclude)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.82504   0.06636   0.31080   0.49436   2.07282  

Coefficients:
                          Estimate Std. Error z value Pr(>|z|)    
(Intercept)                 2.8120     0.7539   3.730 0.000192 ***
scale(age)                 -2.9680     0.7702  -3.854 0.000116 ***
nighttimenight             -0.8259     0.8092  -1.021 0.307440    
scale(age):nighttimenight   1.6185     0.8239   1.964 0.049481 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 221.51  on 222  degrees of freedom
Residual deviance: 146.45  on 219  degrees of freedom
  (27 observations deleted due to missingness)
AIC: 154.45

Number of Fisher Scoring iterations: 6

summary(glm(outcome ~ offended * nighttime, data = drinkdriving, 
    family = binomial, na.action = na.exclude))
[1] 75

Call:
glm(formula = outcome ~ offended * nighttime, family = binomial, 
    data = drinkdriving, na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.9847   0.5482   0.5957   0.5957   0.8163  

Coefficients:
                         Estimate Std. Error z value Pr(>|z|)   
(Intercept)                0.9280     0.2865   3.239   0.0012 **
offendedY                  0.6125     0.6977   0.878   0.3801   
nighttimenight             0.7110     0.3765   1.888   0.0590 . 
offendedY:nighttimenight  -0.4323     0.8604  -0.502   0.6153   
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 235.81  on 242  degrees of freedom
Residual deviance: 231.34  on 239  degrees of freedom
  (7 observations deleted due to missingness)
AIC: 239.34

Number of Fisher Scoring iterations: 4

m3.full <- glm(outcome ~ scale(speed) + scale(bac) + scale(age) + 
    offended + nighttime + scale(speed):scale(bac) + scale(speed):scale(age) + 
    scale(speed):offended + scale(speed):nighttime + scale(bac):scale(age) + 
    scale(bac):offended + scale(age):offended + scale(age):nighttime, 
    data = drinkdriving, family = binomial, na.action = na.exclude)
[1] 76
summary(m3.full)
[1] 77

Call:
glm(formula = outcome ~ scale(speed) + scale(bac) + scale(age) + 
    offended + nighttime + scale(speed):scale(bac) + scale(speed):scale(age) + 
    scale(speed):offended + scale(speed):nighttime + scale(bac):scale(age) + 
    scale(bac):offended + scale(age):offended + scale(age):nighttime, 
    family = binomial, data = drinkdriving, na.action = na.exclude)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-2.823   0.000   0.000   0.000   1.049  

Coefficients:
                              Estimate Std. Error z value Pr(>|z|)  
(Intercept)                  2.444e+02  4.234e+04   0.006   0.9954  
scale(speed)                 1.156e+02  2.305e+04   0.005   0.9960  
scale(bac)                   1.014e+02  1.839e+04   0.006   0.9956  
scale(age)                  -1.100e+02  2.119e+04  -0.005   0.9959  
offendedY                   -2.411e+02  4.234e+04  -0.006   0.9955  
nighttimenight               7.652e-02  2.667e+00   0.029   0.9771  
scale(speed):scale(bac)      4.069e-01  8.565e-01   0.475   0.6348  
scale(speed):scale(age)     -5.643e-01  1.340e+00  -0.421   0.6736  
scale(speed):offendedY      -1.138e+02  2.305e+04  -0.005   0.9961  
scale(speed):nighttimenight  1.555e-01  9.398e+00   0.017   0.9868  
 [ reached getOption("max.print") -- omitted 4 rows ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 208.231  on 211  degrees of freedom
Residual deviance:  26.563  on 198  degrees of freedom
  (38 observations deleted due to missingness)
AIC: 54.563

Number of Fisher Scoring iterations: 25

m3.refined <- glm(outcome ~ scale(speed) + scale(bac) + scale(age) + 
    offended + nighttime + scale(speed):scale(bac) + scale(speed):scale(age) + 
    scale(speed):nighttime + scale(bac):scale(age) + scale(bac):offended + 
    scale(age):offended + scale(age):nighttime, data = drinkdriving, 
    family = binomial, na.action = na.exclude)
[1] 78
summary(m3.refined)
[1] 79

Call:
glm(formula = outcome ~ scale(speed) + scale(bac) + scale(age) + 
    offended + nighttime + scale(speed):scale(bac) + scale(speed):scale(age) + 
    scale(speed):nighttime + scale(bac):scale(age) + scale(bac):offended + 
    scale(age):offended + scale(age):nighttime, family = binomial, 
    data = drinkdriving, na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.2088   0.0000   0.0015   0.0849   1.3249  

Coefficients:
                            Estimate Std. Error z value Pr(>|z|)   
(Intercept)                  11.9562     3.8032   3.144  0.00167 **
scale(speed)                  8.6178     6.0378   1.427  0.15349   
scale(bac)                    5.0000     2.2152   2.257  0.02400 * 
scale(age)                   -2.2385     3.7916  -0.590  0.55493   
offendedY                    -6.7549     2.9866  -2.262  0.02371 * 
nighttimenight               -0.6167     1.9816  -0.311  0.75563   
scale(speed):scale(bac)       1.2846     0.8497   1.512  0.13059   
scale(speed):scale(age)       0.5700     1.2621   0.452  0.65155   
scale(speed):nighttimenight  -5.0523     5.9664  -0.847  0.39711   
scale(bac):scale(age)         2.1247     1.0151   2.093  0.03634 * 
 [ reached getOption("max.print") -- omitted 3 rows ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 208.231  on 211  degrees of freedom
Residual deviance:  40.334  on 199  degrees of freedom
  (38 observations deleted due to missingness)
AIC: 66.334

Number of Fisher Scoring iterations: 10

m3.refined <- glm(outcome ~ scale(speed) + scale(bac) + scale(age) + 
    offended + nighttime + scale(speed):scale(bac) + scale(speed):nighttime + 
    scale(bac):scale(age) + scale(bac):offended + scale(age):offended + 
    scale(age):nighttime, data = drinkdriving, family = binomial, 
    na.action = na.exclude)
[1] 80
summary(m3.refined)
[1] 81

Call:
glm(formula = outcome ~ scale(speed) + scale(bac) + scale(age) + 
    offended + nighttime + scale(speed):scale(bac) + scale(speed):nighttime + 
    scale(bac):scale(age) + scale(bac):offended + scale(age):offended + 
    scale(age):nighttime, family = binomial, data = drinkdriving, 
    na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.3653   0.0000   0.0014   0.0618   1.3093  

Coefficients:
                            Estimate Std. Error z value Pr(>|z|)   
(Intercept)                  11.7410     3.6815   3.189  0.00143 **
scale(speed)                  8.7553     6.1847   1.416  0.15689   
scale(bac)                    4.4651     1.7662   2.528  0.01147 * 
scale(age)                   -2.6494     3.6797  -0.720  0.47152   
offendedY                    -6.7161     2.9062  -2.311  0.02083 * 
nighttimenight               -0.2240     1.8347  -0.122  0.90282   
scale(speed):scale(bac)       1.1597     0.7746   1.497  0.13434   
scale(speed):nighttimenight  -4.8665     6.0805  -0.800  0.42351   
scale(bac):scale(age)         2.3707     0.8926   2.656  0.00791 **
scale(bac):offendedY         -4.5089     1.8756  -2.404  0.01622 * 
 [ reached getOption("max.print") -- omitted 2 rows ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 208.231  on 211  degrees of freedom
Residual deviance:  40.532  on 200  degrees of freedom
  (38 observations deleted due to missingness)
AIC: 64.532

Number of Fisher Scoring iterations: 10

m3.refined <- glm(outcome ~ scale(speed) + scale(bac) + scale(age) + 
    offended + nighttime + scale(speed):scale(bac) + scale(bac):scale(age) + 
    scale(bac):offended + scale(age):offended + scale(age):nighttime, 
    data = drinkdriving, family = binomial, na.action = na.exclude)
[1] 82
summary(m3.refined)
[1] 83

Call:
glm(formula = outcome ~ scale(speed) + scale(bac) + scale(age) + 
    offended + nighttime + scale(speed):scale(bac) + scale(bac):scale(age) + 
    scale(bac):offended + scale(age):offended + scale(age):nighttime, 
    family = binomial, data = drinkdriving, na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.3684   0.0000   0.0014   0.0651   1.2631  

Coefficients:
                          Estimate Std. Error z value Pr(>|z|)    
(Intercept)                10.8104     3.3670   3.211 0.001324 ** 
scale(speed)                3.9625     1.1998   3.303 0.000958 ***
scale(bac)                  4.2701     1.7047   2.505 0.012246 *  
scale(age)                 -5.2605     1.9708  -2.669 0.007602 ** 
offendedY                  -6.8324     2.9003  -2.356 0.018483 *  
nighttimenight              0.8115     1.2372   0.656 0.511887    
scale(speed):scale(bac)     1.0962     0.7927   1.383 0.166718    
scale(bac):scale(age)       2.3406     0.9000   2.601 0.009301 ** 
scale(bac):offendedY       -4.4157     1.8153  -2.432 0.014996 *  
scale(age):offendedY        8.4128     2.6939   3.123 0.001790 ** 
 [ reached getOption("max.print") -- omitted 1 row ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 208.231  on 211  degrees of freedom
Residual deviance:  41.212  on 201  degrees of freedom
  (38 observations deleted due to missingness)
AIC: 63.212

Number of Fisher Scoring iterations: 10

m3.refined <- glm(outcome ~ scale(speed) + scale(bac) + scale(age) + 
    offended + nighttime + scale(bac):scale(age) + scale(bac):offended + 
    scale(age):offended + scale(age):nighttime, data = drinkdriving, 
    family = binomial, na.action = na.exclude)
[1] 84
summary(m3.refined)
[1] 85

Call:
glm(formula = outcome ~ scale(speed) + scale(bac) + scale(age) + 
    offended + nighttime + scale(bac):scale(age) + scale(bac):offended + 
    scale(age):offended + scale(age):nighttime, family = binomial, 
    data = drinkdriving, na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.1784   0.0000   0.0028   0.0972   1.2672  

Coefficients:
                          Estimate Std. Error z value Pr(>|z|)    
(Intercept)                 9.5182     2.8624   3.325 0.000883 ***
scale(speed)                3.7338     1.0823   3.450 0.000561 ***
scale(bac)                  3.3134     1.3268   2.497 0.012515 *  
scale(age)                 -4.6120     1.7339  -2.660 0.007818 ** 
offendedY                  -5.7817     2.5032  -2.310 0.020905 *  
nighttimenight              0.9678     1.2004   0.806 0.420117    
scale(bac):scale(age)       1.7808     0.7368   2.417 0.015651 *  
scale(bac):offendedY       -3.9241     1.6028  -2.448 0.014352 *  
scale(age):offendedY        7.4508     2.3808   3.130 0.001751 ** 
scale(age):nighttimenight  -2.1622     1.3522  -1.599 0.109817    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 208.231  on 211  degrees of freedom
Residual deviance:  43.018  on 202  degrees of freedom
  (38 observations deleted due to missingness)
AIC: 63.018

Number of Fisher Scoring iterations: 10

m3.refined <- glm(outcome ~ scale(speed) + scale(bac) + scale(age) + 
    offended + nighttime + scale(bac):scale(age) + scale(bac):offended + 
    scale(age):offended, data = drinkdriving, family = binomial, 
    na.action = na.exclude)
[1] 86
summary(m3.refined)
[1] 87

Call:
glm(formula = outcome ~ scale(speed) + scale(bac) + scale(age) + 
    offended + nighttime + scale(bac):scale(age) + scale(bac):offended + 
    scale(age):offended, family = binomial, data = drinkdriving, 
    na.action = na.exclude)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.93445   0.00008   0.00727   0.10718   1.34520  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)             8.9960     2.4793   3.629 0.000285 ***
scale(speed)            3.1126     0.8757   3.554 0.000379 ***
scale(bac)              3.0629     1.1592   2.642 0.008235 ** 
scale(age)             -5.3333     1.7086  -3.121 0.001800 ** 
offendedY              -4.5183     2.0330  -2.223 0.026248 *  
nighttimenight         -0.3946     1.1103  -0.355 0.722319    
scale(bac):scale(age)   1.2038     0.5560   2.165 0.030374 *  
scale(bac):offendedY   -3.4900     1.4361  -2.430 0.015090 *  
scale(age):offendedY    6.2751     1.9729   3.181 0.001469 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 208.23  on 211  degrees of freedom
Residual deviance:  45.40  on 203  degrees of freedom
  (38 observations deleted due to missingness)
AIC: 63.4

Number of Fisher Scoring iterations: 9

m3.refined <- glm(outcome ~ scale(speed) + scale(bac) + scale(age) + 
    offended + scale(bac):scale(age) + scale(bac):offended + 
    scale(age):offended, data = drinkdriving, family = binomial, 
    na.action = na.exclude)
[1] 88
summary(m3.refined)
[1] 89

Call:
glm(formula = outcome ~ scale(speed) + scale(bac) + scale(age) + 
    offended + scale(bac):scale(age) + scale(bac):offended + 
    scale(age):offended, family = binomial, data = drinkdriving, 
    na.action = na.exclude)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.95349   0.00009   0.00782   0.11733   1.37260  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)             8.7387     2.3248   3.759 0.000171 ***
scale(speed)            3.1687     0.8716   3.635 0.000278 ***
scale(bac)              2.9724     1.1285   2.634 0.008437 ** 
scale(age)             -5.3200     1.7144  -3.103 0.001915 ** 
offendedY              -4.5474     2.0344  -2.235 0.025404 *  
scale(bac):scale(age)   1.1829     0.5477   2.160 0.030800 *  
scale(bac):offendedY   -3.4396     1.4317  -2.402 0.016286 *  
scale(age):offendedY    6.3463     1.9803   3.205 0.001352 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 209.086  on 213  degrees of freedom
Residual deviance:  45.529  on 206  degrees of freedom
  (36 observations deleted due to missingness)
AIC: 61.529

Number of Fisher Scoring iterations: 9

anova(m3.refined, test = "Chisq")
[1] 90
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


                      Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                                    213    209.086              
scale(speed)           1   86.088       212    122.998 < 2.2e-16 ***
scale(bac)             1   28.999       211     93.998 7.240e-08 ***
scale(age)             1    9.968       210     84.030  0.001593 ** 
offended               1    2.340       209     81.690  0.126072    
scale(bac):scale(age)  1    2.774       208     78.916  0.095814 .  
scale(bac):offended    1   10.558       207     68.358  0.001157 ** 
scale(age):offended    1   22.829       206     45.529 1.771e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
vif(m3.refined)
[1] 91
         scale(speed)            scale(bac)            scale(age)              offended scale(bac):scale(age)   scale(bac):offended 
             2.387180              6.809732             16.593960              6.931397              1.870214              7.108032 
  scale(age):offended 
            13.089056 
drinkdriving$dd_offence <- with(drinkdriving, as.factor(ifelse(prior_offence == 
    "N", NA, ifelse(grepl("DR50", prior_offence), "Y", "N"))))
[1] 92
m3.dd <- glm(outcome ~ dd_offence, data = drinkdriving, family = binomial, 
    na.action = na.exclude)
[1] 93
summary(m3.dd)
[1] 94

Call:
glm(formula = outcome ~ dd_offence, family = binomial, data = drinkdriving, 
    na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1899   0.4366   0.4366   0.4366   0.8346  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)  
(Intercept)   0.8755     0.5323   1.645   0.1000  
dd_offenceY   1.4271     0.7472   1.910   0.0561 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 51.047  on 60  degrees of freedom
Residual deviance: 47.405  on 59  degrees of freedom
  (189 observations deleted due to missingness)
AIC: 51.405

Number of Fisher Scoring iterations: 5

anova(m3.dd, test = "Chisq")
[1] 95
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


           Df Deviance Resid. Df Resid. Dev Pr(>Chi)  
NULL                          60     51.047           
dd_offence  1   3.6421        59     47.405  0.05633 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m3.any <- glm(outcome ~ offended, data = drinkdriving, family = binomial, 
    na.action = na.exclude)
[1] 96
summary(m3.any)
[1] 97

Call:
glm(formula = outcome ~ offended, family = binomial, data = drinkdriving, 
    na.action = na.exclude)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.9564   0.5650   0.6681   0.6681   0.6681  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)   1.3863     0.1838   7.542 4.62e-14 ***
offendedY     0.3677     0.4051   0.908    0.364    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 237.06  on 245  degrees of freedom
Residual deviance: 236.20  on 244  degrees of freedom
  (4 observations deleted due to missingness)
AIC: 240.2

Number of Fisher Scoring iterations: 4

anova(m3.any, test = "Chisq")
[1] 98
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


         Df Deviance Resid. Df Resid. Dev Pr(>Chi)
NULL                       245     237.06         
offended  1  0.86504       244     236.20   0.3523
predicted.data <- data.frame(age = c(17:90), speed = rep(30, 
    74), bac = rep(0, 74), offended = rep(as.factor("N"), 74), 
    nighttime = rep(as.factor("day"), 74))
[1] 99
predicted.data$predicted <- predict(m3, newdata = predicted.data, 
    type = "response")
[1] 100
predicted.data$predicted.refined <- predict(m3.refined, newdata = predicted.data, 
    type = "response")
[1] 101
par(mfrow = c(1, 1))
[1] 102
$mfrow
[1] 1 1

plot(predicted ~ age, data = predicted.data, type = "l", ylab = "p(fine)", 
    main = "Probability of Receiving a Fine by Age")
[1] 103
plot(predicted.refined ~ age, data = predicted.data, type = "l", 
    ylab = "p(fine)", main = "Probability of Receiving a Fine by Age")
[1] 104
cases <- merge(drinkdriving, officer_inc, by = "incident_id")
[1] 105
m4 <- glm(outcome ~ age * officer, data = cases, family = binomial, 
    na.action = na.exclude)
[1] 106
m4.sum <- summary(m4)
[1] 107
m4.anova <- anova(m4, test = "Chisq")
[1] 108
contrasts(cases$officer) <- cbind(`ASvIT,NP` = c(2/3, -1/3, -1/3), 
    ITvNP = c(0, 1/2, -1/2))
[1] 109
m4.corrupt.as <- glm(outcome ~ age * officer, data = cases, family = binomial, 
    na.action = na.exclude)
[1] 110
m4.corrupt.as.sum <- summary(m4.corrupt.as)
[1] 111
contrasts(cases$officer) <- cbind(`ITvAS,NP` = c(-1/3, 2/3, -1/3), 
    ASvNP = c(1/2, 0, -1/2))
[1] 112
m4.corrupt.it <- glm(outcome ~ age * officer, data = cases, family = binomial, 
    na.action = na.exclude)
[1] 113
m4.corrupt.it.sum <- summary(m4.corrupt.it)
[1] 114
contrasts(cases$officer) <- cbind(`NPvAS,IT` = c(-1/3, -1/3, 
    2/3), ASvIT = c(1/2, -1/2, 0))
[1] 115
m4.corrupt.np <- glm(outcome ~ age * officer, data = cases, family = binomial, 
    na.action = na.exclude)
[1] 116
m4.corrupt.np.sum <- summary(m4.corrupt.np)
[1] 117
barplot(table(cases$outcome, cases$officer), col = c("red", "blue"), 
    xlab = "Officer", ylab = "Number of cases", legend = levels(cases$outcome))
[1] 118
with(cases, plot(jitter(as.numeric(outcome)) ~ age, pch = 1, 
    cex = 1, col = ifelse(officer == "AS", "red", ifelse(officer == 
        "IT", "green", "blue")), xlab = "age", ylab = "outcome", 
    axes = F))
[1] 119
axis(1)
[1] 120
[1] 20 40 60 80
with(cases, axis(2, at = c(1, 2), labels = levels(outcome)))
[1] 121
[1] 1 2
with(cases, legend("right", levels(officer), pch = 1, col = c("red", 
    "green", "blue")))
[1] 122
$rect
$rect$w
[1] 9.41797

$rect$h
[1] 0.2799973

$rect$left
[1] 83.62203

$rect$top
[1] 1.643859


$text
$text$x
[1] 88.21928 88.21928 88.21928

$text$y
[1] 1.573860 1.503860 1.433861


sample.as <- data.frame(age = c(17:90), officer = as.factor("AS"))
[1] 123
sample.it <- data.frame(age = c(17:90), officer = as.factor("IT"))
[1] 124
sample.np <- data.frame(age = c(17:90), officer = as.factor("NP"))
[1] 125
officer.predicted <- data.frame(age = c(17:90))
[1] 126
officer.predicted$as <- predict(m4, newdata = sample.as, type = "response")
[1] 127
officer.predicted$it <- predict(m4, newdata = sample.it, type = "response")
[1] 128
officer.predicted$np <- predict(m4, newdata = sample.np, type = "response")
[1] 129
par(mfrow = c(1, 3), oma = c(0, 0, 2, 0))
[1] 130
$mfrow
[1] 1 1

$oma
[1] 0 0 0 0

plot(as ~ age, type = "l", data = officer.predicted, xlab = "Age", 
    ylab = "p(fine)", main = "Officer AS")
[1] 131
plot(it ~ age, type = "l", data = officer.predicted, xlab = "Age", 
    ylab = "p(fine)", main = "Officer IT")
[1] 132
plot(np ~ age, type = "l", data = officer.predicted, xlab = "Age", 
    ylab = "p(fine)", main = "Officer NP")
[1] 133
mtext(expression(bold("p(fine) by Officer given Age")), side = 3, 
    line = -1, outer = T)
[1] 134
NULL
