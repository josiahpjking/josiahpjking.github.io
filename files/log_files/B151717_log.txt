

	####### B151717 R script #######

load(url("https://edin.ac/2QCZNVu"))
[1] 1
[1] "drinkdriving" "officer_inc" 
library(ggplot2, quietly = T)
[1] 2
[1] "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(psych, quietly = T)
[1] 3
 [1] "psych"     "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
load(url("https://edin.ac/2QCZNVu"))
[1] 4
[1] "drinkdriving" "officer_inc" 
summary(drinkdriving)
[1] 5
      age          nighttime         prior_offence          speed             bac           outcome          incident_id       
 Min.   : 14.00   Length:250         Length:250         Min.   :  0.00   Min.   : 3.987   Length:250         Length:250        
 1st Qu.: 30.00   Class :character   Class :character   1st Qu.: 30.92   1st Qu.:19.264   Class :character   Class :character  
 Median : 40.50   Mode  :character   Mode  :character   Median : 40.64   Median :23.609   Mode  :character   Mode  :character  
 Mean   : 46.00                                         Mean   : 40.49   Mean   :23.605                                        
 3rd Qu.: 55.25                                         3rd Qu.: 48.84   3rd Qu.:27.898                                        
 Max.   :297.00                                         Max.   :120.34   Max.   :65.764                                        
 NA's   :22                                                              NA's   :5                                             
table(drinkdriving$age)
[1] 6

14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 
 1  5  2  3  1  2  3  6  2  5  8  3  2  2  5  4  4  4  6  5  9  8  3  4  2 10  5  6  5  3  2  3  4  5  2  3  3  3  6  3  5  4  3  4  4 
59 60 61 62 63 
 1  5  3  3  2 
 [ reached getOption("max.print") -- omitted 15 entries ]
table(drinkdriving$nighttime)
[1] 7

18:25  2:05   day night 
    1     2    78   169 
table(drinkdriving$outcome)
[1] 8

   fine    Fine    FINE warning Warning WARNING 
    191       2       9      43       2       3 
table(drinkdriving$prior_offence)
[1] 9

          CD10           CD60 CD60,CD10,DR80      CD60,CD60           DD20           DR50           DR80              N           PL10 
             2              1              1              1              4             43              4            185              2 
          SP50           SP60           TS70      TS70,DR50 
             2              1              3              1 
boxplot(drinkdriving$speed)
[1] 10
boxplot(drinkdriving$bac)
[1] 11
table(drinkdriving$incident_id)
[1] 12

  inc_1  inc_10 inc_100 inc_101 inc_102 inc_103 inc_104 inc_105 inc_106 inc_107 inc_108 inc_109  inc_11 inc_110 inc_111 inc_112 
      1       1       1       1       1       1       1       1       1       1       1       1       1       1       1       1 
inc_113 inc_114 inc_115 inc_116 inc_117 inc_118 inc_119  inc_12 inc_120 inc_121 inc_122 inc_123 inc_124 inc_125 inc_126 inc_127 
      1       1       1       1       1       1       1       1       1       1       1       1       1       1       1       1 
inc_128 inc_129  inc_13 inc_130 inc_131 inc_132 inc_133 inc_134 inc_135 inc_136 inc_137 inc_138 inc_139  inc_14 inc_140 inc_141 
      1       1       1       1       1       1       1       1       1       1       1       1       1       1       1       1 
inc_142 inc_143 
      1       1 
 [ reached getOption("max.print") -- omitted 200 entries ]
table(officer_inc$incident_id)
[1] 13

  inc_1  inc_10 inc_100 inc_101 inc_102 inc_103 inc_104 inc_105 inc_106 inc_107 inc_108 inc_109  inc_11 inc_110 inc_111 inc_112 
      1       1       1       1       1       1       1       1       1       1       1       1       1       1       1       1 
inc_113 inc_114 inc_115 inc_116 inc_117 inc_118 inc_119  inc_12 inc_120 inc_121 inc_122 inc_123 inc_124 inc_125 inc_126 inc_127 
      1       1       1       1       1       1       1       1       1       1       1       1       1       1       1       1 
inc_128 inc_129  inc_13 inc_130 inc_131 inc_132 inc_133 inc_134 inc_135 inc_136 inc_137 inc_138 inc_139  inc_14 inc_140 inc_141 
      1       1       1       1       1       1       1       1       1       1       1       1       1       1       1       1 
inc_142 inc_143 
      1       1 
 [ reached getOption("max.print") -- omitted 200 entries ]
table(officer_inc$officer)
[1] 14

 AS  IT  NP 
116  66  67 
drinkdriving$age[drinkdriving$age >= 105] <- NA
[1] 15
drinkdriving$age[drinkdriving$speed <= 10] <- NA
[1] 16
drinkdriving$bac[drinkdriving$bac > 40] <- NA
[1] 17
drinkdriving$nighttime[drinkdriving$nighttime == "18:25"] <- "night"
[1] 18
drinkdriving$nighttime[drinkdriving$nighttime == "2:05"] <- "night"
[1] 19
drinkdriving$outcome[drinkdriving$outcome == "Fine"] <- "fine"
[1] 20
drinkdriving$outcome[drinkdriving$outcome == "FINE"] <- "fine"
[1] 21
drinkdriving$outcome[drinkdriving$outcome == "Warning"] <- "warning"
[1] 22
drinkdriving$outcome[drinkdriving$outcome == "WARNING"] <- "warning"
[1] 23
drinkdriving$prior_offence[drinkdriving$prior_offence == "DD20"] <- NA
[1] 24
drinkdriving$prior_offence[drinkdriving$prior_offence == "DR50"] <- "drinking"
[1] 25
drinkdriving$prior_offence[drinkdriving$prior_offence == "TS70,DR50"] <- "drinking"
[1] 26
drinkdriving$prior_offence[drinkdriving$prior_offence == "DR80"] <- "non-drinking"
[1] 27
drinkdriving$prior_offence[drinkdriving$prior_offence == "CD10"] <- "non-drinking"
[1] 28
drinkdriving$prior_offence[drinkdriving$prior_offence == "CD60"] <- "non-drinking"
[1] 29
drinkdriving$prior_offence[drinkdriving$prior_offence == "CD60,CD10,DR80"] <- "non-drinking"
[1] 30
drinkdriving$prior_offence[drinkdriving$prior_offence == "CD60,CD60"] <- "non-drinking"
[1] 31
drinkdriving$prior_offence[drinkdriving$prior_offence == "PL10"] <- "non-drinking"
[1] 32
drinkdriving$prior_offence[drinkdriving$prior_offence == "SP50"] <- "non-drinking"
[1] 33
drinkdriving$prior_offence[drinkdriving$prior_offence == "SP60"] <- "non-drinking"
[1] 34
drinkdriving$prior_offence[drinkdriving$prior_offence == "TS70"] <- "non-drinking"
[1] 35
drinkdriving$prior <- drinkdriving$prior_offence
[1] 36
drinkdriving$prior[drinkdriving$prior != "N"] <- "Y"
[1] 37
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 38
plot(m1)
[1] 39
summary(m1)
[1] 40

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.2850  -4.1462  -0.6942   3.9188  15.2013 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 28.85369    1.08065  26.700  < 2e-16 ***
age         -0.14332    0.02376  -6.031 7.15e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.801 on 212 degrees of freedom
  (36 observations deleted due to missingness)
Multiple R-squared:  0.1465,	Adjusted R-squared:  0.1424 
F-statistic: 36.38 on 1 and 212 DF,  p-value: 7.146e-09

with(drinkdriving, cor.test(bac, age))
[1] 41

	Pearson's product-moment correlation

data:  bac and age
t = -6.0313, df = 212, p-value = 7.146e-09
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.4915848 -0.2620321
sample estimates:
       cor 
-0.3826995 

residuals <- rstudent(model = m1)
[1] 42
describe(residuals)
[1] 43
   vars   n mean   sd median trimmed mad   min  max range skew kurtosis   se
X1    1 214    0 1.01  -0.12   -0.01   1 -2.68 2.68  5.36 0.11    -0.38 0.07
m1


Call:
lm(formula = bac ~ age, data = drinkdriving)

Coefficients:
(Intercept)          age  
    28.8537      -0.1433  



28.8537 + -0.1433 * 50
[1] 45
[1] 21.6887
with(m1, plot(drinkdriving$age, drinkdriving$bac, xlab = "age", 
    ylab = "blood alcohol content", main = "Predicted BAC for 50-yr-old driver"))
[1] 46
abline(m1, col = "red")
[1] 47
abline(v = 50, col = "blue")
[1] 48
qqnorm(residuals)
[1] 49
$x
 [1] -0.98947682 -0.40304396  1.45793009 -0.09972740 -0.76558171  0.78137930  0.02928723  0.64536360  0.61677495 -1.70184170
[11]  1.13348808 -0.42858633  0.81357607 -0.48054330  1.02844975 -0.08796242  0.19448723 -0.24247618 -0.88065483 -0.20643825
[21]  0.98947682  0.54738807 -0.01757073 -0.95195167 -1.30589348 -2.45678408  0.18256393  0.39037174  0.76558171 -1.09002772
[31] -0.93368328  0.97054340  1.15604304 -0.18256393  0.29103044  1.60963924  0.63100480  0.23043083 -0.37776190 -0.39037174
[41]  0.30327245 -0.91572131  0.58868177  0.20643825  1.22752277 -0.19448723  0.88065483  1.27889345  0.57480888 -0.23043083
 [ reached getOption("max.print") -- omitted 164 entries ]

$y
          1           2           3           4           6           8           9          11          12          13          14 
-0.95895840 -0.46756071  1.62765555 -0.18432169 -0.78867874  0.85805993 -0.08165233  0.63094480  0.60045494 -1.66533642  1.20074136 
         15          16          18          19          20          21          23          24          25          26          27 
-0.49723573  0.88107932 -0.53076511  1.05294814 -0.18312705  0.20359053 -0.32293067 -0.84847141 -0.26801066  1.04183825  0.56439791 
         28          29          30          31          32          33          34          35          36          37          38 
-0.12317166 -0.91901418 -1.31770392 -2.62407547  0.20110289  0.41007674  0.79497120 -1.07319467 -0.91607359  1.03370414  1.23466743 
         39          40          41          42          43          44          45          46          47          48          49 
-0.26187832  0.32748141  1.67201069  0.61573822  0.21464979 -0.46059192 -0.46471790  0.33959036 -0.91098884  0.58060214  0.20411894 
         50          52          53          56          57          58 
 1.33314733 -0.26781947  0.93558662  1.40724655  0.57589896 -0.30806534 
 [ reached getOption("max.print") -- omitted 164 entries ]

hist(residuals)
[1] 50
plot(density(residuals))
[1] 51
describe(residuals)
[1] 52
   vars   n mean   sd median trimmed mad   min  max range skew kurtosis   se
X1    1 214    0 1.01  -0.12   -0.01   1 -2.68 2.68  5.36 0.11    -0.38 0.07
shapiro.test(residuals)
[1] 53

	Shapiro-Wilk normality test

data:  residuals
W = 0.99307, p-value = 0.4162

m2 <- lm(bac ~ age + nighttime, data = drinkdriving)
[1] 54
summary(m2)
[1] 55

Call:
lm(formula = bac ~ age + nighttime, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.3614  -4.7255   0.1965   3.8005  14.3758 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    25.79689    1.21875  21.167  < 2e-16 ***
age            -0.13229    0.02278  -5.806 2.33e-08 ***
nighttimenight  3.82243    0.81345   4.699 4.71e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.532 on 211 degrees of freedom
  (36 observations deleted due to missingness)
Multiple R-squared:  0.2273,	Adjusted R-squared:   0.22 
F-statistic: 31.04 on 2 and 211 DF,  p-value: 1.528e-12

summary(m1)
[1] 56

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.2850  -4.1462  -0.6942   3.9188  15.2013 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 28.85369    1.08065  26.700  < 2e-16 ***
age         -0.14332    0.02376  -6.031 7.15e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.801 on 212 degrees of freedom
  (36 observations deleted due to missingness)
Multiple R-squared:  0.1465,	Adjusted R-squared:  0.1424 
F-statistic: 36.38 on 1 and 212 DF,  p-value: 7.146e-09

anova(m2)
[1] 57
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1224.1 1224.12  39.994 1.497e-09 ***
nighttime   1  675.8  675.84  22.081 4.711e-06 ***
Residuals 211 6458.1   30.61                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m3 <- lm(bac ~ age + speed, data = drinkdriving)
[1] 58
summary(m3)
[1] 59

Call:
lm(formula = bac ~ age + speed, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.4289  -3.6417  -0.6605   3.8871  14.2922 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 23.84391    2.91735   8.173 2.76e-14 ***
age         -0.10325    0.03208  -3.219  0.00149 ** 
speed        0.08457    0.04578   1.847  0.06613 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.768 on 211 degrees of freedom
  (36 observations deleted due to missingness)
Multiple R-squared:   0.16,	Adjusted R-squared:  0.1521 
F-statistic:  20.1 on 2 and 211 DF,  p-value: 1.022e-08

anova(m3)
[1] 60
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1224.1 1224.12 36.7909 6.001e-09 ***
speed       1  113.5  113.52  3.4118   0.06613 .  
Residuals 211 7020.5   33.27                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m1)
[1] 61

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.2850  -4.1462  -0.6942   3.9188  15.2013 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 28.85369    1.08065  26.700  < 2e-16 ***
age         -0.14332    0.02376  -6.031 7.15e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.801 on 212 degrees of freedom
  (36 observations deleted due to missingness)
Multiple R-squared:  0.1465,	Adjusted R-squared:  0.1424 
F-statistic: 36.38 on 1 and 212 DF,  p-value: 7.146e-09

m2.1 <- lm(bac ~ nighttime, data = drinkdriving)
[1] 62
hist(resid(m2.1))
[1] 63
summary(m2.1)
[1] 64

Call:
lm(formula = bac ~ nighttime, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-20.8033  -4.2060   0.3691   4.4487  13.2929 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)     20.0009     0.7215  27.720  < 2e-16 ***
nighttimenight   4.7893     0.8704   5.503 9.55e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.29 on 241 degrees of freedom
  (7 observations deleted due to missingness)
Multiple R-squared:  0.1116,	Adjusted R-squared:  0.1079 
F-statistic: 30.28 on 1 and 241 DF,  p-value: 9.552e-08

anova(m2.1, test = "Chisq")
[1] 65
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
nighttime   1 1198.0 1198.01  30.278 9.552e-08 ***
Residuals 241 9535.8   39.57                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m3.1 <- lm(bac ~ speed, data = drinkdriving)
[1] 66
hist(resid(m3.1))
[1] 67
summary(m3.1)
[1] 68

Call:
lm(formula = bac ~ speed, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.1525  -3.9441  -0.3248   4.2172  13.8120 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 15.15965    1.19495  12.686  < 2e-16 ***
speed        0.20335    0.02826   7.197 7.79e-12 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.055 on 241 degrees of freedom
  (7 observations deleted due to missingness)
Multiple R-squared:  0.1769,	Adjusted R-squared:  0.1735 
F-statistic: 51.79 on 1 and 241 DF,  p-value: 7.789e-12

summary(m2)
[1] 69

Call:
lm(formula = bac ~ age + nighttime, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.3614  -4.7255   0.1965   3.8005  14.3758 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    25.79689    1.21875  21.167  < 2e-16 ***
age            -0.13229    0.02278  -5.806 2.33e-08 ***
nighttimenight  3.82243    0.81345   4.699 4.71e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.532 on 211 degrees of freedom
  (36 observations deleted due to missingness)
Multiple R-squared:  0.2273,	Adjusted R-squared:   0.22 
F-statistic: 31.04 on 2 and 211 DF,  p-value: 1.528e-12

summary(m3)
[1] 70

Call:
lm(formula = bac ~ age + speed, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.4289  -3.6417  -0.6605   3.8871  14.2922 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 23.84391    2.91735   8.173 2.76e-14 ***
age         -0.10325    0.03208  -3.219  0.00149 ** 
speed        0.08457    0.04578   1.847  0.06613 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.768 on 211 degrees of freedom
  (36 observations deleted due to missingness)
Multiple R-squared:   0.16,	Adjusted R-squared:  0.1521 
F-statistic:  20.1 on 2 and 211 DF,  p-value: 1.022e-08

m4 <- lm(speed ~ nighttime, data = drinkdriving)
[1] 71
summary(m4)
[1] 72

Call:
lm(formula = speed ~ nighttime, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-41.022  -9.380   0.086   8.311  81.032 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)      39.305      1.690  23.261   <2e-16 ***
nighttimenight    1.717      2.037   0.843      0.4    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 14.92 on 248 degrees of freedom
Multiple R-squared:  0.002856,	Adjusted R-squared:  -0.001165 
F-statistic: 0.7103 on 1 and 248 DF,  p-value: 0.4002

drinkdriving$outcome[drinkdriving$outcome == "warning"] <- 0
[1] 73
drinkdriving$outcome[drinkdriving$outcome == "fine"] <- 1
[1] 74
drinkdriving$nighttime[drinkdriving$nighttime == "night"] <- 1
[1] 75
drinkdriving$nighttime[drinkdriving$nighttime == "day"] <- 0
[1] 76
drinkdriving$outcome <- as.numeric(drinkdriving$outcome)
[1] 77
drinkdriving$speed <- as.numeric(drinkdriving$speed)
[1] 78
drinkdriving$bac <- as.numeric(drinkdriving$bac)
[1] 79
drinkdriving$age <- as.numeric(drinkdriving$age)
[1] 80
drinkdriving$nighttime <- as.numeric(drinkdriving$nighttime)
[1] 81
m5 <- glm(scale(outcome) ~ scale(speed), data = drinkdriving, 
    family = "binomial")
[1] 82


####################################################################################################

[1] "Error in eval(family$initialize) : y values must be 0 <= y <= 1\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in eval(family$initialize): y values must be 0 <= y <= 1>
####################################################################################################


summary(m5)
[1] 83
[1] "Error in summary(m5) : object 'm5' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m5): object 'm5' not found>


####################################################################################################

[1] "Error in summary(m5) : object 'm5' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m5): object 'm5' not found>
####################################################################################################


m6 <- glm(scale(outcome) ~ scale(bac), data = drinkdriving, family = "binomial")
[1] 84


####################################################################################################

[1] "Error in eval(family$initialize) : y values must be 0 <= y <= 1\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in eval(family$initialize): y values must be 0 <= y <= 1>
####################################################################################################


summary(m6)
[1] 85
[1] "Error in summary(m6) : object 'm6' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m6): object 'm6' not found>


####################################################################################################

[1] "Error in summary(m6) : object 'm6' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m6): object 'm6' not found>
####################################################################################################


m5.1 <- glm(scale(outcome) ~ scale(speed) + scale(bac), data = drinkdriving, 
    family = "binomial")
[1] 86


####################################################################################################

[1] "Error in eval(family$initialize) : y values must be 0 <= y <= 1\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in eval(family$initialize): y values must be 0 <= y <= 1>
####################################################################################################


summary(m5.1)
[1] 87
[1] "Error in summary(m5.1) : object 'm5.1' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m5.1): object 'm5.1' not found>


####################################################################################################

[1] "Error in summary(m5.1) : object 'm5.1' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m5.1): object 'm5.1' not found>
####################################################################################################


m6.1 <- glm(scale(outcome) ~ scale(bac) + scale(speed), data = drinkdriving, 
    family = "binomial")
[1] 88


####################################################################################################

[1] "Error in eval(family$initialize) : y values must be 0 <= y <= 1\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in eval(family$initialize): y values must be 0 <= y <= 1>
####################################################################################################


summary(m6.1)
[1] 89
[1] "Error in summary(m6.1) : object 'm6.1' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m6.1): object 'm6.1' not found>


####################################################################################################

[1] "Error in summary(m6.1) : object 'm6.1' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m6.1): object 'm6.1' not found>
####################################################################################################


m7 <- glm(outcome ~ nighttime, data = drinkdriving, family = "binomial")
[1] 90
summary(m7)
[1] 91

Call:
glm(formula = outcome ~ nighttime, family = "binomial", data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.9054   0.5961   0.5961   0.5961   0.7698  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)   1.0647     0.2593   4.106 4.03e-05 ***
nighttime     0.5729     0.3315   1.728    0.084 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 244.56  on 249  degrees of freedom
Residual deviance: 241.63  on 248  degrees of freedom
AIC: 245.63

Number of Fisher Scoring iterations: 4

m8 <- glm(scale(outcome) ~ scale(age), data = drinkdriving, family = "binomial")
[1] 92


####################################################################################################

[1] "Error in eval(family$initialize) : y values must be 0 <= y <= 1\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in eval(family$initialize): y values must be 0 <= y <= 1>
####################################################################################################


summary(m8)
[1] 93
[1] "Error in summary(m8) : object 'm8' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m8): object 'm8' not found>


####################################################################################################

[1] "Error in summary(m8) : object 'm8' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m8): object 'm8' not found>
####################################################################################################


m8.1 <- glm(scale(outcome) ~ scale(age) + scale(nighttime) + 
    scale(speed) + scale(bac), data = drinkdriving, family = "binomial")
[1] 94


####################################################################################################

[1] "Error in eval(family$initialize) : y values must be 0 <= y <= 1\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in eval(family$initialize): y values must be 0 <= y <= 1>
####################################################################################################


summary(m8.1)
[1] 95
[1] "Error in summary(m8.1) : object 'm8.1' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m8.1): object 'm8.1' not found>


####################################################################################################

[1] "Error in summary(m8.1) : object 'm8.1' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in summary(m8.1): object 'm8.1' not found>
####################################################################################################


anova(m8.1)
[1] 96
[1] "Error in anova(m8.1) : object 'm8.1' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in anova(m8.1): object 'm8.1' not found>


####################################################################################################

[1] "Error in anova(m8.1) : object 'm8.1' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in anova(m8.1): object 'm8.1' not found>
####################################################################################################


drinkdriving$prior_offence[drinkdriving$prior_offence == "N"] <- NA
[1] 97
m9 <- glm(outcome ~ prior_offence, data = drinkdriving, family = "binomial")
[1] 98
summary(m9)
[1] 99

Call:
glm(formula = outcome ~ prior_offence, family = "binomial", data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1899   0.4366   0.4366   0.4366   0.8346  

Coefficients:
                          Estimate Std. Error z value Pr(>|z|)    
(Intercept)                 2.3026     0.5244   4.391 1.13e-05 ***
prior_offencenon-drinking  -1.4271     0.7472  -1.910   0.0561 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 51.047  on 60  degrees of freedom
Residual deviance: 47.405  on 59  degrees of freedom
  (189 observations deleted due to missingness)
AIC: 51.405

Number of Fisher Scoring iterations: 5

anova(m9)
[1] 100
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


              Df Deviance Resid. Df Resid. Dev
NULL                             60     51.047
prior_offence  1   3.6421        59     47.405
m10 <- glm(outcome ~ prior, data = drinkdriving, family = "binomial")
[1] 101
summary(m10)
[1] 102

Call:
glm(formula = outcome ~ prior, family = "binomial", data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.9564   0.5650   0.6681   0.6681   0.6681  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)   1.3863     0.1838   7.542 4.62e-14 ***
priorY        0.3677     0.4051   0.908    0.364    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 237.06  on 245  degrees of freedom
Residual deviance: 236.20  on 244  degrees of freedom
  (4 observations deleted due to missingness)
AIC: 240.2

Number of Fisher Scoring iterations: 4

plot(m10)
[1] 103
m11 <- glm(outcome ~ age + nighttime + speed + bac, data = drinkdriving)
[1] 104
summary(m11)
[1] 105

Call:
glm(formula = outcome ~ age + nighttime + speed + bac, data = drinkdriving)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.08282  -0.13933   0.08148   0.21846   0.67156  

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.3619729  0.1795564   2.016  0.04509 *  
age         -0.0057401  0.0017626  -3.257  0.00132 ** 
nighttime    0.0003479  0.0478091   0.007  0.99420    
speed        0.0077712  0.0024753   3.139  0.00194 ** 
bac          0.0172783  0.0038766   4.457 1.35e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for gaussian family taken to be 0.09570535)

    Null deviance: 31.893  on 213  degrees of freedom
Residual deviance: 20.002  on 209  degrees of freedom
  (36 observations deleted due to missingness)
AIC: 112.1

Number of Fisher Scoring iterations: 2

table(drinkdriving$age)
[1] 106

14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 
 1  5  2  3  1  2  3  6  2  5  8  3  2  2  5  4  4  4  6  5  9  8  3  4  2 10  5  6  5  3  2  3  4  5  2  3  3  3  6  3  4  4  2  4  4 
59 60 61 62 63 
 1  4  3  3  2 
 [ reached getOption("max.print") -- omitted 12 entries ]
agerange <- seq(14, 90)
[1] 107
length(agerange)
[1] 108
[1] 77
newdf <- data.frame(id = factor(1:100))
[1] 109
newdf$speed <- runif(100, 30, 30)
[1] 110
newdf$bac <- runif(100, 0, 0)
[1] 111
newdf$nighttime <- 0
[1] 112
newdf$age <- sample(c(14:90), 100, replace = TRUE)
[1] 113
finebyage <- predict(m11, newdata = newdf)
[1] 114
range(finebyage)
[1] 115
[1] 0.08997746 0.51474726
scatter.smooth(agerange, finebyage, xlim = c(14, 90), xaxt = "n", 
    xlab = "age", ylab = "probability of fine", main = "Outcome predicted by age at 30mph, 0 bac during the day")
[1] 116
[1] "Error in xy.coords(x, y, xlabel, ylabel) : 'x' and 'y' lengths differ\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in xy.coords(x, y, xlabel, ylabel): 'x' and 'y' lengths differ>


####################################################################################################

[1] "Error in xy.coords(x, y, xlabel, ylabel) : 'x' and 'y' lengths differ\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in xy.coords(x, y, xlabel, ylabel): 'x' and 'y' lengths differ>
####################################################################################################


axis(1, at = seq(14, 90, by = 5), las = 1)
[1] 117
 [1] 14 19 24 29 34 39 44 49 54 59 64 69 74 79 84 89
alldata <- merge(drinkdriving, officer_inc, by = "incident_id")
[1] 118
m12 <- glm(outcome ~ age * officer, data = alldata, family = "binomial")
[1] 119
summary(m12)
[1] 120

Call:
glm(formula = outcome ~ age * officer, family = "binomial", data = alldata)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.75187   0.07221   0.27678   0.53143   2.32941  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept)    9.60788    2.06783   4.646 3.38e-06 ***
age           -0.15912    0.03554  -4.477 7.56e-06 ***
officerIT     -5.08404    2.45663  -2.070   0.0385 *  
officerNP     -4.63752    2.57900  -1.798   0.0721 .  
age:officerIT  0.09402    0.04326   2.173   0.0298 *  
age:officerNP  0.09207    0.04523   2.036   0.0418 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 209.02  on 220  degrees of freedom
Residual deviance: 139.81  on 215  degrees of freedom
  (29 observations deleted due to missingness)
AIC: 151.81

Number of Fisher Scoring iterations: 7

plot(m12)
[1] 121
with(m12, plot(alldata$officer, alldata$age, alldata$outcome, 
    xlab = "officer", ylab = "age", main = "Outcome by age per officer"))
[1] 122
m12.1 <- glm(outcome ~ age * (officer == "AS"), data = alldata, 
    family = "binomial")
[1] 123
m12.2 <- glm(outcome ~ age * (officer == "IT"), data = alldata, 
    family = "binomial")
[1] 124
m12.3 <- glm(outcome ~ age * (officer == "NP"), data = alldata, 
    family = "binomial")
[1] 125
summary(m12.1)
[1] 126

Call:
glm(formula = outcome ~ age * (officer == "AS"), family = "binomial", 
    data = alldata)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.67044   0.07221   0.28152   0.51339   2.32941  

Coefficients:
                        Estimate Std. Error z value Pr(>|z|)    
(Intercept)              4.71965    0.99594   4.739 2.15e-06 ***
age                     -0.06571    0.01829  -3.592 0.000328 ***
officer == "AS"TRUE      4.88822    2.29517   2.130 0.033190 *  
age:officer == "AS"TRUE -0.09341    0.03997  -2.337 0.019436 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 209.02  on 220  degrees of freedom
Residual deviance: 140.24  on 217  degrees of freedom
  (29 observations deleted due to missingness)
AIC: 148.24

Number of Fisher Scoring iterations: 7

summary(m12.2)
[1] 127

Call:
glm(formula = outcome ~ age * (officer == "IT"), family = "binomial", 
    data = alldata)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.2523   0.1196   0.2671   0.5231   1.8651  

Coefficients:
                        Estimate Std. Error z value Pr(>|z|)    
(Intercept)              7.36725    1.20316   6.123 9.17e-10 ***
age                     -0.11576    0.02098  -5.517 3.45e-08 ***
officer == "IT"TRUE     -2.84341    1.79072  -1.588    0.112    
age:officer == "IT"TRUE  0.05066    0.03238   1.564    0.118    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 209.02  on 220  degrees of freedom
Residual deviance: 145.12  on 217  degrees of freedom
  (29 observations deleted due to missingness)
AIC: 153.12

Number of Fisher Scoring iterations: 6

summary(m12.3)
[1] 128

Call:
glm(formula = outcome ~ age * (officer == "NP"), family = "binomial", 
    data = alldata)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.9410   0.1380   0.2849   0.4904   2.3422  

Coefficients:
                        Estimate Std. Error z value Pr(>|z|)    
(Intercept)              7.01628    1.12907   6.214 5.16e-10 ***
age                     -0.11270    0.02033  -5.544 2.96e-08 ***
officer == "NP"TRUE     -2.04592    1.91052  -1.071    0.284    
age:officer == "NP"TRUE  0.04565    0.03458   1.320    0.187    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 209.02  on 220  degrees of freedom
Residual deviance: 144.97  on 217  degrees of freedom
  (29 observations deleted due to missingness)
AIC: 152.97

Number of Fisher Scoring iterations: 6

anova(m12.1)
[1] 129
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


                    Df Deviance Resid. Df Resid. Dev
NULL                                  220     209.02
age                  1   61.528       219     147.49
officer == "AS"      1    0.330       218     147.16
age:officer == "AS"  1    6.919       217     140.25
