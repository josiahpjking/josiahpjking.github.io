

	####### B026512 R script #######

library(psych, quietly = T)
[1] 1
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(lsr)
[1] 2
 [1] "lsr"       "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 3
 [1] "car"       "carData"   "lsr"       "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[11] "methods"   "base"     
library(gplots, quietly = T)
[1] 4
 [1] "gplots"    "car"       "carData"   "lsr"       "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"    
[11] "datasets"  "methods"   "base"     
library(ggplot2)
[1] 5
 [1] "ggplot2"   "gplots"    "car"       "carData"   "lsr"       "psych"     "readr"     "stats"     "graphics"  "grDevices"
[11] "utils"     "datasets"  "methods"   "base"     
library(tidyverse, quietly = T)
[1] 6
 [1] "forcats"   "stringr"   "dplyr"     "purrr"     "tidyr"     "tibble"    "tidyverse" "ggplot2"   "gplots"    "car"      
[11] "carData"   "lsr"       "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[21] "base"     
load(url("https://edin.ac/2QCZNVu"))
[1] 7
[1] "drinkdriving" "officer_inc" 
summary(drinkdriving)
[1] 8
      age          nighttime         prior_offence          speed             bac           outcome          incident_id       
 Min.   : 14.00   Length:250         Length:250         Min.   :  0.00   Min.   : 3.987   Length:250         Length:250        
 1st Qu.: 30.00   Class :character   Class :character   1st Qu.: 30.92   1st Qu.:19.264   Class :character   Class :character  
 Median : 40.50   Mode  :character   Mode  :character   Median : 40.64   Median :23.609   Mode  :character   Mode  :character  
 Mean   : 46.00                                         Mean   : 40.49   Mean   :23.605                                        
 3rd Qu.: 55.25                                         3rd Qu.: 48.84   3rd Qu.:27.898                                        
 Max.   :297.00                                         Max.   :120.34   Max.   :65.764                                        
 NA's   :22                                                              NA's   :5                                             
summary(drinkdriving$age)
[1] 9
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
  14.00   30.00   40.50   46.00   55.25  297.00      22 
class(drinkdriving$age)
[1] 10
[1] "numeric"
head(drinkdriving$age)
[1] 11
[1] 39 28 38 51 56 36
which(drinkdriving$age > 100)
[1] 12
[1]  51 114 224
drinkdriving$age[c(51, 114, 224)]
[1] 13
[1] 293 297 297
drinkdriving$age[drinkdriving$age > 100] <- NA
[1] 14
class(drinkdriving$age)
[1] 15
[1] "numeric"
summary(drinkdriving$age)
[1] 16
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
  14.00   30.00   40.00   42.68   55.00   90.00      25 
hist(drinkdriving$age)
[1] 17
class(drinkdriving$nighttime)
[1] 18
[1] "character"
drinkdriving$nighttime <- as.factor(drinkdriving$nighttime)
[1] 19
is.factor(drinkdriving$nighttime)
[1] 20
[1] TRUE
levels(drinkdriving$nighttime)
[1] 21
[1] "18:25" "2:05"  "day"   "night"
table(drinkdriving$nighttime)
[1] 22

18:25  2:05   day night 
    1     2    78   169 
drinkdriving$nighttime[drinkdriving$nighttime == "18:25"] <- NA
[1] 23
drinkdriving$nighttime[drinkdriving$nighttime == "2:05"] <- NA
[1] 24
drinkdriving$nighttime <- droplevels(drinkdriving$nighttime)
[1] 25
levels(drinkdriving$nighttime)
[1] 26
[1] "day"   "night"
table(drinkdriving$nighttime)
[1] 27

  day night 
   78   169 
class(drinkdriving$prior_offence)
[1] 28
[1] "character"
drinkdriving$prior_offence <- as.factor(drinkdriving$prior_offence)
[1] 29
is.factor(drinkdriving$prior_offence)
[1] 30
[1] TRUE
levels(drinkdriving$prior_offence)
[1] 31
 [1] "CD10"           "CD60"           "CD60,CD10,DR80" "CD60,CD60"      "DD20"           "DR50"           "DR80"          
 [8] "N"              "PL10"           "SP50"           "SP60"           "TS70"           "TS70,DR50"     
table(drinkdriving$prior_offence)
[1] 32

          CD10           CD60 CD60,CD10,DR80      CD60,CD60           DD20           DR50           DR80              N           PL10 
             2              1              1              1              4             43              4            185              2 
          SP50           SP60           TS70      TS70,DR50 
             2              1              3              1 
drinkdriving$prior_offence <- as.character(drinkdriving$prior_offence)
[1] 33
class(drinkdriving$prior_offence)
[1] 34
[1] "character"
drinkdriving$prior_offence[drinkdriving$prior_offence == "CD10" | 
    drinkdriving$prior_offence == "CD60" | drinkdriving$prior_offence == 
    "CD60,CD60" | drinkdriving$prior_offence == "CD60,CD10,DR80"] <- "CD"
[1] 35
drinkdriving$prior_offence[drinkdriving$prior_offence == "SP50" | 
    drinkdriving$prior_offence == "SP60"] <- "SP"
[1] 36
drinkdriving$prior_offence[drinkdriving$prior_offence == "TS70,DR50"] <- "DR50"
[1] 37
drinkdriving$prior_offence <- as.factor(drinkdriving$prior_offence)
[1] 38
drinkdriving$prior_offence <- droplevels(drinkdriving$prior_offence)
[1] 39
levels(drinkdriving$prior_offence)
[1] 40
[1] "CD"   "DD20" "DR50" "DR80" "N"    "PL10" "SP"   "TS70"
drinkdriving$prior_offence[drinkdriving$prior_offence == "DD20"] <- NA
[1] 41
drinkdriving$prior_offence <- droplevels(drinkdriving$prior_offence)
[1] 42
levels(drinkdriving$prior_offence)
[1] 43
[1] "CD"   "DR50" "DR80" "N"    "PL10" "SP"   "TS70"
table(drinkdriving$prior_offence)
[1] 44

  CD DR50 DR80    N PL10   SP TS70 
   5   44    4  185    2    3    3 
summary(drinkdriving$speed)
[1] 45
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00   30.92   40.64   40.49   48.84  120.34 
head(drinkdriving$speed)
[1] 46
[1] 47.957110 43.826353 47.260707 17.221097  1.945818 41.399468
hist(drinkdriving$speed)
[1] 47
boxplot(drinkdriving$speed)
[1] 48
drinkdriving$speed <- round(drinkdriving$speed, digits = 0)
[1] 49
head(drinkdriving$speed)
[1] 50
[1] 48 44 47 17  2 41
summary(drinkdriving$speed)
[1] 51
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    0.0    31.0    41.0    40.5    49.0   120.0 
class(drinkdriving$bac)
[1] 52
[1] "numeric"
summary(drinkdriving$bac)
[1] 53
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
  3.987  19.264  23.609  23.605  27.898  65.764       5 
drinkdriving$bac <- (drinkdriving$bac/100)
[1] 54
summary(drinkdriving$bac)
[1] 55
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
0.03987 0.19264 0.23609 0.23605 0.27898 0.65764       5 
head(drinkdriving$bac)
[1] 56
[1] 0.1771374 0.2213440 0.3278940 0.2047576 0.2936736 0.1912717
drinkdriving$bac <- round(drinkdriving$bac, digits = 3)
[1] 57
summary(drinkdriving$bac)
[1] 58
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
 0.0400  0.1930  0.2360  0.2361  0.2790  0.6580       5 
head(drinkdriving$bac)
[1] 59
[1] 0.177 0.221 0.328 0.205 0.294 0.191
hist(drinkdriving$bac)
[1] 60
boxplot(drinkdriving$bac)
[1] 61
summary(drinkdriving$outcome)
[1] 62
   Length     Class      Mode 
      250 character character 
drinkdriving$outcome <- as.factor(drinkdriving$outcome)
[1] 63
is.factor(drinkdriving$outcome)
[1] 64
[1] TRUE
levels(drinkdriving$outcome)
[1] 65
[1] "fine"    "Fine"    "FINE"    "warning" "Warning" "WARNING"
drinkdriving$outcome[drinkdriving$outcome == "Fine"] <- "fine"
[1] 66
drinkdriving$outcome[drinkdriving$outcome == "FINE"] <- "fine"
[1] 67
drinkdriving$outcome[drinkdriving$outcome == "Warning"] <- "warning"
[1] 68
drinkdriving$outcome[drinkdriving$outcome == "WARNING"] <- "warning"
[1] 69
drinkdriving$outcome <- droplevels(drinkdriving$outcome)
[1] 70
levels(drinkdriving$outcome)
[1] 71
[1] "fine"    "warning"
summary(drinkdriving$incident_id)
[1] 72
   Length     Class      Mode 
      250 character character 
class(drinkdriving$incident_id)
[1] 73
[1] "character"
drinkdriving$incident_id <- as.factor(drinkdriving$incident_id)
[1] 74
is.factor(drinkdriving$incident_id)
[1] 75
[1] TRUE
levels(drinkdriving$incident_id)
[1] 76
 [1] "inc_1"   "inc_10"  "inc_100" "inc_101" "inc_102" "inc_103" "inc_104" "inc_105" "inc_106" "inc_107" "inc_108" "inc_109" "inc_11" 
[14] "inc_110" "inc_111" "inc_112" "inc_113" "inc_114" "inc_115" "inc_116" "inc_117" "inc_118" "inc_119" "inc_12"  "inc_120" "inc_121"
[27] "inc_122" "inc_123" "inc_124" "inc_125" "inc_126" "inc_127" "inc_128" "inc_129" "inc_13"  "inc_130" "inc_131" "inc_132" "inc_133"
[40] "inc_134" "inc_135" "inc_136" "inc_137" "inc_138" "inc_139" "inc_14"  "inc_140" "inc_141" "inc_142" "inc_143"
 [ reached getOption("max.print") -- omitted 200 entries ]
summary(officer_inc)
[1] 77
 officer     incident_id 
 AS  :116   inc_1  :  1  
 IT  : 66   inc_10 :  1  
 NP  : 67   inc_100:  1  
 NA's:  1   inc_101:  1  
            inc_102:  1  
            inc_103:  1  
            (Other):244  
class(officer_inc$officer)
[1] 78
[1] "factor"
class(officer_inc$incident_id)
[1] 79
[1] "factor"
describe(drinkdriving$age)
[1] 80
   vars   n  mean    sd median trimmed   mad min max range skew kurtosis   se
X1    1 225 42.68 16.77     40   41.93 17.79  14  90    76  0.4    -0.52 1.12
describe(drinkdriving$bac)
[1] 81
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis se
X1    1 245 0.24 0.07   0.24    0.24 0.06 0.04 0.66  0.62 0.77     4.71  0
with(drinkdriving, plot(bac ~ age, xlab = "Age (years)", ylab = "Blood Alcohol Content (%)", 
    main = "Figure 1. Association Between Age and Blood Alcohol Content \nfor Motorists Stopped and Breathalysed by the Police "))
[1] 82
abline(lm(bac ~ age, data = drinkdriving))
[1] 83
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 84
summary(m1)
[1] 85

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.15673 -0.04488 -0.00843  0.03834  0.42817 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.2928974  0.0125573  23.325   <2e-16 ***
age         -0.0014333  0.0002742  -5.228    4e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.0682 on 218 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1114,	Adjusted R-squared:  0.1073 
F-statistic: 27.33 on 1 and 218 DF,  p-value: 4.002e-07

coef(m1)
[1] 86
(Intercept)         age 
 0.29289740 -0.00143334 
confint(m1, level = 0.95)
[1] 87
                   2.5 %        97.5 %
(Intercept)  0.268148095  0.3176467062
age         -0.001973672 -0.0008930078
plot(m1, which = 1)
[1] 88
hist(x = residuals(m1), xlab = "Value of residual", main = "", 
    breaks = 20)
[1] 89
plot(m1, which = 2)
[1] 90
plot(m1, which = 3)
[1] 91
plot(m1, which = 4)
[1] 92
plot(m1, which = 5)
[1] 93
head(predict(m1))
[1] 94
        1         2         3         4         5         6 
0.2369971 0.2527639 0.2384305 0.2197971 0.2126304 0.2412972 
new_age <- data.frame(age = 50)
[1] 95
predict(m1, newdata = new_age)
[1] 96
        1 
0.2212304 
hist(residuals(m1), main = "", breaks = 20, )
[1] 97
rstandard(model = m1)
[1] 98
         1          2          3          4          5          6          7          8          9         10         11         12 
-0.8818122 -0.4676144  1.3165423 -0.2175817  1.1975490 -0.7394306  0.5533925  0.6664818 -0.1328343  0.5466070  0.4745664  0.4536685 
        13         14         15         16         18         19         20         21         23         24         25         26 
-1.4731914  0.9596534 -0.4849778  0.6830233 -0.5182373  0.8357689 -0.2219189  0.1088737 -0.3354106 -0.7936221 -0.2934147  0.8282844 
        27         28         29         30         31         32         33         34         35         36         37         38 
 0.4128722 -0.1671207 -0.8414300 -1.1853138 -2.2582648  0.1035030  0.2920090  0.6187963 -0.9729314 -0.8457964  0.8131626  0.9823436 
        39         40         41         42         43         44         45         46         47         48         49         50 
-0.2870639  0.2197773  1.3476492  0.4634547  0.1176225 -0.4592427 -0.4629009  0.2205055 -0.8392791  0.4304017  0.1167771  1.0736391 
        52         53 
-0.2900964  0.7319830 
 [ reached getOption("max.print") -- omitted 170 entries ]
hist(rstandard(m1), breaks = 20, xlab = "Residuals", ylab = "Frequency", 
    main = "", axes = F)
[1] 99
box(bty = "L")
[1] 100
NULL
axis(side = 1, xpd = T)
[1] 101
[1] 0.00 0.01 0.02 0.03 0.04
axis(side = 2, xpd = T)
[1] 102
[1] -2  0  2  4  6
describe(drinkdriving$age)
[1] 103
   vars   n  mean    sd median trimmed   mad min max range skew kurtosis   se
X1    1 225 42.68 16.77     40   41.93 17.79  14  90    76  0.4    -0.52 1.12
describe(drinkdriving$bac)
[1] 104
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis se
X1    1 245 0.24 0.07   0.24    0.24 0.06 0.04 0.66  0.62 0.77     4.71  0
describe(drinkdriving$speed)
[1] 105
   vars   n mean    sd median trimmed   mad min max range skew kurtosis   se
X1    1 250 40.5 14.87     41   40.31 11.86   0 120   120  0.5     2.83 0.94
table(drinkdriving$nighttime)
[1] 106

  day night 
   78   169 
m2 <- lm(bac ~ age + nighttime, data = drinkdriving)
[1] 107
summary(m2)
[1] 108

Call:
lm(formula = bac ~ age + nighttime, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.16456 -0.04683  0.00076  0.03565  0.41681 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.2683336  0.0142240  18.865  < 2e-16 ***
age            -0.0014415  0.0002665  -5.410 1.68e-07 ***
nighttimenight  0.0362763  0.0095326   3.805 0.000185 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.06549 on 215 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.1808,	Adjusted R-squared:  0.1732 
F-statistic: 23.72 on 2 and 215 DF,  p-value: 4.9e-10

contrasts(drinkdriving$nighttime)
[1] 109
      night
day       0
night     1
standardCoefs(m2)
[1] 110
                          b       beta
age            -0.001441458 -0.3350638
nighttimenight  0.036276337  0.2356996
confint(m2)
[1] 111
                      2.5 %        97.5 %
(Intercept)     0.240297293  0.2963698214
age            -0.001966654 -0.0009162621
nighttimenight  0.017487003  0.0550656706
anova(m2)
[1] 112
Analysis of Variance Table

Response: bac
           Df  Sum Sq  Mean Sq F value    Pr(>F)    
age         1 0.14140 0.141397  32.965 3.172e-08 ***
nighttime   1 0.06212 0.062118  14.482 0.0001845 ***
Residuals 215 0.92221 0.004289                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m3 <- lm(bac ~ age + speed, data = drinkdriving)
[1] 113
summary(m3)
[1] 114

Call:
lm(formula = bac ~ age + speed, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.15857 -0.04434 -0.00766  0.04223  0.34566 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.1743508  0.0273218   6.381 1.05e-09 ***
age         -0.0004266  0.0003342  -1.276    0.203    
speed        0.0019353  0.0004010   4.826 2.63e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.06496 on 217 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1975,	Adjusted R-squared:  0.1901 
F-statistic: 26.71 on 2 and 217 DF,  p-value: 4.265e-11

standardCoefs(m3)
[1] 115
                  b        beta
age   -0.0004265793 -0.09934036
speed  0.0019353171  0.37562035
confint(m3)
[1] 116
                   2.5 %      97.5 %
(Intercept)  0.120500734 0.228200887
age         -0.001085331 0.000232172
speed        0.001144911 0.002725723
anova(m3)
[1] 117
Analysis of Variance Table

Response: bac
           Df  Sum Sq  Mean Sq F value    Pr(>F)    
age         1 0.12714 0.127142  30.129 1.123e-07 ***
speed       1 0.09828 0.098279  23.289 2.626e-06 ***
Residuals 217 0.91572 0.004220                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m4 <- lm(bac ~ age + nighttime + speed, data = drinkdriving)
[1] 118
summary(m4)
[1] 119

Call:
lm(formula = bac ~ age + nighttime + speed, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.13255 -0.04599  0.00114  0.03821  0.33103 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.1447737  0.0273686   5.290 3.02e-07 ***
age            -0.0003960  0.0003226  -1.228    0.221    
nighttimenight  0.0382983  0.0090148   4.248 3.21e-05 ***
speed           0.0019917  0.0003843   5.182 5.05e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.06188 on 214 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.2721,	Adjusted R-squared:  0.2619 
F-statistic: 26.67 on 3 and 214 DF,  p-value: 1.073e-14

standardCoefs(m4)
[1] 120
                           b        beta
age            -0.0003960212 -0.09205428
nighttimenight  0.0382983126  0.24883711
speed           0.0019916544  0.38736563
confint(m4)
[1] 121
                      2.5 %       97.5 %
(Intercept)     0.090827246 0.1987202067
age            -0.001031896 0.0002398534
nighttimenight  0.020529075 0.0560675505
speed           0.001234143 0.0027491661
anova(m4)
[1] 122
Analysis of Variance Table

Response: bac
           Df  Sum Sq  Mean Sq F value    Pr(>F)    
age         1 0.14140 0.141397  36.929 5.541e-09 ***
nighttime   1 0.06212 0.062118  16.224 7.818e-05 ***
speed       1 0.10283 0.102835  26.858 5.054e-07 ***
Residuals 214 0.81937 0.003829                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
plot(m4, which = 1)
[1] 123
hist(x = residuals(m4), xlab = "Value of residual", main = "", 
    breaks = 20)
[1] 124
plot(m4, which = 2)
[1] 125
plot(m4, which = 3)
[1] 126
plot(m4, which = 4)
[1] 127
plot(m4, which = 5)
[1] 128
vif(m4)
[1] 129
      age nighttime     speed 
 1.653237  1.008671  1.642608 
m4a <- lm(bac ~ age + nighttime + speed, data = drinkdriving, 
    subset = c(-110, -154))
[1] 130
summary(m4a)
[1] 131

Call:
lm(formula = bac ~ age + nighttime + speed, data = drinkdriving, 
    subset = c(-110, -154))

Residuals:
      Min        1Q    Median        3Q       Max 
-0.155909 -0.043940  0.005829  0.035693  0.142777 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.2348830  0.0266779   8.804 4.71e-16 ***
age            -0.0011555  0.0002989  -3.865 0.000147 ***
nighttimenight  0.0387789  0.0079356   4.887 2.02e-06 ***
speed           0.0004169  0.0003971   1.050 0.295006    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05416 on 212 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.2458,	Adjusted R-squared:  0.2351 
F-statistic: 23.03 on 3 and 212 DF,  p-value: 6.078e-13

anova(m4a)
[1] 132
Analysis of Variance Table

Response: bac
           Df  Sum Sq  Mean Sq F value    Pr(>F)    
age         1 0.12965 0.129650 44.1932 2.478e-10 ***
nighttime   1 0.06977 0.069775 23.7838 2.113e-06 ***
speed       1 0.00323 0.003233  1.1021     0.295    
Residuals 212 0.62195 0.002934                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
standardCoefs(m4a)
[1] 133
                           b        beta
age            -0.0011554625 -0.31333272
nighttimenight  0.0387788603  0.29263647
speed           0.0004168705  0.08488309
plot(m4a, which = 4)
[1] 134
plot(m4a)
[1] 135
vif(m4a)
[1] 136
      age nighttime     speed 
 1.846987  1.007976  1.837634 
drinkdriving$bac[154]
[1] 137
[1] 0.658
drinkdriving$bac[110]
[1] 138
[1] 0.573
drinkdriving$bac[drinkdriving$bac == 0.573] <- NA
[1] 139
drinkdriving$bac[drinkdriving$bac == 0.658] <- NA
[1] 140
m5 <- lm(bac ~ age + nighttime + speed, data = drinkdriving)
[1] 141
summary(m5)
[1] 142

Call:
lm(formula = bac ~ age + nighttime + speed, data = drinkdriving)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.155909 -0.043940  0.005829  0.035693  0.142777 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.2348830  0.0266779   8.804 4.71e-16 ***
age            -0.0011555  0.0002989  -3.865 0.000147 ***
nighttimenight  0.0387789  0.0079356   4.887 2.02e-06 ***
speed           0.0004169  0.0003971   1.050 0.295006    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05416 on 212 degrees of freedom
  (34 observations deleted due to missingness)
Multiple R-squared:  0.2458,	Adjusted R-squared:  0.2351 
F-statistic: 23.03 on 3 and 212 DF,  p-value: 6.078e-13

anova(m5)
[1] 143
Analysis of Variance Table

Response: bac
           Df  Sum Sq  Mean Sq F value    Pr(>F)    
age         1 0.12965 0.129650 44.1932 2.478e-10 ***
nighttime   1 0.06977 0.069775 23.7838 2.113e-06 ***
speed       1 0.00323 0.003233  1.1021     0.295    
Residuals 212 0.62195 0.002934                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
plot(m5)
[1] 144
plot(m5, which = 4)
[1] 145
vif(m5)
[1] 146
      age nighttime     speed 
 1.846987  1.007976  1.837634 
plotmeans(speed ~ nighttime, data = drinkdriving, xlab = "Time of Day", 
    ylab = "Driving Speed(mph)", n.label = FALSE, main = "Driving Speed by Time of Day")
[1] 147
NULL
t.test <- t.test(speed ~ nighttime, data = drinkdriving)
[1] 148
t.test


	Welch Two Sample t-test

data:  speed by nighttime
t = -0.78114, df = 157.3, p-value = 0.4359
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -5.512046  2.387786
sample estimates:
  mean in group day mean in group night 
           39.30769            40.86982 



table(drinkdriving$nighttime)
[1] 150

  day night 
   78   169 
plot(drinkdriving$age ~ drinkdriving$outcome)
[1] 151
plot(drinkdriving$age, drinkdriving$outcome)
[1] 152
abline(lm(as.numeric(outcome) ~ age, data = drinkdriving))
[1] 153
plot(drinkdriving$speed ~ drinkdriving$outcome)
[1] 154
plot(drinkdriving$speed, drinkdriving$outcome)
[1] 155
abline(lm(as.numeric(outcome) ~ speed, data = drinkdriving))
[1] 156
plot(drinkdriving$bac ~ drinkdriving$outcome)
[1] 157
plot(drinkdriving$bac, drinkdriving$outcome)
[1] 158
abline(lm(as.numeric(outcome) ~ bac, data = drinkdriving))
[1] 159
plot(drinkdriving$outcome ~ drinkdriving$nighttime)
[1] 160
plot(drinkdriving$outcome ~ drinkdriving$prior_offence)
[1] 161
m6 <- glm(formula = relevel(outcome, "warning") ~ +scale(age) + 
    scale(speed) + scale(bac) + relevel(prior_offence, "N") + 
    nighttime, family = binomial, data = drinkdriving, na.action = na.omit)
[1] 162
summary(m6)
[1] 163

Call:
glm(formula = relevel(outcome, "warning") ~ +scale(age) + scale(speed) + 
    scale(bac) + relevel(prior_offence, "N") + nighttime, family = binomial, 
    data = drinkdriving, na.action = na.omit)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-4.2385   0.0030   0.0402   0.1982   1.8866  

Coefficients:
                                 Estimate Std. Error z value Pr(>|z|)    
(Intercept)                        5.0564     1.0347   4.887 1.02e-06 ***
scale(age)                        -2.2475     0.6202  -3.624 0.000290 ***
scale(speed)                       2.4762     0.6443   3.843 0.000121 ***
scale(bac)                         1.9156     0.5094   3.760 0.000170 ***
relevel(prior_offence, "N")CD      3.7485     1.9366   1.936 0.052916 .  
relevel(prior_offence, "N")DR50    2.0732     1.0656   1.946 0.051699 .  
relevel(prior_offence, "N")DR80   -4.5807     2.1407  -2.140 0.032369 *  
relevel(prior_offence, "N")PL10    2.0586    48.8801   0.042 0.966407    
relevel(prior_offence, "N")SP     -5.0900     1.8861  -2.699 0.006961 ** 
relevel(prior_offence, "N")TS70   17.6348  1445.3731   0.012 0.990265    
 [ reached getOption("max.print") -- omitted 1 row ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 208.231  on 211  degrees of freedom
Residual deviance:  64.237  on 201  degrees of freedom
  (38 observations deleted due to missingness)
AIC: 86.237

Number of Fisher Scoring iterations: 15

anova(m6)
[1] 164
Analysis of Deviance Table

Model: binomial, link: logit

Response: relevel(outcome, "warning")

Terms added sequentially (first to last)


                            Df Deviance Resid. Df Resid. Dev
NULL                                          211    208.231
scale(age)                   1   79.883       210    128.348
scale(speed)                 1   22.985       209    105.364
scale(bac)                   1   21.581       208     83.782
relevel(prior_offence, "N")  6   19.349       202     64.433
nighttime                    1    0.196       201     64.237
anova(m6, test = "Chisq")
[1] 165
Analysis of Deviance Table

Model: binomial, link: logit

Response: relevel(outcome, "warning")

Terms added sequentially (first to last)


                            Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                                          211    208.231              
scale(age)                   1   79.883       210    128.348 < 2.2e-16 ***
scale(speed)                 1   22.985       209    105.364 1.633e-06 ***
scale(bac)                   1   21.581       208     83.782 3.392e-06 ***
relevel(prior_offence, "N")  6   19.349       202     64.433  0.003613 ** 
nighttime                    1    0.196       201     64.237  0.658077    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
as.list(exp(coef(m6)))
[1] 166
$`(Intercept)`
[1] 157.0245

$`scale(age)`
[1] 0.1056625

$`scale(speed)`
[1] 11.89584

$`scale(bac)`
[1] 6.79098

$`relevel(prior_offence, "N")CD`
[1] 42.45643

$`relevel(prior_offence, "N")DR50`
[1] 7.950345

$`relevel(prior_offence, "N")DR80`
[1] 0.01024781

$`relevel(prior_offence, "N")PL10`
[1] 7.835111

$`relevel(prior_offence, "N")SP`
[1] 0.006158184

$`relevel(prior_offence, "N")TS70`
[1] 45573846

$nighttimenight
[1] 0.7176204

drinkdriving$offence_type <- drinkdriving$prior_offence
[1] 167
levels(drinkdriving$offence_type)
[1] 168
[1] "CD"   "DR50" "DR80" "N"    "PL10" "SP"   "TS70"
drinkdriving$offence_type[drinkdriving$offence_type == "N"] <- NA
[1] 169
drinkdriving$offence_type <- as.character(drinkdriving$offence_type)
[1] 170
drinkdriving$offence_type[drinkdriving$offence_type == "DR80" | 
    drinkdriving$offence_type == "CD" | drinkdriving$offence_type == 
    "PL10" | drinkdriving$offence_type == "SP" | drinkdriving$offence_type == 
    "TS70"] <- "Other"
[1] 171
drinkdriving$offence_type <- as.factor(drinkdriving$offence_type)
[1] 172
drinkdriving$offence_type <- droplevels(drinkdriving$offence_type)
[1] 173
levels(drinkdriving$offence_type)
[1] 174
[1] "DR50"  "Other"
summary(drinkdriving$offence_type)
[1] 175
 DR50 Other  NA's 
   44    17   189 
cont <- xtabs(~outcome + offence_type, drinkdriving)
[1] 176
cont <- addmargins(cont)
[1] 177
cont

         offence_type
outcome   DR50 Other Sum
  fine      40    12  52
  warning    4     5   9
  Sum       44    17  61


chisq.test(drinkdriving$outcome, drinkdriving$offence_type)
[1] 179

	Pearson's Chi-squared test with Yates' continuity correction

data:  drinkdriving$outcome and drinkdriving$offence_type
X-squared = 2.5724, df = 1, p-value = 0.1087

m7 <- glm(relevel(outcome, "warning") ~ offence_type, data = drinkdriving, 
    family = binomial)
[1] 180
summary(m7)
[1] 181

Call:
glm(formula = relevel(outcome, "warning") ~ offence_type, family = binomial, 
    data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1899   0.4366   0.4366   0.4366   0.8346  

Coefficients:
                  Estimate Std. Error z value Pr(>|z|)    
(Intercept)         2.3026     0.5244   4.391 1.13e-05 ***
offence_typeOther  -1.4271     0.7472  -1.910   0.0561 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 51.047  on 60  degrees of freedom
Residual deviance: 47.405  on 59  degrees of freedom
  (189 observations deleted due to missingness)
AIC: 51.405

Number of Fisher Scoring iterations: 5

anova(m7, test = "Chisq")
[1] 182
Analysis of Deviance Table

Model: binomial, link: logit

Response: relevel(outcome, "warning")

Terms added sequentially (first to last)


             Df Deviance Resid. Df Resid. Dev Pr(>Chi)  
NULL                            60     51.047           
offence_type  1   3.6421        59     47.405  0.05633 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
drinkdriving$offence_yn <- ifelse(drinkdriving$prior_offence == 
    "N", 0, 1)
[1] 183
table(drinkdriving$offence_yn)
[1] 184

  0   1 
185  61 
cont <- xtabs(~outcome + offence_yn, drinkdriving)
[1] 185
cont <- addmargins(cont)
[1] 186
cont

         offence_yn
outcome     0   1 Sum
  fine    148  52 200
  warning  37   9  46
  Sum     185  61 246


chisq.test(drinkdriving$outcome, drinkdriving$offence_yn)
[1] 188

	Pearson's Chi-squared test with Yates' continuity correction

data:  drinkdriving$outcome and drinkdriving$offence_yn
X-squared = 0.52118, df = 1, p-value = 0.4703

m8 <- glm(outcome ~ offence_yn, data = drinkdriving, family = binomial)
[1] 189
summary(m8)
[1] 190

Call:
glm(formula = outcome ~ offence_yn, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.6681  -0.6681  -0.6681  -0.5650   1.9564  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -1.3863     0.1838  -7.542 4.62e-14 ***
offence_yn   -0.3677     0.4051  -0.908    0.364    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 237.06  on 245  degrees of freedom
Residual deviance: 236.20  on 244  degrees of freedom
  (4 observations deleted due to missingness)
AIC: 240.2

Number of Fisher Scoring iterations: 4

anova(m8, test = "Chisq")
[1] 191
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


           Df Deviance Resid. Df Resid. Dev Pr(>Chi)
NULL                         245     237.06         
offence_yn  1  0.86504       244     236.20   0.3523
pred_fine <- with(drinkdriving, data.frame(age = c(14:90), prior_offence = "N", 
    nighttime = "day", speed = 30, bac = 0))
[1] 192
predict(m6, newdata = pred_fine, type = "response")
[1] 193
          1           2           3           4           5           6           7           8           9          10          11 
0.610661448 0.578365389 0.545384750 0.512001036 0.478509916 0.445210881 0.412396604 0.380342818 0.349299425 0.319483427 0.291074032 
         12          13          14          15          16          17          18          19          20          21          22 
0.264210069 0.238989626 0.215471621 0.193678930 0.173602611 0.155206779 0.138433725 0.123208953 0.109445882 0.097050045 0.085922703 
         23          24          25          26          27          28          29          30          31          32          33 
0.075963842 0.067074561 0.059158905 0.052125205 0.045886989 0.040363557 0.035480258 0.031168565 0.027365979 0.024015812 0.021066891 
         34          35          36          37          38          39          40          41          42          43          44 
0.018473217 0.016193584 0.014191195 0.012433279 0.010890717 0.009537687 0.008351335 0.007311459 0.006400228 0.005601924 0.004902701 
         45          46          47          48          49          50 
0.004290378 0.003754242 0.003284882 0.002874033 0.002514440 0.002199739 
 [ reached getOption("max.print") -- omitted 27 entries ]
pred_fine$model_prediction <- predict(m6, newdata = pred_fine, 
    type = "response")
[1] 194
pred_fine$model_prediction <- round(pred_fine$model_prediction, 
    2)
[1] 195
pred_fine

  age prior_offence nighttime speed bac model_prediction
1  14             N       day    30   0             0.61
2  15             N       day    30   0             0.58
3  16             N       day    30   0             0.55
4  17             N       day    30   0             0.51
5  18             N       day    30   0             0.48
6  19             N       day    30   0             0.45
7  20             N       day    30   0             0.41
8  21             N       day    30   0             0.38
 [ reached 'max' / getOption("max.print") -- omitted 69 rows ]


plot(pred_fine$model_prediction ~ pred_fine$age, xlab = "Age (years)", 
    ylab = "Probability", type = "l", lwd = 2)
[1] 197
drinkdriving <- merge(officer_inc, drinkdriving, all.x = T)
[1] 198
head(drinkdriving)
[1] 199
  incident_id officer age nighttime prior_offence speed   bac outcome offence_type offence_yn
1       inc_1      AS  39     night             N    48 0.177    fine         <NA>          0
2      inc_10      AS  60     night             N     3 0.244 warning         <NA>          0
3     inc_100      AS  68     night             N    26 0.105 warning         <NA>          0
4     inc_101      NP  35       day             N    44 0.086    fine         <NA>          0
5     inc_102      AS  47       day             N    37 0.208    fine         <NA>          0
 [ reached 'max' / getOption("max.print") -- omitted 1 rows ]
summary(drinkdriving)
[1] 200
  incident_id  officer         age        nighttime   prior_offence     speed            bac            outcome    offence_type
 inc_1  :  1   AS  :116   Min.   :14.00   day  : 78   N      :185   Min.   :  0.0   Min.   :0.0400   fine   :202   DR50 : 44   
 inc_10 :  1   IT  : 66   1st Qu.:30.00   night:169   DR50   : 44   1st Qu.: 31.0   1st Qu.:0.1925   warning: 48   Other: 17   
 inc_100:  1   NP  : 67   Median :40.00   NA's :  3   CD     :  5   Median : 41.0   Median :0.2350                 NA's :189   
 inc_101:  1   NA's:  1   Mean   :42.68               DR80   :  4   Mean   : 40.5   Mean   :0.2330                             
 inc_102:  1              3rd Qu.:55.00               SP     :  3   3rd Qu.: 49.0   3rd Qu.:0.2780                             
   offence_yn   
 Min.   :0.000  
 1st Qu.:0.000  
 Median :0.000  
 Mean   :0.248  
 3rd Qu.:0.000  
 [ reached getOption("max.print") -- omitted 2 rows ]
ggplot(drinkdriving, aes(factor(officer), age, fill = outcome)) + 
    geom_bar(stat = "identity", position = "dodge") + scale_fill_brewer(palette = "Set2")
[1] 201
ggplot(data = drinkdriving, aes(x = jitter(as.numeric(outcome)), 
    y = age, col = outcome), fill = officer) + geom_point() + 
    facet_grid(~officer) + theme_minimal()
[1] 202
jitter <- (ggplot(drinkdriving) + geom_point(aes(x = jitter(as.numeric(officer)), 
    y = age, colour = outcome)) + xlim(c("AS", "NP", "IT")) + 
    labs(x = "Officer Initials") + scale_y_continuous(name = "Age of Driver", 
    limits = c(10, 90), breaks = c(10, 30, 50, 70, 90)))
[1] 203
jitter + theme_minimal()
[1] 204
m9 <- glm(relevel(outcome, "warning") ~ age * officer, data = drinkdriving, 
    family = binomial, na.action = na.omit)
[1] 205
summary(m9)
[1] 206

Call:
glm(formula = relevel(outcome, "warning") ~ age * officer, family = binomial, 
    data = drinkdriving, na.action = na.omit)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.7179   0.0642   0.2741   0.5454   2.4089  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept)    9.56920    1.99554   4.795 1.62e-06 ***
age           -0.16122    0.03466  -4.652 3.29e-06 ***
officerIT     -5.04535    2.39610  -2.106   0.0352 *  
officerNP     -4.68465    2.48887  -1.882   0.0598 .  
age:officerIT  0.09612    0.04254   2.260   0.0238 *  
age:officerNP  0.09365    0.04405   2.126   0.0335 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 222.38  on 224  degrees of freedom
Residual deviance: 146.41  on 219  degrees of freedom
  (25 observations deleted due to missingness)
AIC: 158.41

Number of Fisher Scoring iterations: 7

anova(m9, test = "Chisq")
[1] 207
Analysis of Deviance Table

Model: binomial, link: logit

Response: relevel(outcome, "warning")

Terms added sequentially (first to last)


            Df Deviance Resid. Df Resid. Dev Pr(>Chi)    
NULL                          224     222.38             
age          1   67.728       223     154.65  < 2e-16 ***
officer      2    0.861       221     153.79  0.65013    
age:officer  2    7.383       219     146.41  0.02494 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
as.list(exp(coef(m9)))
[1] 208
$`(Intercept)`
[1] 14316.9

$age
[1] 0.8511019

$officerIT
[1] 0.006439183

$officerNP
[1] 0.009235935

$`age:officerIT`
[1] 1.100894

$`age:officerNP`
[1] 1.098178

pred_fine_AS <- with(drinkdriving, data.frame(age = c(14:90), 
    officer = "AS"))
[1] 209
predict(m9, newdata = pred_fine_AS, type = "response")
[1] 210
        1         2         3         4         5         6         7         8         9        10        11        12        13 
0.9993330 0.9992164 0.9990795 0.9989186 0.9987296 0.9985077 0.9982471 0.9979411 0.9975817 0.9971599 0.9966646 0.9960834 0.9954014 
       14        15        16        17        18        19        20        21        22        23        24        25        26 
0.9946012 0.9936627 0.9925622 0.9912724 0.9897611 0.9879913 0.9859200 0.9834974 0.9806662 0.9773604 0.9735046 0.9690129 0.9637881 
       27        28        29        30        31        32        33        34        35        36        37        38        39 
0.9577207 0.9506888 0.9425575 0.9331796 0.9223967 0.9100415 0.8959412 0.8799224 0.8618180 0.8414756 0.8187684 0.7936063 0.7659493 
       40        41        42        43        44        45        46        47        48        49        50 
0.7358200 0.7033145 0.6686107 0.6319717 0.5937432 0.5543440 0.5142498 0.4739713 0.4340288 0.3949252 0.3571216 
 [ reached getOption("max.print") -- omitted 27 entries ]
pred_fine_AS$model_prediction_AS <- predict(m9, newdata = pred_fine_AS, 
    type = "response")
[1] 211
pred_fine_AS$model_prediction_AS <- round(pred_fine_AS$model_prediction_AS, 
    2)
[1] 212
pred_fine_AS

   age officer model_prediction_AS
1   14      AS                1.00
2   15      AS                1.00
3   16      AS                1.00
4   17      AS                1.00
5   18      AS                1.00
6   19      AS                1.00
7   20      AS                1.00
8   21      AS                1.00
9   22      AS                1.00
10  23      AS                1.00
11  24      AS                1.00
12  25      AS                1.00
13  26      AS                1.00
14  27      AS                0.99
15  28      AS                0.99
16  29      AS                0.99
 [ reached 'max' / getOption("max.print") -- omitted 61 rows ]


plot(pred_fine_AS$model_prediction_AS ~ pred_fine_AS$age)
[1] 214
pred_fine_NP <- with(drinkdriving, data.frame(age = c(14:90), 
    officer = "NP"))
[1] 215
predict(m9, newdata = pred_fine_NP, type = "response")
[1] 216
        1         2         3         4         5         6         7         8         9        10        11        12        13 
0.9808957 0.9795874 0.9781916 0.9767025 0.9751144 0.9734210 0.9716157 0.9696916 0.9676415 0.9654575 0.9631318 0.9606559 0.9580210 
       14        15        16        17        18        19        20        21        22        23        24        25        26 
0.9552178 0.9522368 0.9490679 0.9457008 0.9421247 0.9383283 0.9343004 0.9300289 0.9255019 0.9207070 0.9156316 0.9102630 0.9045884 
       27        28        29        30        31        32        33        34        35        36        37        38        39 
0.8985949 0.8922697 0.8856003 0.8785741 0.8711792 0.8634039 0.8552373 0.8466692 0.8376902 0.8282921 0.8184677 0.8082113 0.7975188 
       40        41        42        43        44        45        46        47        48        49        50 
0.7863877 0.7748176 0.7628097 0.7503678 0.7374979 0.7242083 0.7105100 0.6964166 0.6819441 0.6671116 0.6519403 
 [ reached getOption("max.print") -- omitted 27 entries ]
pred_fine_NP$model_prediction_NP <- predict(m9, newdata = pred_fine_NP, 
    type = "response")
[1] 217
pred_fine_NP$model_prediction_NP <- round(pred_fine_NP$model_prediction_NP, 
    2)
[1] 218
pred_fine_NP

   age officer model_prediction_NP
1   14      NP                0.98
2   15      NP                0.98
3   16      NP                0.98
4   17      NP                0.98
5   18      NP                0.98
6   19      NP                0.97
7   20      NP                0.97
8   21      NP                0.97
9   22      NP                0.97
10  23      NP                0.97
11  24      NP                0.96
12  25      NP                0.96
13  26      NP                0.96
14  27      NP                0.96
15  28      NP                0.95
16  29      NP                0.95
 [ reached 'max' / getOption("max.print") -- omitted 61 rows ]


plot(pred_fine_NP$model_prediction_NP ~ pred_fine_NP$age)
[1] 220
pred_fine_IT <- with(drinkdriving, data.frame(age = c(14:90), 
    officer = "IT"))
[1] 221
predict(m9, newdata = pred_fine_IT, type = "response")
[1] 222
        1         2         3         4         5         6         7         8         9        10        11        12        13 
0.9737228 0.9720047 0.9701777 0.9682354 0.9661709 0.9639773 0.9616471 0.9591726 0.9565456 0.9537577 0.9508001 0.9476638 0.9443393 
       14        15        16        17        18        19        20        21        22        23        24        25        26 
0.9408167 0.9370861 0.9331371 0.9289589 0.9245408 0.9198716 0.9149401 0.9097348 0.9042443 0.8984572 0.8923619 0.8859472 0.8792020 
       27        28        29        30        31        32        33        34        35        36        37        38        39 
0.8721154 0.8646771 0.8568772 0.8487063 0.8401560 0.8312185 0.8218873 0.8121567 0.8020227 0.7914822 0.7805341 0.7691789 0.7574187 
       40        41        42        43        44        45        46        47        48        49        50 
0.7452578 0.7327024 0.7197609 0.7064438 0.6927640 0.6787367 0.6643792 0.6497111 0.6347545 0.6195332 0.6040732 
 [ reached getOption("max.print") -- omitted 27 entries ]
pred_fine_IT$model_prediction_IT <- predict(m9, newdata = pred_fine_IT, 
    type = "response")
[1] 223
pred_fine_IT$model_prediction_IT <- round(pred_fine_IT$model_prediction_IT, 
    2)
[1] 224
pred_fine_IT

   age officer model_prediction_IT
1   14      IT                0.97
2   15      IT                0.97
3   16      IT                0.97
4   17      IT                0.97
5   18      IT                0.97
6   19      IT                0.96
7   20      IT                0.96
8   21      IT                0.96
9   22      IT                0.96
10  23      IT                0.95
11  24      IT                0.95
12  25      IT                0.95
13  26      IT                0.94
14  27      IT                0.94
15  28      IT                0.94
16  29      IT                0.93
 [ reached 'max' / getOption("max.print") -- omitted 61 rows ]


plot(pred_fine_IT$model_prediction_IT ~ pred_fine_IT$age)
[1] 226
par(mfrow = c(1, 3))
[1] 227
$mfrow
[1] 1 1

plot(pred_fine_AS$model_prediction_AS ~ pred_fine_AS$age, main = "Probability of Fine from Officer AS", 
    xlab = "Age", ylab = "Probability", col = "seagreen1", type = "l", 
    lwd = 2)
[1] 228
plot(pred_fine_NP$model_prediction_NP ~ pred_fine_NP$age, main = "Probability of Fine from Officer NP", 
    xlab = "Age", ylab = "Probability", col = "darkturquoise", 
    type = "l", lwd = 2)
[1] 229
plot(pred_fine_IT$model_prediction_IT ~ pred_fine_IT$age, main = "Probability of Fine from Officer IT", 
    xlab = "Age", ylab = "Probability", col = "firebrick1", type = "l", 
    lwd = 2)
[1] 230
par(mfrow = c(1, 1))
[1] 231
$mfrow
[1] 1 3

pred_bias_all <- data.frame(age = c(14:90))
[1] 232
pred_bias_all$Pred_AS <- pred_fine_AS$model_prediction_AS
[1] 233
pred_bias_all$Pred_NP <- pred_fine_IT$model_prediction_IT
[1] 234
pred_bias_all$Pred_IT <- pred_fine_NP$model_prediction_NP
[1] 235
pred_bias_all <- pred_bias_all %>% pivot_longer(-age, names_to = "officer")
[1] 236
combined_plot <- ggplot(pred_bias_all) + geom_point(aes(x = age, 
    y = value, colour = officer))
[1] 237
combined_plot + theme_minimal()
[1] 238
