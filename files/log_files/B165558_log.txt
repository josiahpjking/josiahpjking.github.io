

	####### B165558 R script #######

library(ggplot2, quietly = T)
[1] 1
[1] "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(psych, quietly = T)
[1] 2
 [1] "psych"     "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
load(url("https://edin.ac/2QCZNVu"))
[1] 3
[1] "drinkdriving" "officer_inc" 
head(drinkdriving)
[1] 4
# A tibble: 6 x 7
    age nighttime prior_offence speed   bac outcome incident_id
  <dbl> <chr>     <chr>         <dbl> <dbl> <chr>   <chr>      
1    39 night     N             48.0   17.7 fine    inc_1      
2    28 day       N             43.8   22.1 fine    inc_2      
3    38 night     DR50          47.3   32.8 fine    inc_3      
4    51 night     N             17.2   20.5 warning inc_4      
5    56 night     N              1.95  29.4 warning inc_5      
6    36 day       N             41.4   19.1 fine    inc_6      
describe(drinkdriving)
[1] 5
               vars   n mean    sd median trimmed   mad min  max range skew kurtosis   se
age               1 228   46 33.35   40.5   42.34 18.53  14  297   283  5.5    38.49 2.21
nighttime*        2 250  NaN    NA     NA     NaN    NA Inf -Inf  -Inf   NA       NA   NA
prior_offence*    3 250  NaN    NA     NA     NaN    NA Inf -Inf  -Inf   NA       NA   NA
 [ reached 'max' / getOption("max.print") -- omitted 4 rows ]
drinkdriving$nighttime <- as.factor(drinkdriving$nighttime)
[1] 6
drinkdriving$outcome <- as.factor(drinkdriving$outcome)
[1] 7
drinkdriving <- na.omit(drinkdriving)
[1] 8
drinkdriving <- subset(drinkdriving, drinkdriving$age < 100)
[1] 9
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 10
summary(m1)
[1] 11

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.719  -4.516  -0.861   3.849  42.785 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 29.29455    1.25564  23.330  < 2e-16 ***
age         -0.14353    0.02741  -5.236 3.86e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.82 on 218 degrees of freedom
Multiple R-squared:  0.1117,	Adjusted R-squared:  0.1076 
F-statistic: 27.41 on 1 and 218 DF,  p-value: 3.863e-07

m1$coefficients[1] + m1$coefficients[2] * 50
[1] 12
(Intercept) 
   22.11824 
par(mfrow = c(2, 2))
[1] 13
$mfrow
[1] 1 1

plot(m1)
[1] 14
drinkdriving[drinkdriving$nighttime == "2:05", ]$nighttime = "night"
[1] 15
m2 <- lm(bac ~ age + nighttime + speed, data = drinkdriving)
[1] 16
summary(m2)
[1] 17

Call:
lm(formula = bac ~ age + nighttime + speed, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-13.291  -4.650   0.136   3.971  33.088 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    14.15205    2.74426   5.157 5.67e-07 ***
age            -0.03148    0.03233  -0.974    0.331    
nighttimenight  3.84615    0.90937   4.229 3.46e-05 ***
speed           0.19824    0.03853   5.145 6.00e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.258 on 216 degrees of freedom
Multiple R-squared:  0.2587,	Adjusted R-squared:  0.2484 
F-statistic: 25.13 on 3 and 216 DF,  p-value: 5.5e-14

0.03233^2
[1] 18
[1] 0.001045229
0.03853^2
[1] 19
[1] 0.001484561
0.90937^2
[1] 20
[1] 0.8269538
day <- subset(drinkdriving, drinkdriving$nighttime == "day")
[1] 21
night <- subset(drinkdriving, drinkdriving$nighttime == "night")
[1] 22
boxplot(day$speed, night$speed, main = "Boxplot for speed by nighttime", 
    xlab = "nighttime", ylab = "speed")
[1] 23
mean(day$speed)
[1] 24
[1] 38.62555
mean(night$speed)
[1] 25
[1] 39.27218
summary(drinkdriving$outcome)
[1] 26
   fine    Fine    FINE warning Warning WARNING 
    166       2       9      39       1       3 
drinkdriving$outcome <- tolower(drinkdriving$outcome)
[1] 27
drinkdriving$outcome = as.numeric(as.factor(drinkdriving$outcome)) - 
    1
[1] 28
m3 = lm(outcome ~ age + nighttime + speed + bac, data = drinkdriving)
[1] 29
summary(m3)
[1] 30

Call:
lm(formula = outcome ~ age + nighttime + speed + bac, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.63949 -0.21972 -0.08248  0.13496  1.04796 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.362239   0.148803   2.434  0.01573 *  
age             0.007683   0.001658   4.635  6.2e-06 ***
nighttimenight -0.026322   0.048416  -0.544  0.58724    
speed          -0.006661   0.002089  -3.189  0.00164 ** 
bac            -0.009322   0.003481  -2.678  0.00798 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.3202 on 215 degrees of freedom
Multiple R-squared:  0.3628,	Adjusted R-squared:  0.3509 
F-statistic:  30.6 on 4 and 215 DF,  p-value: < 2.2e-16

m3$coefficients[4] * sd(drinkdriving$speed)
[1] 31
      speed 
-0.09367661 
m3$coefficients[5] * sd(drinkdriving$bac)
[1] 32
        bac 
-0.06729914 
noffence = drinkdriving[drinkdriving$prior_offence == "N", ]
[1] 33
offence = drinkdriving[drinkdriving$prior_offence != "N", ]
[1] 34
table(noffence$outcome)[1]/(table(noffence$outcome)[1] + table(noffence$outcome)[2])
[1] 35
        0 
0.7950311 
table(offence$outcome)[1]/(table(offence$outcome)[1] + table(offence$outcome)[2])
[1] 36
        0 
0.8305085 
drinkdriving$outcome = 1 - drinkdriving$outcome
[1] 37
m4 = lm(outcome ~ age + nighttime + speed + bac, data = noffence)
[1] 38
age = unique(noffence$age)
[1] 39
pd = m4$coefficients[1] + m4$coefficients[2] * age + m4$coefficients[4] * 
    30 + m4$coefficients[5] * mean(noffence$bac)
[1] 40
plot(age, pd, ylab = "predicted value")
[1] 41
load(url("https://edin.ac/2QCZNVu"))
[1] 42
[1] "drinkdriving" "officer_inc" 
all = merge(drinkdriving, officer_inc)
[1] 43
all$outcome = 2 - as.numeric(as.factor(tolower(all$outcome)))
[1] 44
m_all = lm(outcome ~ age, data = all)
[1] 45
summary(m_all)
[1] 46

Call:
lm(formula = outcome ~ age, data = all)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.94812  0.06152  0.14002  0.20061  0.58872 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  1.0472692  0.0409285  25.588  < 2e-16 ***
age         -0.0055084  0.0007208  -7.642 6.06e-13 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.3622 on 226 degrees of freedom
  (22 observations deleted due to missingness)
Multiple R-squared:  0.2053,	Adjusted R-squared:  0.2018 
F-statistic: 58.39 on 1 and 226 DF,  p-value: 6.059e-13

as = all[all$officer == "AS", ]
[1] 47
it = all[all$officer == "IT", ]
[1] 48
np = all[all$officer == "NP", ]
[1] 49
m_as = lm(outcome ~ age, data = as)
[1] 50
m_it = lm(outcome ~ age, data = it)
[1] 51
m_np = lm(outcome ~ age, data = np)
[1] 52
