

	####### B163317 R script #######

library(plyr, quietly = T)
[1] 1
[1] "plyr"      "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(tidyverse, quietly = T)
[1] 2
 [1] "forcats"   "stringr"   "dplyr"     "purrr"     "tidyr"     "tibble"    "ggplot2"   "tidyverse" "plyr"      "readr"    
[11] "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 3
 [1] "car"       "carData"   "forcats"   "stringr"   "dplyr"     "purrr"     "tidyr"     "tibble"    "ggplot2"   "tidyverse"
[11] "plyr"      "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
load(url("https://edin.ac/2QCZNVu"))
[1] 4
[1] "drinkdriving" "officer_inc" 
summary(drinkdriving)
[1] 5
      age          nighttime         prior_offence          speed             bac           outcome          incident_id       
 Min.   : 14.00   Length:250         Length:250         Min.   :  0.00   Min.   : 3.987   Length:250         Length:250        
 1st Qu.: 30.00   Class :character   Class :character   1st Qu.: 30.92   1st Qu.:19.264   Class :character   Class :character  
 Median : 40.50   Mode  :character   Mode  :character   Median : 40.64   Median :23.609   Mode  :character   Mode  :character  
 Mean   : 46.00                                         Mean   : 40.49   Mean   :23.605                                        
 3rd Qu.: 55.25                                         3rd Qu.: 48.84   3rd Qu.:27.898                                        
 Max.   :297.00                                         Max.   :120.34   Max.   :65.764                                        
 NA's   :22                                                              NA's   :5                                             
drinkdriving$nighttime <- factor(drinkdriving$nighttime)
[1] 6
drinkdriving$prior_offence <- factor(drinkdriving$prior_offence)
[1] 7
drinkdriving$outcome <- factor(drinkdriving$outcome)
[1] 8
drinkdriving$incident_id <- factor(drinkdriving$incident_id)
[1] 9
outliers <- function(obs, x = 2.5) {
    return(abs(obs - mean(obs, na.rm = T)) > (sd(obs, na.rm = T) * 
        x))
}
[1] 10
which(outliers(drinkdriving$age))
[1] 11
[1]  51 114 224
boxplot(drinkdriving$age)
[1] 12
drinkdriving$age[drinkdriving$age > 80] <- NA
[1] 13
drinkdriving$age[drinkdriving$age < 17] <- NA
[1] 14
drinkdriving$speed <- round(drinkdriving$speed)
[1] 15
which(outliers(drinkdriving$speed))
[1] 16
[1]   5   7  10 110 154 161
boxplot(drinkdriving$speed)
[1] 17
drinkdriving$speed[drinkdriving$speed > 70] <- NA
[1] 18
drinkdriving$speed[drinkdriving$speed < 10] <- NA
[1] 19
drinkdriving$bac <- round(drinkdriving$bac)
[1] 20
which(outliers(drinkdriving$bac))
[1] 21
[1]  51 110 154
boxplot(drinkdriving$bac)
[1] 22
drinkdriving$bac[drinkdriving$bac > 40] <- NA
[1] 23
drinkdriving$bac[drinkdriving$bac < 6] <- NA
[1] 24
levels(drinkdriving$nighttime)
[1] 25
[1] "18:25" "2:05"  "day"   "night"
drinkdriving$nighttime[drinkdriving$nighttime == "18:25"] <- "night"
[1] 26
drinkdriving$nighttime[drinkdriving$nighttime == "2:05"] <- NA
[1] 27
drinkdriving$nighttime <- droplevels(drinkdriving$nighttime)
[1] 28
levels(drinkdriving$nighttime)
[1] 29
[1] "day"   "night"
levels(drinkdriving$prior_offence)
[1] 30
 [1] "CD10"           "CD60"           "CD60,CD10,DR80" "CD60,CD60"      "DD20"           "DR50"           "DR80"          
 [8] "N"              "PL10"           "SP50"           "SP60"           "TS70"           "TS70,DR50"     
drinkdriving$prior_offence <- revalue(drinkdriving$prior_offence, 
    c(CD10 = "CD", CD60 = "CD", `CD60,CD10,DR80` = NA, `CD60,CD60` = "CD", 
        DD20 = NA, DR50 = "DR50", DR80 = "DR80", N = "N", PL10 = "PL", 
        SP50 = "SP", SP60 = "SP", TS70 = "TS", `TS70,DR50` = NA))
[1] 31
levels(drinkdriving$prior_offence)
[1] 32
[1] "CD"   "DR50" "DR80" "N"    "PL"   "SP"   "TS"  
levels(drinkdriving$outcome)
[1] 33
[1] "fine"    "Fine"    "FINE"    "warning" "Warning" "WARNING"
drinkdriving$outcome[drinkdriving$outcome == "Fine"] <- "fine"
[1] 34
drinkdriving$outcome[drinkdriving$outcome == "FINE"] <- "fine"
[1] 35
drinkdriving$outcome[drinkdriving$outcome == "WARNING"] <- "warning"
[1] 36
drinkdriving$outcome[drinkdriving$outcome == "Warning"] <- "warning"
[1] 37
drinkdriving$outcome <- droplevels(drinkdriving$outcome)
[1] 38
levels(drinkdriving$outcome)
[1] 39
[1] "fine"    "warning"
drinkdriving <- merge(drinkdriving, officer_inc, all = T)
[1] 40
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 41
summary(m1)
[1] 42

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-14.6665  -3.9987  -0.7778   3.9979  14.2289 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 27.56194    1.17586  23.440  < 2e-16 ***
age         -0.11130    0.02586  -4.304 2.61e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.654 on 203 degrees of freedom
  (45 observations deleted due to missingness)
Multiple R-squared:  0.08362,	Adjusted R-squared:  0.0791 
F-statistic: 18.52 on 1 and 203 DF,  p-value: 2.61e-05

coef(lm(bac ~ age, data = drinkdriving))
[1] 43
(Intercept)         age 
 27.5619449  -0.1112983 
ggplot(drinkdriving, aes(x = age, y = bac)) + geom_point() + 
    theme_minimal() + theme(plot.title = element_text(face = "bold", 
    hjust = 0.5)) + labs(title = "Relationship Between Age and Blood Alcohol Content", 
    x = "Age", y = "BAC" + geom_smooth(method = lm, se = TRUE)) + 
    geom_abline(intercept = 27.98, slope = -0.122, col = "#D35400")
[1] 44
plot(m1, which = c(1:4))
[1] 45
predict(m1, data.frame(age = 50))
[1] 46
       1 
21.99703 
plot(m1, which = c(2))
[1] 47
model_2 <- lm(bac ~ age + speed, data = drinkdriving)
[1] 48
anova(model_2)
[1] 49
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1  626.5  626.49 19.5690 1.596e-05 ***
speed       1   42.3   42.30  1.3212    0.2518    
Residuals 199 6370.8   32.01                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(model_2)
[1] 50

Call:
lm(formula = bac ~ age + speed, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-14.7124  -3.4861  -0.8968   3.6515  13.8274 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 24.47612    3.01303   8.123  4.7e-14 ***
age         -0.09025    0.03391  -2.662  0.00841 ** 
speed        0.05443    0.04736   1.149  0.25175    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.658 on 199 degrees of freedom
  (48 observations deleted due to missingness)
Multiple R-squared:  0.095,	Adjusted R-squared:  0.08591 
F-statistic: 10.45 on 2 and 199 DF,  p-value: 4.857e-05

model_3 <- lm(bac ~ age + nighttime, data = drinkdriving)
[1] 51
anova(model_3)
[1] 52
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1  701.9  701.95  25.010 1.245e-06 ***
nighttime   1  606.8  606.75  21.618 6.036e-06 ***
Residuals 200 5613.4   28.07                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(model_3)
[1] 53

Call:
lm(formula = bac ~ age + nighttime, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-12.1329  -4.4344   0.2976   3.5241  13.8110 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    25.13513    1.27277  19.748  < 2e-16 ***
age            -0.11435    0.02457  -4.655 5.90e-06 ***
nighttimenight  3.71516    0.79904   4.650 6.04e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.298 on 200 degrees of freedom
  (47 observations deleted due to missingness)
Multiple R-squared:  0.1891,	Adjusted R-squared:  0.181 
F-statistic: 23.31 on 2 and 200 DF,  p-value: 7.922e-10

model_total <- lm(bac ~ age + nighttime + speed, data = drinkdriving)
[1] 54
anova(model_total)
[1] 55
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1  741.1  741.06 26.2275 7.229e-07 ***
nighttime   1  575.3  575.33 20.3620 1.104e-05 ***
speed       1   25.5   25.47  0.9015    0.3436    
Residuals 196 5538.0   28.26                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(model_total)
[1] 56

Call:
lm(formula = bac ~ age + nighttime + speed, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-12.2534  -4.4961   0.4293   3.4708  13.7112 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    22.80611    2.90202   7.859 2.52e-13 ***
age            -0.09800    0.03226  -3.038  0.00271 ** 
nighttimenight  3.60130    0.80591   4.469 1.33e-05 ***
speed           0.04266    0.04493   0.949  0.34355    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.316 on 196 degrees of freedom
  (50 observations deleted due to missingness)
Multiple R-squared:  0.195,	Adjusted R-squared:  0.1827 
F-statistic: 15.83 on 3 and 196 DF,  p-value: 2.947e-09

model_total <- lm(bac ~ age + nighttime + speed, data = drinkdriving)
[1] 57
summary(model_total)
[1] 58

Call:
lm(formula = bac ~ age + nighttime + speed, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-12.2534  -4.4961   0.4293   3.4708  13.7112 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    22.80611    2.90202   7.859 2.52e-13 ***
age            -0.09800    0.03226  -3.038  0.00271 ** 
nighttimenight  3.60130    0.80591   4.469 1.33e-05 ***
speed           0.04266    0.04493   0.949  0.34355    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.316 on 196 degrees of freedom
  (50 observations deleted due to missingness)
Multiple R-squared:  0.195,	Adjusted R-squared:  0.1827 
F-statistic: 15.83 on 3 and 196 DF,  p-value: 2.947e-09

vif(model_total)
[1] 59
      age nighttime     speed 
 1.699320  1.008540  1.700081 
par(mfrow = c(2, 2))
[1] 60
$mfrow
[1] 2 2

plot(model_total, which = c(1:4))
[1] 61
t.test(drinkdriving$speed ~ drinkdriving$nighttime, alternative = "greater")
[1] 62

	Welch Two Sample t-test

data:  drinkdriving$speed by drinkdriving$nighttime
t = -1.7213, df = 174.16, p-value = 0.9565
alternative hypothesis: true difference in means is greater than 0
95 percent confidence interval:
 -5.481685       Inf
sample estimates:
  mean in group day mean in group night 
           38.25974            41.05556 

drinkdriving %>% ggplot(aes(x = nighttime, y = speed, colour = nighttime, 
    fill = nighttime)) + geom_bar(position = "dodge", stat = "identity") + 
    geom_smooth(method = "lm", formula = y ~ x) + theme_minimal() + 
    theme(plot.title = element_text(face = "bold", hjust = 0.5)) + 
    scale_color_manual(values = c("#73C6B6", "#CB4335"), aesthetics = c("colour", 
        "fill")) + labs(title = "Relationship Speed - Time", 
    x = "Time", y = "Speed", colour = "Time", fill = "Time")
[1] 63
model_4 <- glm(outcome ~ age + nighttime + prior_offence + speed + 
    bac, data = drinkdriving, family = binomial)
[1] 64
summary(model_4)
[1] 65

Call:
glm(formula = outcome ~ age + nighttime + prior_offence + speed + 
    bac, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.8108  -0.2249  -0.0537  -0.0059   4.3066  

Coefficients:
                    Estimate Std. Error z value Pr(>|z|)    
(Intercept)         -2.42318    3.62250  -0.669 0.503543    
age                  0.14231    0.03842   3.704 0.000212 ***
nighttimenight       0.40565    0.75368   0.538 0.590423    
prior_offenceDR50    1.27038    2.19892   0.578 0.563448    
prior_offenceDR80    8.35576    2.96734   2.816 0.004864 ** 
prior_offenceN       3.71532    1.92691   1.928 0.053839 .  
prior_offencePL     -6.44855 2399.54607  -0.003 0.997856    
prior_offenceSP      8.82302    2.91144   3.030 0.002442 ** 
prior_offenceTS     -9.03978 2399.54578  -0.004 0.996994    
speed               -0.13442    0.05117  -2.627 0.008615 ** 
 [ reached getOption("max.print") -- omitted 1 row ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 180.85  on 195  degrees of freedom
Residual deviance:  62.44  on 185  degrees of freedom
  (54 observations deleted due to missingness)
AIC: 84.44

Number of Fisher Scoring iterations: 15

model_5 <- glm(outcome ~ bac + age + speed + nighttime + prior_offence, 
    data = drinkdriving, family = binomial)
[1] 66
summary(model_5)
[1] 67

Call:
glm(formula = outcome ~ bac + age + speed + nighttime + prior_offence, 
    family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.8108  -0.2249  -0.0537  -0.0059   4.3066  

Coefficients:
                    Estimate Std. Error z value Pr(>|z|)    
(Intercept)         -2.42318    3.62250  -0.669 0.503543    
bac                 -0.29366    0.07755  -3.786 0.000153 ***
age                  0.14231    0.03842   3.704 0.000212 ***
speed               -0.13442    0.05117  -2.627 0.008615 ** 
nighttimenight       0.40565    0.75368   0.538 0.590423    
prior_offenceDR50    1.27038    2.19892   0.578 0.563448    
prior_offenceDR80    8.35576    2.96734   2.816 0.004864 ** 
prior_offenceN       3.71532    1.92691   1.928 0.053839 .  
prior_offencePL     -6.44855 2399.54607  -0.003 0.997856    
prior_offenceSP      8.82302    2.91144   3.030 0.002442 ** 
 [ reached getOption("max.print") -- omitted 1 row ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 180.85  on 195  degrees of freedom
Residual deviance:  62.44  on 185  degrees of freedom
  (54 observations deleted due to missingness)
AIC: 84.44

Number of Fisher Scoring iterations: 15

anova(model_5, test = "Chisq")
[1] 68
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


              Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                            195    180.847              
bac            1   39.021       194    141.826 4.192e-10 ***
age            1   47.516       193     94.310 5.455e-12 ***
speed          1   13.341       192     80.969 0.0002597 ***
nighttime      1    0.000       191     80.969 0.9950033    
prior_offence  6   18.529       185     62.440 0.0050382 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
scaled_model_speed <- glm(outcome ~ scale(speed), data = drinkdriving, 
    family = binomial)
[1] 69
anova(scaled_model_speed, test = "Chisq")
[1] 70
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


             Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                           240     229.08              
scale(speed)  1    76.23       239     152.85 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(scaled_model_speed)
[1] 71

Call:
glm(formula = outcome ~ scale(speed), family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.8119  -0.5273  -0.2652  -0.0954   3.4719  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept)   -2.4134     0.3027  -7.973 1.55e-15 ***
scale(speed)  -1.9816     0.3042  -6.514 7.32e-11 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 229.08  on 240  degrees of freedom
Residual deviance: 152.85  on 239  degrees of freedom
  (9 observations deleted due to missingness)
AIC: 156.85

Number of Fisher Scoring iterations: 6

scaled_model_bac <- glm(outcome ~ scale(bac), data = drinkdriving, 
    family = binomial)
[1] 72
anova(scaled_model_bac, test = "Chisq")
[1] 73
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


           Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                         240     232.05              
scale(bac)  1   46.637       239     185.41 8.544e-12 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(scaled_model_bac)
[1] 74

Call:
glm(formula = outcome ~ scale(bac), family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.6096  -0.6597  -0.4148  -0.2099   2.9710  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -1.8959     0.2229  -8.506  < 2e-16 ***
scale(bac)   -1.2848     0.2210  -5.814  6.1e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 232.05  on 240  degrees of freedom
Residual deviance: 185.41  on 239  degrees of freedom
  (9 observations deleted due to missingness)
AIC: 189.41

Number of Fisher Scoring iterations: 5

drinkdriving$new <- rep(drinkdriving$prior_offence)
[1] 75
drinkdriving$new <- as.character(drinkdriving$new)
[1] 76
drinkdriving$new[which(drinkdriving$new == "N")] <- NA
[1] 77
drinkdriving$new[which(drinkdriving$new != "DR50")] <- "Non"
[1] 78
drinkdriving$new <- as.factor(drinkdriving$new)
[1] 79
drinkdriving$newoutcome <- ifelse(drinkdriving$outcome == "fine", 
    1, 0)
[1] 80
model_drink_offence <- glm(newoutcome ~ relevel(new, "Non"), 
    data = drinkdriving, family = binomial)
[1] 81
summary(model_drink_offence)
[1] 82

Call:
glm(formula = newoutcome ~ relevel(new, "Non"), family = binomial, 
    data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.3076   0.3803   0.3803   0.3803   0.8657  

Coefficients:
                        Estimate Std. Error z value Pr(>|z|)  
(Intercept)               0.7885     0.5394   1.462   0.1438  
relevel(new, "Non")DR50   1.8018     0.8058   2.236   0.0253 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 46.832  on 58  degrees of freedom
Residual deviance: 41.636  on 57  degrees of freedom
  (191 observations deleted due to missingness)
AIC: 45.636

Number of Fisher Scoring iterations: 5

anova(model_drink_offence, test = "Chisq")
[1] 83
Analysis of Deviance Table

Model: binomial, link: logit

Response: newoutcome

Terms added sequentially (first to last)


                    Df Deviance Resid. Df Resid. Dev Pr(>Chi)  
NULL                                   58     46.832           
relevel(new, "Non")  1   5.1962        57     41.636  0.02264 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
drinkdriving$noffence <- ifelse(drinkdriving$prior_offence == 
    "N", 0, 1)
[1] 84
drinkdriving$noffence <- as.factor(drinkdriving$noffence)
[1] 85
model_no_ffence <- glm(newoutcome ~ noffence, data = drinkdriving, 
    family = binomial)
[1] 86
summary(model_no_ffence)
[1] 87

Call:
glm(formula = newoutcome ~ noffence, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.9990   0.5398   0.6681   0.6681   0.6681  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)   1.3863     0.1838   7.542 4.62e-14 ***
noffence1     0.4661     0.4224   1.104     0.27    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 233.28  on 243  degrees of freedom
Residual deviance: 231.98  on 242  degrees of freedom
  (6 observations deleted due to missingness)
AIC: 235.98

Number of Fisher Scoring iterations: 4

anova(model_no_ffence, test = "Chisq")
[1] 88
Analysis of Deviance Table

Model: binomial, link: logit

Response: newoutcome

Terms added sequentially (first to last)


         Df Deviance Resid. Df Resid. Dev Pr(>Chi)
NULL                       243     233.28         
noffence  1   1.3021       242     231.98   0.2538
age <- sort(unique(drinkdriving$age))
[1] 89
df <- data.frame(age, nighttime = c("day"), prior_offence = c("N"), 
    speed = c(30), bac = c(0))
[1] 90
df$nighttime <- as.factor(df$nighttime)
[1] 91
df$model_prediction <- predict(model_4, newdata = df, type = "response")
[1] 92
ggplot(df, aes(x = age, y = model_prediction)) + geom_line(position = "dodge", 
    stat = "identity", size = 1, colour = "#2471A3") + theme_minimal() + 
    theme(plot.title = element_text(face = "bold")) + scale_y_continuous(breaks = c(0.4, 
    1), labels = c("Fine", "Warning")) + labs(title = "Predicted Probabilities of Receiving Fine for Different Ages", 
    x = "Age", y = "Outcome", subtitle = "Drivers who were stopped during the daytime, 30 mph with 0 BAC and no prior offence")
[1] 93
biased_police <- glm(newoutcome ~ officer * age, data = drinkdriving, 
    family = binomial)
[1] 94
summary(biased_police)
[1] 95

Call:
glm(formula = newoutcome ~ officer * age, family = binomial, 
    data = drinkdriving)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.71789   0.07704   0.29666   0.54731   2.39603  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept)    9.49441    2.00977   4.724 2.31e-06 ***
officerIT     -4.32011    2.63213  -1.641   0.1007    
officerNP     -4.60987    2.50030  -1.844   0.0652 .  
age           -0.15983    0.03500  -4.567 4.95e-06 ***
officerIT:age  0.08036    0.04778   1.682   0.0926 .  
officerNP:age  0.09225    0.04432   2.082   0.0374 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 208.66  on 212  degrees of freedom
Residual deviance: 142.61  on 207  degrees of freedom
  (37 observations deleted due to missingness)
AIC: 154.61

Number of Fisher Scoring iterations: 6

coef(biased_police)
[1] 96
  (Intercept)     officerIT     officerNP           age officerIT:age officerNP:age 
   9.49441354   -4.32011494   -4.60987105   -0.15982531    0.08035743    0.09225446 
anova(biased_police, test = "Chisq")
[1] 97
Analysis of Deviance Table

Model: binomial, link: logit

Response: newoutcome

Terms added sequentially (first to last)


            Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                          212     208.66              
officer      2    0.303       210     208.36   0.85949    
age          1   60.253       209     148.10 8.342e-15 ***
officer:age  2    5.493       207     142.61   0.06416 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
biased_police_2 <- glm(newoutcome ~ age * relevel(officer, "NP"), 
    data = drinkdriving, family = binomial)
[1] 98
summary(biased_police_2)
[1] 99

Call:
glm(formula = newoutcome ~ age * relevel(officer, "NP"), family = binomial, 
    data = drinkdriving)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.71789   0.07704   0.29666   0.54731   2.39603  

Coefficients:
                             Estimate Std. Error z value Pr(>|z|)   
(Intercept)                   4.88454    1.48738   3.284  0.00102 **
age                          -0.06757    0.02719  -2.485  0.01296 * 
relevel(officer, "NP")AS      4.60987    2.50030   1.844  0.06522 . 
relevel(officer, "NP")IT      0.28976    2.25858   0.128  0.89792   
age:relevel(officer, "NP")AS -0.09225    0.04432  -2.082  0.03738 * 
age:relevel(officer, "NP")IT -0.01190    0.04240  -0.281  0.77905   
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 208.66  on 212  degrees of freedom
Residual deviance: 142.61  on 207  degrees of freedom
  (37 observations deleted due to missingness)
AIC: 154.61

Number of Fisher Scoring iterations: 6

coef(biased_police_2)
[1] 100
                 (Intercept)                          age     relevel(officer, "NP")AS     relevel(officer, "NP")IT 
                  4.88454249                  -0.06757085                   4.60987105                   0.28975611 
age:relevel(officer, "NP")AS age:relevel(officer, "NP")IT 
                 -0.09225446                  -0.01189703 
anova(biased_police_2, test = "Chisq")
[1] 101
Analysis of Deviance Table

Model: binomial, link: logit

Response: newoutcome

Terms added sequentially (first to last)


                           Df Deviance Resid. Df Resid. Dev Pr(>Chi)    
NULL                                         212     208.66             
age                         1   59.604       211     149.06 1.16e-14 ***
relevel(officer, "NP")      2    0.951       209     148.10  0.62152    
age:relevel(officer, "NP")  2    5.493       207     142.61  0.06416 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
drinkdriving %>% ggplot(aes(x = officer, y = age, colour = outcome, 
    fill = outcome)) + geom_point(position = "dodge", stat = "identity") + 
    geom_smooth(method = "glm", formula = outcome ~ age) + theme_minimal() + 
    theme(plot.title = element_text(face = "bold")) + scale_color_manual(values = c("#F1C40F", 
    "#D35400"), aesthetics = c("colour", "fill")) + labs(title = "Age-Related Bias", 
    x = "Officer", y = "Age", subtitle = "Distribution of Penalties by Officers", 
    colour = "Outcome", fill = "Outcome")
[1] 102
