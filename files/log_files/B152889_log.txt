

	####### B152889 R script #######

library(ggplot2, quietly = T)
[1] 1
[1] "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 2
 [1] "car"       "carData"   "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
library(lmtest, quietly = T)
[1] 3
 [1] "lmtest"    "zoo"       "car"       "carData"   "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"    
[11] "datasets"  "methods"   "base"     
load(url("https://edin.ac/2QCZNVu"))
[1] 4
[1] "drinkdriving" "officer_inc" 
summary(drinkdriving)
[1] 5
      age          nighttime         prior_offence          speed             bac           outcome          incident_id       
 Min.   : 14.00   Length:250         Length:250         Min.   :  0.00   Min.   : 3.987   Length:250         Length:250        
 1st Qu.: 30.00   Class :character   Class :character   1st Qu.: 30.92   1st Qu.:19.264   Class :character   Class :character  
 Median : 40.50   Mode  :character   Mode  :character   Median : 40.64   Median :23.609   Mode  :character   Mode  :character  
 Mean   : 46.00                                         Mean   : 40.49   Mean   :23.605                                        
 3rd Qu.: 55.25                                         3rd Qu.: 48.84   3rd Qu.:27.898                                        
 Max.   :297.00                                         Max.   :120.34   Max.   :65.764                                        
 NA's   :22                                                              NA's   :5                                             
drinkdriving$age[drinkdriving$age > 120] <- NA
[1] 6
summary(drinkdriving$age)
[1] 7
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
  14.00   30.00   40.00   42.68   55.00   90.00      25 
drinkdriving$nighttime[drinkdriving$nighttime != "night" & drinkdriving$nighttime != 
    "day"] <- NA
[1] 8
drinkdriving$nighttime <- as.factor(drinkdriving$nighttime)
[1] 9
summary(drinkdriving$nighttime)
[1] 10
  day night  NA's 
   78   169     3 
drinkdriving$prior_offence[drinkdriving$prior_offence == "DD20"] <- NA
[1] 11
drinkdriving$prior_offence[drinkdriving$prior_offence == "CD60,CD60"] <- "CD60"
[1] 12
drinkdriving$prior_offence[drinkdriving$prior_offence == "CD60,CD10,DR80" | 
    drinkdriving$prior_offence == "TS70,DR50"] <- NA
[1] 13
drinkdriving$prior_offence[drinkdriving$prior_offence == "CD10" | 
    drinkdriving$prior_offence == "CD60"] <- "CD"
[1] 14
drinkdriving$prior_offence[drinkdriving$prior_offence == "PL10"] <- "PL"
[1] 15
drinkdriving$prior_offence[drinkdriving$prior_offence == "SP50" | 
    drinkdriving$prior_offence == "SP60"] <- "SP"
[1] 16
drinkdriving$prior_offence[drinkdriving$prior_offence == "TS70"] <- "TS"
[1] 17
drinkdriving$prior_offence <- as.factor(drinkdriving$prior_offence)
[1] 18
drinkdriving$prior_offence <- relevel(drinkdriving$prior_offence, 
    "N")
[1] 19
summary(drinkdriving$prior_offence)
[1] 20
   N   CD DR50 DR80   PL   SP   TS NA's 
 185    4   43    4    2    3    3    6 
summary(drinkdriving$speed)
[1] 21
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00   30.92   40.64   40.49   48.84  120.34 
which(outliers(drinkdriving$speed))
[1] 22
[1] "Error in outliers(drinkdriving$speed) : \n  could not find function \"outliers\"\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in outliers(drinkdriving$speed): could not find function "outliers">


####################################################################################################

[1] "Error in outliers(drinkdriving$speed) : \n  could not find function \"outliers\"\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in outliers(drinkdriving$speed): could not find function "outliers">
####################################################################################################


summary(drinkdriving$bac)
[1] 23
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
  3.987  19.264  23.609  23.605  27.898  65.764       5 
drinkdriving$outcome[drinkdriving$outcome %in% c("Warning", "WARNING")] <- "warning"
[1] 24
drinkdriving$outcome[drinkdriving$outcome %in% c("Fine", "FINE")] <- "fine"
[1] 25
drinkdriving$outcome <- as.factor(drinkdriving$outcome)
[1] 26
drinkdriving$outcome <- relevel(drinkdriving$outcome, "warning")
[1] 27
drinkdriving$incident_id <- as.factor(drinkdriving$incident_id)
[1] 28
drinkdriving <- merge(drinkdriving, officer_inc)
[1] 29
summary(drinkdriving)
[1] 30
  incident_id       age        nighttime   prior_offence     speed             bac            outcome    officer   
 inc_1  :  1   Min.   :14.00   day  : 78   N      :185   Min.   :  0.00   Min.   : 3.987   warning: 48   AS  :116  
 inc_10 :  1   1st Qu.:30.00   night:169   DR50   : 43   1st Qu.: 30.92   1st Qu.:19.264   fine   :202   IT  : 66  
 inc_100:  1   Median :40.00   NA's :  3   CD     :  4   Median : 40.64   Median :23.609                 NP  : 67  
 inc_101:  1   Mean   :42.68               DR80   :  4   Mean   : 40.49   Mean   :23.605                 NA's:  1  
 inc_102:  1   3rd Qu.:55.00               SP     :  3   3rd Qu.: 48.84   3rd Qu.:27.898                           
 inc_103:  1   Max.   :90.00               (Other):  5   Max.   :120.34   Max.   :65.764                           
 [ reached getOption("max.print") -- omitted 1 row ]
sum(!complete.cases(drinkdriving))
[1] 31
[1] 38
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 32
summary(m1)
[1] 33

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.719  -4.516  -0.861   3.849  42.785 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 29.29455    1.25564  23.330  < 2e-16 ***
age         -0.14353    0.02741  -5.236 3.86e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.82 on 218 degrees of freedom
  (30 observations deleted due to missingness)
Multiple R-squared:  0.1117,	Adjusted R-squared:  0.1076 
F-statistic: 27.41 on 1 and 218 DF,  p-value: 3.863e-07

plot(m1, which = 1)
[1] 34
plot(m1, which = 2)
[1] 35
plot(m1, which = 3)
[1] 36
plot(m1, which = 5)
[1] 37
drinkdriving$bac[drinkdriving$bac > 55] <- NA
[1] 38
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 39
plot(m1)
[1] 40
ncvTest(m1)
[1] 41
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 9.111218, Df = 1, p = 0.0025405
with(drinkdriving, plot(age, bac, col = "blue4", main = "BAC as predicted by age", 
    ylab = "BAC"))
[1] 42
abline(m1, col = "coral4", lwd = 2)
[1] 43
summary(m1)
[1] 44

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.3270  -4.1824  -0.5698   3.9975  14.9487 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 28.68503    1.06949   26.82  < 2e-16 ***
age         -0.13730    0.02331   -5.89 1.47e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.791 on 216 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.1384,	Adjusted R-squared:  0.1344 
F-statistic: 34.69 on 1 and 216 DF,  p-value: 1.469e-08

m1.S <- lm(bac ~ I(age - mean(age, na.rm = T)), data = drinkdriving)
[1] 45
summary(m1.S)
[1] 46

Call:
lm(formula = bac ~ I(age - mean(age, na.rm = T)), data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.3270  -4.1824  -0.5698   3.9975  14.9487 

Coefficients:
                              Estimate Std. Error t value Pr(>|t|)    
(Intercept)                   22.82551    0.39220   58.20  < 2e-16 ***
I(age - mean(age, na.rm = T)) -0.13730    0.02331   -5.89 1.47e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.791 on 216 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.1384,	Adjusted R-squared:  0.1344 
F-statistic: 34.69 on 1 and 216 DF,  p-value: 1.469e-08

age50 <- data.frame(age = 50)
[1] 47
predict(m1, newdata = age50)
[1] 48
       1 
21.81983 
plot(m1, which = 2)
[1] 49
m2.1 <- lm(bac ~ age + nighttime, data = drinkdriving)
[1] 50
summary(m1)
[1] 51

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.3270  -4.1824  -0.5698   3.9975  14.9487 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 28.68503    1.06949   26.82  < 2e-16 ***
age         -0.13730    0.02331   -5.89 1.47e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.791 on 216 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.1384,	Adjusted R-squared:  0.1344 
F-statistic: 34.69 on 1 and 216 DF,  p-value: 1.469e-08

summary(m2.1)
[1] 52

Call:
lm(formula = bac ~ age + nighttime, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.3421  -4.3987   0.2997   3.7390  14.4090 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    26.00346    1.18497  21.944  < 2e-16 ***
age            -0.13690    0.02209  -6.199 2.91e-09 ***
nighttimenight  3.86857    0.79364   4.874 2.13e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.417 on 213 degrees of freedom
  (34 observations deleted due to missingness)
Multiple R-squared:  0.2422,	Adjusted R-squared:  0.235 
F-statistic: 34.03 on 2 and 213 DF,  p-value: 1.498e-13

anova(m2.1)
[1] 53
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1300.0 1299.99  44.298 2.349e-10 ***
nighttime   1  697.3  697.27  23.760 2.131e-06 ***
Residuals 213 6250.8   29.35                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m2.2 <- lm(bac ~ age + speed, data = drinkdriving)
[1] 54
summary(m2.2)
[1] 55

Call:
lm(formula = bac ~ age + speed, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.4118  -3.8926  -0.6094   4.1298  14.4229 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 26.08699    2.74183   9.514  < 2e-16 ***
age         -0.11540    0.03156  -3.656 0.000322 ***
speed        0.04320    0.04198   1.029 0.304616    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.79 on 215 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.1426,	Adjusted R-squared:  0.1346 
F-statistic: 17.88 on 2 and 215 DF,  p-value: 6.574e-08

anova(m2.2)
[1] 56
Analysis of Variance Table

Response: bac
           Df Sum Sq Mean Sq F value    Pr(>F)    
age         1 1163.1 1163.14 34.6961 1.471e-08 ***
speed       1   35.5   35.50  1.0589    0.3046    
Residuals 215 7207.6   33.52                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
vif(m2.1)
[1] 57
      age nighttime 
 1.007883  1.007883 
vif(m2.2)
[1] 58
    age   speed 
1.83361 1.83361 
plot(m2.1, which = c(1:4))
[1] 59
plot(m2.2, which = c(1:4))
[1] 60
ncvTest(m2.1)
[1] 61
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 2.100596, Df = 1, p = 0.14724
ncvTest(m2.2)
[1] 62
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 8.799486, Df = 1, p = 0.0030132
coeftest(m2.2, vcov = hccm)
[1] 63

t test of coefficients:

             Estimate Std. Error t value  Pr(>|t|)    
(Intercept) 26.086994   2.799516  9.3184 < 2.2e-16 ***
age         -0.115403   0.034550 -3.3402 0.0009869 ***
speed        0.043202   0.042711  1.0115 0.3129185    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

summary(m2.1)
[1] 64

Call:
lm(formula = bac ~ age + nighttime, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.3421  -4.3987   0.2997   3.7390  14.4090 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    26.00346    1.18497  21.944  < 2e-16 ***
age            -0.13690    0.02209  -6.199 2.91e-09 ***
nighttimenight  3.86857    0.79364   4.874 2.13e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.417 on 213 degrees of freedom
  (34 observations deleted due to missingness)
Multiple R-squared:  0.2422,	Adjusted R-squared:  0.235 
F-statistic: 34.03 on 2 and 213 DF,  p-value: 1.498e-13

summary(m2.2)
[1] 65

Call:
lm(formula = bac ~ age + speed, data = drinkdriving)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.4118  -3.8926  -0.6094   4.1298  14.4229 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 26.08699    2.74183   9.514  < 2e-16 ***
age         -0.11540    0.03156  -3.656 0.000322 ***
speed        0.04320    0.04198   1.029 0.304616    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.79 on 215 degrees of freedom
  (32 observations deleted due to missingness)
Multiple R-squared:  0.1426,	Adjusted R-squared:  0.1346 
F-statistic: 17.88 on 2 and 215 DF,  p-value: 6.574e-08

t.test(drinkdriving$speed ~ drinkdriving$nighttime, alternative = "less")
[1] 66

	Welch Two Sample t-test

data:  drinkdriving$speed by drinkdriving$nighttime
t = -0.7709, df = 156.78, p-value = 0.221
alternative hypothesis: true difference in means is less than 0
95 percent confidence interval:
     -Inf 1.774294
sample estimates:
  mean in group day mean in group night 
           39.30514            40.85289 

plot(drinkdriving$speed ~ drinkdriving$nighttime)
[1] 67
drinkdriving$is_offence <- ifelse(drinkdriving$prior_offence == 
    "N", 0, 1)
[1] 68
m3.1 <- glm(outcome ~ scale(age) + nighttime + scale(speed) + 
    scale(bac) + officer + is_offence, data = drinkdriving, family = binomial)
[1] 69
summary(m3.1)
[1] 70

Call:
glm(formula = outcome ~ scale(age) + nighttime + scale(speed) + 
    scale(bac) + officer + is_offence, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-4.2916   0.0147   0.0903   0.2909   2.3302  

Coefficients:
               Estimate Std. Error z value Pr(>|z|)    
(Intercept)      3.4191     0.8218   4.160 3.18e-05 ***
scale(age)      -1.2224     0.4221  -2.896 0.003782 ** 
nighttimenight   0.1220     0.6687   0.182 0.855202    
scale(speed)     2.3203     0.6326   3.668 0.000245 ***
scale(bac)       1.5192     0.4168   3.645 0.000268 ***
officerIT        0.2344     0.6843   0.342 0.731997    
officerNP        0.8099     0.7536   1.075 0.282535    
is_offence       1.1144     0.7699   1.448 0.147742    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 204.92  on 210  degrees of freedom
Residual deviance:  80.25  on 203  degrees of freedom
  (39 observations deleted due to missingness)
AIC: 96.25

Number of Fisher Scoring iterations: 7

m3.1.2 <- glm(outcome ~ scale(bac) + scale(speed) + scale(age), 
    data = drinkdriving, family = binomial)
[1] 71
anova(m3.1.2, test = "Chisq")
[1] 72
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


             Df Deviance Resid. Df Resid. Dev  Pr(>Chi)    
NULL                           217     216.50              
scale(bac)    1   41.973       216     174.53 9.256e-11 ***
scale(speed)  1   62.737       215     111.79 2.363e-15 ***
scale(age)    1    5.484       214     106.31   0.01919 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m3.1)
[1] 73

Call:
glm(formula = outcome ~ scale(age) + nighttime + scale(speed) + 
    scale(bac) + officer + is_offence, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-4.2916   0.0147   0.0903   0.2909   2.3302  

Coefficients:
               Estimate Std. Error z value Pr(>|z|)    
(Intercept)      3.4191     0.8218   4.160 3.18e-05 ***
scale(age)      -1.2224     0.4221  -2.896 0.003782 ** 
nighttimenight   0.1220     0.6687   0.182 0.855202    
scale(speed)     2.3203     0.6326   3.668 0.000245 ***
scale(bac)       1.5192     0.4168   3.645 0.000268 ***
officerIT        0.2344     0.6843   0.342 0.731997    
officerNP        0.8099     0.7536   1.075 0.282535    
is_offence       1.1144     0.7699   1.448 0.147742    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 204.92  on 210  degrees of freedom
Residual deviance:  80.25  on 203  degrees of freedom
  (39 observations deleted due to missingness)
AIC: 96.25

Number of Fisher Scoring iterations: 7

drinkdriving$is_drink[drinkdriving$prior_offence == "N"] <- NA
[1] 74
drinkdriving$is_drink[drinkdriving$prior_offence == "DR50"] <- 1
[1] 75
drinkdriving$is_drink[drinkdriving$prior_offence %in% c("CD", 
    "DR80", "PL", "SP", "TS")] <- 0
[1] 76
model3.2 <- glm(outcome ~ is_drink, data = drinkdriving, family = binomial)
[1] 77
summary(model3.2)
[1] 78

Call:
glm(formula = outcome ~ is_drink, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.3076   0.3803   0.3803   0.3803   0.8657  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)  
(Intercept)   0.7885     0.5394   1.462   0.1438  
is_drink      1.8018     0.8058   2.236   0.0253 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 46.832  on 58  degrees of freedom
Residual deviance: 41.636  on 57  degrees of freedom
  (191 observations deleted due to missingness)
AIC: 45.636

Number of Fisher Scoring iterations: 5

anova(model3.2, test = "Chisq")
[1] 79
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


         Df Deviance Resid. Df Resid. Dev Pr(>Chi)  
NULL                        58     46.832           
is_drink  1   5.1962        57     41.636  0.02264 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
model3.2.2 <- glm(outcome ~ scale(age) + scale(bac) + scale(speed) + 
    is_drink, data = drinkdriving, family = binomial)
[1] 80
summary(model3.2.2)
[1] 81

Call:
glm(formula = outcome ~ scale(age) + scale(bac) + scale(speed) + 
    is_drink, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.2843   0.1331   0.2705   0.4193   1.6887  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)  
(Intercept)    1.4301     0.7816   1.830   0.0673 .
scale(age)    -0.1126     0.5055  -0.223   0.8237  
scale(bac)     1.0662     0.6515   1.636   0.1017  
scale(speed)   0.2677     0.9206   0.291   0.7712  
is_drink       1.7743     1.0688   1.660   0.0969 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 41.087  on 51  degrees of freedom
Residual deviance: 28.614  on 47  degrees of freedom
  (198 observations deleted due to missingness)
AIC: 38.614

Number of Fisher Scoring iterations: 6

anova(model3.2.2, test = "Chisq")
[1] 82
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


             Df Deviance Resid. Df Resid. Dev Pr(>Chi)  
NULL                            51     41.087           
scale(age)    1   4.3895        50     36.697  0.03616 *
scale(bac)    1   4.6522        49     32.045  0.03101 *
scale(speed)  1   0.4328        48     31.612  0.51060  
is_drink      1   2.9988        47     28.614  0.08333 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m3.1)
[1] 83

Call:
glm(formula = outcome ~ scale(age) + nighttime + scale(speed) + 
    scale(bac) + officer + is_offence, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-4.2916   0.0147   0.0903   0.2909   2.3302  

Coefficients:
               Estimate Std. Error z value Pr(>|z|)    
(Intercept)      3.4191     0.8218   4.160 3.18e-05 ***
scale(age)      -1.2224     0.4221  -2.896 0.003782 ** 
nighttimenight   0.1220     0.6687   0.182 0.855202    
scale(speed)     2.3203     0.6326   3.668 0.000245 ***
scale(bac)       1.5192     0.4168   3.645 0.000268 ***
officerIT        0.2344     0.6843   0.342 0.731997    
officerNP        0.8099     0.7536   1.075 0.282535    
is_offence       1.1144     0.7699   1.448 0.147742    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 204.92  on 210  degrees of freedom
Residual deviance:  80.25  on 203  degrees of freedom
  (39 observations deleted due to missingness)
AIC: 96.25

Number of Fisher Scoring iterations: 7

m4 <- glm(outcome ~ scale(age) + nighttime + scale(speed) + scale(bac) + 
    is_offence, data = drinkdriving, family = binomial)
[1] 84
new.df <- data.frame(age = 17:80, nighttime = "day", speed = 30, 
    bac = 0, is_offence = 0)
[1] 85
predictedprobs <- predict(m4, new.df, type = "response")
[1] 86
plot(17:80, predictedprobs, main = "Probability of receiving a fine by age", 
    xlab = "Age", ylab = "Probability of receiving a fine", col = "blue4", 
    lwd = 2, type = "l")
[1] 87
outcome_age <- ggplot(data = drinkdriving, aes(x = age, y = outcome))
[1] 88
outcome_age + geom_point() + theme_minimal() + facet_grid(. ~ 
    officer) + geom_jitter() + ggtitle("Relationship between age and outcome by officer")
[1] 89
contrasts(drinkdriving$officer) <- cbind(AvIN = c(-2, 1, 1)/3, 
    IvN = c(0, -1, 1)/2)
[1] 90
m5 <- glm(outcome ~ age * officer, data = drinkdriving, family = binomial)
[1] 91
summary(m5)
[1] 92

Call:
glm(formula = outcome ~ age * officer, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.7179   0.0642   0.2741   0.5454   2.4089  

Coefficients:
                Estimate Std. Error z value Pr(>|z|)    
(Intercept)      6.32586    0.94007   6.729 1.71e-11 ***
age             -0.09796    0.01683  -5.821 5.84e-09 ***
officerAvIN     -4.86500    2.23048  -2.181   0.0292 *  
officerIvN       0.36070    1.99283   0.181   0.8564    
age:officerAvIN  0.09489    0.03922   2.419   0.0155 *  
age:officerIvN  -0.00247    0.03671  -0.067   0.9464    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 222.38  on 224  degrees of freedom
Residual deviance: 146.41  on 219  degrees of freedom
  (25 observations deleted due to missingness)
AIC: 158.41

Number of Fisher Scoring iterations: 7

contrasts(drinkdriving$officer) <- cbind(IvAN = c(1, -2, 1)/3, 
    AvN = c(-1, 0, 1)/2)
[1] 93
m5.2 <- glm(outcome ~ age * officer, data = drinkdriving, family = binomial)
[1] 94
summary(m5.2)
[1] 95

Call:
glm(formula = outcome ~ age * officer, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.7179   0.0642   0.2741   0.5454   2.4089  

Coefficients:
                Estimate Std. Error z value Pr(>|z|)    
(Intercept)      6.32586    0.94007   6.729 1.71e-11 ***
age             -0.09797    0.01683  -5.821 5.84e-09 ***
officerIvAN      2.70303    1.81871   1.486   0.1372    
officerAvN      -4.68465    2.48887  -1.882   0.0598 .  
age:officerIvAN -0.04930    0.03307  -1.491   0.1360    
age:officerAvN   0.09365    0.04405   2.126   0.0335 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 222.38  on 224  degrees of freedom
Residual deviance: 146.41  on 219  degrees of freedom
  (25 observations deleted due to missingness)
AIC: 158.41

Number of Fisher Scoring iterations: 7

contrasts(drinkdriving$officer) <- cbind(NvAI = c(1, 1, -2)/3, 
    AvI = c(-1, 1, 0)/2)
[1] 96
m5.3 <- glm(outcome ~ age * officer, data = drinkdriving, family = binomial)
[1] 97
summary(m5.3)
[1] 98

Call:
glm(formula = outcome ~ age * officer, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.7179   0.0642   0.2741   0.5454   2.4089  

Coefficients:
                Estimate Std. Error z value Pr(>|z|)    
(Intercept)      6.32586    0.94007   6.729 1.71e-11 ***
age             -0.09797    0.01683  -5.821 5.84e-09 ***
officerNvAI      2.16198    1.90987   1.132   0.2576    
officerAvI      -5.04535    2.39610  -2.106   0.0352 *  
age:officerNvAI -0.04559    0.03452  -1.321   0.1866    
age:officerAvI   0.09612    0.04254   2.260   0.0238 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 222.38  on 224  degrees of freedom
Residual deviance: 146.41  on 219  degrees of freedom
  (25 observations deleted due to missingness)
AIC: 158.41

Number of Fisher Scoring iterations: 7

