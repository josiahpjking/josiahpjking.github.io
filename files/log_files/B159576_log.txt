

	####### B159576 R script #######

load(url("https://edin.ac/2QCZNVu"))
[1] 1
[1] "drinkdriving" "officer_inc" 
class(drinkdriving$incident_id)
[1] 2
[1] "character"
drinkdriving$incident_id <- factor(drinkdriving$incident_id)
[1] 3
class(officer_inc$incident_id)
[1] 4
[1] "factor"
table(drinkdriving$age)
[1] 5

14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 
 1  5  2  3  1  2  3  6  2  5  8  3  2  2  5  4  4  4  6  5  9  8  3  4  2 10  5  6  5  3  2  3  4  5  2  3  3  3  6  3  5  4  3  4  4 
59 60 61 62 63 
 1  5  3  3  2 
 [ reached getOption("max.print") -- omitted 15 entries ]
drinkdriving$age[drinkdriving$age < 17] <- NA
[1] 6
drinkdriving$age[drinkdriving$age > 90] <- NA
[1] 7
drinkdriving$nighttime <- as.factor(drinkdriving$nighttime)
[1] 8
table(drinkdriving$nighttime)
[1] 9

18:25  2:05   day night 
    1     2    78   169 
drinkdriving$nighttime[drinkdriving$nighttime == "18:25"] <- "night"
[1] 10
drinkdriving$nighttime[drinkdriving$nighttime == "2:05"] <- "night"
[1] 11
drinkdriving$prior_offence <- as.factor(drinkdriving$prior_offence)
[1] 12
table(drinkdriving$prior_offence)
[1] 13

          CD10           CD60 CD60,CD10,DR80      CD60,CD60           DD20           DR50           DR80              N           PL10 
             2              1              1              1              4             43              4            185              2 
          SP50           SP60           TS70      TS70,DR50 
             2              1              3              1 
drinkdriving$prior_offence[drinkdriving$prior_offence == "CD60,CD60"] <- "CD60"
[1] 14
table(drinkdriving$outcome)
[1] 15

   fine    Fine    FINE warning Warning WARNING 
    191       2       9      43       2       3 
drinkdriving$outcome <- tolower(drinkdriving$outcome)
[1] 16
drinkdriving$outcome <- as.factor(drinkdriving$outcome)
[1] 17
m1 <- lm(bac ~ scale(age), data = drinkdriving)
[1] 18
mean(drinkdriving$age, na.rm = T)
[1] 19
[1] 43.69124
sd(drinkdriving$age, na.rm = T)
[1] 20
[1] 16.20047
summary(m1)
[1] 21

Call:
lm(formula = bac ~ scale(age), data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.567  -4.490  -0.993   3.833  42.860 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  22.9457     0.4739  48.423  < 2e-16 ***
scale(age)   -2.1872     0.4740  -4.614 6.86e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.899 on 210 degrees of freedom
  (38 observations deleted due to missingness)
Multiple R-squared:  0.09205,	Adjusted R-squared:  0.08773 
F-statistic: 21.29 on 1 and 210 DF,  p-value: 6.86e-06

predict(m1, data.frame(age = 50))
[1] 22
       1 
22.09395 
plot(m1)
[1] 23
m2 <- lm(bac ~ age + nighttime + speed, data = drinkdriving, 
    na.action = na.exclude)
[1] 24
summary(m2)
[1] 25

Call:
lm(formula = bac ~ age + nighttime + speed, data = drinkdriving, 
    na.action = na.exclude)

Residuals:
    Min      1Q  Median      3Q     Max 
-13.267  -4.718   0.201   4.153  33.064 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    13.65776    2.84819   4.795 3.09e-06 ***
age            -0.02318    0.03394  -0.683    0.496    
nighttimenight  3.80752    0.93649   4.066 6.79e-05 ***
speed           0.20060    0.03978   5.043 9.97e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.342 on 208 degrees of freedom
  (38 observations deleted due to missingness)
Multiple R-squared:  0.2401,	Adjusted R-squared:  0.2291 
F-statistic: 21.91 on 3 and 208 DF,  p-value: 2.279e-12

anova(m1, m2)
[1] 26
Analysis of Variance Table

Model 1: bac ~ scale(age)
Model 2: bac ~ age + nighttime + speed
  Res.Df    RSS Df Sum of Sq      F    Pr(>F)    
1    210 9996.4                                  
2    208 8366.4  2      1630 20.262 9.129e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m2)
[1] 27

Call:
lm(formula = bac ~ age + nighttime + speed, data = drinkdriving, 
    na.action = na.exclude)

Residuals:
    Min      1Q  Median      3Q     Max 
-13.267  -4.718   0.201   4.153  33.064 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    13.65776    2.84819   4.795 3.09e-06 ***
age            -0.02318    0.03394  -0.683    0.496    
nighttimenight  3.80752    0.93649   4.066 6.79e-05 ***
speed           0.20060    0.03978   5.043 9.97e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 6.342 on 208 degrees of freedom
  (38 observations deleted due to missingness)
Multiple R-squared:  0.2401,	Adjusted R-squared:  0.2291 
F-statistic: 21.91 on 3 and 208 DF,  p-value: 2.279e-12

m3 <- lm(speed ~ nighttime, data = drinkdriving)
[1] 28
summary(m3)
[1] 29

Call:
lm(formula = speed ~ nighttime, data = drinkdriving)

Residuals:
    Min      1Q  Median      3Q     Max 
-41.022  -9.380   0.086   8.311  81.032 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)      39.305      1.690  23.261   <2e-16 ***
nighttimenight    1.717      2.037   0.843      0.4    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 14.92 on 248 degrees of freedom
Multiple R-squared:  0.002856,	Adjusted R-squared:  -0.001165 
F-statistic: 0.7103 on 1 and 248 DF,  p-value: 0.4002

m4 <- glm(outcome ~ scale(age) + nighttime + prior_offence + 
    speed + bac, data = drinkdriving, family = binomial)
[1] 30
summary(m4)
[1] 31

Call:
glm(formula = outcome ~ scale(age) + nighttime + prior_offence + 
    speed + bac, family = binomial, data = drinkdriving)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-3.01304  -0.20843  -0.03906  -0.00221   3.15112  

Coefficients:
                              Estimate Std. Error z value Pr(>|z|)    
(Intercept)                  -14.69935 4330.97624  -0.003 0.997292    
scale(age)                     2.23297    0.61173   3.650 0.000262 ***
nighttimenight                 0.69719    0.77702   0.897 0.369578    
prior_offenceCD60             40.12327 4339.32285   0.009 0.992623    
prior_offenceCD60,CD10,DR80   27.90024 7829.57213   0.004 0.997157    
prior_offenceDD20             28.74649 4330.97668   0.007 0.994704    
prior_offenceDR50             20.28505 4330.97610   0.005 0.996263    
prior_offenceDR80             27.37813 4330.97667   0.006 0.994956    
prior_offenceN                22.88465 4330.97600   0.005 0.995784    
prior_offencePL10             20.82550 4331.23872   0.005 0.996164    
 [ reached getOption("max.print") -- omitted 6 rows ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 213.824  on 211  degrees of freedom
Residual deviance:  62.076  on 196  degrees of freedom
  (38 observations deleted due to missingness)
AIC: 94.076

Number of Fisher Scoring iterations: 17

contrasts(drinkdriving$outcome)
[1] 32
        warning
fine          0
warning       1
m5 <- glm(outcome ~ prior_offence, data = drinkdriving, family = binomial)
[1] 33
summary(m5)
[1] 34

Call:
glm(formula = outcome ~ prior_offence, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.1774  -0.6681  -0.6681  -0.3803   2.3076  

Coefficients:
                              Estimate Std. Error z value Pr(>|z|)
(Intercept)                 -1.657e+01  1.697e+03  -0.010    0.992
prior_offenceCD60            1.657e+01  1.697e+03   0.010    0.992
prior_offenceCD60,CD10,DR80  3.278e-08  2.939e+03   0.000    1.000
prior_offenceDD20            1.657e+01  1.697e+03   0.010    0.992
prior_offenceDR50            1.398e+01  1.697e+03   0.008    0.993
prior_offenceDR80            1.547e+01  1.697e+03   0.009    0.993
prior_offenceN               1.518e+01  1.697e+03   0.009    0.993
prior_offencePL10            1.657e+01  1.697e+03   0.010    0.992
prior_offenceSP50            3.280e-08  2.400e+03   0.000    1.000
prior_offenceSP60            3.313e+01  2.939e+03   0.011    0.991
prior_offenceTS70            1.587e+01  1.697e+03   0.009    0.993
prior_offenceTS70,DR50       3.313e+01  2.939e+03   0.011    0.991

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 244.56  on 249  degrees of freedom
Residual deviance: 226.32  on 238  degrees of freedom
AIC: 250.32

Number of Fisher Scoring iterations: 15

new <- data.frame(age = seq.int(17, 90, 1), nighttime = "day", 
    prior_offence = "N", speed = 30, bac = 0)
[1] 35
p.outcome <- predict(m4, newdata = new, type = "response")
[1] 36
p.outcome

        1         2         3         4         5         6         7         8         9        10        11        12        13 
0.5781233 0.6113304 0.6435353 0.6744926 0.7039980 0.7318920 0.7580607 0.7824345 0.8049845 0.8257179 0.8446723 0.8619100 0.8775122 
       14        15        16        17        18        19        20        21        22        23        24        25        26 
0.8915733 0.9041964 0.9154893 0.9255606 0.9345175 0.9424637 0.9494978 0.9557123 0.9611933 0.9660201 0.9702652 0.9739942 0.9772665 
       27        28        29        30        31        32        33        34        35        36        37        38        39 
0.9801354 0.9826487 0.9848490 0.9867740 0.9884572 0.9899285 0.9912139 0.9923365 0.9933166 0.9941721 0.9949187 0.9955700 0.9961382 
       40        41        42        43        44        45        46        47        48        49        50 
0.9966338 0.9970659 0.9974427 0.9977713 0.9980577 0.9983073 0.9985250 0.9987146 0.9988799 0.9990240 0.9991496 
 [ reached getOption("max.print") -- omitted 24 entries ]


p.outcome1 <- (1 - p.outcome) * 100
[1] 38
plot(new$age, p.outcome1, main = "Outcome predicted by Age", 
    xlab = "age", ylab = "predicted possibility")
[1] 39
corrupt <- merge(drinkdriving, officer_inc, by = "incident_id")
[1] 40
contrasts(corrupt$officer)
[1] 41
   IT NP
AS  0  0
IT  1  0
NP  0  1
table(corrupt$officer)
[1] 42

 AS  IT  NP 
116  66  67 
m6 <- glm(outcome ~ scale(age) + officer + scale(age):officer, 
    data = corrupt, family = binomial)
[1] 43
summary(m6)
[1] 44

Call:
glm(formula = outcome ~ scale(age) + officer + scale(age):officer, 
    family = binomial, data = corrupt)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.4075  -0.5638  -0.3183  -0.0757   2.7179  

Coefficients:
                     Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -2.5220     0.5763  -4.376 1.21e-05 ***
scale(age)             2.6086     0.5628   4.635 3.57e-06 ***
officerIT              0.8700     0.7085   1.228   0.2195    
officerNP              0.5897     0.7311   0.807   0.4199    
scale(age):officerIT  -1.5864     0.6950  -2.283   0.0225 *  
scale(age):officerNP  -1.5139     0.7147  -2.118   0.0342 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 218.83  on 216  degrees of freedom
Residual deviance: 146.22  on 211  degrees of freedom
  (33 observations deleted due to missingness)
AIC: 158.22

Number of Fisher Scoring iterations: 6

plot(corrupt$outcome ~ corrupt$age + corrupt$officer)
[1] 45
m7 <- glm(outcome ~ scale(age), data = corrupt, family = binomial)
[1] 46
summary(m7)
[1] 47

Call:
glm(formula = outcome ~ scale(age), family = binomial, data = corrupt)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1710  -0.5373  -0.3166  -0.1663   3.0285  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -1.9941     0.2626  -7.595 3.08e-14 ***
scale(age)    1.6279     0.2572   6.329 2.46e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 218.83  on 216  degrees of freedom
Residual deviance: 154.53  on 215  degrees of freedom
  (33 observations deleted due to missingness)
AIC: 158.53

Number of Fisher Scoring iterations: 5

anova(m7, m6, test = "Chisq")
[1] 48
Analysis of Deviance Table

Model 1: outcome ~ scale(age)
Model 2: outcome ~ scale(age) + officer + scale(age):officer
  Resid. Df Resid. Dev Df Deviance Pr(>Chi)  
1       215     154.53                       
2       211     146.22  4   8.3079  0.08093 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
