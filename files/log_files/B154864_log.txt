

	####### B154864 R script #######

library(ggplot2, quietly = T)
[1] 1
[1] "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(plyr, quietly = T)
[1] 2
 [1] "plyr"      "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(lsr, quietly = T)
[1] 3
 [1] "lsr"       "plyr"      "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
library(car, quietly = T)
[1] 4
 [1] "car"       "carData"   "lsr"       "plyr"      "ggplot2"   "readr"     "stats"     "graphics"  "grDevices" "utils"    
[11] "datasets"  "methods"   "base"     
library(psych, quietly = T)
[1] 5
 [1] "psych"     "car"       "carData"   "lsr"       "plyr"      "ggplot2"   "readr"     "stats"     "graphics"  "grDevices"
[11] "utils"     "datasets"  "methods"   "base"     
library(dplyr, quietly = T)
[1] 6
 [1] "dplyr"     "psych"     "car"       "carData"   "lsr"       "plyr"      "ggplot2"   "readr"     "stats"     "graphics" 
[11] "grDevices" "utils"     "datasets"  "methods"   "base"     
library(CGPfunctions, quietly = T)
[1] 7
 [1] "CGPfunctions" "dplyr"        "psych"        "car"          "carData"      "lsr"          "plyr"         "ggplot2"     
 [9] "readr"        "stats"        "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
load(url("https://edin.ac/2QCZNVu"))
[1] 8
[1] "drinkdriving" "officer_inc" 
drinkdriving <- merge(drinkdriving, officer_inc)
[1] 9
drinkdriving$bac <- drinkdriving$bac/100
[1] 10
summary(drinkdriving)
[1] 11
 incident_id             age          nighttime         prior_offence          speed             bac         
 Length:250         Min.   : 14.00   Length:250         Length:250         Min.   :  0.00   Min.   :0.03987  
 Class :character   1st Qu.: 30.00   Class :character   Class :character   1st Qu.: 30.92   1st Qu.:0.19264  
 Mode  :character   Median : 40.50   Mode  :character   Mode  :character   Median : 40.64   Median :0.23609  
                    Mean   : 46.00                                         Mean   : 40.49   Mean   :0.23605  
                    3rd Qu.: 55.25                                         3rd Qu.: 48.84   3rd Qu.:0.27898  
                    Max.   :297.00                                         Max.   :120.34   Max.   :0.65764  
   outcome          officer   
 Length:250         AS  :116  
 Class :character   IT  : 66  
 Mode  :character   NP  : 67  
                    NA's:  1  
                              
                              
 [ reached getOption("max.print") -- omitted 1 row ]
head(drinkdriving)
[1] 12
  incident_id age nighttime prior_offence     speed        bac outcome officer
1       inc_1  39     night             N 47.957110 0.17713735    fine      AS
2      inc_10  60     night             N  2.533468 0.24419368 warning      AS
3     inc_100  68     night             N 25.541785 0.10497119 warning      AS
4     inc_101  35       day             N 44.357546 0.08552419    fine      NP
5     inc_102  47       day             N 37.070612 0.20756351    fine      AS
6     inc_103  41     night             N 40.412547 0.18781113    fine      NP
length(drinkdriving$incident_id)
[1] 13
[1] 250
class(drinkdriving$age)
[1] 14
[1] "numeric"
sum(is.na(drinkdriving$age))
[1] 15
[1] 22
drinkdriving$age[drinkdriving$age > 100] <- NA
[1] 16
table(drinkdriving$nighttime)
[1] 17

18:25  2:05   day night 
    1     2    78   169 
class(drinkdriving$nighttime)
[1] 18
[1] "character"
drinkdriving$nighttime <- factor(drinkdriving$nighttime)
[1] 19
drinkdriving$nighttime[drinkdriving$nighttime == "18:25" | drinkdriving$nighttime == 
    "2:05"] <- NA
[1] 20
drinkdriving$nighttime <- droplevels(drinkdriving$nighttime)
[1] 21
levels(drinkdriving$nighttime)
[1] 22
[1] "day"   "night"
class(drinkdriving$prior_offence)
[1] 23
[1] "character"
table(drinkdriving$prior_offence)
[1] 24

          CD10           CD60 CD60,CD10,DR80      CD60,CD60           DD20           DR50           DR80              N 
             2              1              1              1              4             43              4            185 
          PL10           SP50           SP60           TS70      TS70,DR50 
             2              2              1              3              1 
summary(drinkdriving$speed)
[1] 25
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00   30.92   40.64   40.49   48.84  120.34 
class(drinkdriving$speed)
[1] 26
[1] "numeric"
length(which(drinkdriving$speed == "0"))
[1] 27
[1] 1
class(drinkdriving$bac)
[1] 28
[1] "numeric"
drinkdriving$bac[drinkdriving$bac > 0.4] <- NA
[1] 29
table(drinkdriving$outcome)
[1] 30

   fine    Fine    FINE warning Warning WARNING 
    191       2       9      43       2       3 
class(drinkdriving$outcome)
[1] 31
[1] "character"
drinkdriving$outcome[drinkdriving$outcome == "Fine" | drinkdriving$outcome == 
    "FINE"] <- "fine"
[1] 32
drinkdriving$outcome[drinkdriving$outcome == "Warning" | drinkdriving$outcome == 
    "WARNING"] <- "warning"
[1] 33
drinkdriving$outcome <- factor(drinkdriving$outcome)
[1] 34
levels(drinkdriving$outcome)
[1] 35
[1] "fine"    "warning"
summary(drinkdriving$incident_id)
[1] 36
   Length     Class      Mode 
      250 character character 
class(drinkdriving$incident_id)
[1] 37
[1] "character"
drinkdriving$incident_id[duplicated(drinkdriving$incident_id)]
[1] 38
character(0)
class(drinkdriving$officer)
[1] 39
[1] "factor"
levels(drinkdriving$officer)
[1] 40
[1] "AS" "IT" "NP"
which(is.na(drinkdriving$officer))
[1] 41
[1] 121
sum(!complete.cases(drinkdriving))
[1] 42
[1] 34
sum(is.na(drinkdriving))
[1] 43
[1] 36
drinkdriving <- na.omit(drinkdriving)
[1] 44
sum(complete.cases(drinkdriving))
[1] 45
[1] 216
m1 <- lm(bac ~ age, data = drinkdriving)
[1] 46
summary(m1)
[1] 47

Call:
lm(formula = bac ~ age, data = drinkdriving)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.153651 -0.041773 -0.005542  0.041637  0.120745 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.2904216  0.0105998  27.399  < 2e-16 ***
age         -0.0014642  0.0002314  -6.328 1.44e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05698 on 214 degrees of freedom
Multiple R-squared:  0.1576,	Adjusted R-squared:  0.1537 
F-statistic: 40.04 on 1 and 214 DF,  p-value: 1.436e-09

plot(hatvalues(m1))
[1] 48
plot(cooks.distance(m1))
[1] 49
outlierTest(m1)
[1] 50
No Studentized residuals with Bonferroni p < 0.05
Largest |rstudent|:
   rstudent unadjusted p-value Bonferroni p
4 -2.745112          0.0065657           NA
m1_subset <- lm(bac ~ age, data = drinkdriving, subset = -c(19, 
    83, 164))
[1] 51
summary(m1_subset)
[1] 52

Call:
lm(formula = bac ~ age, data = drinkdriving, subset = -c(19, 
    83, 164))

Residuals:
     Min       1Q   Median       3Q      Max 
-0.15376 -0.04166 -0.00582  0.04105  0.12157 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.2915309  0.0106196  27.452  < 2e-16 ***
age         -0.0014928  0.0002334  -6.396 1.01e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05653 on 211 degrees of freedom
Multiple R-squared:  0.1624,	Adjusted R-squared:  0.1584 
F-statistic: 40.91 on 1 and 211 DF,  p-value: 1.01e-09

par(mfrow = c(2, 2), mar = c(2, 2, 2, 2))
[1] 53
$mfrow
[1] 1 1

$mar
[1] 5.1 4.1 4.1 2.1

plot(m1_subset, which = c(1:4))
[1] 54
confint(m1)
[1] 55
                   2.5 %       97.5 %
(Intercept)  0.269528223  0.311314923
age         -0.001920294 -0.001008089
par(mfrow = c(2, 2), mar = c(2, 2, 2, 2))
[1] 56
$mfrow
[1] 2 2

$mar
[1] 2 2 2 2

plot(m1, which = c(1:4))
[1] 57
par(mfrow = c(1, 1))
[1] 58
$mfrow
[1] 2 2

m1_residuals <- residuals(m1)
[1] 59
m1_stresiduals <- rstandard(m1)
[1] 60
plot(m1_residuals)
[1] 61
plot(m1_stresiduals)
[1] 62
head(predict(m1))
[1] 63
        1         2         3         4         5         6 
0.2333181 0.2025701 0.1908566 0.2391749 0.2216046 0.2303897 
p.drinkdriving <- predict(m1, interval = "confidence")
[1] 64
head(p.drinkdriving)
[1] 65
        fit       lwr       upr
1 0.2333181 0.2254984 0.2411378
2 0.2025701 0.1915639 0.2135763
3 0.1908566 0.1769911 0.2047220
4 0.2391749 0.2307770 0.2475728
5 0.2216046 0.2137074 0.2295018
6 0.2303897 0.2227114 0.2380680
drinkdriving_pred <- merge(drinkdriving, p.drinkdriving, by = "row.names")
[1] 66
ggplot(drinkdriving_pred, aes(x = age)) + geom_point(aes(y = bac), 
    col = "blue") + geom_line(aes(y = fit)) + geom_ribbon(aes(ymin = lwr, 
    ymax = upr), fill = "orange", alpha = 0.4) + theme_minimal() + 
    labs(x = "- Age of driver (in years) - ", y = "Blood Alcohol Content (%)")
[1] 67
new_driver_age50 <- data.frame(age = 50)
[1] 68
new_driver_age50_prediction <- predict(m1, newdrinkdriving = new_driver_age50)
[1] 69
new_driver_age50_prediction

        1         2         3         4         5         6         7         8         9        10        11        12 
0.2333181 0.2025701 0.1908566 0.2391749 0.2216046 0.2303897 0.2377107 0.2289255 0.2596736 0.1645011 0.2245330 0.2626019 
       13        15        16        17        19        20        21        22        23        24        25        27 
0.2494242 0.2274613 0.1952491 0.2333181 0.1586443 0.2011059 0.1937849 0.2406391 0.2421033 0.2303897 0.2230688 0.2362465 
       28        30        31        32        34        35        36        37        38        39        42        43 
0.2142836 0.2655303 0.2186762 0.2025701 0.2421033 0.2567452 0.2274613 0.2538168 0.2172120 0.2318539 0.2084269 0.2450316 
       44        45        46        47        48        50        51        52        53        54        55        56 
0.2450316 0.2655303 0.2391749 0.2596736 0.2142836 0.2494242 0.2303897 0.2479600 0.2318539 0.2479600 0.2552810 0.1967133 
       57        58 
0.2333181 0.2596736 
 [ reached getOption("max.print") -- omitted 166 entries ]


par(mfrow = c(1, 1))
[1] 71
$mfrow
[1] 1 1

plot(m1, which = 2)
[1] 72
plot(m1, which = 3)
[1] 73
hist(x = residuals(m1), xlab = "Value of residual", main = "Residuals of m1", 
    breaks = 20)
[1] 74
m2 <- lm(bac ~ age + nighttime, data = drinkdriving, na.action = na.omit)
[1] 75
summary(m2)
[1] 76

Call:
lm(formula = bac ~ age + nighttime, data = drinkdriving, na.action = na.omit)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.163421 -0.043987  0.002997  0.037390  0.144090 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.2600346  0.0118497  21.944  < 2e-16 ***
age            -0.0013690  0.0002209  -6.199 2.91e-09 ***
nighttimenight  0.0386857  0.0079364   4.874 2.13e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05417 on 213 degrees of freedom
Multiple R-squared:  0.2422,	Adjusted R-squared:  0.235 
F-statistic: 34.03 on 2 and 213 DF,  p-value: 1.498e-13

anova(m2)
[1] 77
Analysis of Variance Table

Response: bac
           Df  Sum Sq  Mean Sq F value    Pr(>F)    
age         1 0.13000 0.129999  44.298 2.349e-10 ***
nighttime   1 0.06973 0.069727  23.760 2.131e-06 ***
Residuals 213 0.62508 0.002935                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
m3 <- lm(bac ~ age + speed, data = drinkdriving, na.action = na.omit)
[1] 78
summary(m3)
[1] 79

Call:
lm(formula = bac ~ age + speed, data = drinkdriving, na.action = na.omit)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.15446 -0.03963 -0.00632  0.03973  0.12218 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.2668292  0.0271884   9.814  < 2e-16 ***
age         -0.0012644  0.0003139  -4.029  7.8e-05 ***
speed        0.0003925  0.0004165   0.942    0.347    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.057 on 213 degrees of freedom
Multiple R-squared:  0.1611,	Adjusted R-squared:  0.1532 
F-statistic: 20.45 on 2 and 213 DF,  p-value: 7.492e-09

anova(m3)
[1] 80
Analysis of Variance Table

Response: bac
           Df  Sum Sq  Mean Sq F value    Pr(>F)    
age         1 0.13000 0.129999  40.019 1.459e-09 ***
speed       1 0.00288 0.002885   0.888    0.3471    
Residuals 213 0.69192 0.003248                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
standardCoefs(m2)
[1] 81
                          b       beta
age            -0.001368982 -0.3711892
nighttimenight  0.038685730  0.2918985
standardCoefs(m3)
[1] 82
                  b        beta
age   -0.0012644357 -0.34284218
speed  0.0003924784  0.08019311
par(mfrow = c(2, 2), mar = c(2, 2, 2, 2))
[1] 83
$mfrow
[1] 1 1

$mar
[1] 2 2 2 2

plot(m2, which = c(1:4))
[1] 84
summary(m2)
[1] 85

Call:
lm(formula = bac ~ age + nighttime, data = drinkdriving, na.action = na.omit)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.163421 -0.043987  0.002997  0.037390  0.144090 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.2600346  0.0118497  21.944  < 2e-16 ***
age            -0.0013690  0.0002209  -6.199 2.91e-09 ***
nighttimenight  0.0386857  0.0079364   4.874 2.13e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05417 on 213 degrees of freedom
Multiple R-squared:  0.2422,	Adjusted R-squared:  0.235 
F-statistic: 34.03 on 2 and 213 DF,  p-value: 1.498e-13

par(mfrow = c(2, 2), mar = c(2, 2, 2, 2))
[1] 86
$mfrow
[1] 2 2

$mar
[1] 2 2 2 2

plot(m3, which = c(1:4))
[1] 87
summary(m3)
[1] 88

Call:
lm(formula = bac ~ age + speed, data = drinkdriving, na.action = na.omit)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.15446 -0.03963 -0.00632  0.03973  0.12218 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.2668292  0.0271884   9.814  < 2e-16 ***
age         -0.0012644  0.0003139  -4.029  7.8e-05 ***
speed        0.0003925  0.0004165   0.942    0.347    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.057 on 213 degrees of freedom
Multiple R-squared:  0.1611,	Adjusted R-squared:  0.1532 
F-statistic: 20.45 on 2 and 213 DF,  p-value: 7.492e-09

drinkdriving$nighttime <- as.factor(drinkdriving$nighttime)
[1] 89
contrasts(drinkdriving$nighttime)
[1] 90
      night
day       0
night     1
mean(drinkdriving$speed)
[1] 91
[1] 38.41225
t.test(speed ~ nighttime, data = drinkdriving)
[1] 92

	Welch Two Sample t-test

data:  speed by nighttime
t = -0.88386, df = 187.21, p-value = 0.3779
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -4.610903  1.757555
sample estimates:
  mean in group day mean in group night 
           37.44132            38.86800 

var.test(drinkdriving$speed, as.numeric(drinkdriving$nighttime))
[1] 93

	F test to compare two variances

data:  drinkdriving$speed and as.numeric(drinkdriving$nighttime)
F = 733.3, num df = 215, denom df = 215, p-value < 2.2e-16
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 560.8792 958.7205
sample estimates:
ratio of variances 
          733.2983 

cohensD(speed ~ nighttime, data = drinkdriving)
[1] 94
[1] 0.112626
drinkdriving$outcome <- relevel(drinkdriving$outcome, ref = "fine")
[1] 95
contrasts(drinkdriving$outcome)
[1] 96
        warning
fine          0
warning       1
prop.table(table(drinkdriving$outcome))
[1] 97

     fine   warning 
0.8009259 0.1990741 
drinkdriving_model <- glm(outcome ~ age + nighttime + prior_offence + 
    speed + bac, data = drinkdriving, family = binomial)
[1] 98
exp(coef(drinkdriving_model))
[1] 99
           (Intercept)                    age         nighttimenight      prior_offenceCD60      prior_offenceDD20 
          9.954987e-10           1.147777e+00           2.007400e+00           2.125697e+20           3.047072e+12 
     prior_offenceDR50      prior_offenceDR80         prior_offenceN      prior_offencePL10      prior_offenceSP50 
          6.473306e+08           7.761037e+11           8.683957e+09           1.109203e+09           7.136579e+04 
     prior_offenceSP60      prior_offenceTS70 prior_offenceTS70,DR50                  speed                    bac 
          8.016782e+19           2.287139e+01           6.551767e+16           8.696827e-01           1.042575e-14 
summary(drinkdriving_model)
[1] 100

Call:
glm(formula = outcome ~ age + nighttime + prior_offence + speed + 
    bac, family = binomial, data = drinkdriving)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-3.01257  -0.19445  -0.03577  -0.00186   3.15025  

Coefficients:
                         Estimate Std. Error z value Pr(>|z|)    
(Intercept)             -20.72778 4336.30016  -0.005 0.996186    
age                       0.13783    0.03775   3.651 0.000261 ***
nighttimenight            0.69684    0.77689   0.897 0.369742    
prior_offenceCD60        46.80580 7832.51610   0.006 0.995232    
prior_offenceDD20        28.74520 4336.29993   0.007 0.994711    
prior_offenceDR50        20.28837 4336.29936   0.005 0.996267    
prior_offenceDR80        27.37755 4336.29993   0.006 0.994963    
prior_offenceN           22.88474 4336.29925   0.005 0.995789    
prior_offencePL10        20.82691 4336.56089   0.005 0.996168    
prior_offenceSP50        11.17557 6049.48706   0.002 0.998526    
 [ reached getOption("max.print") -- omitted 5 rows ]
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 215.618  on 215  degrees of freedom
Residual deviance:  62.071  on 201  degrees of freedom
AIC: 92.071

Number of Fisher Scoring iterations: 17

exp(confint(drinkdriving_model))
[1] 101
                               2.5 %        97.5 %
(Intercept)                       NA 7.240813e+169
age                     1.073466e+00  1.248003e+00
nighttimenight          4.569734e-01  1.005375e+01
prior_offenceCD60       0.000000e+00            NA
prior_offenceDD20      7.047178e-208            NA
prior_offenceDR50      1.728142e-272            NA
prior_offenceDR80      3.953883e-241            NA
prior_offenceN         2.861461e-284            NA
prior_offencePL10      1.750330e-302            NA
prior_offenceSP50      2.518818e-208 1.945613e+162
prior_offenceSP60       0.000000e+00            NA
prior_offenceTS70      2.281508e-205           Inf
prior_offenceTS70,DR50  0.000000e+00            NA
speed                   7.886287e-01  9.392740e-01
bac                     1.510559e-22  1.738006e-08
drinkdriving_model_scaled <- glm(outcome ~ scale(age) + scale(speed) + 
    scale(bac), data = drinkdriving, family = binomial)
[1] 102
exp(coef(drinkdriving_model_scaled))
[1] 103
 (Intercept)   scale(age) scale(speed)   scale(bac) 
  0.05610737   2.16105715   0.17442209   0.30580760 
summary(drinkdriving_model_scaled)
[1] 104

Call:
glm(formula = outcome ~ scale(age) + scale(speed) + scale(bac), 
    family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.3349  -0.3711  -0.1579  -0.0325   3.5351  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)    
(Intercept)   -2.8805     0.4114  -7.001 2.53e-12 ***
scale(age)     0.7706     0.3359   2.294   0.0218 *  
scale(speed)  -1.7463     0.4239  -4.119 3.80e-05 ***
scale(bac)    -1.1848     0.3038  -3.900 9.60e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 215.62  on 215  degrees of freedom
Residual deviance: 106.24  on 212  degrees of freedom
AIC: 114.24

Number of Fisher Scoring iterations: 7

exp(confint(drinkdriving_model_scaled))
[1] 105
                 2.5 %    97.5 %
(Intercept)  0.0226712 0.1155450
scale(age)   1.1349011 4.2932558
scale(speed) 0.0699028 0.3726272
scale(bac)   0.1607723 0.5341758
drinkdriving_model_scaled_plot <- data.frame(fit = predict(drinkdriving_model_scaled, 
    data = drinkdriving))
[1] 106
drinkdriving_model_scaled_plot$fit_prob <- exp(drinkdriving_model_scaled_plot$fit)/(1 + 
    exp(drinkdriving_model_scaled_plot$fit))
[1] 107
par(mfrow = c(1, 1), mar = c(4, 4, 1, 1))
[1] 108
$mfrow
[1] 2 2

$mar
[1] 2 2 2 2

drinkdriving_model_scaled_plot <- plot(drinkdriving_model_scaled_plot, 
    ylab = "prob of receiving a fine", xlab = "predictors (scaled): age, speed, bac")
[1] 109
drinkdriving_model_without_age <- glm(outcome ~ nighttime + prior_offence + 
    speed + bac, data = drinkdriving, family = binomial)
[1] 110
drinkdriving_model_without_nighttime <- glm(outcome ~ age + prior_offence + 
    speed + bac, data = drinkdriving, family = binomial)
[1] 111
drinkdriving_model_without_prioroffence <- glm(outcome ~ age + 
    nighttime + speed + bac, data = drinkdriving, family = binomial)
[1] 112
drinkdriving_model_without_speed <- glm(outcome ~ age + nighttime + 
    prior_offence + bac, data = drinkdriving, family = binomial)
[1] 113
drinkdriving_model_without_bac <- glm(outcome ~ age + nighttime + 
    prior_offence + speed, data = drinkdriving, family = binomial)
[1] 114
step(drinkdriving_model, direction = "backward")
[1] 115
Start:  AIC=92.07
outcome ~ age + nighttime + prior_offence + speed + bac

                Df Deviance     AIC
- nighttime      1   62.903  90.903
<none>               62.071  92.071
- speed          1   76.582 104.582
- age            1   81.243 109.243
- bac            1   87.543 115.543
- prior_offence 10  106.216 116.216

Step:  AIC=90.9
outcome ~ age + prior_offence + speed + bac

                Df Deviance     AIC
<none>               62.903  90.903
- speed          1   78.391 104.391
- age            1   81.286 107.286
- prior_offence 10  106.244 114.244
- bac            1   88.688 114.688

Call:  glm(formula = outcome ~ age + prior_offence + speed + bac, family = binomial, 
    data = drinkdriving)

Coefficients:
           (Intercept)                     age       prior_offenceCD60       prior_offenceDD20       prior_offenceDR50  
              -20.5376                  0.1330                 46.9866                 29.0036                 20.6900  
     prior_offenceDR80          prior_offenceN       prior_offencePL10       prior_offenceSP50       prior_offenceSP60  
               27.3722                 23.0239                 20.7217                 11.3624                 45.4464  
     prior_offenceTS70  prior_offenceTS70,DR50                   speed                     bac  
                3.5678                 38.9254                 -0.1443                -29.7984  

Degrees of Freedom: 215 Total (i.e. Null);  202 Residual
Null Deviance:	    215.6 
Residual Deviance: 62.9 	AIC: 90.9
par(mfrow = c(2, 2), mar = c(2, 2, 2, 2))
[1] 116
$mfrow
[1] 1 1

$mar
[1] 4 4 1 1

plot(drinkdriving_model, which = c(1:4))
[1] 117
plot(drinkdriving_model_without_nighttime, which = c(1:4))
[1] 118
plot(drinkdriving_model_scaled, which = c(1:4))
[1] 119
drinkdriving$prior_offence_merged <- as.factor(drinkdriving$prior_offence)
[1] 120
levels(drinkdriving$prior_offence_merged) <- list(N = "N", DR50 = c("DR50", 
    "TS70,DR50"), DR80 = c("DR80", "CD60,CD10,DR80"), CD = c("CD10", 
    "CD60", "CD60,CD10,DR80", "CD60,CD60"), PL = c("PL10"), SP = c("SP50", 
    "SP60"), TS = c("TS70", "TS70,DR50"))
[1] 121
summary(drinkdriving$prior_offence_merged)
[1] 122
   N DR50 DR80   CD   PL   SP   TS NA's 
 160   37    4    3    2    3    3    4 
drinkdriving_model_condensed <- glm(outcome ~ age + nighttime + 
    prior_offence_merged + speed + bac, data = drinkdriving, 
    family = binomial)
[1] 123
exp(coef(drinkdriving_model_condensed))
[1] 124
             (Intercept)                      age           nighttimenight prior_offence_mergedDR50 prior_offence_mergedDR80 
            3.477114e+01             1.132480e+00             1.352386e+00             1.028292e-01             7.625539e+01 
  prior_offence_mergedCD   prior_offence_mergedPL   prior_offence_mergedSP   prior_offence_mergedTS                    speed 
            2.477452e-02             1.235406e-01             1.318274e+02             6.588059e-02             8.408140e-01 
                     bac 
            1.744878e-13 
step(drinkdriving_model_scaled)
[1] 125
Start:  AIC=114.24
outcome ~ scale(age) + scale(speed) + scale(bac)

               Df Deviance    AIC
<none>              106.24 114.24
- scale(age)    1   111.77 117.77
- scale(bac)    1   125.86 131.85
- scale(speed)  1   130.99 136.99

Call:  glm(formula = outcome ~ scale(age) + scale(speed) + scale(bac), 
    family = binomial, data = drinkdriving)

Coefficients:
 (Intercept)    scale(age)  scale(speed)    scale(bac)  
     -2.8805        0.7706       -1.7463       -1.1848  

Degrees of Freedom: 215 Total (i.e. Null);  212 Residual
Null Deviance:	    215.6 
Residual Deviance: 106.2 	AIC: 114.2
step(drinkdriving_model_without_speed)
[1] 126
Start:  AIC=104.58
outcome ~ age + nighttime + prior_offence + bac

                Df Deviance    AIC
- nighttime      1   78.391 104.39
<none>               76.582 104.58
- bac            1  102.423 128.42
- prior_offence 10  130.593 138.59
- age            1  145.770 171.77

Step:  AIC=104.39
outcome ~ age + prior_offence + bac

                Df Deviance    AIC
<none>               78.391 104.39
- bac            1  102.699 126.70
- prior_offence 10  130.991 136.99
- age            1  146.365 170.37

Call:  glm(formula = outcome ~ age + prior_offence + bac, family = binomial, 
    data = drinkdriving)

Coefficients:
           (Intercept)                     age       prior_offenceCD60       prior_offenceDD20       prior_offenceDR50  
              -27.7502                  0.1778                 47.4288                 28.3239                 19.7208  
     prior_offenceDR80          prior_offenceN       prior_offencePL10       prior_offenceSP50       prior_offenceSP60  
               27.1360                 22.5680                 20.6237                 11.9179                 44.4195  
     prior_offenceTS70  prior_offenceTS70,DR50                     bac  
                1.6928                 42.7721                -25.7684  

Degrees of Freedom: 215 Total (i.e. Null);  203 Residual
Null Deviance:	    215.6 
Residual Deviance: 78.39 	AIC: 104.4
step(drinkdriving_model_without_age)
[1] 127
Start:  AIC=109.24
outcome ~ nighttime + prior_offence + speed + bac

                Df Deviance    AIC
- nighttime      1   81.286 107.29
<none>               81.243 109.24
- prior_offence 10  111.643 119.64
- bac            1  110.836 136.84
- speed          1  145.770 171.77

Step:  AIC=107.29
outcome ~ prior_offence + speed + bac

                Df Deviance    AIC
<none>               81.286 107.29
- prior_offence 10  111.766 117.77
- bac            1  116.689 140.69
- speed          1  146.365 170.37

Call:  glm(formula = outcome ~ prior_offence + speed + bac, family = binomial, 
    data = drinkdriving)

Coefficients:
           (Intercept)       prior_offenceCD60       prior_offenceDD20       prior_offenceDR50       prior_offenceDR80  
               -8.3492                 40.1003                 23.4476                 18.0237                 21.9905  
        prior_offenceN       prior_offencePL10       prior_offenceSP50       prior_offenceSP60       prior_offenceTS70  
               20.2337                 18.6418                  5.3281                 41.0076                  5.4408  
prior_offenceTS70,DR50                   speed                     bac  
               32.8230                 -0.2201                -29.3904  

Degrees of Freedom: 215 Total (i.e. Null);  203 Residual
Null Deviance:	    215.6 
Residual Deviance: 81.29 	AIC: 107.3
step(drinkdriving_model_without_bac)
[1] 128
Start:  AIC=115.54
outcome ~ age + nighttime + prior_offence + speed

                Df Deviance    AIC
- nighttime      1   88.688 114.69
<none>               87.543 115.54
- speed          1  102.423 128.42
- prior_offence 10  123.722 131.72
- age            1  110.836 136.84

Step:  AIC=114.69
outcome ~ age + prior_offence + speed

                Df Deviance    AIC
<none>               88.688 114.69
- speed          1  102.699 126.70
- prior_offence 10  125.855 131.85
- age            1  116.689 140.69

Call:  glm(formula = outcome ~ age + prior_offence + speed, family = binomial, 
    data = drinkdriving)

Coefficients:
           (Intercept)                     age       prior_offenceCD60       prior_offenceDD20       prior_offenceDR50  
              -23.8644                  0.1314                 40.7939                 24.3956                 17.6268  
     prior_offenceDR80          prior_offenceN       prior_offencePL10       prior_offenceSP50       prior_offenceSP60  
               23.4375                 19.3417                 19.1054                  7.5058                 39.4960  
     prior_offenceTS70  prior_offenceTS70,DR50                   speed  
               -0.5167                 34.3372                 -0.1141  

Degrees of Freedom: 215 Total (i.e. Null);  203 Residual
Null Deviance:	    215.6 
Residual Deviance: 88.69 	AIC: 114.7
step(drinkdriving_model_without_nighttime)
[1] 129
Start:  AIC=90.9
outcome ~ age + prior_offence + speed + bac

                Df Deviance     AIC
<none>               62.903  90.903
- speed          1   78.391 104.391
- age            1   81.286 107.286
- prior_offence 10  106.244 114.244
- bac            1   88.688 114.688

Call:  glm(formula = outcome ~ age + prior_offence + speed + bac, family = binomial, 
    data = drinkdriving)

Coefficients:
           (Intercept)                     age       prior_offenceCD60       prior_offenceDD20       prior_offenceDR50  
              -20.5376                  0.1330                 46.9866                 29.0036                 20.6900  
     prior_offenceDR80          prior_offenceN       prior_offencePL10       prior_offenceSP50       prior_offenceSP60  
               27.3722                 23.0239                 20.7217                 11.3624                 45.4464  
     prior_offenceTS70  prior_offenceTS70,DR50                   speed                     bac  
                3.5678                 38.9254                 -0.1443                -29.7984  

Degrees of Freedom: 215 Total (i.e. Null);  202 Residual
Null Deviance:	    215.6 
Residual Deviance: 62.9 	AIC: 90.9
step(drinkdriving_model_without_prioroffence)
[1] 130
Start:  AIC=116.22
outcome ~ age + nighttime + speed + bac

            Df Deviance    AIC
- nighttime  1   106.24 114.24
<none>           106.22 116.22
- age        1   111.64 119.64
- bac        1   123.72 131.72
- speed      1   130.59 138.59

Step:  AIC=114.24
outcome ~ age + speed + bac

        Df Deviance    AIC
<none>       106.24 114.24
- age    1   111.77 117.77
- bac    1   125.86 131.85
- speed  1   130.99 136.99

Call:  glm(formula = outcome ~ age + speed + bac, family = binomial, 
    data = drinkdriving)

Coefficients:
(Intercept)          age        speed          bac  
    4.82490      0.04589     -0.13799    -19.12884  

Degrees of Freedom: 215 Total (i.e. Null);  212 Residual
Null Deviance:	    215.6 
Residual Deviance: 106.2 	AIC: 114.2
step(drinkdriving_model_without_speed)
[1] 131
Start:  AIC=104.58
outcome ~ age + nighttime + prior_offence + bac

                Df Deviance    AIC
- nighttime      1   78.391 104.39
<none>               76.582 104.58
- bac            1  102.423 128.42
- prior_offence 10  130.593 138.59
- age            1  145.770 171.77

Step:  AIC=104.39
outcome ~ age + prior_offence + bac

                Df Deviance    AIC
<none>               78.391 104.39
- bac            1  102.699 126.70
- prior_offence 10  130.991 136.99
- age            1  146.365 170.37

Call:  glm(formula = outcome ~ age + prior_offence + bac, family = binomial, 
    data = drinkdriving)

Coefficients:
           (Intercept)                     age       prior_offenceCD60       prior_offenceDD20       prior_offenceDR50  
              -27.7502                  0.1778                 47.4288                 28.3239                 19.7208  
     prior_offenceDR80          prior_offenceN       prior_offencePL10       prior_offenceSP50       prior_offenceSP60  
               27.1360                 22.5680                 20.6237                 11.9179                 44.4195  
     prior_offenceTS70  prior_offenceTS70,DR50                     bac  
                1.6928                 42.7721                -25.7684  

Degrees of Freedom: 215 Total (i.e. Null);  203 Residual
Null Deviance:	    215.6 
Residual Deviance: 78.39 	AIC: 104.4
step(drinkdriving_model_condensed)
[1] 132
Start:  AIC=87.57
outcome ~ age + nighttime + prior_offence_merged + speed + bac

                       Df Deviance     AIC
- nighttime             1   65.729  85.729
<none>                      65.566  87.566
- prior_offence_merged  6   83.965  93.965
- age                   1   83.558 103.558
- bac                   1   87.835 107.835
- speed                 1   90.481 110.481

Step:  AIC=85.73
outcome ~ age + prior_offence_merged + speed + bac

                       Df Deviance     AIC
<none>                      65.729  85.729
- prior_offence_merged  6   83.991  91.991
- age                   1   84.122 102.122
- bac                   1   89.828 107.828
- speed                 1   91.559 109.559

Call:  glm(formula = outcome ~ age + prior_offence_merged + speed + 
    bac, family = binomial, data = drinkdriving)

Coefficients:
             (Intercept)                       age  prior_offence_mergedDR50  prior_offence_mergedDR80  
                  3.7136                    0.1224                   -2.1798                    4.2762  
  prior_offence_mergedCD    prior_offence_mergedPL    prior_offence_mergedSP    prior_offence_mergedTS  
                 -3.7957                   -2.2013                    4.7885                   -2.6430  
                   speed                       bac  
                 -0.1758                  -28.4148  

Degrees of Freedom: 211 Total (i.e. Null);  202 Residual
  (4 observations deleted due to missingness)
Null Deviance:	    208.2 
Residual Deviance: 65.73 	AIC: 85.73
drink_offence <- as.character(drinkdriving$prior_offence)
[1] 133
drink_offence[grep("DR50", drink_offence)] <- 1
[1] 134
drink_offence[drink_offence != "N" & drink_offence != 1] <- 0
[1] 135
drink_offence[drink_offence == "N"] <- NA
[1] 136
drinkdriving <- cbind(drinkdriving, drink_offence)
[1] 137
summary(drinkdriving)
[1] 138
 incident_id             age        nighttime   prior_offence          speed            bac             outcome    officer 
 Length:216         Min.   :14.00   day  : 69   Length:216         Min.   : 0.00   Min.   :0.05453   fine   :173   AS:103  
 Class :character   1st Qu.:30.00   night:147   Class :character   1st Qu.:30.12   1st Qu.:0.19019   warning: 43   IT: 55  
 Mode  :character   Median :40.00               Mode  :character   Median :39.18   Median :0.22997                 NP: 58  
                    Mean   :42.63                                  Mean   :38.41   Mean   :0.22800                         
                    3rd Qu.:55.00                                  3rd Qu.:46.52   3rd Qu.:0.26700                         
 prior_offence_merged drink_offence
 N      :160          0   : 18     
 DR50   : 37          1   : 38     
 DR80   :  4          NA's:160     
 CD     :  3                       
 SP     :  3                       
 [ reached getOption("max.print") -- omitted 2 rows ]
drink_offence_frequencies <- xtabs(~outcome + drink_offence, 
    data = drinkdriving)
[1] 139
drink_offence_frequencies

         drink_offence
outcome    0  1
  fine    12 34
  warning  6  4


drinkdriving$outcome <- as.factor(drinkdriving$outcome)
[1] 141
associationTest(formula = ~outcome + drink_offence, data = drinkdriving)
[1] 142

     Chi-square test of categorical association

Variables:   outcome, drink_offence 

Hypotheses: 
   null:        variables are independent of one another
   alternative: some contingency exists between variables

Observed contingency table:
         drink_offence
outcome    0  1
  fine    12 34
  warning  6  4

Expected contingency table under the null hypothesis:
         drink_offence
outcome       0     1
  fine    14.79 31.21
  warning  3.21  6.79

Test results: 
   X-squared statistic:  2.916 
   degrees of freedom:  1 
   p-value:  0.088 

Other information: 
   estimated effect size (Cramer's v):  0.228 
   Yates' continuity correction has been applied
   warning: expected frequencies too small, results may be inaccurate

fisher.test(drink_offence_frequencies)
[1] 143

	Fisher's Exact Test for Count Data

data:  drink_offence_frequencies
p-value = 0.06022
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 0.0424121 1.2216580
sample estimates:
odds ratio 
 0.2425011 

offence <- drinkdriving$prior_offence
[1] 144
which(is.na(drinkdriving$prior_offence))
[1] 145
integer(0)
offence[offence != "N"] <- 0
[1] 146
offence[offence == "N"] <- 1
[1] 147
drinkdriving <- cbind(drinkdriving, offence)
[1] 148
summary(drinkdriving)
[1] 149
 incident_id             age        nighttime   prior_offence          speed            bac             outcome    officer 
 Length:216         Min.   :14.00   day  : 69   Length:216         Min.   : 0.00   Min.   :0.05453   fine   :173   AS:103  
 Class :character   1st Qu.:30.00   night:147   Class :character   1st Qu.:30.12   1st Qu.:0.19019   warning: 43   IT: 55  
 Mode  :character   Median :40.00               Mode  :character   Median :39.18   Median :0.22997                 NP: 58  
                    Mean   :42.63                                  Mean   :38.41   Mean   :0.22800                         
 prior_offence_merged drink_offence offence
 N      :160          0   : 18      0: 56  
 DR50   : 37          1   : 38      1:160  
 DR80   :  4          NA's:160             
 CD     :  3                               
 [ reached getOption("max.print") -- omitted 3 rows ]
table(drinkdriving$offence)
[1] 150

  0   1 
 56 160 
contrasts(drinkdriving$outcome)
[1] 151
        warning
fine          0
warning       1
m_fine_by_offence <- glm(outcome ~ offence, data = drinkdriving, 
    family = binomial)
[1] 152
coef(m_fine_by_offence)
[1] 153
(Intercept)    offence1 
 -1.5260563   0.1783768 
summary(m_fine_by_offence)
[1] 154

Call:
glm(formula = outcome ~ offence, family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.6797  -0.6797  -0.6797  -0.6272   1.8562  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -1.5261     0.3489  -4.374 1.22e-05 ***
offence1      0.1784     0.3999   0.446    0.656    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 215.62  on 215  degrees of freedom
Residual deviance: 215.42  on 214  degrees of freedom
AIC: 219.42

Number of Fisher Scoring iterations: 4

anova(m_fine_by_offence, test = "Chisq")
[1] 155
Analysis of Deviance Table

Model: binomial, link: logit

Response: outcome

Terms added sequentially (first to last)


        Df Deviance Resid. Df Resid. Dev Pr(>Chi)
NULL                      215     215.62         
offence  1  0.20289       214     215.41   0.6524
summary(drinkdriving$age)
[1] 156
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  14.00   30.00   40.00   42.63   55.00   90.00 
drinkdriving$nighttime <- ifelse(drinkdriving$nighttime == "day", 
    0, 1)
[1] 157
drinkdriving$outcome <- ifelse(drinkdriving$outcome == "fine", 
    1, 0)
[1] 158
model_pred_prob_of_outcome <- glm(outcome ~ age + offence + nighttime + 
    speed + bac, data = drinkdriving, family = binomial)
[1] 159
summary(model_pred_prob_of_outcome)
[1] 160

Call:
glm(formula = outcome ~ age + offence + nighttime + speed + bac, 
    family = binomial, data = drinkdriving)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.6056   0.0336   0.1439   0.3888   2.2047  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -4.42971    2.27334  -1.949 0.051350 .  
age         -0.04682    0.02054  -2.280 0.022630 *  
offence1    -0.37610    0.60754  -0.619 0.535884    
nighttime   -0.14089    0.56396  -0.250 0.802727    
speed        0.13554    0.03361   4.033 5.51e-05 ***
bac         19.64392    5.23600   3.752 0.000176 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 215.62  on 215  degrees of freedom
Residual deviance: 105.82  on 210  degrees of freedom
AIC: 117.82

Number of Fisher Scoring iterations: 7

confint(model_pred_prob_of_outcome)
[1] 161
                  2.5 %       97.5 %
(Intercept) -9.10480915 -0.120610293
age         -0.08857410 -0.007031934
offence1    -1.63033298  0.781725189
nighttime   -1.27881263  0.953664127
speed        0.07567349  0.208378023
bac          9.99394167 30.688618031
predict_outcome_by_age <- exp(coef(model_pred_prob_of_outcome)[1] + 
    coef(model_pred_prob_of_outcome)[2] * 14 + coef(model_pred_prob_of_outcome)[3] * 
    0 + coef(model_pred_prob_of_outcome)[4] * 0 + coef(model_pred_prob_of_outcome)[5] * 
    30 + coef(model_pred_prob_of_outcome)[6] * 0)
[1] 162
predict_outcome_by_age_prob <- exp(predict_outcome_by_age)/(1 + 
    exp(predict_outcome_by_age))
[1] 163
predict_outcome_by_age_prob

(Intercept) 
  0.5892691 


function_outcome_by_age <- function(age) {
    outcome <- exp(coef(model_pred_prob_of_outcome)[1] + coef(model_pred_prob_of_outcome)[2] * 
        age + coef(model_pred_prob_of_outcome)[3] * 0 + coef(model_pred_prob_of_outcome)[4] * 
        0 + coef(model_pred_prob_of_outcome)[5] * 30 + coef(model_pred_prob_of_outcome)[6] * 
        0)
    return(exp(outcome)/(1 + exp(outcome)))
}
[1] 165
ages <- seq(14, 90)
[1] 166
outcome_by_age <- sapply(ages, function_outcome_by_age)
[1] 167
outcome_by_age_df <- data.frame(ages = ages, `p()` = outcome_by_age)
[1] 168
summary(outcome_by_age_df)
[1] 169
      ages         p..        
 Min.   :14   Min.   :0.5026  
 1st Qu.:33   1st Qu.:0.5063  
 Median :52   Median :0.5152  
 Mean   :52   Mean   :0.5248  
 3rd Qu.:71   3rd Qu.:0.5370  
 Max.   :90   Max.   :0.5893  
outcome_by_age_df

   ages       p..
1    14 0.5892691
2    15 0.5852670
3    16 0.5814375
4    17 0.5777739
5    18 0.5742699
6    19 0.5709193
7    20 0.5677158
8    21 0.5646536
9    22 0.5617268
10   23 0.5589300
11   24 0.5562576
12   25 0.5537044
13   26 0.5512653
14   27 0.5489355
15   28 0.5467103
16   29 0.5445851
17   30 0.5425557
18   31 0.5406177
19   32 0.5387673
20   33 0.5370005
21   34 0.5353137
22   35 0.5337032
23   36 0.5321658
24   37 0.5306982
25   38 0.5292972
 [ reached 'max' / getOption("max.print") -- omitted 52 rows ]


par(mfrow = c(1, 1), mar = c(5, 5, 1, 1))
[1] 171
$mfrow
[1] 2 2

$mar
[1] 2 2 2 2

plot(outcome_by_age, type = "l", xlab = "age (14-90)", ylab = "probability of receiving a fine", 
    lwd = 2, col = "blue", xaxt = "n")
[1] 172
axis(side = 1, at = seq(14, 90, by = 10))
[1] 173
[1] 14 24 34 44 54 64 74 84
spec_pro <- ggplot(data = drinkdriving, aes(x = age, y = outcome, 
    colour = officer))
[1] 174
spec_pro + geom_jitter() + theme_minimal() + facet_grid(. ~ officer)
[1] 175
age_categories <- cut(x = drinkdriving$age, breaks = 7, labels = c("14-24", 
    "25-35", "36-46", "47-57", "57-67", "68-78", "79-90"))
[1] 176
summary(age_categories)
[1] 177
14-24 25-35 36-46 47-57 57-67 68-78 79-90 
   37    50    44    40    30     9     6 
summary(drinkdriving$officer)
[1] 178
 AS  IT  NP 
103  55  58 
table(drinkdriving$outcome)
[1] 179

  0   1 
 43 173 
outcome_by_officer <- xtabs(~outcome + officer, data = drinkdriving)
[1] 180
outcome_by_age_categories <- xtabs(~outcome + age_categories, 
    data = drinkdriving)
[1] 181
outcome_by_officer_and_age_categories <- xtabs(~outcome + age_categories + 
    officer, data = drinkdriving)
[1] 182
officer_tables <- table(drinkdriving$outcome, age_categories, 
    data = drinkdriving$officer)
[1] 183
drinkdriving$outcome <- as.factor(drinkdriving$outcome)
[1] 184
chisq.test(outcome_by_officer)
[1] 185

	Pearson's Chi-squared test

data:  outcome_by_officer
X-squared = 0.39944, df = 2, p-value = 0.819

fisher.test(outcome_by_officer)
[1] 186

	Fisher's Exact Test for Count Data

data:  outcome_by_officer
p-value = 0.8179
alternative hypothesis: two.sided

associationTest(formula = ~outcome + officer, data = drinkdriving[drinkdriving$age < 
    24, ])
[1] 187

     Chi-square test of categorical association

Variables:   outcome, officer 

Hypotheses: 
   null:        variables are independent of one another
   alternative: some contingency exists between variables

Observed contingency table:
       officer
outcome AS IT NP
      0  0  0  1
      1 19  5  5

Expected contingency table under the null hypothesis:
       officer
outcome     AS    IT  NP
      0  0.633 0.167 0.2
      1 18.367 4.833 5.8

Test results: 
   X-squared statistic:  4.138 
   degrees of freedom:  2 
   p-value:  0.126 

Other information: 
   estimated effect size (Cramer's v):  0.371 
   warning: expected frequencies too small, results may be inaccurate

age_group_1 <- xtabs(~outcome + officer, data = drinkdriving[drinkdriving$age < 
    24, ])
[1] 188
fisher.test(age_group_1)
[1] 189

	Fisher's Exact Test for Count Data

data:  age_group_1
p-value = 0.3667
alternative hypothesis: two.sided

associationTest(formula = ~outcome + officer, data = drinkdriving[drinkdriving$age > 
    24 & drinkdriving$age <= 35, ])
[1] 190

     Chi-square test of categorical association

Variables:   outcome, officer 

Hypotheses: 
   null:        variables are independent of one another
   alternative: some contingency exists between variables

Observed contingency table:
       officer
outcome AS IT NP
      0  0  1  1
      1 26 11 11

Expected contingency table under the null hypothesis:
       officer
outcome    AS    IT    NP
      0  1.04  0.48  0.48
      1 24.96 11.52 11.52

Test results: 
   X-squared statistic:  2.257 
   degrees of freedom:  2 
   p-value:  0.324 

Other information: 
   estimated effect size (Cramer's v):  0.212 
   warning: expected frequencies too small, results may be inaccurate

age_group_2 <- xtabs(~outcome + officer, data = drinkdriving[drinkdriving$age > 
    24 & drinkdriving$age <= 35, ])
[1] 191
fisher.test(age_group_2)
[1] 192

	Fisher's Exact Test for Count Data

data:  age_group_2
p-value = 0.2253
alternative hypothesis: two.sided

associationTest(formula = ~outcome + officer, data = drinkdriving[drinkdriving$age > 
    35 & drinkdriving$age <= 46, ])
[1] 193

     Chi-square test of categorical association

Variables:   outcome, officer 

Hypotheses: 
   null:        variables are independent of one another
   alternative: some contingency exists between variables

Observed contingency table:
       officer
outcome AS IT NP
      0  1  0  0
      1 19 12 12

Expected contingency table under the null hypothesis:
       officer
outcome     AS     IT     NP
      0  0.455  0.273  0.273
      1 19.545 11.727 11.727

Test results: 
   X-squared statistic:  1.228 
   degrees of freedom:  2 
   p-value:  0.541 

Other information: 
   estimated effect size (Cramer's v):  0.167 
   warning: expected frequencies too small, results may be inaccurate

age_group_3 <- xtabs(~outcome + officer, data = drinkdriving[drinkdriving$age > 
    35 & drinkdriving$age <= 46, ])
[1] 194
fisher.test(age_group_3)
[1] 195

	Fisher's Exact Test for Count Data

data:  age_group_3
p-value = 1
alternative hypothesis: two.sided

associationTest(formula = ~outcome + officer, data = drinkdriving[drinkdriving$age > 
    46 & drinkdriving$age <= 57, ])
[1] 196

     Chi-square test of categorical association

Variables:   outcome, officer 

Hypotheses: 
   null:        variables are independent of one another
   alternative: some contingency exists between variables

Observed contingency table:
       officer
outcome AS IT NP
      0  3  4  2
      1  8 11 12

Expected contingency table under the null hypothesis:
       officer
outcome   AS    IT    NP
      0 2.48  3.38  3.15
      1 8.53 11.62 10.85

Test results: 
   X-squared statistic:  0.835 
   degrees of freedom:  2 
   p-value:  0.659 

Other information: 
   estimated effect size (Cramer's v):  0.144 
   warning: expected frequencies too small, results may be inaccurate

age_group_4 <- xtabs(~outcome + officer, data = drinkdriving[drinkdriving$age > 
    46 & drinkdriving$age <= 57, ])
[1] 197
fisher.test(age_group_4)
[1] 198

	Fisher's Exact Test for Count Data

data:  age_group_4
p-value = 0.7085
alternative hypothesis: two.sided

associationTest(formula = ~outcome + officer, data = drinkdriving[drinkdriving$age > 
    57 & drinkdriving$age <= 67, ])
[1] 199

     Chi-square test of categorical association

Variables:   outcome, officer 

Hypotheses: 
   null:        variables are independent of one another
   alternative: some contingency exists between variables

Observed contingency table:
       officer
outcome AS IT NP
      0 10  4  3
      1  3  2  4

Expected contingency table under the null hypothesis:
       officer
outcome  AS   IT   NP
      0 8.5 3.92 4.58
      1 4.5 2.08 2.42

Test results: 
   X-squared statistic:  2.339 
   degrees of freedom:  2 
   p-value:  0.311 

Other information: 
   estimated effect size (Cramer's v):  0.3 
   warning: expected frequencies too small, results may be inaccurate

age_group_5 <- xtabs(~outcome + officer, data = drinkdriving[drinkdriving$age > 
    57 & drinkdriving$age <= 67, ])
[1] 200
fisher.test(age_group_5)
[1] 201

	Fisher's Exact Test for Count Data

data:  age_group_5
p-value = 0.3189
alternative hypothesis: two.sided

associationTest(formula = ~outcome + officer, data = drinkdriving[drinkdriving$age > 
    67 & drinkdriving$age <= 78, ])
[1] 202

     Chi-square test of categorical association

Variables:   outcome, officer 

Hypotheses: 
   null:        variables are independent of one another
   alternative: some contingency exists between variables

Observed contingency table:
       officer
outcome AS IT NP
      0  4  0  3
      1  3  1  2

Expected contingency table under the null hypothesis:
       officer
outcome   AS    IT   NP
      0 3.77 0.538 2.69
      1 3.23 0.462 2.31

Test results: 
   X-squared statistic:  1.273 
   degrees of freedom:  2 
   p-value:  0.529 

Other information: 
   estimated effect size (Cramer's v):  0.313 
   warning: expected frequencies too small, results may be inaccurate

age_group_6 <- xtabs(~outcome + officer, data = drinkdriving[drinkdriving$age > 
    67 & drinkdriving$age <= 78, ])
[1] 203
fisher.test(age_group_6)
[1] 204

	Fisher's Exact Test for Count Data

data:  age_group_6
p-value = 1
alternative hypothesis: two.sided

associationTest(formula = ~outcome + officer, data = drinkdriving[drinkdriving$age > 
    78 & drinkdriving$age <= 90, ])
[1] 205

     Chi-square test of categorical association

Variables:   outcome, officer 

Hypotheses: 
   null:        variables are independent of one another
   alternative: some contingency exists between variables

Observed contingency table:
       officer
outcome AS IT NP
      0  3  2  0
      1  0  1  0

Expected contingency table under the null hypothesis:
       officer
outcome  AS  IT NP
      0 2.5 2.5  0
      1 0.5 0.5  0

Test results: 
   X-squared statistic:  NaN 
   degrees of freedom:  2 
   p-value:  NA 

Other information: 
   estimated effect size (Cramer's v):  NaN 
   warning: expected frequencies too small, results may be inaccurate

age_group_7 <- xtabs(~outcome + officer, data = drinkdriving[drinkdriving$age > 
    78 & drinkdriving$age <= 90, ])
[1] 206
fisher.test(age_group_7)
[1] 207

	Fisher's Exact Test for Count Data

data:  age_group_7
p-value = 1
alternative hypothesis: two.sided

