

	####### B081864 R script #######

setwd("/cloud/project")
[1] 1
data <- read.csv("../RMS2_report_1920.csv")
[1] 2
library(car, quietly = T)
[1] 3
 [1] "car"       "carData"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[10] "base"     
library(ggpubr, quietly = T)
[1] 4
 [1] "ggpubr"    "magrittr"  "ggplot2"   "car"       "carData"   "readr"     "stats"     "graphics"  "grDevices"
[10] "utils"     "datasets"  "methods"   "base"     
library(psych, quietly = T)
[1] 5
 [1] "psych"     "ggpubr"    "magrittr"  "ggplot2"   "car"       "carData"   "readr"     "stats"     "graphics" 
[10] "grDevices" "utils"     "datasets"  "methods"   "base"     
library(jtools, quietly = T)
[1] 6
 [1] "jtools"    "psych"     "ggpubr"    "magrittr"  "ggplot2"   "car"       "carData"   "readr"     "stats"    
[10] "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(interactions, quietly = T)
[1] 7
 [1] "interactions" "jtools"       "psych"        "ggpubr"       "magrittr"     "ggplot2"      "car"         
 [8] "carData"      "readr"        "stats"        "graphics"     "grDevices"    "utils"        "datasets"    
[15] "methods"      "base"        
library(lsr, quietly = T)
[1] 8
 [1] "lsr"          "interactions" "jtools"       "psych"        "ggpubr"       "magrittr"     "ggplot2"     
 [8] "car"          "carData"      "readr"        "stats"        "graphics"     "grDevices"    "utils"       
[15] "datasets"     "methods"      "base"        
library(emmeans, quietly = T)
[1] 9
 [1] "emmeans"      "lsr"          "interactions" "jtools"       "psych"        "ggpubr"       "magrittr"    
 [8] "ggplot2"      "car"          "carData"      "readr"        "stats"        "graphics"     "grDevices"   
[15] "utils"        "datasets"     "methods"      "base"        
library(effects, quietly = T)
[1] 10
 [1] "effects"      "emmeans"      "lsr"          "interactions" "jtools"       "psych"        "ggpubr"      
 [8] "magrittr"     "ggplot2"      "car"          "carData"      "readr"        "stats"        "graphics"    
[15] "grDevices"    "utils"        "datasets"     "methods"      "base"        
describe(data)
[1] 11
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training     3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
max(data$incidents)
[1] 12
[1] 0.9166667
min(data$incidents)
[1] 13
[1] 0.08333333
max(data$training)
[1] 14
[1] 2
min(data$training)
[1] 15
[1] 1
max(data$feedback)
[1] 16
[1] 2
min(data$feedback)
[1] 17
[1] 1
max(data$empathy)
[1] 18
[1] 16
min(data$empathy)
[1] 19
[1] 3
max(data$years)
[1] 20
[1] 19
min(data$years)
[1] 21
[1] 1
str(data)
[1] 22
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : int  2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : int  2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
class(data$incidents)
[1] 23
[1] "numeric"
class(data$feedback)
[1] 24
[1] "integer"
class(data$years)
[1] 25
[1] "integer"
class(data$training)
[1] 26
[1] "integer"
class(data$empathy)
[1] 27
[1] "integer"
data$training <- as.factor(data$training)
[1] 28
data$feedback <- as.factor(data$feedback)
[1] 29
str(data)
[1] 30
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : Factor w/ 2 levels "1","2": 2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : Factor w/ 2 levels "1","2": 2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
data$empathy_m <- data$empathy - mean(data$empathy)
[1] 31
m0 <- lm(data$empathy_m ~ data$years)
[1] 32
summary(m0)
[1] 33

Call:
lm(formula = data$empathy_m ~ data$years)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) -1.76875    0.49085  -3.603 0.000397 ***
data$years   0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

cooks0 <- cooks.distance(m0)
[1] 34
names(which(cooks0 > (4/198)))
[1] 35
 [1] "16"  "61"  "88"  "89"  "94"  "108" "137" "141" "154" "163" "171" "175" "192" "200"
plot(m0, which = 4)
[1] 36
qqPlot(m0)
[1] 37
hist(m0$residuals, xlab = "x", main = "Histogram of Normality")
[1] 38
shapiro.test(m0$residuals)
[1] 39

	Shapiro-Wilk normality test

data:  m0$residuals
W = 0.98911, p-value = 0.1321

residualPlots(m0)
[1] 40
ncvTest(m0)
[1] 41
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.9815033, Df = 1, p = 0.32183
durbinWatsonTest(m0)
[1] 42
 lag Autocorrelation D-W Statistic p-value
   1       0.1017162      1.769879     0.1
 Alternative hypothesis: rho != 0
crPlots(m0)
[1] 43
m0_poly <- lm(data$empathy_m ~ poly(data$years, 2))
[1] 44
summary(m0_poly)
[1] 45

Call:
lm(formula = data$empathy_m ~ poly(data$years, 2))

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
                       Estimate Std. Error t value Pr(>|t|)    
(Intercept)          -6.843e-16  1.392e-01    0.00        1    
poly(data$years, 2)1  9.450e+00  1.969e+00    4.80 3.13e-06 ***
poly(data$years, 2)2 -2.069e+01  1.969e+00  -10.51  < 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

crPlots(m0_poly)
[1] 46
residualPlots(m0_poly)
[1] 47
summary(m0_poly)
[1] 48

Call:
lm(formula = data$empathy_m ~ poly(data$years, 2))

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
                       Estimate Std. Error t value Pr(>|t|)    
(Intercept)          -6.843e-16  1.392e-01    0.00        1    
poly(data$years, 2)1  9.450e+00  1.969e+00    4.80 3.13e-06 ***
poly(data$years, 2)2 -2.069e+01  1.969e+00  -10.51  < 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

contrasts(data$training)
[1] 49
  2
1 0
2 1
m1 <- lm(data$incidents ~ data$training + data$empathy_m + data$years)
[1] 50
summary(m1)
[1] 51

Call:
lm(formula = data$incidents ~ data$training + data$empathy_m + 
    data$years)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.665721   0.036551  18.214  < 2e-16 ***
data$training2 -0.152427   0.023166  -6.580 4.20e-10 ***
data$empathy_m  0.025396   0.004735   5.363 2.29e-07 ***
data$years     -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

cooks <- cooks.distance(m1)
[1] 52
names(which(cooks > (4/196)))
[1] 53
[1] "13"  "35"  "74"  "137" "165"
plot(m1, which = 4)
[1] 54
qqPlot(m1)
[1] 55
hist(m1$residuals, xlab = "x", main = "Histogram of Normality")
[1] 56
shapiro.test(m1$residuals)
[1] 57

	Shapiro-Wilk normality test

data:  m1$residuals
W = 0.97994, p-value = 0.005838

residualPlots(m1)
[1] 58
ncvTest(m1)
[1] 59
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0293323, Df = 1, p = 0.86401
crPlots(m1)
[1] 60
durbinWatsonTest(m1)
[1] 61
 lag Autocorrelation D-W Statistic p-value
   1      -0.1072849      2.199897   0.172
 Alternative hypothesis: rho != 0
vif(m1)
[1] 62
 data$training data$empathy_m     data$years 
      1.020633       1.092467       1.085089 
data$logincidents <- log(data$incidents + 1)
[1] 63
m1a <- lm(data$logincidents ~ data$training + data$empathy_m + 
    data$years)
[1] 64
summary(m1a)
[1] 65

Call:
lm(formula = data$logincidents ~ data$training + data$empathy_m + 
    data$years)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.25974 -0.08206 -0.00301  0.07026  0.33183 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.511876   0.024544  20.856  < 2e-16 ***
data$training2 -0.104810   0.015556  -6.737 1.75e-10 ***
data$empathy_m  0.017470   0.003180   5.494 1.21e-07 ***
data$years     -0.009683   0.002611  -3.708 0.000272 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1089 on 196 degrees of freedom
Multiple R-squared:  0.2657,	Adjusted R-squared:  0.2544 
F-statistic: 23.63 on 3 and 196 DF,  p-value: 4.229e-13

qqPlot(m1a)
[1] 66
hist(m1a$residuals, xlab = "x", main = "Log Transformed")
[1] 67
shapiro.test(m1a$residuals)
[1] 68

	Shapiro-Wilk normality test

data:  m1a$residuals
W = 0.9901, p-value = 0.1845

m2 <- lm(data$incidents ~ data$empathy_m + data$years + data$feedback)
[1] 69
summary(m2)
[1] 70

Call:
lm(formula = data$incidents ~ data$empathy_m + data$years + data$feedback)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.512093   0.035846  14.286  < 2e-16 ***
data$empathy_m  0.023187   0.004829   4.802 3.11e-06 ***
data$years     -0.012689   0.003975  -3.192  0.00165 ** 
data$feedback2  0.132132   0.023585   5.602 7.09e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

contrasts(data$feedback)
[1] 71
  2
1 0
2 1
cooks1 <- cooks.distance(m2)
[1] 72
names(which(cooks1 > (4/196)))
[1] 73
[1] "73"  "74"  "89"  "137" "156" "160" "165" "176"
plot(m2, which = 4)
[1] 74
qqPlot(m2)
[1] 75
hist(m2$residuals, xlab = "x", main = "Histogram of Normality")
[1] 76
shapiro.test(m2$residuals)
[1] 77

	Shapiro-Wilk normality test

data:  m2$residuals
W = 0.98772, p-value = 0.08174

residualPlots(m2)
[1] 78
ncvTest(m2)
[1] 79
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.01731234, Df = 1, p = 0.89532
crPlots(m2)
[1] 80
durbinWatsonTest(m2)
[1] 81
 lag Autocorrelation D-W Statistic p-value
   1       0.2738264      1.444081       0
 Alternative hypothesis: rho != 0
vif(m2)
[1] 82
data$empathy_m     data$years  data$feedback 
      1.079397       1.077467       1.005211 
m2a1 <- lm(data$incidents ~ data$feedback + data$empathy_m + 
    data$years + data$training)
[1] 83
summary(m2a1)
[1] 84

Call:
lm(formula = data$incidents ~ data$feedback + data$empathy_m + 
    data$years + data$training)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.31626 -0.10096 -0.00949  0.09165  0.46650 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.608620   0.034515  17.634  < 2e-16 ***
data$feedback2  0.133715   0.020968   6.377 1.28e-09 ***
data$empathy_m  0.027191   0.004328   6.283 2.12e-09 ***
data$years     -0.015199   0.003551  -4.281 2.92e-05 ***
data$training2 -0.153824   0.021128  -7.281 7.98e-12 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1479 on 195 degrees of freedom
Multiple R-squared:  0.3848,	Adjusted R-squared:  0.3721 
F-statistic: 30.49 on 4 and 195 DF,  p-value: < 2.2e-16

qqPlot(m2a1)
[1] 85
hist(m2a1$residuals)
[1] 86
shapiro.test(m2a1$residuals)
[1] 87

	Shapiro-Wilk normality test

data:  m2a1$residuals
W = 0.98734, p-value = 0.07172

residualPlots(m2a1)
[1] 88
ncvTest(m2a1)
[1] 89
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 3.684027, Df = 1, p = 0.054936
crPlots(m2a1)
[1] 90
durbinWatsonTest(m2a1)
[1] 91
 lag Autocorrelation D-W Statistic p-value
   1      0.07303546      1.841386   0.268
 Alternative hypothesis: rho != 0
summary(m2a1)
[1] 92

Call:
lm(formula = data$incidents ~ data$feedback + data$empathy_m + 
    data$years + data$training)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.31626 -0.10096 -0.00949  0.09165  0.46650 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.608620   0.034515  17.634  < 2e-16 ***
data$feedback2  0.133715   0.020968   6.377 1.28e-09 ***
data$empathy_m  0.027191   0.004328   6.283 2.12e-09 ***
data$years     -0.015199   0.003551  -4.281 2.92e-05 ***
data$training2 -0.153824   0.021128  -7.281 7.98e-12 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1479 on 195 degrees of freedom
Multiple R-squared:  0.3848,	Adjusted R-squared:  0.3721 
F-statistic: 30.49 on 4 and 195 DF,  p-value: < 2.2e-16

AIC(m1, m2)
[1] 93
   df       AIC
m1  5 -154.1654
m2  5 -143.9591
BIC(m1, m2)
[1] 94
   df       BIC
m1  5 -137.6738
m2  5 -127.4675
m3 <- lm(data$incidents ~ data$empathy_m + data$years + data$feedback * 
    data$training)
[1] 95
summary(m3)
[1] 96

Call:
lm(formula = data$incidents ~ data$empathy_m + data$years + data$feedback * 
    data$training)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30367 -0.10365 -0.00795  0.08806  0.44359 

Coefficients:
                               Estimate Std. Error t value Pr(>|t|)    
(Intercept)                    0.637438   0.036309  17.556  < 2e-16 ***
data$empathy_m                 0.028695   0.004328   6.630 3.25e-10 ***
data$years                    -0.015720   0.003518  -4.468 1.34e-05 ***
data$feedback2                 0.085558   0.029299   2.920  0.00391 ** 
data$training2                -0.203496   0.029874  -6.812 1.18e-10 ***
data$feedback2:data$training2  0.097334   0.041840   2.326  0.02103 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1462 on 194 degrees of freedom
Multiple R-squared:  0.4015,	Adjusted R-squared:  0.386 
F-statistic: 26.02 on 5 and 194 DF,  p-value: < 2.2e-16

cooks2 <- cooks.distance(m3)
[1] 97
names(which(cooks2 > (4/197)))
[1] 98
 [1] "13"  "73"  "74"  "89"  "117" "137" "160" "165" "176" "181"
plot(m3, which = 4)
[1] 99
qqPlot(m3)
[1] 100
hist(m3$residuals, xlab = "x", main = "Histogram of Normality")
[1] 101
shapiro.test(m3$residuals)
[1] 102

	Shapiro-Wilk normality test

data:  m3$residuals
W = 0.98794, p-value = 0.08817

residualPlots(m3)
[1] 103
ncvTest(m3)
[1] 104
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 4.398557, Df = 1, p = 0.035969
durbinWatsonTest(m3)
[1] 105
 lag Autocorrelation D-W Statistic p-value
   1      0.09456969      1.801048   0.222
 Alternative hypothesis: rho != 0
vif(m3)
[1] 106
             data$empathy_m                  data$years               data$feedback               data$training 
                   1.122147                    1.092150                    2.007327                    2.086826 
data$feedback:data$training 
                   3.070068 
with(data, tapply(incidents, list(training = training, feedback = feedback), 
    mean))
[1] 107
        feedback
training         1         2
       1 0.4933333 0.5900000
       2 0.3333333 0.4833333
m3a <- lm(incidents ~ empathy_m + years + feedback * training, 
    data = data)
[1] 108
summary(m3a)
[1] 109

Call:
lm(formula = incidents ~ empathy_m + years + feedback * training, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30367 -0.10365 -0.00795  0.08806  0.44359 

Coefficients:
                     Estimate Std. Error t value Pr(>|t|)    
(Intercept)          0.637438   0.036309  17.556  < 2e-16 ***
empathy_m            0.028695   0.004328   6.630 3.25e-10 ***
years               -0.015720   0.003518  -4.468 1.34e-05 ***
feedback2            0.085558   0.029299   2.920  0.00391 ** 
training2           -0.203496   0.029874  -6.812 1.18e-10 ***
feedback2:training2  0.097334   0.041840   2.326  0.02103 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1462 on 194 degrees of freedom
Multiple R-squared:  0.4015,	Adjusted R-squared:  0.386 
F-statistic: 26.02 on 5 and 194 DF,  p-value: < 2.2e-16

effect("feedback*training", m3a)
[1] 110

 feedback*training effect
        training
feedback         1         2
       1 0.5096358 0.3061393
       2 0.5951938 0.4890311
emmip(m3a, feedback ~ training)
[1] 111
