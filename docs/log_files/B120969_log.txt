

	####### B120969 R script #######

setwd("C:/Users/Lenovo/Desktop/uni/R/packages")
[1] 1
library(psych, quietly = T)
[1] 2
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 3
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[10] "methods"   "base"     
library(interactions, quietly = T)
[1] 4
 [1] "interactions" "car"          "carData"      "psych"        "readr"        "stats"        "graphics"    
 [8] "grDevices"    "utils"        "datasets"     "methods"      "base"        
data <- read.csv("../RMS2_report_1920.csv")
[1] 5
describe(data)
[1] 6
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training     3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
which(data$empathy > 20 | data$empathy < 1)
[1] 7
integer(0)
which(data$years > 30 | data$years < 0)
[1] 8
integer(0)
skew(data$incidents)
[1] 9
[1] 0.3221457
skew(data$empathy)
[1] 10
[1] -0.371876
skew(data$years)
[1] 11
[1] 0.516562
hist(data$years)
[1] 12
plot(density(data$years))
[1] 13
skew(data$years)
[1] 14
[1] 0.516562
data$log.years <- log(data$years + (-1 * min(data$years) + 1))
[1] 15
skew(data$log.years)
[1] 16
[1] -1.284774
data$subject <- as.factor(data$subject)
[1] 17
data$training <- factor(data$training, labels = c("0", "1"))
[1] 18
data$feedback <- factor(data$feedback, labels = c("0", "1"))
[1] 19
data$empathy.min <- data$empathy - min(data$empathy)
[1] 20
EElm <- lm(empathy.min ~ years, data = data)
[1] 21
summary(EElm)
[1] 22

Call:
lm(formula = empathy.min ~ years, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  5.40625    0.49085  11.014  < 2e-16 ***
years        0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

qqPlot(EElm)
[1] 23
hist(EElm$residuals)
[1] 24
shapiro.test(EElm$residuals)
[1] 25

	Shapiro-Wilk normality test

data:  EElm$residuals
W = 0.98911, p-value = 0.1321

residualPlots(EElm)
[1] 26
plot(empathy.min ~ years, data, main = "Relationship between empathy and experience", 
    xlab = "Years of experience", ylab = "Empathy score")
[1] 27
abline(lm(empathy.min ~ years, data))
[1] 28
lines(lowess(data$years, data$empathy.min), col = "red")
[1] 29
plot(x = EElm$residuals, y = data$years)
[1] 30
EElm2 <- lm(empathy.min ~ years + I(years^2), data = data)
[1] 31
summary(EElm2)
[1] 32

Call:
lm(formula = empathy.min ~ years + I(years^2), data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept) -1.813644   0.791848   -2.29   0.0231 *  
years        2.068508   0.181845   11.38   <2e-16 ***
I(years^2)  -0.103645   0.009861  -10.51   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

2.068508 - 0.103645
[1] 33
[1] 1.964863
plot(empathy.min ~ years, data, main = "Relationship between empathy and experience", 
    xlab = "Years of experience", ylab = "Empathy score")
[1] 34
lines(lowess(data$years, data$empathy.min))
[1] 35
qqPlot(EElm2)
[1] 36
hist(EElm2$residuals)
[1] 37
residualPlots(EElm2)
[1] 38
crPlots(EElm2)
[1] 39
plot(x = EElm2$residuals, y = data$years)
[1] 40
plot(x = EElm2$residuals, y = data$years^2)
[1] 41
cutoff <- 4/(200 - 1 - 1)
[1] 42
plot(EElm2, which = 4, cook.levels = cutoff)
[1] 43
data.c <- data[-154, ]
[1] 44
EElm2.2 <- lm(empathy.min ~ years + I(years^2), data = data.c)
[1] 45
summary(EElm2.2)
[1] 46

Call:
lm(formula = empathy.min ~ years + I(years^2), data = data.c)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5194 -1.3712  0.0603  1.2385  6.0603 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) -2.12784    0.83682  -2.543   0.0118 *  
years        2.16230    0.19908  10.861   <2e-16 ***
I(years^2)  -0.10976    0.01119  -9.809   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.967 on 196 degrees of freedom
Multiple R-squared:  0.3953,	Adjusted R-squared:  0.3891 
F-statistic: 64.05 on 2 and 196 DF,  p-value: < 2.2e-16

m1 <- lm(incidents ~ empathy.min + years, data = data)
[1] 47
summary(m1)
[1] 48

Call:
lm(formula = incidents ~ empathy.min + years, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.41333 -0.11682 -0.02057  0.10135  0.46713 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.415492   0.045408   9.150  < 2e-16 ***
empathy.min  0.021449   0.005177   4.143 5.08e-05 ***
years       -0.011610   0.004266  -2.722  0.00708 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1787 on 197 degrees of freedom
Multiple R-squared:  0.09222,	Adjusted R-squared:  0.08301 
F-statistic: 10.01 on 2 and 197 DF,  p-value: 7.259e-05

m1a <- lm(incidents ~ empathy.min + years + training, data = data)
[1] 49
summary(m1a)
[1] 50

Call:
lm(formula = incidents ~ empathy.min + years + training, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.483507   0.042477  11.383  < 2e-16 ***
empathy.min  0.025396   0.004735   5.363 2.29e-07 ***
years       -0.014085   0.003889  -3.622 0.000372 ***
training1   -0.152427   0.023166  -6.580 4.20e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

sum(is.na(data$empathy.min))
[1] 51
[1] 0
sum(is.na(data$years))
[1] 52
[1] 0
sum(is.na(data$training))
[1] 53
[1] 0
sum(is.na(data$incidents))
[1] 54
[1] 0
anova(m1, m1a)
[1] 55
Analysis of Variance Table

Model 1: incidents ~ empathy.min + years
Model 2: incidents ~ empathy.min + years + training
  Res.Df    RSS Df Sum of Sq      F  Pr(>F)    
1    197 6.2914                                
2    196 5.1532  1    1.1382 43.292 4.2e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
qqPlot(m1a)
[1] 56
hist(m1a$residuals)
[1] 57
shapiro.test(m1a$residuals)
[1] 58

	Shapiro-Wilk normality test

data:  m1a$residuals
W = 0.97994, p-value = 0.005838

residualPlots(m1a)
[1] 59
crPlots(m1a)
[1] 60
par(mfrow = c(2, 2))
[1] 61
$mfrow
[1] 1 1

plot(x = m1a$residuals, y = data$empathy.min)
[1] 62
plot(x = m1a$residuals, y = data$years)
[1] 63
plot(x = m1a$residuals, y = data$training)
[1] 64
plot(x = m1a$residuals, y = data$feedback)
[1] 65
par(mfrow = c(1, 1))
[1] 66
$mfrow
[1] 2 2

cutoff2 <- 4/(200 - 3 - 1)
[1] 67
plot(m1a, which = 4, cook.levels = cutoff2)
[1] 68
data.c2 <- data[-137, ]
[1] 69
m1a.2 <- lm(incidents ~ empathy.min + years + training, data = data.c2)
[1] 70
summary(m1a.2)
[1] 71

Call:
lm(formula = incidents ~ empathy.min + years + training, data = data.c2)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.36356 -0.12093 -0.01069  0.09901  0.53229 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.485562   0.042251  11.492  < 2e-16 ***
empathy.min  0.026977   0.004789   5.633 6.13e-08 ***
years       -0.016009   0.004011  -3.991 9.30e-05 ***
training1   -0.150984   0.023048  -6.551 4.97e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1612 on 195 degrees of freedom
Multiple R-squared:  0.2674,	Adjusted R-squared:  0.2561 
F-statistic: 23.73 on 3 and 195 DF,  p-value: 3.911e-13

m1b <- lm(incidents ~ empathy.min + years + feedback, data = data)
[1] 72
summary(m1b)
[1] 73

Call:
lm(formula = incidents ~ empathy.min + years + feedback, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.345723   0.044062   7.846 2.71e-13 ***
empathy.min  0.023187   0.004829   4.802 3.11e-06 ***
years       -0.012689   0.003975  -3.192  0.00165 ** 
feedback1    0.132132   0.023585   5.602 7.09e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

sum(is.na(data$feedback))
[1] 74
[1] 0
anova(m1, m1b)
[1] 75
Analysis of Variance Table

Model 1: incidents ~ empathy.min + years
Model 2: incidents ~ empathy.min + years + feedback
  Res.Df    RSS Df Sum of Sq      F   Pr(>F)    
1    197 6.2914                                 
2    196 5.4230  1   0.86841 31.387 7.09e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
par(mfrow = c(1, 1))
[1] 76
$mfrow
[1] 1 1

qqPlot(m1b)
[1] 77
hist(m1b$residuals)
[1] 78
residualPlots(m1b)
[1] 79
ncvTest(m1b)
[1] 80
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.01731234, Df = 1, p = 0.89532
crPlots(m1b)
[1] 81
par(mfrow = c(2, 2))
[1] 82
$mfrow
[1] 1 1

plot(x = m1b$residuals, y = data$empathy.min)
[1] 83
plot(x = m1b$residuals, y = data$years)
[1] 84
plot(x = m1b$residuals, y = data$training)
[1] 85
plot(x = m1b$residuals, y = data$feedback)
[1] 86
par(mfrow = c(1, 1))
[1] 87
$mfrow
[1] 2 2

plot(m1b, which = 4, cook.levels = cutoff2)
[1] 88
m1b.2 <- lm(incidents ~ empathy.min + years + feedback, data = data.c2)
[1] 89
summary(m1b.2)
[1] 90

Call:
lm(formula = incidents ~ empathy.min + years + feedback, data = data.c2)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.36297 -0.11299 -0.00704  0.11578  0.53962 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.349429   0.043915   7.957 1.41e-13 ***
empathy.min  0.024705   0.004891   5.051 1.01e-06 ***
years       -0.014532   0.004107  -3.538 0.000503 ***
feedback1    0.129996   0.023511   5.529 1.02e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1656 on 195 degrees of freedom
Multiple R-squared:  0.2273,	Adjusted R-squared:  0.2154 
F-statistic: 19.12 on 3 and 195 DF,  p-value: 6.517e-11

summary(m1a)
[1] 91

Call:
lm(formula = incidents ~ empathy.min + years + training, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.483507   0.042477  11.383  < 2e-16 ***
empathy.min  0.025396   0.004735   5.363 2.29e-07 ***
years       -0.014085   0.003889  -3.622 0.000372 ***
training1   -0.152427   0.023166  -6.580 4.20e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

summary(m1b)
[1] 92

Call:
lm(formula = incidents ~ empathy.min + years + feedback, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.345723   0.044062   7.846 2.71e-13 ***
empathy.min  0.023187   0.004829   4.802 3.11e-06 ***
years       -0.012689   0.003975  -3.192  0.00165 ** 
feedback1    0.132132   0.023585   5.602 7.09e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

lmI <- lm(incidents ~ empathy.min + years + training + feedback + 
    training:feedback, data = data)
[1] 93
summary(lmI)
[1] 94

Call:
lm(formula = incidents ~ empathy.min + years + training + feedback + 
    training:feedback, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30367 -0.10365 -0.00795  0.08806  0.44359 

Coefficients:
                     Estimate Std. Error t value Pr(>|t|)    
(Intercept)          0.431552   0.040561  10.639  < 2e-16 ***
empathy.min          0.028695   0.004328   6.630 3.25e-10 ***
years               -0.015720   0.003518  -4.468 1.34e-05 ***
training1           -0.203496   0.029874  -6.812 1.18e-10 ***
feedback1            0.085558   0.029299   2.920  0.00391 ** 
training1:feedback1  0.097334   0.041840   2.326  0.02103 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1462 on 194 degrees of freedom
Multiple R-squared:  0.4015,	Adjusted R-squared:  0.386 
F-statistic: 26.02 on 5 and 194 DF,  p-value: < 2.2e-16

cat_plot(lmI, pred = feedback, modx = training, main.title = "Feedback and training interaction", 
    data = data)
[1] 95
par(mfrow = c(1, 1))
[1] 96
$mfrow
[1] 1 1

qqPlot(lmI)
[1] 97
hist(lmI$residuals)
[1] 98
residualPlots(lmI)
[1] 99
crPlots(lm(incidents ~ empathy.min + years + training + feedback, 
    data = data))
[1] 100
par(mfrow = c(2, 2))
[1] 101
$mfrow
[1] 1 1

plot(x = lmI$residuals, y = data$empathy.min)
[1] 102
plot(x = lmI$residuals, y = data$years)
[1] 103
plot(x = lmI$residuals, y = data$training)
[1] 104
plot(x = lmI$residuals, y = data$feedback)
[1] 105
par(mfrow = c(1, 1))
[1] 106
$mfrow
[1] 2 2

cutoff3 <- 4/(200 - 5 - 1)
[1] 107
plot(lmI, which = 4, cook.levels = cutoff3)
[1] 108
lmI.2 <- lm(incidents ~ empathy.min + years + training + feedback + 
    training:feedback, data = data.c2)
[1] 109
summary(lmI.2)
[1] 110

Call:
lm(formula = incidents ~ empathy.min + years + training + feedback + 
    training:feedback, data = data.c2)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30479 -0.10570 -0.00812  0.08770  0.44416 

Coefficients:
                     Estimate Std. Error t value Pr(>|t|)    
(Intercept)          0.436268   0.040361  10.809  < 2e-16 ***
empathy.min          0.030322   0.004382   6.920 6.50e-11 ***
years               -0.017602   0.003630  -4.849 2.55e-06 ***
training1           -0.206498   0.029712  -6.950 5.48e-11 ***
feedback1            0.079111   0.029294   2.701  0.00754 ** 
training1:feedback1  0.105983   0.041800   2.535  0.01202 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1452 on 193 degrees of freedom
Multiple R-squared:  0.4116,	Adjusted R-squared:  0.3964 
F-statistic:    27 on 5 and 193 DF,  p-value: < 2.2e-16

