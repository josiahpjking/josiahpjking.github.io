

	####### B111865 R script #######

rm(list = ls())
[1] 1
library(psych, quietly = T)
[1] 2
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 3
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[10] "methods"   "base"     
library(carData, quietly = T)
[1] 4
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[10] "methods"   "base"     
library(lm.beta, quietly = T)
[1] 5
 [1] "lm.beta"   "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"    
[10] "datasets"  "methods"   "base"     
mdata <- read.csv("../RMS2_report_1920.csv")
[1] 6
describe(mdata)
[1] 7
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training     3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
mdata$training <- factor(mdata$training, labels = c("No Training", 
    "Training"))
[1] 8
mdata$feedback <- factor(mdata$feedback, labels = c("No Feedback", 
    "Feedback"))
[1] 9
summary(mdata$training)
[1] 10
No Training    Training 
        100         100 
summary(mdata$feedback)
[1] 11
No Feedback    Feedback 
        100         100 
str(mdata$training)
[1] 12
 Factor w/ 2 levels "No Training",..: 2 2 2 2 2 2 2 2 2 2 ...
NULL
str(mdata$feedback)
[1] 13
 Factor w/ 2 levels "No Feedback",..: 2 1 2 1 2 1 2 1 2 1 ...
NULL
summary(mdata$incidents)
[1] 14
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
0.08333 0.33333 0.41667 0.47500 0.58333 0.91667 
summary(mdata$empathy)
[1] 15
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   3.00    9.00   10.00   10.18   12.00   16.00 
mdata$empathy_mean <- mdata$empathy - mean(mdata$empathy)
[1] 16
summary(mdata$years)
[1] 17
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1.00    6.00    8.00    8.13   10.00   19.00 
mdata$years_min <- mdata$years - min(mdata$years)
[1] 18
describe(mdata)
[1] 19
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training*    3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 5 rows ]
par(mfrow = c(2, 2))
[1] 20
$mfrow
[1] 2 2

m1 <- lm(empathy_mean ~ years_min, data = mdata)
[1] 21
summary(m1)
[1] 22

Call:
lm(formula = empathy_mean ~ years_min, data = mdata)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) -1.55119    0.43847  -3.538 0.000503 ***
years_min    0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

cooks1 <- cooks.distance(m1)
[1] 23
names(which(cooks1 > (4/(200 - 1 - 1))))
[1] 24
 [1] "16"  "61"  "88"  "89"  "94"  "108" "137" "141" "154" "163" "171" "175" "192" "200"
plot(m1, which = 4)
[1] 25
plot(m1)
[1] 26
shapiro.test(m1$residuals)
[1] 27

	Shapiro-Wilk normality test

data:  m1$residuals
W = 0.98911, p-value = 0.1321

par(mfrow = c(2, 2))
[1] 28
$mfrow
[1] 2 2

qqPlot(m1)
[1] 29
hist <- hist(m1$residuals)
[1] 30
durbinWatsonTest(m1)
[1] 31
 lag Autocorrelation D-W Statistic p-value
   1       0.1017162      1.769879   0.102
 Alternative hypothesis: rho != 0
crPlots(m1)
[1] 32
ncvTest(m1)
[1] 33
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.9815033, Df = 1, p = 0.32183
residualPlots(m1)
[1] 34
m2a <- lm(incidents ~ training, data = mdata)
[1] 35
summary(m2a)
[1] 36

Call:
lm(formula = incidents ~ training, data = mdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.32500 -0.12500  0.00833  0.12500  0.50833 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.54167    0.01747  31.009  < 2e-16 ***
trainingTraining -0.13333    0.02470  -5.397 1.92e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1747 on 198 degrees of freedom
Multiple R-squared:  0.1283,	Adjusted R-squared:  0.1239 
F-statistic: 29.13 on 1 and 198 DF,  p-value: 1.922e-07

m2 <- lm(incidents ~ training + years_min + empathy_mean, data = mdata)
[1] 37
summary(m2)
[1] 38

Call:
lm(formula = incidents ~ training + years_min + empathy_mean, 
    data = mdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.651636   0.033113  19.679  < 2e-16 ***
trainingTraining -0.152427   0.023166  -6.580 4.20e-10 ***
years_min        -0.014085   0.003889  -3.622 0.000372 ***
empathy_mean      0.025396   0.004735   5.363 2.29e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

qqPlot(m2)
[1] 39
hist(m2$residuals)
[1] 40
shapiro.test(m2$residuals)
[1] 41

	Shapiro-Wilk normality test

data:  m2$residuals
W = 0.97994, p-value = 0.005838

residualPlots(m2)
[1] 42
ncvTest(m2)
[1] 43
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0293323, Df = 1, p = 0.86401
crPlots(m2)
[1] 44
vif(m2)
[1] 45
    training    years_min empathy_mean 
    1.020633     1.085089     1.092467 
stdz2 <- MASS::studres(m2)
[1] 46
names(which(abs(stdz2) > 2))
[1] 47
[1] "7"   "13"  "35"  "74"  "159" "165" "176" "181"
hats2 <- hatvalues(m2)
[1] 48
names(which(hats2 > 2 * mean(hats2)))
[1] 49
 [1] "61"  "88"  "89"  "92"  "94"  "137" "141" "154" "163" "175" "200"
cooks2 <- cooks.distance(m2)
[1] 50
names(which(cooks2 > (4/(200 - 3 - 1))))
[1] 51
[1] "13"  "35"  "74"  "137" "165"
plot(m2, which = 4)
[1] 52
m3a <- lm(incidents ~ feedback, data = mdata)
[1] 53
summary(m3a)
[1] 54

Call:
lm(formula = incidents ~ feedback, data = mdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.45333 -0.12000  0.00333  0.13000  0.50333 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.41333    0.01765   23.41  < 2e-16 ***
feedbackFeedback  0.12333    0.02496    4.94 1.66e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1765 on 198 degrees of freedom
Multiple R-squared:  0.1097,	Adjusted R-squared:  0.1052 
F-statistic: 24.41 on 1 and 198 DF,  p-value: 1.656e-06

m3 <- lm(incidents ~ feedback + years_min + empathy_mean + training, 
    data = mdata)
[1] 55
summary(m3)
[1] 56

Call:
lm(formula = incidents ~ feedback + years_min + empathy_mean + 
    training, data = mdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.31626 -0.10096 -0.00949  0.09165  0.46650 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.593421   0.031548  18.810  < 2e-16 ***
feedbackFeedback  0.133715   0.020968   6.377 1.28e-09 ***
years_min        -0.015199   0.003551  -4.281 2.92e-05 ***
empathy_mean      0.027191   0.004328   6.283 2.12e-09 ***
trainingTraining -0.153824   0.021128  -7.281 7.98e-12 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1479 on 195 degrees of freedom
Multiple R-squared:  0.3848,	Adjusted R-squared:  0.3721 
F-statistic: 30.49 on 4 and 195 DF,  p-value: < 2.2e-16

qqPlot(m3)
[1] 57
hist(m3$residuals)
[1] 58
shapiro.test(m3$residuals)
[1] 59

	Shapiro-Wilk normality test

data:  m3$residuals
W = 0.98734, p-value = 0.07172

residualPlots(m3)
[1] 60
ncvTest(m3)
[1] 61
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 3.684027, Df = 1, p = 0.054936
crPlots(m3)
[1] 62
vif(m3)
[1] 63
    feedback    years_min empathy_mean     training 
    1.005320     1.087722     1.097109     1.020743 
stdz3 <- MASS::studres(m3)
[1] 64
names(which(abs(stdz3) > 2))
[1] 65
 [1] "13"  "74"  "101" "117" "150" "156" "159" "160" "176" "181"
hats3 <- hatvalues(m3)
[1] 66
names(which(hats3 > 2 * mean(hats3)))
[1] 67
[1] "61"  "88"  "89"  "92"  "137" "141" "154" "175" "200"
cooks3 <- cooks.distance(m3)
[1] 68
names(which(cooks3 > (4/(200 - 3 - 1))))
[1] 69
 [1] "13"  "35"  "74"  "117" "131" "137" "141" "156" "160" "176"
plot(m2, which = 4)
[1] 70
AIC(m2, m3)
[1] 71
   df       AIC
m2  5 -154.1654
m3  6 -190.0499
anova(m2, m3)
[1] 72
Analysis of Variance Table

Model 1: incidents ~ training + years_min + empathy_mean
Model 2: incidents ~ feedback + years_min + empathy_mean + training
  Res.Df    RSS Df Sum of Sq      F    Pr(>F)    
1    196 5.1532                                  
2    195 4.2639  1   0.88925 40.668 1.279e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
levels(mdata$training) <- c(0, 1)
[1] 73
levels(mdata$feedback) <- c(0, 1)
[1] 74
mdata$training <- as.numeric(levels(mdata$training))[mdata$training]
[1] 75
mdata$feedback <- as.numeric(levels(mdata$feedback))[mdata$feedback]
[1] 76
m4 <- lm(incidents ~ training + feedback + training * feedback, 
    data = mdata)
[1] 77
summary(m4)
[1] 78

Call:
lm(formula = incidents ~ training + feedback + training * feedback, 
    data = mdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40000 -0.10500  0.00000  0.08333  0.43333 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)        0.49333    0.02314  21.323  < 2e-16 ***
training          -0.16000    0.03272  -4.890 2.09e-06 ***
feedback           0.09667    0.03272   2.954  0.00352 ** 
training:feedback  0.05333    0.04627   1.153  0.25047    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1636 on 196 degrees of freedom
Multiple R-squared:  0.2431,	Adjusted R-squared:  0.2315 
F-statistic: 20.99 on 3 and 196 DF,  p-value: 7.827e-12

shapiro.test(m4$residuals)
[1] 79

	Shapiro-Wilk normality test

data:  m4$residuals
W = 0.9767, p-value = 0.002072

par(mfrow = c(1, 1))
[1] 80
$mfrow
[1] 2 2

qqPlot(m4)
[1] 81
hist(m4$residuals)
[1] 82
durbinWatsonTest(m4)
[1] 83
 lag Autocorrelation D-W Statistic p-value
   1       0.1114255      1.770733   0.106
 Alternative hypothesis: rho != 0
residualPlots(m4)
[1] 84
ncvTest(m4)
[1] 85
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 1.881673, Df = 1, p = 0.17014
summary(m4)
[1] 86

Call:
lm(formula = incidents ~ training + feedback + training * feedback, 
    data = mdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40000 -0.10500  0.00000  0.08333  0.43333 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)        0.49333    0.02314  21.323  < 2e-16 ***
training          -0.16000    0.03272  -4.890 2.09e-06 ***
feedback           0.09667    0.03272   2.954  0.00352 ** 
training:feedback  0.05333    0.04627   1.153  0.25047    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1636 on 196 degrees of freedom
Multiple R-squared:  0.2431,	Adjusted R-squared:  0.2315 
F-statistic: 20.99 on 3 and 196 DF,  p-value: 7.827e-12

