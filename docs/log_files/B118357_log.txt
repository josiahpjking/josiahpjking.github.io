

	####### B118357 R script #######

library("psych", quietly = T)
[1] 1
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library("car", quietly = T)
[1] 2
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[10] "methods"   "base"     
library("interactions", quietly = T)
[1] 3
 [1] "interactions" "car"          "carData"      "psych"        "readr"        "stats"        "graphics"    
 [8] "grDevices"    "utils"        "datasets"     "methods"      "base"        
library("sandwich", quietly = T)
[1] 4
 [1] "sandwich"     "interactions" "car"          "carData"      "psych"        "readr"        "stats"       
 [8] "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
library("lmtest", quietly = T)
[1] 5
 [1] "lmtest"       "zoo"          "sandwich"     "interactions" "car"          "carData"      "psych"       
 [8] "readr"        "stats"        "graphics"     "grDevices"    "utils"        "datasets"     "methods"     
[15] "base"        
library("ez", quietly = T)
[1] 6
 [1] "ez"           "lmtest"       "zoo"          "sandwich"     "interactions" "car"          "carData"     
 [8] "psych"        "readr"        "stats"        "graphics"     "grDevices"    "utils"        "datasets"    
[15] "methods"      "base"        
cwdata <- read.csv("../RMS2_report_1920.csv")
[1] 7
str(cwdata)
[1] 8
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : int  2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : int  2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
describe(cwdata)
[1] 9
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training     3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
cwdata$training <- factor(cwdata$training, labels = c("no training", 
    "training"))
[1] 10
str(cwdata$training)
[1] 11
 Factor w/ 2 levels "no training",..: 2 2 2 2 2 2 2 2 2 2 ...
NULL
summary(cwdata$training)
[1] 12
no training    training 
        100         100 
cwdata$feedback <- factor(cwdata$feedback, labels = c("no feedback", 
    "feedback"))
[1] 13
str(cwdata$feedback)
[1] 14
 Factor w/ 2 levels "no feedback",..: 2 1 2 1 2 1 2 1 2 1 ...
NULL
summary(cwdata$feedback)
[1] 15
no feedback    feedback 
        100         100 
plot(cwdata$empathy, cwdata$years)
[1] 16
cwdata$STempathy <- scale(cwdata$empathy)
[1] 17
summary(cwdata$STempathy)
[1] 18
       V1          
 Min.   :-2.82810  
 1st Qu.:-0.46314  
 Median :-0.06898  
 Mean   : 0.00000  
 3rd Qu.: 0.71934  
 Max.   : 2.29599  
cwdata$years_mean <- cwdata$years - mean(cwdata$years)
[1] 19
summary(cwdata$years_mean)
[1] 20
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  -7.13   -2.13   -0.13    0.00    1.87   10.87 
M1 <- lm(STempathy ~ years_mean, data = cwdata)
[1] 21
summary(M1)
[1] 22

Call:
lm(formula = STempathy ~ years_mean, data = cwdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.97192 -0.59754  0.02792  0.64474  2.30713 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept) -3.544e-16  6.837e-02   0.000 1.000000    
years_mean   8.575e-02  2.226e-02   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.9669 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

which(cooks.distance(M1) > (4/(200 - 1 - 1)))
[1] 23
 16  61  88  89  94 108 137 141 154 163 171 175 192 200 
 16  61  88  89  94 108 137 141 154 163 171 175 192 200 
plot(cooks.distance(M1))
[1] 24
abline(h = cooks.distance(M1) > (4/(200 - 1 - 1)), col = "magenta")
[1] 25
plot(M1, which = 4)
[1] 26
M1a <- lm(STempathy ~ years_mean, data = cwdata[-c(88, 137, 154), 
    ])
[1] 27
summary(M1a)
[1] 28

Call:
lm(formula = STempathy ~ years_mean, data = cwdata[-c(88, 137, 
    154), ])

Residuals:
     Min       1Q   Median       3Q      Max 
-2.45211 -0.65255  0.01621  0.58161  2.26971 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.04076    0.06532   0.624    0.533    
years_mean   0.11146    0.02278   4.894 2.07e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.9165 on 195 degrees of freedom
Multiple R-squared:  0.1094,	Adjusted R-squared:  0.1048 
F-statistic: 23.95 on 1 and 195 DF,  p-value: 2.068e-06

M1a_coef <- summary(M1)
[1] 29
M1_coef <- summary(M1a)
[1] 30
CompareM1 <- data.frame(round(M1_coef$coefficients[, 1], 3), 
    round(M1_coef$coefficients[, 4], 4), round(M1a_coef$coefficients[, 
        1], 3), round(M1a_coef$coefficients[, 4], 4))
[1] 31
print(CompareM1)
[1] 32
            round.M1_coef.coefficients...1...3. round.M1_coef.coefficients...4...4.
(Intercept)                               0.041                              0.5333
years_mean                                0.111                              0.0000
            round.M1a_coef.coefficients...1...3. round.M1a_coef.coefficients...4...4.
(Intercept)                                0.000                                1e+00
years_mean                                 0.086                                2e-04
            round.M1_coef.coefficients...1...3. round.M1_coef.coefficients...4...4.
(Intercept)                               0.041                              0.5333
years_mean                                0.111                              0.0000
            round.M1a_coef.coefficients...1...3. round.M1a_coef.coefficients...4...4.
(Intercept)                                0.000                                1e+00
years_mean                                 0.086                                2e-04
colnames(CompareM1) <- c("M1 Coefficients", "M1 P-Value", "M1a Coefficients", 
    "M1a P-Value")
[1] 33
print(CompareM1)
[1] 34
            M1 Coefficients M1 P-Value M1a Coefficients M1a P-Value
(Intercept)           0.041     0.5333            0.000       1e+00
years_mean            0.111     0.0000            0.086       2e-04
            M1 Coefficients M1 P-Value M1a Coefficients M1a P-Value
(Intercept)           0.041     0.5333            0.000       1e+00
years_mean            0.111     0.0000            0.086       2e-04
plot(cwdata$STempathy ~ cwdata$years_mean)
[1] 35
abline(M1a)
[1] 36
lines(lowess(cwdata$years_mean, cwdata$STempathy), col = "green")
[1] 37
residualPlots(M1a)
[1] 38
ncvTest(M1a)
[1] 39
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.01869613, Df = 1, p = 0.89124
durbinWatsonTest(M1a)
[1] 40
 lag Autocorrelation D-W Statistic p-value
   1       0.0580735      1.857553    0.33
 Alternative hypothesis: rho != 0
qqPlot(M1a)
[1] 41
hist(M1a$residuals)
[1] 42
shapiro.test(M1a$residuals)
[1] 43

	Shapiro-Wilk normality test

data:  M1a$residuals
W = 0.99287, p-value = 0.4558

M1b <- lm(cwdata$STempathy ~ cwdata$years_mean + I(cwdata$years_mean^2))
[1] 44
summary(M1b)
[1] 45

Call:
lm(formula = cwdata$STempathy ~ cwdata$years_mean + I(cwdata$years_mean^2))

Residuals:
     Min       1Q   Median       3Q      Max 
-1.77645 -0.55225 -0.03293  0.46143  2.38949 

Coefficients:
                        Estimate Std. Error t value Pr(>|t|)    
(Intercept)             0.385369   0.065991   5.840 2.13e-08 ***
cwdata$years_mean       0.151057   0.018914   7.986 1.13e-13 ***
I(cwdata$years_mean^2) -0.040853   0.003887 -10.510  < 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.776 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

crPlots(M1b)
[1] 46
residualPlots(M1b)
[1] 47
ncvTest(M1b)
[1] 48
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.5107658, Df = 1, p = 0.47481
durbinWatsonTest(M1b)
[1] 49
 lag Autocorrelation D-W Statistic p-value
   1      0.01288905      1.973855   0.818
 Alternative hypothesis: rho != 0
qqPlot(M1b)
[1] 50
hist(M1b$residuals)
[1] 51
shapiro.test(M1b$residuals)
[1] 52

	Shapiro-Wilk normality test

data:  M1b$residuals
W = 0.9941, p-value = 0.6155

summary(M1b)
[1] 53

Call:
lm(formula = cwdata$STempathy ~ cwdata$years_mean + I(cwdata$years_mean^2))

Residuals:
     Min       1Q   Median       3Q      Max 
-1.77645 -0.55225 -0.03293  0.46143  2.38949 

Coefficients:
                        Estimate Std. Error t value Pr(>|t|)    
(Intercept)             0.385369   0.065991   5.840 2.13e-08 ***
cwdata$years_mean       0.151057   0.018914   7.986 1.13e-13 ***
I(cwdata$years_mean^2) -0.040853   0.003887 -10.510  < 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.776 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

plot(cwdata$STempathy ~ cwdata$years_mean, xlab = "Mean years of Teaching Experience", 
    ylab = "Centered Measure of Empathy", main = "The Relationship between years of Experience and level of Empathy")
[1] 54
abline(M1b)
[1] 55
M2 <- lm(incidents ~ training + STempathy + years_mean, data = cwdata)
[1] 56
summary(M2)
[1] 57

Call:
lm(formula = incidents ~ training + STempathy + years_mean, data = cwdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.551213   0.016298  33.821  < 2e-16 ***
trainingtraining -0.152427   0.023166  -6.580 4.20e-10 ***
STempathy         0.064430   0.012014   5.363 2.29e-07 ***
years_mean       -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

plot(cooks.distance(M2))
[1] 58
abline(h = cooks.distance(M2) > (4/(200 - 3 - 1)), col = "green")
[1] 59
which(cooks.distance(M2) > (4/(200 - 3 - 1)))
[1] 60
 13  35  74 137 165 
 13  35  74 137 165 
plot(M2, which = 4)
[1] 61
M2a <- lm(incidents ~ training + STempathy + years_mean, data = cwdata[-c(137), 
    ])
[1] 62
summary(M2a)
[1] 63

Call:
lm(formula = incidents ~ training + STempathy + years_mean, data = cwdata[-c(137), 
    ])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.36356 -0.12093 -0.01069  0.09901  0.53229 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.548967   0.016253  33.776  < 2e-16 ***
trainingtraining -0.150984   0.023048  -6.551 4.97e-10 ***
STempathy         0.068441   0.012151   5.633 6.13e-08 ***
years_mean       -0.016009   0.004011  -3.991 9.30e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1612 on 195 degrees of freedom
Multiple R-squared:  0.2674,	Adjusted R-squared:  0.2561 
F-statistic: 23.73 on 3 and 195 DF,  p-value: 3.911e-13

M2a_coef <- summary(M2a)
[1] 64
M2_coef <- summary(M2)
[1] 65
CompareM2 <- data.frame(round(M2_coef$coefficients[, 1], 3), 
    round(M2_coef$coefficients[, 4], 4), round(M2a_coef$coefficients[, 
        1], 3), round(M2a_coef$coefficients[, 4], 4))
[1] 66
colnames(CompareM2) <- c("M2 Coefficients", "M2 P-Value", "M2a Coefficients", 
    "M2a P-Value")
[1] 67
print(CompareM2)
[1] 68
                 M2 Coefficients M2 P-Value M2a Coefficients M2a P-Value
(Intercept)                0.551      0e+00            0.549       0e+00
trainingtraining          -0.152      0e+00           -0.151       0e+00
STempathy                  0.064      0e+00            0.068       0e+00
years_mean                -0.014      4e-04           -0.016       1e-04
                 M2 Coefficients M2 P-Value M2a Coefficients M2a P-Value
(Intercept)                0.551      0e+00            0.549       0e+00
trainingtraining          -0.152      0e+00           -0.151       0e+00
STempathy                  0.064      0e+00            0.068       0e+00
years_mean                -0.014      4e-04           -0.016       1e-04
crPlots(M2)
[1] 69
residualPlots(M2)
[1] 70
ncvTest(M2)
[1] 71
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0293323, Df = 1, p = 0.86401
durbinWatsonTest(M2)
[1] 72
 lag Autocorrelation D-W Statistic p-value
   1      -0.1072849      2.199897   0.208
 Alternative hypothesis: rho != 0
qqPlot(M2)
[1] 73
hist(M2$residuals)
[1] 74
shapiro.test(M2$residuals)
[1] 75

	Shapiro-Wilk normality test

data:  M2$residuals
W = 0.97994, p-value = 0.005838

vif(M2)
[1] 76
  training  STempathy years_mean 
  1.020633   1.092467   1.085089 
summary(M2)
[1] 77

Call:
lm(formula = incidents ~ training + STempathy + years_mean, data = cwdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.551213   0.016298  33.821  < 2e-16 ***
trainingtraining -0.152427   0.023166  -6.580 4.20e-10 ***
STempathy         0.064430   0.012014   5.363 2.29e-07 ***
years_mean       -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

plot(cwdata$training, cwdata$incidents, xlab = "Training condition", 
    ylab = "Percentage of total reported incidents that teachers intervened in", 
    main = "Does specialised training affect the percentage of bullying incidents that teachers intervened in?")
[1] 78
M3 <- lm(incidents ~ feedback + STempathy + years_mean, data = cwdata)
[1] 79
summary(M3)
[1] 80

Call:
lm(formula = incidents ~ feedback + STempathy + years_mean, data = cwdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.408934   0.016655  24.553  < 2e-16 ***
feedbackfeedback  0.132132   0.023585   5.602 7.09e-08 ***
STempathy         0.058827   0.012251   4.802 3.11e-06 ***
years_mean       -0.012689   0.003975  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

plot(cooks.distance(M3))
[1] 81
abline(h = cooks.distance(M3) > (4/(200 - 3 - 1)), col = "green")
[1] 82
which(cooks.distance(M3) > (4/(200 - 3 - 1)))
[1] 83
 73  74  89 137 156 160 165 176 
 73  74  89 137 156 160 165 176 
plot(M3, which = 4)
[1] 84
M3a <- lm(cwdata$incidents ~ cwdata$feedback + cwdata$STempathy + 
    cwdata$years_mean, subset = -c(74, 89, 137))
[1] 85
summary(M3a)
[1] 86

Call:
lm(formula = cwdata$incidents ~ cwdata$feedback + cwdata$STempathy + 
    cwdata$years_mean, subset = -c(74, 89, 137))

Residuals:
     Min       1Q   Median       3Q      Max 
-0.34740 -0.11326 -0.01073  0.11335  0.53413 

Coefficients:
                         Estimate Std. Error t value Pr(>|t|)    
(Intercept)              0.412290   0.016427  25.098  < 2e-16 ***
cwdata$feedbackfeedback  0.128900   0.023282   5.537 9.99e-08 ***
cwdata$STempathy         0.063141   0.012557   5.028 1.13e-06 ***
cwdata$years_mean       -0.013583   0.004147  -3.276  0.00125 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1633 on 193 degrees of freedom
Multiple R-squared:  0.2282,	Adjusted R-squared:  0.2162 
F-statistic: 19.02 on 3 and 193 DF,  p-value: 7.541e-11

M3a_coef <- summary(M3a)
[1] 87
M3_coef <- summary(M3)
[1] 88
CompareM3 <- data.frame(round(M3_coef$coefficients[, 1], 3), 
    round(M3_coef$coefficients[, 4], 4), round(M3a_coef$coefficients[, 
        1], 3), round(M3a_coef$coefficients[, 4], 4))
[1] 89
print(CompareM3)
[1] 90
                 round.M3_coef.coefficients...1...3. round.M3_coef.coefficients...4...4.
(Intercept)                                    0.409                              0.0000
feedbackfeedback                               0.132                              0.0000
STempathy                                      0.059                              0.0000
years_mean                                    -0.013                              0.0016
                 round.M3a_coef.coefficients...1...3. round.M3a_coef.coefficients...4...4.
(Intercept)                                     0.412                               0.0000
feedbackfeedback                                0.129                               0.0000
STempathy                                       0.063                               0.0000
years_mean                                     -0.014                               0.0013
                 round.M3_coef.coefficients...1...3. round.M3_coef.coefficients...4...4.
(Intercept)                                    0.409                              0.0000
feedbackfeedback                               0.132                              0.0000
STempathy                                      0.059                              0.0000
years_mean                                    -0.013                              0.0016
                 round.M3a_coef.coefficients...1...3. round.M3a_coef.coefficients...4...4.
(Intercept)                                     0.412                               0.0000
feedbackfeedback                                0.129                               0.0000
STempathy                                       0.063                               0.0000
years_mean                                     -0.014                               0.0013
colnames(CompareM3) <- c("M3 Coefficients", "M3 P-Value", "M3a Coefficients", 
    "M3a P-value")
[1] 91
print(CompareM3)
[1] 92
                 M3 Coefficients M3 P-Value M3a Coefficients M3a P-value
(Intercept)                0.409     0.0000            0.412      0.0000
feedbackfeedback           0.132     0.0000            0.129      0.0000
STempathy                  0.059     0.0000            0.063      0.0000
years_mean                -0.013     0.0016           -0.014      0.0013
                 M3 Coefficients M3 P-Value M3a Coefficients M3a P-value
(Intercept)                0.409     0.0000            0.412      0.0000
feedbackfeedback           0.132     0.0000            0.129      0.0000
STempathy                  0.059     0.0000            0.063      0.0000
years_mean                -0.013     0.0016           -0.014      0.0013
crPlots(M3)
[1] 93
residualPlots(M3)
[1] 94
ncvTest(M3)
[1] 95
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.01731234, Df = 1, p = 0.89532
durbinWatsonTest(M3)
[1] 96
 lag Autocorrelation D-W Statistic p-value
   1       0.2738264      1.444081       0
 Alternative hypothesis: rho != 0
qqPlot(M3)
[1] 97
hist(M3$residuals)
[1] 98
shapiro.test(M3$residuals)
[1] 99

	Shapiro-Wilk normality test

data:  M3$residuals
W = 0.98772, p-value = 0.08174

vif(M3)
[1] 100
  feedback  STempathy years_mean 
  1.005211   1.079397   1.077467 
summary(M3)
[1] 101

Call:
lm(formula = incidents ~ feedback + STempathy + years_mean, data = cwdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.408934   0.016655  24.553  < 2e-16 ***
feedbackfeedback  0.132132   0.023585   5.602 7.09e-08 ***
STempathy         0.058827   0.012251   4.802 3.11e-06 ***
years_mean       -0.012689   0.003975  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

plot(cwdata$feedback, cwdata$incidents, xlab = "Feedback condition", 
    ylab = "Percentage of total reported incidents that teachers intervened in", 
    main = "Does feedback affect the percentage of bullying incidents that teachers intervened in?")
[1] 102
AIC(M2, M3)
[1] 103
   df       AIC
M2  5 -154.1654
M3  5 -143.9591
BIC(M2, M3)
[1] 104
   df       BIC
M2  5 -137.6738
M3  5 -127.4675
M4 <- lm(incidents ~ training + feedback + training * feedback, 
    data = cwdata)
[1] 105
summary(M4)
[1] 106

Call:
lm(formula = incidents ~ training + feedback + training * feedback, 
    data = cwdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40000 -0.10500  0.00000  0.08333  0.43333 

Coefficients:
                                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)                        0.49333    0.02314  21.323  < 2e-16 ***
trainingtraining                  -0.16000    0.03272  -4.890 2.09e-06 ***
feedbackfeedback                   0.09667    0.03272   2.954  0.00352 ** 
trainingtraining:feedbackfeedback  0.05333    0.04627   1.153  0.25047    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1636 on 196 degrees of freedom
Multiple R-squared:  0.2431,	Adjusted R-squared:  0.2315 
F-statistic: 20.99 on 3 and 196 DF,  p-value: 7.827e-12

plot(cooks.distance(M4))
[1] 107
abline(h = cooks.distance(M4) > (4/(200 - 2 - 1)), col = "green")
[1] 108
which(cooks.distance(M4) > (4/(200 - 2 - 1)))
[1] 109
  7  13  89 131 150 159 160 165 176 181 
  7  13  89 131 150 159 160 165 176 181 
plot(M4, which = 4)
[1] 110
M4a <- lm(incidents ~ training + feedback + training * feedback, 
    data = cwdata[-c(13, 89, 160, 176), ])
[1] 111
summary(M4a)
[1] 112

Call:
lm(formula = incidents ~ training + feedback + training * feedback, 
    data = cwdata[-c(13, 89, 160, 176), ])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.34000 -0.10309  0.00000  0.08333  0.35764 

Coefficients:
                                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)                        0.47569    0.02216  21.469  < 2e-16 ***
trainingtraining                  -0.14236    0.03102  -4.589 8.02e-06 ***
feedbackfeedback                   0.11431    0.03102   3.685 0.000297 ***
trainingtraining:feedbackfeedback  0.03500    0.04387   0.798 0.425949    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1535 on 192 degrees of freedom
Multiple R-squared:  0.2688,	Adjusted R-squared:  0.2574 
F-statistic: 23.53 on 3 and 192 DF,  p-value: 5.18e-13

M4a_coef <- summary(M4a)
[1] 113
M4_coef <- summary(M4)
[1] 114
CompareM4 <- data.frame(round(M4_coef$coefficients[, 1], 3), 
    round(M4_coef$coefficients[, 4], 4), round(M4a_coef$coefficients[, 
        1], 3), round(M4a_coef$coefficients[, 4], 4))
[1] 115
print(CompareM4)
[1] 116
                                  round.M4_coef.coefficients...1...3. round.M4_coef.coefficients...4...4.
(Intercept)                                                     0.493                              0.0000
trainingtraining                                               -0.160                              0.0000
feedbackfeedback                                                0.097                              0.0035
trainingtraining:feedbackfeedback                               0.053                              0.2505
                                  round.M4a_coef.coefficients...1...3. round.M4a_coef.coefficients...4...4.
(Intercept)                                                      0.476                               0.0000
trainingtraining                                                -0.142                               0.0000
feedbackfeedback                                                 0.114                               0.0003
trainingtraining:feedbackfeedback                                0.035                               0.4259
                                  round.M4_coef.coefficients...1...3. round.M4_coef.coefficients...4...4.
(Intercept)                                                     0.493                              0.0000
trainingtraining                                               -0.160                              0.0000
feedbackfeedback                                                0.097                              0.0035
trainingtraining:feedbackfeedback                               0.053                              0.2505
                                  round.M4a_coef.coefficients...1...3. round.M4a_coef.coefficients...4...4.
(Intercept)                                                      0.476                               0.0000
trainingtraining                                                -0.142                               0.0000
feedbackfeedback                                                 0.114                               0.0003
trainingtraining:feedbackfeedback                                0.035                               0.4259
colnames(CompareM4) <- c("M4 Coefficients", "M4 P-Value", "M4a Coefficients", 
    "M4a P-value")
[1] 117
print(CompareM4)
[1] 118
                                  M4 Coefficients M4 P-Value M4a Coefficients M4a P-value
(Intercept)                                 0.493     0.0000            0.476      0.0000
trainingtraining                           -0.160     0.0000           -0.142      0.0000
feedbackfeedback                            0.097     0.0035            0.114      0.0003
trainingtraining:feedbackfeedback           0.053     0.2505            0.035      0.4259
                                  M4 Coefficients M4 P-Value M4a Coefficients M4a P-value
(Intercept)                                 0.493     0.0000            0.476      0.0000
trainingtraining                           -0.160     0.0000           -0.142      0.0000
feedbackfeedback                            0.097     0.0035            0.114      0.0003
trainingtraining:feedbackfeedback           0.053     0.2505            0.035      0.4259
ncvTest(M4a)
[1] 119
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 1.992662, Df = 1, p = 0.15806
durbinWatsonTest(M4a)
[1] 120
 lag Autocorrelation D-W Statistic p-value
   1      0.06128982      1.869805   0.408
 Alternative hypothesis: rho != 0
qqPlot(M4a)
[1] 121
hist(M4a$residuals)
[1] 122
shapiro.test(M4a$residuals)
[1] 123

	Shapiro-Wilk normality test

data:  M4a$residuals
W = 0.97726, p-value = 0.002826

interaction.plot(x.factor = cwdata$feedback, trace.factor = cwdata$training, 
    response = cwdata$incidents)
[1] 124
cat_plot(M4a, pred = training, modx = feedback, plot.points = TRUE, 
    x.label = "Training Condition", y.label = "Percentage of total reported incidents that teachers intervened in", 
    legend.main = "Feedback")
[1] 125
