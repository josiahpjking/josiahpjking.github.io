

	####### B118635 R script #######

data <- read.csv("../RMS2_report_1920.csv")
[1] 1
library(psych, quietly = T)
[1] 2
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 3
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[10] "methods"   "base"     
library(interactions, quietly = T)
[1] 4
 [1] "interactions" "car"          "carData"      "psych"        "readr"        "stats"        "graphics"    
 [8] "grDevices"    "utils"        "datasets"     "methods"      "base"        
describe(data)
[1] 5
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training     3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
str(data)
[1] 6
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : int  2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : int  2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
data$training <- as.factor(data$training)
[1] 7
data$feedback <- as.factor(data$feedback)
[1] 8
str(data)
[1] 9
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : Factor w/ 2 levels "1","2": 2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : Factor w/ 2 levels "1","2": 2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
data$empathy <- data$empathy - mean(data$empathy)
[1] 10
plot(data$years, data$empathy, xlab = "Years", ylab = "Empathy", 
    main = "Figure 1 - Correlation between Years and Empathy", 
    col = "dark blue")
[1] 11
m1 <- lm(empathy ~ years, data = data)
[1] 12
qqPlot(m1)
[1] 13
shapiro.test(m1$residuals)
[1] 14

	Shapiro-Wilk normality test

data:  m1$residuals
W = 0.98911, p-value = 0.1321

residualPlots(m1)
[1] 15
ncvTest(m1)
[1] 16
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.9815033, Df = 1, p = 0.32183
crPlots(m1)
[1] 17
durbinWatsonTest(m1)
[1] 18
 lag Autocorrelation D-W Statistic p-value
   1       0.1017162      1.769879   0.094
 Alternative hypothesis: rho != 0
m2 <- lm(empathy ~ years + I(years^2), data = data)
[1] 19
summary(m2)
[1] 20

Call:
lm(formula = empathy ~ years + I(years^2), data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept) -8.988644   0.791848  -11.35   <2e-16 ***
years        2.068508   0.181845   11.38   <2e-16 ***
I(years^2)  -0.103645   0.009861  -10.51   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

confint(m2)
[1] 21
                  2.5 %      97.5 %
(Intercept) -10.5502312 -7.42705651
years         1.7098945  2.42712124
I(years^2)   -0.1230923 -0.08419814
qqPlot(m2)
[1] 22
shapiro.test(m2$residuals)
[1] 23

	Shapiro-Wilk normality test

data:  m2$residuals
W = 0.9941, p-value = 0.6155

residualPlots(m2)
[1] 24
ncvTest(m2)
[1] 25
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.5107658, Df = 1, p = 0.47481
crPlots(m2)
[1] 26
durbinWatsonTest(m2)
[1] 27
 lag Autocorrelation D-W Statistic p-value
   1      0.01288905      1.973855   0.876
 Alternative hypothesis: rho != 0
plot(MASS::studres(m2))
[1] 28
which(abs(MASS::studres(m2)) > 2)
[1] 29
 30  68  69  70  74  76 122 142 162 175 
 30  68  69  70  74  76 122 142 162 175 
plot(cooks.distance(m2))
[1] 30
which(cooks.distance(m2) > (4/(200 - 1 - 1)))
[1] 31
 61  89 137 141 154 163 165 175 
 61  89 137 141 154 163 165 175 
plot(hatvalues(m2))
[1] 32
which((hatvalues(m2)) > 2 * mean(hatvalues(m2)))
[1] 33
 16  61  88  89  92 116 137 141 154 155 165 171 190 200 
 16  61  88  89  92 116 137 141 154 155 165 171 190 200 
M2 <- lm(empathy ~ years + I(years^2), data = data, subset = -c(154))
[1] 34
summary(M2)
[1] 35

Call:
lm(formula = empathy ~ years + I(years^2), data = data, subset = -c(154))

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5194 -1.3712  0.0603  1.2385  6.0603 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) -9.30284    0.83682 -11.117   <2e-16 ***
years        2.16230    0.19908  10.861   <2e-16 ***
I(years^2)  -0.10976    0.01119  -9.809   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.967 on 196 degrees of freedom
Multiple R-squared:  0.3953,	Adjusted R-squared:  0.3891 
F-statistic: 64.05 on 2 and 196 DF,  p-value: < 2.2e-16

Model2 <- lm(empathy ~ years + I(years^2), data = data, subset = -c(61, 
    89, 137, 141, 154, 163, 165, 175))
[1] 36
summary(Model2)
[1] 37

Call:
lm(formula = empathy ~ years + I(years^2), data = data, subset = -c(61, 
    89, 137, 141, 154, 163, 165, 175))

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5344 -1.1205  0.1144  1.2235  4.8795 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) -9.32753    0.96042  -9.712  < 2e-16 ***
years        2.14585    0.23421   9.162  < 2e-16 ***
I(years^2)  -0.10772    0.01353  -7.962 1.54e-13 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.912 on 189 degrees of freedom
Multiple R-squared:  0.3587,	Adjusted R-squared:  0.3519 
F-statistic: 52.86 on 2 and 189 DF,  p-value: < 2.2e-16

data$training <- factor(data$training, labels = c("No training", 
    "Training"))
[1] 38
describeBy(data$incidents, data$training)
[1] 39

 Descriptive statistics by group 
group: No training
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 100 0.54 0.18    0.5    0.53 0.25 0.25 0.92  0.67 0.39    -0.73 0.02
--------------------------------------------------------------------------------------- 
group: Training
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 100 0.41 0.17   0.42     0.4 0.12 0.08 0.92  0.83 0.38    -0.05 0.02
plot(data$training, data$incidents, xlab = "training", ylab = "incidents", 
    main = "Figure 2 - Boxplot of the effect of training on interventions in incidents", 
    col = "light blue")
[1] 40
m3 <- lm(incidents ~ training + years + empathy, data = data)
[1] 41
summary(m3)
[1] 42

Call:
lm(formula = incidents ~ training + years + empathy, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.665721   0.036551  18.214  < 2e-16 ***
trainingTraining -0.152427   0.023166  -6.580 4.20e-10 ***
years            -0.014085   0.003889  -3.622 0.000372 ***
empathy           0.025396   0.004735   5.363 2.29e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

confint(m3)
[1] 43
                       2.5 %       97.5 %
(Intercept)       0.59363751  0.737803982
trainingTraining -0.19811433 -0.106739356
years            -0.02175353 -0.006415556
empathy           0.01605669  0.034734598
qqPlot(m3)
[1] 44
shapiro.test(m3$residuals)
[1] 45

	Shapiro-Wilk normality test

data:  m3$residuals
W = 0.97994, p-value = 0.005838

residualPlots(m3)
[1] 46
ncvTest(m3)
[1] 47
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0293323, Df = 1, p = 0.86401
crPlots(m3)
[1] 48
durbinWatsonTest(m3)
[1] 49
 lag Autocorrelation D-W Statistic p-value
   1      -0.1072849      2.199897   0.208
 Alternative hypothesis: rho != 0
vif(m3)
[1] 50
training    years  empathy 
1.020633 1.085089 1.092467 
plot(MASS::studres(m3))
[1] 51
which(abs(MASS::studres(m3)) > 2)
[1] 52
  7  13  35  74 159 165 176 181 
  7  13  35  74 159 165 176 181 
plot(cooks.distance(m3))
[1] 53
which(cooks.distance(m3) > (4/(200 - 3 - 1)))
[1] 54
 13  35  74 137 165 
 13  35  74 137 165 
plot(hatvalues(m3))
[1] 55
which((hatvalues(m3)) > 2 * mean(hatvalues(m3)))
[1] 56
 61  88  89  92  94 137 141 154 163 175 200 
 61  88  89  92  94 137 141 154 163 175 200 
data$feedback <- factor(data$feedback, labels = c("No feedback", 
    "Feedback"))
[1] 57
plot(data$feedback, data$incidents, ylab = "incidents", main = "Figure 3 - Boxplot of the effect of feedback sessions on interventions in incidents", 
    col = "light pink")
[1] 58
describeBy(data$incidents, data$feedback)
[1] 59

 Descriptive statistics by group 
group: No feedback
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 100 0.41 0.17   0.42     0.4 0.12 0.08 0.92  0.83  0.6     0.36 0.02
--------------------------------------------------------------------------------------- 
group: Feedback
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 100 0.54 0.18    0.5    0.53 0.25 0.08 0.92  0.83 0.11    -0.44 0.02
m4 <- lm(incidents ~ feedback + years + empathy, data = data)
[1] 60
summary(m4)
[1] 61

Call:
lm(formula = incidents ~ feedback + years + empathy, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.512093   0.035846  14.286  < 2e-16 ***
feedbackFeedback  0.132132   0.023585   5.602 7.09e-08 ***
years            -0.012689   0.003975  -3.192  0.00165 ** 
empathy           0.023187   0.004829   4.802 3.11e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

confint(m4)
[1] 62
                       2.5 %       97.5 %
(Intercept)       0.44139942  0.582785691
feedbackFeedback  0.08561885  0.178644455
years            -0.02052811 -0.004849104
empathy           0.01366456  0.032710219
qqPlot(m4)
[1] 63
shapiro.test(m4$residuals)
[1] 64

	Shapiro-Wilk normality test

data:  m4$residuals
W = 0.98772, p-value = 0.08174

residualPlots(m4)
[1] 65
ncvTest(m4)
[1] 66
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.01731234, Df = 1, p = 0.89532
crPlots(m4)
[1] 67
durbinWatsonTest(m4)
[1] 68
 lag Autocorrelation D-W Statistic p-value
   1       0.2738264      1.444081       0
 Alternative hypothesis: rho != 0
vif(m4)
[1] 69
feedback    years  empathy 
1.005211 1.077467 1.079397 
plot(MASS::studres(m4))
[1] 70
which(abs(MASS::studres(m4)) > 2)
[1] 71
 13  21  73  74 150 156 159 160 165 176 181 
 13  21  73  74 150 156 159 160 165 176 181 
plot(cooks.distance(m4))
[1] 72
which(cooks.distance(m4) > (4/(200 - 3 - 1)))
[1] 73
 73  74  89 137 156 160 165 176 
 73  74  89 137 156 160 165 176 
plot(hatvalues(m4))
[1] 74
which((hatvalues(m4)) > 2 * mean(hatvalues(m4)))
[1] 75
 61  88  89  92 137 141 154 163 175 200 
 61  88  89  92 137 141 154 163 175 200 
AIC(m3, m4)
[1] 76
   df       AIC
m3  5 -154.1654
m4  5 -143.9591
BIC(m3, m4)
[1] 77
   df       BIC
m3  5 -137.6738
m4  5 -127.4675
describeBy(data$incidents, group = list(data$training, data$feedback))
[1] 78

 Descriptive statistics by group 
: No training
: No feedback
   vars  n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 50 0.49 0.17   0.42    0.48 0.12 0.25 0.92  0.67 0.82    -0.07 0.02
--------------------------------------------------------------------------------------- 
: Training
: No feedback
   vars  n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 50 0.33 0.14   0.33    0.33 0.12 0.08 0.58   0.5 0.15    -0.96 0.02
--------------------------------------------------------------------------------------- 
: No training
: Feedback
   vars  n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 50 0.59 0.17   0.58    0.59 0.12 0.25 0.92  0.67 0.05    -0.81 0.02
--------------------------------------------------------------------------------------- 
: Training
: Feedback
   vars  n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 50 0.48 0.17    0.5    0.48 0.12 0.08 0.92  0.83 0.23    -0.07 0.02
m5 <- lm(incidents ~ training + feedback + training * feedback, 
    data = data)
[1] 79
summary(m5)
[1] 80

Call:
lm(formula = incidents ~ training + feedback + training * feedback, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40000 -0.10500  0.00000  0.08333  0.43333 

Coefficients:
                                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)                        0.49333    0.02314  21.323  < 2e-16 ***
trainingTraining                  -0.16000    0.03272  -4.890 2.09e-06 ***
feedbackFeedback                   0.09667    0.03272   2.954  0.00352 ** 
trainingTraining:feedbackFeedback  0.05333    0.04627   1.153  0.25047    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1636 on 196 degrees of freedom
Multiple R-squared:  0.2431,	Adjusted R-squared:  0.2315 
F-statistic: 20.99 on 3 and 196 DF,  p-value: 7.827e-12

confint(m5)
[1] 81
                                        2.5 %      97.5 %
(Intercept)                        0.44770646  0.53896021
trainingTraining                  -0.22452614 -0.09547386
feedbackFeedback                   0.03214052  0.16119281
trainingTraining:feedbackFeedback -0.03792042  0.14458708
cat_plot(m5, pred = training, modx = feedback, geom = "line", 
    main = "Figure 4 - Interaction plot between training and feedback")
[1] 82
qqPlot(m5)
[1] 83
shapiro.test(m5$residuals)
[1] 84

	Shapiro-Wilk normality test

data:  m5$residuals
W = 0.9767, p-value = 0.002072

ncvTest(m5)
[1] 85
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 1.881673, Df = 1, p = 0.17014
durbinWatsonTest(m5)
[1] 86
 lag Autocorrelation D-W Statistic p-value
   1       0.1114255      1.770733   0.106
 Alternative hypothesis: rho != 0
plot(MASS::studres(m5))
[1] 87
which(abs(MASS::studres(m5)) > 2)
[1] 88
  7  13  89 131 150 159 160 165 176 181 
  7  13  89 131 150 159 160 165 176 181 
plot(cooks.distance(m5))
[1] 89
which(cooks.distance(m5) > (4/(200 - 3 - 1)))
[1] 90
  7  13  89 131 150 159 160 165 176 181 
  7  13  89 131 150 159 160 165 176 181 
M5 <- lm(incidents ~ training + feedback + training * feedback, 
    data = data, subset = -c(7, 13, 89, 131, 150, 159, 160, 165, 
        176, 181))
[1] 91
summary(M5)
[1] 92

Call:
lm(formula = incidents ~ training + feedback + training * feedback, 
    data = data, subset = -c(7, 13, 89, 131, 150, 159, 160, 165, 
        176, 181))

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30851 -0.12190  0.00000  0.09058  0.28192 

Coefficients:
                                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)                        0.46809    0.02091  22.382  < 2e-16 ***
trainingTraining                  -0.13475    0.02913  -4.626 6.97e-06 ***
feedbackFeedback                   0.10800    0.02974   3.632 0.000364 ***
trainingTraining:feedbackFeedback  0.03384    0.04163   0.813 0.417260    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1434 on 186 degrees of freedom
Multiple R-squared:  0.273,	Adjusted R-squared:  0.2613 
F-statistic: 23.28 on 3 and 186 DF,  p-value: 7.654e-13

