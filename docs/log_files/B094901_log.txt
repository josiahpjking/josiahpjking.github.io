

	####### B094901 R script #######

rm(list = ls())
[1] 1
library(readr, quietly = T)
[1] 2
[1] "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
df <- read_csv("~/Desktop/rms2/code_check/RMS2_report_1920.csv")
[1] 3
View(df)
[1] 4
install.packages("psych")
[1] 5
install.packages("car")
[1] 6
install.packages("interactions")
[1] 7
library(psych, quietly = T)
[1] 8
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 9
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
library(interactions, quietly = T)
[1] 10
 [1] "interactions" "car"          "carData"      "psych"        "readr"        "stats"        "graphics"     "grDevices"   
 [9] "utils"        "datasets"     "methods"      "base"        
describe(df)
[1] 11
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training     3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
summary(df)
[1] 12
    subject         incidents          training      feedback      empathy          years      
 Min.   :  1.00   Min.   :0.08333   Min.   :1.0   Min.   :1.0   Min.   : 3.00   Min.   : 1.00  
 1st Qu.: 50.75   1st Qu.:0.33333   1st Qu.:1.0   1st Qu.:1.0   1st Qu.: 9.00   1st Qu.: 6.00  
 Median :100.50   Median :0.41667   Median :1.5   Median :1.5   Median :10.00   Median : 8.00  
 Mean   :100.50   Mean   :0.47500   Mean   :1.5   Mean   :1.5   Mean   :10.18   Mean   : 8.13  
 3rd Qu.:150.25   3rd Qu.:0.58333   3rd Qu.:2.0   3rd Qu.:2.0   3rd Qu.:12.00   3rd Qu.:10.00  
 Max.   :200.00   Max.   :0.91667   Max.   :2.0   Max.   :2.0   Max.   :16.00   Max.   :19.00  
df$subject <- as.factor(df$subject)
[1] 13
df$training <- as.factor(df$training)
[1] 14
df$feedback <- as.factor(df$feedback)
[1] 15
df$training <- factor(df$training, labels = c("no training", 
    "training"))
[1] 16
df$feedback <- factor(df$feedback, labels = c("no feedback", 
    "feedback"))
[1] 17
q1 <- lm(empathy ~ years, data = df)
[1] 18
summary(q1)
[1] 19

Call:
lm(formula = empathy ~ years, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  8.40625    0.49085  17.126  < 2e-16 ***
years        0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

crPlots(q1)
[1] 20
cooks <- cooks.distance(q1)
[1] 21
which(cooks > (4/(200 - 1 - 1)))
[1] 22
 16  61  88  89  94 108 137 141 154 163 171 175 192 200 
 16  61  88  89  94 108 137 141 154 163 171 175 192 200 
plot(q1, which = 4)
[1] 23
q1.1 <- lm(empathy ~ years, data = df[-c(16, 61, 88, 89, 94, 
    108, 137, 141, 154, 163, 171, 175, 192, 200), ])
[1] 24
summary(q1.1)
[1] 25

Call:
lm(formula = empathy ~ years, data = df[-c(16, 61, 88, 89, 94, 
    108, 137, 141, 154, 163, 171, 175, 192, 200), ])

Residuals:
   Min     1Q Median     3Q    Max 
-4.681 -1.378  0.008  1.307  5.532 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  8.36973    0.49518  16.902  < 2e-16 ***
years        0.26223    0.05804   4.518 1.11e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.064 on 184 degrees of freedom
Multiple R-squared:  0.09986,	Adjusted R-squared:  0.09497 
F-statistic: 20.41 on 1 and 184 DF,  p-value: 1.114e-05

crPlots(q1.1)
[1] 26
ncvTest(q1.1)
[1] 27
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.5295132, Df = 1, p = 0.46681
durbinWatsonTest(q1.1)
[1] 28
 lag Autocorrelation D-W Statistic p-value
   1      0.05174473      1.895214   0.482
 Alternative hypothesis: rho != 0
qqPlot(q1.1)
[1] 29
hist(q1.1$residuals)
[1] 30
shapiro.test(q1.1$residuals)
[1] 31

	Shapiro-Wilk normality test

data:  q1.1$residuals
W = 0.98896, p-value = 0.1589

q2 <- lm(incidents ~ empathy + years + training, data = df)
[1] 32
summary(q2)
[1] 33

Call:
lm(formula = incidents ~ empathy + years + training, data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.407320   0.051814   7.861 2.48e-13 ***
empathy           0.025396   0.004735   5.363 2.29e-07 ***
years            -0.014085   0.003889  -3.622 0.000372 ***
trainingtraining -0.152427   0.023166  -6.580 4.20e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

crPlots(q2)
[1] 34
ncvTest(q2)
[1] 35
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0293323, Df = 1, p = 0.86401
durbinWatsonTest(q2)
[1] 36
 lag Autocorrelation D-W Statistic p-value
   1      -0.1072849      2.199897   0.208
 Alternative hypothesis: rho != 0
qqPlot(q2)
[1] 37
hist(q2$residuals)
[1] 38
shapiro.test(q2$residuals)
[1] 39

	Shapiro-Wilk normality test

data:  q2$residuals
W = 0.97994, p-value = 0.005838

cooks <- cooks.distance(q2)
[1] 40
which(cooks > (4/(200 - 3 - 1)))
[1] 41
 13  35  74 137 165 
 13  35  74 137 165 
plot(q2, which = 4)
[1] 42
log.incidents <- log(df$incidents + (-1 * min(df$incidents) + 
    1))
[1] 43
q2.1 <- lm(log.incidents ~ df$empathy + df$years + df$training, 
    data = df[-c(13, 35, 74, 137, 165), ])
[1] 44
summary(q2.1)
[1] 45

Call:
lm(formula = log.incidents ~ df$empathy + df$years + df$training, 
    data = df[-c(13, 35, 74, 137, 165), ])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.27676 -0.08678 -0.00271  0.07438  0.35035 

Coefficients:
                     Estimate Std. Error t value Pr(>|t|)    
(Intercept)          0.272109   0.036897   7.375 4.53e-12 ***
df$empathy           0.018550   0.003372   5.501 1.17e-07 ***
df$years            -0.010283   0.002769  -3.713 0.000266 ***
df$trainingtraining -0.111288   0.016497  -6.746 1.67e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1155 on 196 degrees of freedom
Multiple R-squared:  0.2661,	Adjusted R-squared:  0.2549 
F-statistic: 23.69 on 3 and 196 DF,  p-value: 3.963e-13

crPlots(q2.1)
[1] 46
ncvTest(q2.1)
[1] 47
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 1.036059, Df = 1, p = 0.30874
durbinWatsonTest(q2.1)
[1] 48
 lag Autocorrelation D-W Statistic p-value
   1       -0.116516      2.217742   0.158
 Alternative hypothesis: rho != 0
qqPlot(q2.1)
[1] 49
hist(q2.1$residuals)
[1] 50
shapiro.test(q2.1$residuals)
[1] 51

	Shapiro-Wilk normality test

data:  q2.1$residuals
W = 0.9905, p-value = 0.2109

vif(q2.1)
[1] 52
 df$empathy    df$years df$training 
   1.092467    1.085089    1.020633 
q3 <- lm(log.incidents ~ empathy + years + feedback, data = df)
[1] 53
summary(q3)
[1] 54

Call:
lm(formula = log.incidents ~ empathy + years + feedback, data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.27663 -0.07576 -0.00237  0.08302  0.35261 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.176834   0.038637   4.577 8.37e-06 ***
empathy           0.016926   0.003448   4.909 1.92e-06 ***
years            -0.009257   0.002839  -3.261  0.00131 ** 
feedbackfeedback  0.095615   0.016841   5.677 4.87e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1188 on 196 degrees of freedom
Multiple R-squared:  0.2235,	Adjusted R-squared:  0.2116 
F-statistic:  18.8 on 3 and 196 DF,  p-value: 9.283e-11

crPlots(q3)
[1] 55
ncvTest(q3)
[1] 56
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.6746094, Df = 1, p = 0.41145
durbinWatsonTest(q3)
[1] 57
 lag Autocorrelation D-W Statistic p-value
   1       0.2794347      1.431864       0
 Alternative hypothesis: rho != 0
shapiro.test(q3$residuals)
[1] 58

	Shapiro-Wilk normality test

data:  q3$residuals
W = 0.99572, p-value = 0.8487

vif(q3)
[1] 59
 empathy    years feedback 
1.079397 1.077467 1.005211 
q5 <- lm(incidents ~ empathy + years + training * feedback, data = df)
[1] 60
summary(q5)
[1] 61

Call:
lm(formula = incidents ~ empathy + years + training * feedback, 
    data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30367 -0.10365 -0.00795  0.08806  0.44359 

Coefficients:
                                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)                        0.345467   0.048515   7.121 2.04e-11 ***
empathy                            0.028695   0.004328   6.630 3.25e-10 ***
years                             -0.015720   0.003518  -4.468 1.34e-05 ***
trainingtraining                  -0.203496   0.029874  -6.812 1.18e-10 ***
feedbackfeedback                   0.085558   0.029299   2.920  0.00391 ** 
trainingtraining:feedbackfeedback  0.097334   0.041840   2.326  0.02103 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1462 on 194 degrees of freedom
Multiple R-squared:  0.4015,	Adjusted R-squared:  0.386 
F-statistic: 26.02 on 5 and 194 DF,  p-value: < 2.2e-16

describeBy(df$incidents, group = list(df$training, df$feedback), 
    mat = T)
[1] 62
    item      group1      group2 vars  n      mean        sd    median   trimmed     mad        min       max     range
X11    1 no training no feedback    1 50 0.4933333 0.1673794 0.4166667 0.4770833 0.12355 0.25000000 0.9166667 0.6666667
X12    2    training no feedback    1 50 0.3333333 0.1398493 0.3333333 0.3270833 0.12355 0.08333333 0.5833333 0.5000000
X13    3 no training    feedback    1 50 0.5900000 0.1707327 0.5833333 0.5875000 0.12355 0.25000000 0.9166667 0.6666667
          skew   kurtosis         se
X11 0.81813067 -0.0698501 0.02367103
X12 0.15233791 -0.9575614 0.01977768
X13 0.04793352 -0.8075298 0.02414525
 [ reached 'max' / getOption("max.print") -- omitted 1 rows ]
avPlots(q5)
[1] 63
ncvTest(q5)
[1] 64
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 4.398557, Df = 1, p = 0.035969
q5.1 <- lm(log.incidents ~ empathy + years + training * feedback, 
    data = df)
[1] 65
summary(q5.1)
[1] 66

Call:
lm(formula = log.incidents ~ empathy + years + training * feedback, 
    data = df)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.226383 -0.071808 -0.000811  0.069089  0.284822 

Coefficients:
                                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)                        0.228340   0.034303   6.656 2.80e-10 ***
empathy                            0.021048   0.003060   6.878 8.14e-11 ***
years                             -0.011505   0.002488  -4.625 6.84e-06 ***
trainingtraining                  -0.151903   0.021123  -7.191 1.36e-11 ***
feedbackfeedback                   0.058376   0.020716   2.818  0.00533 ** 
trainingtraining:feedbackfeedback  0.077604   0.029583   2.623  0.00940 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1034 on 194 degrees of freedom
Multiple R-squared:  0.4176,	Adjusted R-squared:  0.4026 
F-statistic: 27.82 on 5 and 194 DF,  p-value: < 2.2e-16

avPlots(q5.1)
[1] 67
ncvTest(q5.1)
[1] 68
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.577295, Df = 1, p = 0.44737
durbinWatsonTest(q5.1)
[1] 69
 lag Autocorrelation D-W Statistic p-value
   1      0.09726586      1.794988   0.188
 Alternative hypothesis: rho != 0
shapiro.test(q5.1$residuals)
[1] 70

	Shapiro-Wilk normality test

data:  q5.1$residuals
W = 0.99434, p-value = 0.6515

vif(q5.1)
[1] 71
          empathy             years          training          feedback training:feedback 
         1.122147          1.092150          2.086826          2.007327          3.070068 
q6 <- lm(incidents ~ empathy, data = df)
[1] 72
summary(q6)
[1] 73

Call:
lm(formula = incidents ~ empathy, data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.39387 -0.12084 -0.01977  0.11454  0.46250 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 0.294610   0.053195   5.538 9.64e-08 ***
empathy     0.017729   0.005073   3.494 0.000586 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1816 on 198 degrees of freedom
Multiple R-squared:  0.05809,	Adjusted R-squared:  0.05333 
F-statistic: 12.21 on 1 and 198 DF,  p-value: 0.0005861

q7 <- lm(incidents ~ years, data = df)
[1] 74
summary(q7)
[1] 75

Call:
lm(formula = incidents ~ years, data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.41340 -0.12868 -0.03146  0.12132  0.46159 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.531452   0.037188  14.291   <2e-16 ***
years       -0.006944   0.004279  -1.623    0.106    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1859 on 198 degrees of freedom
Multiple R-squared:  0.01312,	Adjusted R-squared:  0.008141 
F-statistic: 2.633 on 1 and 198 DF,  p-value: 0.1062

q8 <- lm(incidents ~ empathy + years, data = df)
[1] 76
summary(q8)
[1] 77

Call:
lm(formula = incidents ~ empathy + years, data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.41333 -0.11682 -0.02057  0.10135  0.46713 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.351145   0.056325   6.234 2.71e-09 ***
empathy      0.021449   0.005177   4.143 5.08e-05 ***
years       -0.011610   0.004266  -2.722  0.00708 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1787 on 197 degrees of freedom
Multiple R-squared:  0.09222,	Adjusted R-squared:  0.08301 
F-statistic: 10.01 on 2 and 197 DF,  p-value: 7.259e-05

