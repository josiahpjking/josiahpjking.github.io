

	####### B095109 R script #######

setwd("~/Desktop/R/datasets/data_part1")
[1] 1
install.packages("interactions")
[1] 2
install.packages("lm.beta")
[1] 3
library(psych, quietly = T)
[1] 4
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 5
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[10] "methods"   "base"     
library(interactions, quietly = T)
[1] 6
 [1] "interactions" "car"          "carData"      "psych"        "readr"        "stats"        "graphics"    
 [8] "grDevices"    "utils"        "datasets"     "methods"      "base"        
library(lm.beta, quietly = T)
[1] 7
 [1] "lm.beta"      "interactions" "car"          "carData"      "psych"        "readr"        "stats"       
 [8] "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
bullying <- read.csv("../RMS2_report_1920.csv")
[1] 8
summary(bullying)
[1] 9
    subject         incidents          training      feedback      empathy          years      
 Min.   :  1.00   Min.   :0.08333   Min.   :1.0   Min.   :1.0   Min.   : 3.00   Min.   : 1.00  
 1st Qu.: 50.75   1st Qu.:0.33333   1st Qu.:1.0   1st Qu.:1.0   1st Qu.: 9.00   1st Qu.: 6.00  
 Median :100.50   Median :0.41667   Median :1.5   Median :1.5   Median :10.00   Median : 8.00  
 Mean   :100.50   Mean   :0.47500   Mean   :1.5   Mean   :1.5   Mean   :10.18   Mean   : 8.13  
 3rd Qu.:150.25   3rd Qu.:0.58333   3rd Qu.:2.0   3rd Qu.:2.0   3rd Qu.:12.00   3rd Qu.:10.00  
 Max.   :200.00   Max.   :0.91667   Max.   :2.0   Max.   :2.0   Max.   :16.00   Max.   :19.00  
describe(bullying)[, c(2:4, 8, 9)]
[1] 10
            n   mean    sd  min    max
subject   200 100.50 57.88 1.00 200.00
incidents 200   0.48  0.19 0.08   0.92
training  200   1.50  0.50 1.00   2.00
feedback  200   1.50  0.50 1.00   2.00
empathy   200  10.18  2.54 3.00  16.00
years     200   8.13  3.08 1.00  19.00
which(is.na(bullying))
[1] 11
integer(0)
sum(bullying$incidents > 1 | bullying$incidents < 0)
[1] 12
[1] 0
sum(bullying$subject > 200 | bullying$subject < 1)
[1] 13
[1] 0
sum(bullying$training > 2 | bullying$training < 1)
[1] 14
[1] 0
sum(bullying$feedback > 2 | bullying$feedback < 1)
[1] 15
[1] 0
sum(bullying$empathy > 20 | bullying$empathy < 1)
[1] 16
[1] 0
sum(bullying$years > 30 | bullying$years < 0)
[1] 17
[1] 0
bullying$training <- as.factor(bullying$training)
[1] 18
levels(bullying$training)
[1] 19
[1] "1" "2"
levels(bullying$training) <- c("no", "yes")
[1] 20
str(bullying$training)
[1] 21
 Factor w/ 2 levels "no","yes": 2 2 2 2 2 2 2 2 2 2 ...
NULL
summary(bullying$training)
[1] 22
 no yes 
100 100 
bullying$feedback <- as.factor(bullying$feedback)
[1] 23
levels(bullying$feedback)
[1] 24
[1] "1" "2"
levels(bullying$feedback) <- c("no", "yes")
[1] 25
str(bullying$feedback)
[1] 26
 Factor w/ 2 levels "no","yes": 2 1 2 1 2 1 2 1 2 1 ...
NULL
summary(bullying$feedback)
[1] 27
 no yes 
100 100 
summary(bullying[, 3:4])
[1] 28
 training  feedback 
 no :100   no :100  
 yes:100   yes:100  
par(mfrow = c(1, 1))
[1] 29
$mfrow
[1] 1 1

plot(bullying$empathy, bullying$incidents, xlab = "Empathy", 
    ylab = "Incidents", main = "Incidents by Empathy")
[1] 30
plot(bullying$years, bullying$incidents, xlab = "Experience", 
    ylab = "Incidents", main = "Incidents by Experience")
[1] 31
par(mfrow = c(1, 2))
[1] 32
$mfrow
[1] 1 1

plot(bullying$training, bullying$incidents, xlab = "Training", 
    ylab = "Incidents", main = "Incidents by Training")
[1] 33
plot(bullying$feedback, bullying$incidents, xlab = "Feedback", 
    ylab = "Incidents", main = "Incidents by Feedback")
[1] 34
par(mfrow = c(1, 1))
[1] 35
$mfrow
[1] 1 2

plot(bullying$years, bullying$empathy, xlab = "Experience", ylab = "Empathy", 
    main = "Empathy by Experience")
[1] 36
m1 <- lm(empathy ~ years, data = bullying)
[1] 37
summary(m1)
[1] 38

Call:
lm(formula = empathy ~ years, data = bullying)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  8.40625    0.49085  17.126  < 2e-16 ***
years        0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

abline(m1)
[1] 39
abline(m1, col = "red")
[1] 40
summary(lm.beta(m1))
[1] 41

Call:
lm(formula = empathy ~ years, data = bullying)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Standardized Std. Error t value Pr(>|t|)    
(Intercept)  8.40625      0.00000    0.49085  17.126  < 2e-16 ***
years        0.21756      0.26404    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

cooks <- cooks.distance(m1)
[1] 42
which(cooks > (4/(200 - 1 - 1)))
[1] 43
 16  61  88  89  94 108 137 141 154 163 171 175 192 200 
 16  61  88  89  94 108 137 141 154 163 171 175 192 200 
plot(m1, which = 4, cook.levels = cutoff)
[1] 44
m1a <- lm(empathy ~ years, data = bullying[-c(88, 137, 154), 
    ])
[1] 45
summary(lm.beta(m1a))
[1] 46

Call:
lm(formula = empathy ~ years, data = bullying[-c(88, 137, 154), 
    ])

Residuals:
    Min      1Q  Median      3Q     Max 
-6.2211 -1.6555  0.0411  1.4756  5.7583 

Coefficients:
            Estimate Standardized Std. Error t value Pr(>|t|)    
(Intercept)  7.97944      0.00000    0.49438  16.140  < 2e-16 ***
years        0.28278      0.33072    0.05778   4.894 2.07e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.325 on 195 degrees of freedom
Multiple R-squared:  0.1094,	Adjusted R-squared:  0.1048 
F-statistic: 23.95 on 1 and 195 DF,  p-value: 2.068e-06

m1_coef <- summary(lm.beta(m1))
[1] 47
m1a_coef <- summary(lm.beta(m1a))
[1] 48
compare <- data.frame(round(m1_coef$coefficients[, 2], 3), round(m1_coef$coefficients[, 
    5], 4), round(m1a_coef$coefficients[, 2], 3), round(m1a_coef$coefficients[, 
    5], 4))
[1] 49
colnames(compare) <- c("M1 Coef", "M1 p-value", "M1a Coef", "M1a p-value")
[1] 50
compare

            M1 Coef M1 p-value M1a Coef M1a p-value
(Intercept)   0.000      0e+00    0.000           0
years         0.264      2e-04    0.331           0


cooks <- cooks.distance(m1a)
[1] 52
which(cooks > (4/(200 - 1 - 1)))
[1] 53
 16  61  89  92  94 108 131 140 141 155 163 171 175 192 200 
 16  61  88  91  93 107 130 138 139 152 160 168 172 189 197 
par(mfrow = c(1, 2))
[1] 54
$mfrow
[1] 1 1

plot(m1, which = 4, cook.levels = cutoff)
[1] 55
plot(m1a, which = 4, cook.levels = cutoff)
[1] 56
par(mfrow = c(1, 2))
[1] 57
$mfrow
[1] 1 2

qqPlot(m1a, main = "QQ Plot")
[1] 58
sresid <- MASS::studres(m1a)
[1] 59
head(sresid, 20)
[1] 60
          1           2           3           4           5           6           7           8           9 
 0.08300641  0.01768977  0.26170998 -0.41269340  0.27110135  0.08300641  1.19055686  1.38141306  0.87984419 
         10          11          12          13          14          15          16          17          18 
 0.63540285  0.57057465 -0.90311658 -0.41269340  0.87984419 -0.41269340 -1.67128560 -1.15471657 -0.41269340 
         19          20 
 0.26170998 -0.59376449 
hist(sresid, freq = FALSE, main = "Distribution of Studentized Residuals")
[1] 61
xfit <- seq(min(sresid), max(sresid), length = 40)
[1] 62
yfit <- dnorm(xfit)
[1] 63
lines(xfit, yfit, col = "red")
[1] 64
shapiro.test(sresid)
[1] 65

	Shapiro-Wilk normality test

data:  sresid
W = 0.99288, p-value = 0.4565

par(mfrow = c(1, 1))
[1] 66
$mfrow
[1] 1 2

residualPlots(m1a)
[1] 67
ncvTest(m1a)
[1] 68
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.01869613, Df = 1, p = 0.89124
crPlots(m1a)
[1] 69
durbinWatsonTest(m1a)
[1] 70
 lag Autocorrelation D-W Statistic p-value
   1       0.0580735      1.857553   0.308
 Alternative hypothesis: rho != 0
summary(lm.beta(m1a))
[1] 71

Call:
lm(formula = empathy ~ years, data = bullying[-c(88, 137, 154), 
    ])

Residuals:
    Min      1Q  Median      3Q     Max 
-6.2211 -1.6555  0.0411  1.4756  5.7583 

Coefficients:
            Estimate Standardized Std. Error t value Pr(>|t|)    
(Intercept)  7.97944      0.00000    0.49438  16.140  < 2e-16 ***
years        0.28278      0.33072    0.05778   4.894 2.07e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.325 on 195 degrees of freedom
Multiple R-squared:  0.1094,	Adjusted R-squared:  0.1048 
F-statistic: 23.95 on 1 and 195 DF,  p-value: 2.068e-06

confint(m1a)
[1] 72
                2.5 %    97.5 %
(Intercept) 7.0044240 8.9544469
years       0.1688158 0.3967399
par(mfrow = c(1, 1))
[1] 73
$mfrow
[1] 1 1

plot(bullying$training, bullying$incidents, xlab = "Training", 
    ylab = "Incidents (%)", main = "Incidents by Training")
[1] 74
m2 <- lm(incidents ~ training + empathy + years, data = bullying)
[1] 75
summary(m2)
[1] 76

Call:
lm(formula = incidents ~ training + empathy + years, data = bullying)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.407320   0.051814   7.861 2.48e-13 ***
trainingyes -0.152427   0.023166  -6.580 4.20e-10 ***
empathy      0.025396   0.004735   5.363 2.29e-07 ***
years       -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

summary(lm.beta(m2))
[1] 77

Call:
lm(formula = incidents ~ training + empathy + years, data = bullying)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
             Estimate Standardized Std. Error t value Pr(>|t|)    
(Intercept)  0.407320     0.000000   0.051814   7.861 2.48e-13 ***
trainingyes -0.152427    -0.409414   0.023166  -6.580 4.20e-10 ***
empathy      0.025396     0.345246   0.004735   5.363 2.29e-07 ***
years       -0.014085    -0.232381   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

cooks <- cooks.distance(m2)
[1] 78
which(cooks > (4/(200 - 1 - 1)))
[1] 79
 13  35  74  77 137 165 
 13  35  74  77 137 165 
plot(m2, which = 4, cook.levels = cutoff)
[1] 80
m2a <- lm(incidents ~ training + empathy + years, data = bullying[-c(13, 
    74, 137), ])
[1] 81
summary(lm.beta(m2a))
[1] 82

Call:
lm(formula = incidents ~ training + empathy + years, data = bullying[-c(13, 
    74, 137), ])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.29350 -0.11585 -0.00812  0.10001  0.40267 

Coefficients:
             Estimate Standardized Std. Error t value Pr(>|t|)    
(Intercept)  0.386104     0.000000   0.049898   7.738 5.50e-13 ***
trainingyes -0.153719    -0.419006   0.022279  -6.900 7.28e-11 ***
empathy      0.029033     0.396908   0.004656   6.236 2.77e-09 ***
years       -0.016244    -0.266756   0.003864  -4.204 4.01e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1552 on 193 degrees of freedom
Multiple R-squared:  0.2988,	Adjusted R-squared:  0.2879 
F-statistic: 27.41 on 3 and 193 DF,  p-value: 8.212e-15

m2_coef <- summary(lm.beta(m2))
[1] 83
m2a_coef <- summary(lm.beta(m2a))
[1] 84
compare <- data.frame(round(m2_coef$coefficients[, 2], 3), round(m2_coef$coefficients[, 
    5], 4), round(m2a_coef$coefficients[, 2], 3), round(m2a_coef$coefficients[, 
    5], 4))
[1] 85
colnames(compare) <- c("M2 Coef", "M2 p-value", "M2a Coef", "M2a p-value")
[1] 86
compare

            M2 Coef M2 p-value M2a Coef M2a p-value
(Intercept)   0.000      0e+00    0.000           0
trainingyes  -0.409      0e+00   -0.419           0
empathy       0.345      0e+00    0.397           0
years        -0.232      4e-04   -0.267           0


cooks <- cooks.distance(m2a)
[1] 88
which(cooks > (4/(200 - 1 - 1)))
[1] 89
  7  35  41  60  77 165 176 181 
  7  34  40  59  75 162 173 178 
par(mfrow = c(1, 2))
[1] 90
$mfrow
[1] 1 1

plot(m2, which = 4, cook.levels = cutoff)
[1] 91
plot(m2a, which = 4, cook.levels = cutoff)
[1] 92
qqPlot(m2, main = "QQ Plot")
[1] 93
sresid <- MASS::studres(m2)
[1] 94
hist(sresid, freq = FALSE, main = "Distribution of Studentized Residuals")
[1] 95
xfit <- seq(min(sresid), max(sresid), length = 40)
[1] 96
yfit <- dnorm(xfit)
[1] 97
lines(xfit, yfit, col = "red")
[1] 98
par(mfrow = c(1, 1))
[1] 99
$mfrow
[1] 1 2

residualPlots(m2)
[1] 100
ncvTest(m2)
[1] 101
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0293323, Df = 1, p = 0.86401
crPlots(m2)
[1] 102
durbinWatsonTest(m2)
[1] 103
 lag Autocorrelation D-W Statistic p-value
   1      -0.1072849      2.199897   0.192
 Alternative hypothesis: rho != 0
vif(m2)
[1] 104
training  empathy    years 
1.020633 1.092467 1.085089 
summary(lm.beta(m2))
[1] 105

Call:
lm(formula = incidents ~ training + empathy + years, data = bullying)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
             Estimate Standardized Std. Error t value Pr(>|t|)    
(Intercept)  0.407320     0.000000   0.051814   7.861 2.48e-13 ***
trainingyes -0.152427    -0.409414   0.023166  -6.580 4.20e-10 ***
empathy      0.025396     0.345246   0.004735   5.363 2.29e-07 ***
years       -0.014085    -0.232381   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

confint(m2)
[1] 106
                  2.5 %       97.5 %
(Intercept)  0.30513599  0.509504162
trainingyes -0.19811433 -0.106739356
empathy      0.01605669  0.034734598
years       -0.02175353 -0.006415556
par(mfrow = c(1, 1))
[1] 107
$mfrow
[1] 1 1

plot(bullying$feedback, bullying$incidents, xlab = "Feedback", 
    ylab = "Incidents (%)", main = "Incidents by Feedback")
[1] 108
m3 <- lm(incidents ~ feedback + empathy + years, data = bullying)
[1] 109
summary(m3)
[1] 110

Call:
lm(formula = incidents ~ feedback + empathy + years, data = bullying)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.276161   0.054108   5.104 7.84e-07 ***
feedbackyes  0.132132   0.023585   5.602 7.09e-08 ***
empathy      0.023187   0.004829   4.802 3.11e-06 ***
years       -0.012689   0.003975  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

summary(lm.beta(m3))
[1] 111

Call:
lm(formula = incidents ~ feedback + empathy + years, data = bullying)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
             Estimate Standardized Std. Error t value Pr(>|t|)    
(Intercept)  0.276161     0.000000   0.054108   5.104 7.84e-07 ***
feedbackyes  0.132132     0.354902   0.023585   5.602 7.09e-08 ***
empathy      0.023187     0.315225   0.004829   4.802 3.11e-06 ***
years       -0.012689    -0.209350   0.003975  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

cooks <- cooks.distance(m3)
[1] 112
which(cooks > (4/(200 - 1 - 1)))
[1] 113
 73  74  89 137 156 160 165 176 
 73  74  89 137 156 160 165 176 
plot(m3, which = 4, cook.levels = cutoff)
[1] 114
par(mfrow = c(1, 2))
[1] 115
$mfrow
[1] 1 1

qqPlot(m3, main = "QQ Plot")
[1] 116
sresid <- MASS::studres(m3)
[1] 117
hist(sresid, freq = FALSE, main = "Distribution of Studentized Residuals")
[1] 118
xfit <- seq(min(sresid), max(sresid), length = 40)
[1] 119
yfit <- dnorm(xfit)
[1] 120
lines(xfit, yfit, col = "red")
[1] 121
shapiro.test(sresid)
[1] 122

	Shapiro-Wilk normality test

data:  sresid
W = 0.98747, p-value = 0.07501

par(mfrow = c(1, 1))
[1] 123
$mfrow
[1] 1 2

residualPlots(m3)
[1] 124
ncvTest(m3)
[1] 125
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.01731234, Df = 1, p = 0.89532
crPlots(m3)
[1] 126
durbinWatsonTest(m3)
[1] 127
 lag Autocorrelation D-W Statistic p-value
   1       0.2738264      1.444081       0
 Alternative hypothesis: rho != 0
vif(m3)
[1] 128
feedback  empathy    years 
1.005211 1.079397 1.077467 
summary(lm.beta(m3))
[1] 129

Call:
lm(formula = incidents ~ feedback + empathy + years, data = bullying)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
             Estimate Standardized Std. Error t value Pr(>|t|)    
(Intercept)  0.276161     0.000000   0.054108   5.104 7.84e-07 ***
feedbackyes  0.132132     0.354902   0.023585   5.602 7.09e-08 ***
empathy      0.023187     0.315225   0.004829   4.802 3.11e-06 ***
years       -0.012689    -0.209350   0.003975  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

confint(m3)
[1] 130
                  2.5 %       97.5 %
(Intercept)  0.16945259  0.382869109
feedbackyes  0.08561885  0.178644455
empathy      0.01366456  0.032710219
years       -0.02052811 -0.004849104
m4 <- lm(incidents ~ empathy + years, data = bullying)
[1] 131
summary(m4)
[1] 132

Call:
lm(formula = incidents ~ empathy + years, data = bullying)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.41333 -0.11682 -0.02057  0.10135  0.46713 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.351145   0.056325   6.234 2.71e-09 ***
empathy      0.021449   0.005177   4.143 5.08e-05 ***
years       -0.011610   0.004266  -2.722  0.00708 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1787 on 197 degrees of freedom
Multiple R-squared:  0.09222,	Adjusted R-squared:  0.08301 
F-statistic: 10.01 on 2 and 197 DF,  p-value: 7.259e-05

anova(m4, m2)
[1] 133
Analysis of Variance Table

Model 1: incidents ~ empathy + years
Model 2: incidents ~ training + empathy + years
  Res.Df    RSS Df Sum of Sq      F  Pr(>F)    
1    197 6.2914                                
2    196 5.1532  1    1.1382 43.292 4.2e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
anova(m4, m3)
[1] 134
Analysis of Variance Table

Model 1: incidents ~ empathy + years
Model 2: incidents ~ feedback + empathy + years
  Res.Df    RSS Df Sum of Sq      F   Pr(>F)    
1    197 6.2914                                 
2    196 5.4230  1   0.86841 31.387 7.09e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
AIC(m2, m3)
[1] 135
   df       AIC
m2  5 -154.1654
m3  5 -143.9591
BIC(m2, m3)
[1] 136
   df       BIC
m2  5 -137.6738
m3  5 -127.4675
bullying$training <- as.numeric(bullying$training)
[1] 137
bullying$training <- ifelse(bullying$training == "2", 1, 0)
[1] 138
bullying$training
[1] 139
 [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 [ reached getOption("max.print") -- omitted 150 entries ]
bullying$feedback <- as.numeric(bullying$feedback)
[1] 140
bullying$feedback <- ifelse(bullying$feedback == "2", 1, 0)
[1] 141
bullying$feedback
[1] 142
 [1] 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0
 [ reached getOption("max.print") -- omitted 150 entries ]
m5 = lm(incidents ~ training * feedback, data = bullying)
[1] 143
summary(lm.beta(m5))
[1] 144

Call:
lm(formula = incidents ~ training * feedback, data = bullying)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40000 -0.10500  0.00000  0.08333  0.43333 

Coefficients:
                  Estimate Standardized Std. Error t value Pr(>|t|)    
(Intercept)        0.49333      0.00000    0.02314  21.323  < 2e-16 ***
training          -0.16000     -0.42976    0.03272  -4.890 2.09e-06 ***
feedback           0.09667      0.25964    0.03272   2.954  0.00352 ** 
training:feedback  0.05333      0.12406    0.04627   1.153  0.25047    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1636 on 196 degrees of freedom
Multiple R-squared:  0.2431,	Adjusted R-squared:  0.2315 
F-statistic: 20.99 on 3 and 196 DF,  p-value: 7.827e-12

cooks <- cooks.distance(m5)
[1] 145
which(cooks > (4/(200 - 1 - 1)))
[1] 146
  7  13  89 131 150 159 160 165 176 181 
  7  13  89 131 150 159 160 165 176 181 
plot(m5, which = 4, cook.levels = cutoff)
[1] 147
par(mfrow = c(1, 2))
[1] 148
$mfrow
[1] 1 1

qqPlot(m5, main = "QQ Plot")
[1] 149
sresid <- MASS::studres(m5)
[1] 150
hist(sresid, freq = FALSE, main = "Distribution of Studentized Residuals")
[1] 151
xfit <- seq(min(sresid), max(sresid), length = 40)
[1] 152
yfit <- dnorm(xfit)
[1] 153
lines(xfit, yfit, col = "red")
[1] 154
shapiro.test(sresid)
[1] 155

	Shapiro-Wilk normality test

data:  sresid
W = 0.97677, p-value = 0.002119

par(mfrow = c(1, 1))
[1] 156
$mfrow
[1] 1 2

ncvTest(m5)
[1] 157
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 1.881673, Df = 1, p = 0.17014
durbinWatsonTest(m5)
[1] 158
 lag Autocorrelation D-W Statistic p-value
   1       0.1114255      1.770733   0.142
 Alternative hypothesis: rho != 0
vif(m5)
[1] 159
         training          feedback training:feedback 
                2                 2                 3 
summary(lm.beta(m5))
[1] 160

Call:
lm(formula = incidents ~ training * feedback, data = bullying)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40000 -0.10500  0.00000  0.08333  0.43333 

Coefficients:
                  Estimate Standardized Std. Error t value Pr(>|t|)    
(Intercept)        0.49333      0.00000    0.02314  21.323  < 2e-16 ***
training          -0.16000     -0.42976    0.03272  -4.890 2.09e-06 ***
feedback           0.09667      0.25964    0.03272   2.954  0.00352 ** 
training:feedback  0.05333      0.12406    0.04627   1.153  0.25047    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1636 on 196 degrees of freedom
Multiple R-squared:  0.2431,	Adjusted R-squared:  0.2315 
F-statistic: 20.99 on 3 and 196 DF,  p-value: 7.827e-12

confint(m5)
[1] 161
                        2.5 %      97.5 %
(Intercept)        0.44770646  0.53896021
training          -0.22452614 -0.09547386
feedback           0.03214052  0.16119281
training:feedback -0.03792042  0.14458708
