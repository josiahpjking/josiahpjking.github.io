

	####### B123178 R script #######

install.packages("car")
[1] 1
install.packages("gqplot2")
[1] 2
install.packages("interactions")
[1] 3
install.packages("psych")
[1] 4
library(car, quietly = T)
[1] 5
 [1] "car"       "carData"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(interactions, quietly = T)
[1] 6
 [1] "interactions" "car"          "carData"      "readr"        "stats"        "graphics"     "grDevices"    "utils"       
 [9] "datasets"     "methods"      "base"        
library(psych, quietly = T)
[1] 7
 [1] "psych"        "interactions" "car"          "carData"      "readr"        "stats"        "graphics"     "grDevices"   
 [9] "utils"        "datasets"     "methods"      "base"        
data <- read.csv("~/Desktop/rms2/code_check/RMS2_report_1920.csv", 
    header = TRUE)
[1] 8
summary(data)
[1] 9
    subject         incidents          training      feedback      empathy          years      
 Min.   :  1.00   Min.   :0.08333   Min.   :1.0   Min.   :1.0   Min.   : 3.00   Min.   : 1.00  
 1st Qu.: 50.75   1st Qu.:0.33333   1st Qu.:1.0   1st Qu.:1.0   1st Qu.: 9.00   1st Qu.: 6.00  
 Median :100.50   Median :0.41667   Median :1.5   Median :1.5   Median :10.00   Median : 8.00  
 Mean   :100.50   Mean   :0.47500   Mean   :1.5   Mean   :1.5   Mean   :10.18   Mean   : 8.13  
 3rd Qu.:150.25   3rd Qu.:0.58333   3rd Qu.:2.0   3rd Qu.:2.0   3rd Qu.:12.00   3rd Qu.:10.00  
 Max.   :200.00   Max.   :0.91667   Max.   :2.0   Max.   :2.0   Max.   :16.00   Max.   :19.00  
head(data)
[1] 10
  subject incidents training feedback empathy years
1       1 0.6666667        2        2      11    10
2       2 0.3333333        2        1      10     7
3       3 0.3333333        2        2      10     5
4       4 0.4166667        2        1       9     7
5       5 0.5000000        2        2      12    12
6       6 0.2500000        2        1      11    10
data$training <- as.factor(data$training)
[1] 11
data$feedback <- as.factor(data$feedback)
[1] 12
summary(data)
[1] 13
    subject         incidents       training feedback    empathy          years      
 Min.   :  1.00   Min.   :0.08333   1:100    1:100    Min.   : 3.00   Min.   : 1.00  
 1st Qu.: 50.75   1st Qu.:0.33333   2:100    2:100    1st Qu.: 9.00   1st Qu.: 6.00  
 Median :100.50   Median :0.41667                     Median :10.00   Median : 8.00  
 Mean   :100.50   Mean   :0.47500                     Mean   :10.18   Mean   : 8.13  
 3rd Qu.:150.25   3rd Qu.:0.58333                     3rd Qu.:12.00   3rd Qu.:10.00  
 Max.   :200.00   Max.   :0.91667                     Max.   :16.00   Max.   :19.00  
plot(data$years, data$empathy, xlab = "Years of Experience", 
    ylab = "Empathy Score", main = "Relationship between Years of Experience and Empathy")
[1] 14
m1 <- lm(data$empathy ~ data$years)
[1] 15
scatter.smooth(x = data$years, y = data$empathy, main = "relation between years and empathy")
[1] 16
NULL
shapiro.test(data$empathy)
[1] 17

	Shapiro-Wilk normality test

data:  data$empathy
W = 0.97073, p-value = 0.0003477

shapiro.test(data$years)
[1] 18

	Shapiro-Wilk normality test

data:  data$years
W = 0.97276, p-value = 0.0006279

plot(log(data$years), log(data$empathy))
[1] 19
logm1 <- lm(log(data$empathy) ~ log(data$years))
[1] 20
summary(logm1)
[1] 21

Call:
lm(formula = log(data$empathy) ~ log(data$years))

Residuals:
     Min       1Q   Median       3Q      Max 
-0.99014 -0.14210  0.04352  0.18031  0.56373 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)      1.59548    0.08500  18.771  < 2e-16 ***
log(data$years)  0.34102    0.04126   8.266 1.98e-14 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.2556 on 198 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2528 
F-statistic: 68.32 on 1 and 198 DF,  p-value: 1.98e-14

shapiro.test(log(data$years))
[1] 22

	Shapiro-Wilk normality test

data:  log(data$years)
W = 0.91687, p-value = 3.455e-09

shapiro.test(log(data$empathy))
[1] 23

	Shapiro-Wilk normality test

data:  log(data$empathy)
W = 0.87796, p-value = 1.224e-11

logm1.resid <- resid(logm1)
[1] 24
crPlots(logm1)
[1] 25
`?`(crPlots)
[1] 26
question1 <- cor.test(data$years, data$empathy, method = "spearman")
[1] 27
question1


	Spearman's rank correlation rho

data:  data$years and data$empathy
S = 923838, p-value = 9.723e-06
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.3071045 



m2 <- lm(incidents ~ empathy + years + training, data = data)
[1] 29
summary(m2)
[1] 30

Call:
lm(formula = incidents ~ empathy + years + training, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.407320   0.051814   7.861 2.48e-13 ***
empathy      0.025396   0.004735   5.363 2.29e-07 ***
years       -0.014085   0.003889  -3.622 0.000372 ***
training2   -0.152427   0.023166  -6.580 4.20e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

qqPlot(m2)
[1] 31
shapiro.test(m2$residuals)
[1] 32

	Shapiro-Wilk normality test

data:  m2$residuals
W = 0.97994, p-value = 0.005838

hist(m2$residuals)
[1] 33
logm2 <- lm(log(incidents) ~ empathy + years + training, data = data)
[1] 34
summary(logm2)
[1] 35

Call:
lm(formula = log(incidents) ~ empathy + years + training, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.23509 -0.23391  0.04258  0.25072  0.97572 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept) -1.004980   0.124409  -8.078 6.59e-14 ***
empathy      0.065246   0.011370   5.738 3.59e-08 ***
years       -0.036951   0.009337  -3.957 0.000106 ***
training2   -0.386312   0.055624  -6.945 5.43e-11 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.3893 on 196 degrees of freedom
Multiple R-squared:  0.2809,	Adjusted R-squared:  0.2699 
F-statistic: 25.52 on 3 and 196 DF,  p-value: 5.564e-14

qqPlot(logm2)
[1] 36
shapiro.test(logm2$residuals)
[1] 37

	Shapiro-Wilk normality test

data:  logm2$residuals
W = 0.98378, p-value = 0.02105

hist(logm2$residuals)
[1] 38
residualPlots(logm2)
[1] 39
ncvTest(logm2)
[1] 40
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 24.55162, Df = 1, p = 7.2345e-07
plot(cooks.distance(logm2))
[1] 41
abline(h = cooks.distance(logm2) > (4/(200 - 3 - 1)), col = "red")
[1] 42
newdata <- data[-which(cooks.distance(logm2) > (4/(200 - 3 - 
    1))), ]
[1] 43
dim(newdata)
[1] 44
[1] 190   6
newlogm2 <- lm(log(incidents) ~ empathy + years + training, data = newdata)
[1] 45
residualPlots(newlogm2)
[1] 46
ncvTest(newlogm2)
[1] 47
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 5.09799, Df = 1, p = 0.023954
shapiro.test(newlogm2$residuals)
[1] 48

	Shapiro-Wilk normality test

data:  newlogm2$residuals
W = 0.98918, p-value = 0.1596

crPlots(newlogm2)
[1] 49
durbinWatsonTest(newlogm2)
[1] 50
 lag Autocorrelation D-W Statistic p-value
   1      -0.1613259       2.30684   0.032
 Alternative hypothesis: rho != 0
vif(newlogm2)
[1] 51
 empathy    years training 
1.115593 1.096010 1.032181 
summary(newlogm2)
[1] 52

Call:
lm(formula = log(incidents) ~ empathy + years + training, data = newdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.90012 -0.20386  0.01999  0.23225  0.88070 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept) -0.857891   0.116461  -7.366 5.53e-12 ***
empathy      0.051141   0.010844   4.716 4.71e-06 ***
years       -0.038678   0.008905  -4.344 2.30e-05 ***
training2   -0.299338   0.049741  -6.018 9.21e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.3371 on 186 degrees of freedom
Multiple R-squared:  0.2385,	Adjusted R-squared:  0.2262 
F-statistic: 19.42 on 3 and 186 DF,  p-value: 5.385e-11

m3 <- lm(log(incidents) ~ empathy + years + feedback, data = newdata)
[1] 53
summary(m3)
[1] 54

Call:
lm(formula = log(incidents) ~ empathy + years + feedback, data = newdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.01254 -0.17848  0.02121  0.25017  0.90013 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept) -1.098241   0.124390  -8.829 7.75e-16 ***
empathy      0.044263   0.011066   4.000 9.14e-05 ***
years       -0.033153   0.009141  -3.627  0.00037 ***
feedback2    0.241068   0.050654   4.759 3.90e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.3479 on 186 degrees of freedom
Multiple R-squared:  0.189,	Adjusted R-squared:  0.1759 
F-statistic: 14.44 on 3 and 186 DF,  p-value: 1.688e-08

newdata$feedback <- factor(newdata$feedback, labels = c("no feedback", 
    "feedback"))
[1] 55
table(newdata$feedback)
[1] 56

no feedback    feedback 
         93          97 
qqPlot(m3)
[1] 57
hist(m3$residuals)
[1] 58
shapiro.test(m3$residuals)
[1] 59

	Shapiro-Wilk normality test

data:  m3$residuals
W = 0.98235, p-value = 0.01702

residualPlots(m3)
[1] 60
ncvTest(m3)
[1] 61
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 1.745308, Df = 1, p = 0.18647
crPlots(m3)
[1] 62
durbinWatsonTest(m3)
[1] 63
 lag Autocorrelation D-W Statistic p-value
   1       0.1796981      1.632559   0.016
 Alternative hypothesis: rho != 0
vif(m3)
[1] 64
 empathy    years feedback 
1.090802 1.084403 1.006411 
summary(newlogm2)
[1] 65

Call:
lm(formula = log(incidents) ~ empathy + years + training, data = newdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.90012 -0.20386  0.01999  0.23225  0.88070 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept) -0.857891   0.116461  -7.366 5.53e-12 ***
empathy      0.051141   0.010844   4.716 4.71e-06 ***
years       -0.038678   0.008905  -4.344 2.30e-05 ***
training2   -0.299338   0.049741  -6.018 9.21e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.3371 on 186 degrees of freedom
Multiple R-squared:  0.2385,	Adjusted R-squared:  0.2262 
F-statistic: 19.42 on 3 and 186 DF,  p-value: 5.385e-11

summary(m3)
[1] 66

Call:
lm(formula = log(incidents) ~ empathy + years + feedback, data = newdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.01254 -0.17848  0.02121  0.25017  0.90013 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept) -1.098241   0.124390  -8.829 7.75e-16 ***
empathy      0.044263   0.011066   4.000 9.14e-05 ***
years       -0.033153   0.009141  -3.627  0.00037 ***
feedback2    0.241068   0.050654   4.759 3.90e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.3479 on 186 degrees of freedom
Multiple R-squared:  0.189,	Adjusted R-squared:  0.1759 
F-statistic: 14.44 on 3 and 186 DF,  p-value: 1.688e-08

m4 <- lm(log(incidents) ~ empathy + years + feedback + training, 
    data = newdata)
[1] 67
summary(m4)
[1] 68

Call:
lm(formula = log(incidents) ~ empathy + years + feedback + training, 
    data = newdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.83728 -0.17004  0.03277  0.19458  0.77250 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)      -1.028978   0.112251  -9.167  < 2e-16 ***
empathy           0.055827   0.010091   5.532 1.07e-07 ***
years            -0.038880   0.008258  -4.708 4.89e-06 ***
feedbackfeedback  0.254823   0.045564   5.593 7.94e-08 ***
training2        -0.310916   0.046175  -6.733 2.02e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.3126 on 185 degrees of freedom
Multiple R-squared:  0.3486,	Adjusted R-squared:  0.3345 
F-statistic: 24.75 on 4 and 185 DF,  p-value: < 2.2e-16

anova(m3, m4)
[1] 69
Analysis of Variance Table

Model 1: log(incidents) ~ empathy + years + feedback
Model 2: log(incidents) ~ empathy + years + feedback + training
  Res.Df    RSS Df Sum of Sq     F    Pr(>F)    
1    186 22.515                                 
2    185 18.083  1    4.4318 45.34 2.023e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
anova(newlogm2, m4)
[1] 70
Analysis of Variance Table

Model 1: log(incidents) ~ empathy + years + training
Model 2: log(incidents) ~ empathy + years + feedback + training
  Res.Df    RSS Df Sum of Sq      F    Pr(>F)    
1    186 21.140                                  
2    185 18.083  1    3.0572 31.277 7.938e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
qqPlot(m4)
[1] 71
hist(m4$residuals)
[1] 72
shapiro.test(m4$residuals)
[1] 73

	Shapiro-Wilk normality test

data:  m4$residuals
W = 0.98597, p-value = 0.05563

residualPlots(m4)
[1] 74
ncvTest(m4)
[1] 75
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 2.073866, Df = 1, p = 0.14984
crPlots(m4)
[1] 76
durbinWatsonTest(m4)
[1] 77
 lag Autocorrelation D-W Statistic p-value
   1     -0.01962982      2.025471   0.884
 Alternative hypothesis: rho != 0
vif(m4)
[1] 78
 empathy    years feedback training 
1.123337 1.096030 1.008438 1.034260 
is.factor(newdata$training)
[1] 79
[1] TRUE
is.factor(newdata$feedback)
[1] 80
[1] TRUE
m5 <- lm(log(incidents) ~ empathy + years + training + feedback + 
    training * feedback, data = newdata)
[1] 81
summary(m5)
[1] 82

Call:
lm(formula = log(incidents) ~ empathy + years + training + feedback + 
    training * feedback, data = newdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.88578 -0.19172  0.01972  0.20967  0.72274 

Coefficients:
                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                -1.018544   0.110876  -9.186  < 2e-16 ***
empathy                     0.061066   0.010191   5.992 1.07e-08 ***
years                      -0.040187   0.008169  -4.920 1.92e-06 ***
training2                  -0.429135   0.066679  -6.436 1.03e-09 ***
feedbackfeedback            0.150173   0.062281   2.411   0.0169 *  
training2:feedbackfeedback  0.222925   0.091780   2.429   0.0161 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.3086 on 184 degrees of freedom
Multiple R-squared:  0.3688,	Adjusted R-squared:  0.3517 
F-statistic: 21.51 on 5 and 184 DF,  p-value: < 2.2e-16

anova(m4, m5)
[1] 83
Analysis of Variance Table

Model 1: log(incidents) ~ empathy + years + feedback + training
Model 2: log(incidents) ~ empathy + years + training + feedback + training * 
    feedback
  Res.Df    RSS Df Sum of Sq      F  Pr(>F)  
1    185 18.083                              
2    184 17.521  1   0.56178 5.8995 0.01611 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
cat_plot(m5, pred = feedback, modx = training, geom = "line", 
    data = newdata)
[1] 84
par(mfrow = c(2, 2))
[1] 85
$mfrow
[1] 1 2

plot(m5)
[1] 86
qqPlot(m5)
[1] 87
hist(m5$residuals)
[1] 88
shapiro.test(m5$residuals)
[1] 89

	Shapiro-Wilk normality test

data:  m5$residuals
W = 0.98681, p-value = 0.07328

residualPlots(m5)
[1] 90
ncvTest(m5)
[1] 91
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 1.940412, Df = 1, p = 0.16362
durbinWatsonTest(m5)
[1] 92
 lag Autocorrelation D-W Statistic p-value
   1     0.009240309      1.970523   0.818
 Alternative hypothesis: rho != 0
vif(m5)
[1] 93
          empathy             years          training          feedback training:feedback 
         1.176008          1.100807          2.213854          1.934016          3.173392 
