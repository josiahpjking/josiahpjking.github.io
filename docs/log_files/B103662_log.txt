

	####### B103662 R script #######

RMS2_report_1920 <- read.csv("../RMS2_report_1920.csv")
[1] 1
View(RMS2_report_1920)
[1] 2
data <- RMS2_report_1920
[1] 3
library("psych", quietly = T)
[1] 4
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library("ggplot2", quietly = T)
[1] 5
 [1] "ggplot2"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[10] "base"     
library("car", quietly = T)
[1] 6
 [1] "car"       "carData"   "ggplot2"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"    
[10] "datasets"  "methods"   "base"     
library("carData", quietly = T)
[1] 7
 [1] "car"       "carData"   "ggplot2"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"    
[10] "datasets"  "methods"   "base"     
library("interactions", quietly = T)
[1] 8
 [1] "interactions" "car"          "carData"      "ggplot2"      "psych"        "readr"        "stats"       
 [8] "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
library("jtools", quietly = T)
[1] 9
 [1] "jtools"       "interactions" "car"          "carData"      "ggplot2"      "psych"        "readr"       
 [8] "stats"        "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
library("lm.beta", quietly = T)
[1] 10
 [1] "lm.beta"      "jtools"       "interactions" "car"          "carData"      "ggplot2"      "psych"       
 [8] "readr"        "stats"        "graphics"     "grDevices"    "utils"        "datasets"     "methods"     
[15] "base"        
library("tools", quietly = T)
[1] 11
 [1] "tools"        "lm.beta"      "jtools"       "interactions" "car"          "carData"      "ggplot2"     
 [8] "psych"        "readr"        "stats"        "graphics"     "grDevices"    "utils"        "datasets"    
[15] "methods"      "base"        
describe(data)
[1] 12
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training     3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
str(data)
[1] 13
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : int  2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : int  2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
data$training <- as.factor(data$training)
[1] 14
data$feedback <- as.factor(data$feedback)
[1] 15
str(data$training)
[1] 16
 Factor w/ 2 levels "1","2": 2 2 2 2 2 2 2 2 2 2 ...
NULL
str(data$feedback)
[1] 17
 Factor w/ 2 levels "1","2": 2 1 2 1 2 1 2 1 2 1 ...
NULL
summary(data$training)
[1] 18
  1   2 
100 100 
summary(data$feedback)
[1] 19
  1   2 
100 100 
str(data)
[1] 20
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : Factor w/ 2 levels "1","2": 2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : Factor w/ 2 levels "1","2": 2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
data$training <- factor(data$training, labels = c("No training", 
    "Training"))
[1] 21
str(data$training)
[1] 22
 Factor w/ 2 levels "No training",..: 2 2 2 2 2 2 2 2 2 2 ...
NULL
summary(data$training)
[1] 23
No training    Training 
        100         100 
data$feedback <- factor(data$feedback, labels = c("No feedback", 
    "Feedback"))
[1] 24
summary(data$feedback)
[1] 25
No feedback    Feedback 
        100         100 
str(data)
[1] 26
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : Factor w/ 2 levels "No training",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : Factor w/ 2 levels "No feedback",..: 2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
describe(data)[c(1:6), c(2:4, 8, 9, 11, 12)]
[1] 27
            n   mean    sd  min    max  skew kurtosis
subject   200 100.50 57.88 1.00 200.00  0.00    -1.22
incidents 200   0.48  0.19 0.08   0.92  0.32    -0.31
training* 200   1.50  0.50 1.00   2.00  0.00    -2.01
feedback* 200   1.50  0.50 1.00   2.00  0.00    -2.01
empathy   200  10.18  2.54 3.00  16.00 -0.37     0.23
years     200   8.13  3.08 1.00  19.00  0.52     0.48
summary(data[, 3:4])
[1] 28
        training          feedback  
 No training:100   No feedback:100  
 Training   :100   Feedback   :100  
View(data)
[1] 29
plot(data$empathy, data$incidents, xlab = "Teacher empathy score", 
    ylab = "Bullying incidents intervented in", main = "Scatterplot to represent the relationship between empathy score and interventions in bullying incidents")
[1] 30
plot(data$years, data$incidents, xlab = "Years of teaching experience", 
    ylab = "Bullying incidents intervened in", main = "Scatterplot to represent the relationship between years of teaching and interventions in bullying incidents")
[1] 31
plot(data$training, data$incidents, xlab = "Teacher training level", 
    ylab = "Bullying incidents intervened in", main = "Boxplots to represent the relationship between training level and interventions in bullying incidents")
[1] 32
plot(data$feedback, data$incidents, xlab = "Feedback level", 
    ylab = "Bullying incidents intervened in", main = "Boxplots to represent the relationship between feedback level and interventions in bullying incidents")
[1] 33
describe(data)[, c(1:4, 8, 9)]
[1] 34
          vars   n   mean    sd  min    max
subject      1 200 100.50 57.88 1.00 200.00
incidents    2 200   0.48  0.19 0.08   0.92
training*    3 200   1.50  0.50 1.00   2.00
feedback*    4 200   1.50  0.50 1.00   2.00
empathy      5 200  10.18  2.54 3.00  16.00
years        6 200   8.13  3.08 1.00  19.00
library(ggplot2, quietly = T)
[1] 35
 [1] "tools"        "lm.beta"      "jtools"       "interactions" "car"          "carData"      "ggplot2"     
 [8] "psych"        "readr"        "stats"        "graphics"     "grDevices"    "utils"        "datasets"    
[15] "methods"      "base"        
ggplot(data = data, aes(x = years, y = empathy, xlab = "Years teaching experience", 
    ylab = "Teacher empathy")) + geom_point() + geom_smooth(method = "lm")
[1] 36
cor.test(data$years, data$empathy)
[1] 37

	Pearson's product-moment correlation

data:  data$years and data$empathy
t = 3.852, df = 198, p-value = 0.0001582
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.1300604 0.3885445
sample estimates:
      cor 
0.2640369 

model1 <- lm(incidents ~ years + empathy + years * empathy, data = data)
[1] 38
summary(model1)
[1] 39

Call:
lm(formula = incidents ~ years + empathy + years * empathy, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.41516 -0.11427 -0.01661  0.10733  0.46912 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)   
(Intercept)    0.197617   0.105294   1.877  0.06203 . 
years          0.009296   0.012859   0.723  0.47059   
empathy        0.040493   0.012198   3.320  0.00107 **
years:empathy -0.002480   0.001440  -1.722  0.08659 . 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1778 on 196 degrees of freedom
Multiple R-squared:  0.1058,	Adjusted R-squared:  0.09207 
F-statistic: 7.727 on 3 and 196 DF,  p-value: 6.636e-05

data$empathy_mean <- data$empathy - mean(data$empathy)
[1] 40
data$years_mean <- data$years - mean(data$years)
[1] 41
describe(data)[, c(1:4, 8, 9)]
[1] 42
             vars   n   mean    sd   min    max
subject         1 200 100.50 57.88  1.00 200.00
incidents       2 200   0.48  0.19  0.08   0.92
training*       3 200   1.50  0.50  1.00   2.00
feedback*       4 200   1.50  0.50  1.00   2.00
empathy         5 200  10.18  2.54  3.00  16.00
years           6 200   8.13  3.08  1.00  19.00
empathy_mean    7 200   0.00  2.54 -7.18   5.82
years_mean      8 200   0.00  3.08 -7.13  10.87
m1 <- lm(incidents ~ years_mean + empathy_mean + years_mean * 
    empathy_mean, data = data)
[1] 43
summary(m1)
[1] 44

Call:
lm(formula = incidents ~ years_mean + empathy_mean + years_mean * 
    empathy_mean, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.41516 -0.11427 -0.01661  0.10733  0.46912 

Coefficients:
                         Estimate Std. Error t value Pr(>|t|)    
(Intercept)              0.480089   0.012916  37.169  < 2e-16 ***
years_mean              -0.015934   0.004931  -3.231 0.001446 ** 
empathy_mean             0.020334   0.005192   3.916 0.000124 ***
years_mean:empathy_mean -0.002480   0.001440  -1.722 0.086587 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1778 on 196 degrees of freedom
Multiple R-squared:  0.1058,	Adjusted R-squared:  0.09207 
F-statistic: 7.727 on 3 and 196 DF,  p-value: 6.636e-05

confint(m1, level = 0.95)
[1] 45
                               2.5 %        97.5 %
(Intercept)              0.454615954  0.5055615619
years_mean              -0.025659322 -0.0062084908
empathy_mean             0.010094436  0.0305728321
years_mean:empathy_mean -0.005318843  0.0003596448
-m1$coefficients[3]/m1$coefficients[4]
[1] 46
empathy_mean 
    8.200371 
-m1$coefficients[2]/m1$coefficients[4]
[1] 47
years_mean 
    -6.426 
interact_plot(m1, pred = years_mean, modx = empathy_mean, plot.points = TRUE, 
    x.label = "Mean years teaching experience", y.label = "Mean teacher empathy", 
    legend.main = "Bullying incidents intervened in", main.title = "Interaction plot for years teaching experience and teacher empathy")
[1] 48
sim_slopes(m1, pred = years_mean, modx = empathy_mean, johnson_neyman = FALSE)
[1] 49
SIMPLE SLOPES ANALYSIS 

Slope of years_mean when empathy_mean = -2.54 (- 1 SD): 

   Est.   S.E.   t val.      p
------- ------ -------- ------
  -0.01   0.00    -2.19   0.03

Slope of years_mean when empathy_mean = -0.00 (Mean): 

   Est.   S.E.   t val.      p
------- ------ -------- ------
  -0.02   0.00    -3.23   0.00

Slope of years_mean when empathy_mean =  2.54 (+ 1 SD): 

   Est.   S.E.   t val.      p
------- ------ -------- ------
  -0.02   0.01    -2.97   0.00

interact_plot(m1, pred = years_mean, modx = empathy_mean, plot.points = TRUE, 
    modx.values = c(-4, -2, 0), x.label = "Mean years teaching experience", 
    y.label = "Mean teacher empathy", legend.main = "Bullying incidents intervened in", 
    main.title = "Interaction plot for years teaching experince and teacher empathy")
[1] 50
sim_slopes(m1, pred = years_mean, modx = empathy_mean, johnson_neyman = FALSE, 
    modx.values = c(-4, 2, 0))
[1] 51
SIMPLE SLOPES ANALYSIS 

Slope of years_mean when empathy_mean = -4.00: 

   Est.   S.E.   t val.      p
------- ------ -------- ------
  -0.01   0.01    -1.13   0.26

Slope of years_mean when empathy_mean =  0.00: 

   Est.   S.E.   t val.      p
------- ------ -------- ------
  -0.02   0.00    -3.23   0.00

Slope of years_mean when empathy_mean =  2.00: 

   Est.   S.E.   t val.      p
------- ------ -------- ------
  -0.02   0.01    -3.05   0.00

johnson_neyman(m1, pred = years_mean, modx = empathy_mean, alpha = 0.05)
[1] 52
plot(cooks.distance(m1))
[1] 53
abline(h = cooks.distance(m1) > (4/(200 - 2 - 1)), col = "red")
[1] 54
which(cooks.distance(m1) > (4/(200 - 2 - 1)))
[1] 55
 30  35  60  74  77  88  89  94 137 154 165 181 200 
 30  35  60  74  77  88  89  94 137 154 165 181 200 
names(which(cooks.distance(m1) > (4/(200 - 2 - 1))))
[1] 56
 [1] "30"  "35"  "60"  "74"  "77"  "88"  "89"  "94"  "137" "154" "165" "181" "200"
plot(m1, which = 4)
[1] 57
m1a <- lm(incidents ~ years_mean + empathy_mean + years_mean * 
    empathy_mean, data = data[-c(35, 89, 137, 200), ])
[1] 58
summary(lm.beta(m1a))
[1] 59

Call:
lm(formula = incidents ~ years_mean + empathy_mean + years_mean * 
    empathy_mean, data = data[-c(35, 89, 137, 200), ])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.41490 -0.11445 -0.01838  0.10527  0.47294 

Coefficients:
                         Estimate Standardized Std. Error t value Pr(>|t|)    
(Intercept)              0.479522     0.000000   0.012964  36.988  < 2e-16 ***
years_mean              -0.017847    -0.281693   0.005002  -3.568 0.000454 ***
empathy_mean             0.020225     0.269280   0.005420   3.732 0.000250 ***
years_mean:empathy_mean -0.003414    -0.169706   0.001585  -2.154 0.032473 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1755 on 192 degrees of freedom
Multiple R-squared:  0.1159,	Adjusted R-squared:  0.1021 
F-statistic: 8.389 on 3 and 192 DF,  p-value: 2.871e-05

summary(m1a)
[1] 60

Call:
lm(formula = incidents ~ years_mean + empathy_mean + years_mean * 
    empathy_mean, data = data[-c(35, 89, 137, 200), ])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.41490 -0.11445 -0.01838  0.10527  0.47294 

Coefficients:
                         Estimate Std. Error t value Pr(>|t|)    
(Intercept)              0.479522   0.012964  36.988  < 2e-16 ***
years_mean              -0.017847   0.005002  -3.568 0.000454 ***
empathy_mean             0.020225   0.005420   3.732 0.000250 ***
years_mean:empathy_mean -0.003414   0.001585  -2.154 0.032473 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1755 on 192 degrees of freedom
Multiple R-squared:  0.1159,	Adjusted R-squared:  0.1021 
F-statistic: 8.389 on 3 and 192 DF,  p-value: 2.871e-05

m1_coef <- summary(lm.beta(m1))
[1] 61
m1a_coef <- summary(lm.beta(m1a))
[1] 62
compare <- data.frame(round(m1_coef$coefficients[, 2], 3), round(m1_coef$coefficients[, 
    5], 4), round(m1a_coef$coefficients[, 2], 3), round(m1a_coef$coefficients[, 
    5], 4))
[1] 63
colnames(compare) <- c("M1 Coef", "M1 p-value", "M1a Coef", "M1a p-value")
[1] 64
compare

                        M1 Coef M1 p-value M1a Coef M1a p-value
(Intercept)               0.000     0.0000    0.000      0.0000
years_mean               -0.263     0.0014   -0.282      0.0005
empathy_mean              0.276     0.0001    0.269      0.0003
years_mean:empathy_mean  -0.139     0.0866   -0.170      0.0325


stdz <- MASS::studres(m1)
[1] 66
summary(MASS::studres(m1))
[1] 67
      Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
-2.3925351 -0.6441303 -0.0936582  0.0008143  0.6080850  2.6894571 
head(stdz, 20)
[1] 68
            1             2             3             4             5             6             7             8 
 1.1493183137 -0.9064056234 -1.0860523433 -0.3054201218  0.3520411386 -1.2051906409  1.6641123938 -0.5320182813 
            9            10            11            12            13            14            15            16 
-0.2274408440 -1.8908732027  1.2170770955 -0.4827901620  2.5507896758 -0.2274408440  0.6335095182 -1.2913320711 
           17            18            19            20 
-1.2878453273 -0.7756437163  1.2758281602  0.0006849583 
which(abs(stdz) > 2)
[1] 69
 13  74 150 159 160 165 176 181 
 13  74 150 159 160 165 176 181 
m1outliers <- lm(incidents ~ years_mean + empathy_mean + years_mean * 
    empathy_mean, data = data[-c(13, 150, 160, 181)])
[1] 70
summary(m1outliers)
[1] 71

Call:
lm(formula = incidents ~ years_mean + empathy_mean + years_mean * 
    empathy_mean, data = data[-c(13, 150, 160, 181)])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.41516 -0.11427 -0.01661  0.10733  0.46912 

Coefficients:
                         Estimate Std. Error t value Pr(>|t|)    
(Intercept)              0.480089   0.012916  37.169  < 2e-16 ***
years_mean              -0.015934   0.004931  -3.231 0.001446 ** 
empathy_mean             0.020334   0.005192   3.916 0.000124 ***
years_mean:empathy_mean -0.002480   0.001440  -1.722 0.086587 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1778 on 196 degrees of freedom
Multiple R-squared:  0.1058,	Adjusted R-squared:  0.09207 
F-statistic: 7.727 on 3 and 196 DF,  p-value: 6.636e-05

m1 <- lm(incidents ~ years_mean + empathy_mean + years_mean * 
    empathy_mean, data = data)
[1] 72
summary(m1)
[1] 73

Call:
lm(formula = incidents ~ years_mean + empathy_mean + years_mean * 
    empathy_mean, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.41516 -0.11427 -0.01661  0.10733  0.46912 

Coefficients:
                         Estimate Std. Error t value Pr(>|t|)    
(Intercept)              0.480089   0.012916  37.169  < 2e-16 ***
years_mean              -0.015934   0.004931  -3.231 0.001446 ** 
empathy_mean             0.020334   0.005192   3.916 0.000124 ***
years_mean:empathy_mean -0.002480   0.001440  -1.722 0.086587 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1778 on 196 degrees of freedom
Multiple R-squared:  0.1058,	Adjusted R-squared:  0.09207 
F-statistic: 7.727 on 3 and 196 DF,  p-value: 6.636e-05

hats <- hatvalues(m1)
[1] 74
head(hats, 20)
[1] 75
          1           2           3           4           5           6           7           8           9 
0.007639367 0.006679905 0.013657463 0.007082487 0.024122776 0.007639367 0.011965237 0.023321847 0.011092000 
         10          11          12          13          14          15          16          17          18 
0.007876715 0.012151266 0.012142177 0.007082487 0.011092000 0.007082487 0.044234386 0.021763716 0.007082487 
         19          20 
0.013657463 0.014824011 
which(hats > 2 * mean(hats))
[1] 76
 16  35  54  61  77  88  89 137 141 142 154 163 171 175 200 
 16  35  54  61  77  88  89 137 141 142 154 163 171 175 200 
m1leverage <- lm(incidents ~ years_mean + empathy_mean + years_mean * 
    empathy_mean, data = data[-c(35, 61, 89, 137, 200)])
[1] 77
summary(m1leverage)
[1] 78

Call:
lm(formula = incidents ~ years_mean + empathy_mean + years_mean * 
    empathy_mean, data = data[-c(35, 61, 89, 137, 200)])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.41516 -0.11427 -0.01661  0.10733  0.46912 

Coefficients:
                         Estimate Std. Error t value Pr(>|t|)    
(Intercept)              0.480089   0.012916  37.169  < 2e-16 ***
years_mean              -0.015934   0.004931  -3.231 0.001446 ** 
empathy_mean             0.020334   0.005192   3.916 0.000124 ***
years_mean:empathy_mean -0.002480   0.001440  -1.722 0.086587 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1778 on 196 degrees of freedom
Multiple R-squared:  0.1058,	Adjusted R-squared:  0.09207 
F-statistic: 7.727 on 3 and 196 DF,  p-value: 6.636e-05

m1 <- lm(incidents ~ years_mean + empathy_mean + years_mean * 
    empathy_mean, data = data)
[1] 79
summary(m1)
[1] 80

Call:
lm(formula = incidents ~ years_mean + empathy_mean + years_mean * 
    empathy_mean, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.41516 -0.11427 -0.01661  0.10733  0.46912 

Coefficients:
                         Estimate Std. Error t value Pr(>|t|)    
(Intercept)              0.480089   0.012916  37.169  < 2e-16 ***
years_mean              -0.015934   0.004931  -3.231 0.001446 ** 
empathy_mean             0.020334   0.005192   3.916 0.000124 ***
years_mean:empathy_mean -0.002480   0.001440  -1.722 0.086587 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1778 on 196 degrees of freedom
Multiple R-squared:  0.1058,	Adjusted R-squared:  0.09207 
F-statistic: 7.727 on 3 and 196 DF,  p-value: 6.636e-05

qqPlot(m1, main = "QQplot indicating the normality of residuals in model 1")
[1] 81
hist(m1$residuals, main = "Histogram indicating the normality of residuals in model 1")
[1] 82
shapiro.test(m1$residuals)
[1] 83

	Shapiro-Wilk normality test

data:  m1$residuals
W = 0.98722, p-value = 0.06871

residualPlots(m1, main = "Residual-vs-Predicted values plot for model 1")
[1] 84
ncvTest(m1)
[1] 85
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.5435786, Df = 1, p = 0.46095
plot(m1, which = 1)
[1] 86
durbinWatsonTest(m1)
[1] 87
 lag Autocorrelation D-W Statistic p-value
   1      0.07842262      1.831305   0.216
 Alternative hypothesis: rho != 0
vif(m1)
[1] 88
             years_mean            empathy_mean years_mean:empathy_mean 
               1.450969                1.091933                1.435233 
crPlots(m1)
[1] 89
crPlots(lm(incidents ~ years_mean + empathy_mean, data = data))
[1] 90
describe(data)
[1] 91
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training*    3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 5 rows ]
library("pastecs", quietly = T)
[1] 92
 [1] "pastecs"      "tools"        "lm.beta"      "jtools"       "interactions" "car"          "carData"     
 [8] "ggplot2"      "psych"        "readr"        "stats"        "graphics"     "grDevices"    "utils"       
[15] "datasets"     "methods"      "base"        
by(data$incidents, data$training, stat.desc, basic = F)
[1] 93
data$training: No training
      median         mean      SE.mean CI.mean.0.95          var      std.dev     coef.var 
  0.50000000   0.54166667   0.01750822   0.03474010   0.03065376   0.17508215   0.32322859 
--------------------------------------------------------------------------------------- 
data$training: Training
      median         mean      SE.mean CI.mean.0.95          var      std.dev     coef.var 
  0.41666667   0.40833333   0.01742790   0.03458074   0.03037318   0.17427902   0.42680576 
by(data$years, data$training, stat.desc, basic = F)
[1] 94
data$training: No training
      median         mean      SE.mean CI.mean.0.95          var      std.dev     coef.var 
   8.0000000    8.3300000    0.3321357    0.6590293   11.0314141    3.3213573    0.3987224 
--------------------------------------------------------------------------------------- 
data$training: Training
      median         mean      SE.mean CI.mean.0.95          var      std.dev     coef.var 
   7.0000000    7.9300000    0.2818607    0.5592728    7.9445455    2.8186070    0.3554359 
by(data$empathy, data$training, stat.desc, basic = F)
[1] 95
data$training: No training
      median         mean      SE.mean CI.mean.0.95          var      std.dev     coef.var 
  10.0000000    9.9100000    0.2340228    0.4643520    5.4766667    2.3402279    0.2361481 
--------------------------------------------------------------------------------------- 
data$training: Training
      median         mean      SE.mean CI.mean.0.95          var      std.dev     coef.var 
  11.0000000   10.4400000    0.2705475    0.5368250    7.3195960    2.7054752    0.2591451 
leveneTest(data$incidents, as.factor(data$training), center = median)
[1] 96
Levene's Test for Homogeneity of Variance (center = median)
       Df F value Pr(>F)
group   1  0.7674 0.3821
      198               
training <- factor(data$training, levels = c(1:2), labels = c("No training", 
    "Training"))
[1] 97
str(training)
[1] 98
 Factor w/ 2 levels "No training",..: NA NA NA NA NA NA NA NA NA NA ...
NULL
table(data$training)
[1] 99

No training    Training 
        100         100 
leveneTest(data$incidents, data$training, center = median)
[1] 100
Levene's Test for Homogeneity of Variance (center = median)
       Df F value Pr(>F)
group   1  0.7674 0.3821
      198               
contrasts(data$training)
[1] 101
            Training
No training        0
Training           1
contrasts(data$training) <- c(-1, 1)
[1] 102
contrasts(data$training)
[1] 103
            [,1]
No training   -1
Training       1
model2 <- aov(incidents ~ empathy + years + factor(training), 
    data = data)
[1] 104
summary(model2)
[1] 105
                  Df Sum Sq Mean Sq F value   Pr(>F)    
empathy            1  0.403  0.4026  15.312 0.000126 ***
years              1  0.237  0.2366   8.998 0.003053 ** 
factor(training)   1  1.138  1.1382  43.292  4.2e-10 ***
Residuals        196  5.153  0.0263                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
Anova(model2, type = "III")
[1] 106
Anova Table (Type III tests)

Response: incidents
                 Sum Sq  Df F value    Pr(>F)    
(Intercept)      1.6248   1  61.799 2.479e-13 ***
empathy          0.7562   1  28.761 2.293e-07 ***
years            0.3449   1  13.118 0.0003724 ***
factor(training) 1.1382   1  43.292 4.200e-10 ***
Residuals        5.1532 196                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
hist(model2$residuals, main = "Histogram indicating the normality of residuals in model 2")
[1] 107
qqPlot(model2$residuals, main = "QQplot indicating the normality of residuals in model 2")
[1] 108
shapiro.test(model2$residuals)
[1] 109

	Shapiro-Wilk normality test

data:  model2$residuals
W = 0.97994, p-value = 0.005838

shapiro.test(data$incidents)
[1] 110

	Shapiro-Wilk normality test

data:  data$incidents
W = 0.96722, p-value = 0.0001303

incidents_log <- log(data$incidents + (-1 * min(data$incidents) + 
    1))
[1] 111
describe(incidents_log)
[1] 112
   vars   n mean   sd median trimmed mad min  max range skew kurtosis   se
X1    1 200 0.32 0.13   0.29    0.32 0.1   0 0.61  0.61    0    -0.36 0.01
model2a <- aov(incidents_log ~ empathy + years + factor(training), 
    data = data)
[1] 113
summary(model2a)
[1] 114
                  Df Sum Sq Mean Sq F value   Pr(>F)    
empathy            1 0.2149  0.2149  16.116 8.48e-05 ***
years              1 0.1261  0.1261   9.459   0.0024 ** 
factor(training)   1 0.6067  0.6067  45.508 1.67e-10 ***
Residuals        196 2.6132  0.0133                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
Anova(model2a, type = "III")
[1] 115
Anova Table (Type III tests)

Response: incidents_log
                  Sum Sq  Df F value    Pr(>F)    
(Intercept)      0.72513   1  54.388 4.532e-12 ***
empathy          0.40343   1  30.259 1.171e-07 ***
years            0.18386   1  13.790 0.0002664 ***
factor(training) 0.60674   1  45.508 1.669e-10 ***
Residuals        2.61319 196                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
model2b <- lm(incidents_log ~ empathy + years + factor(training), 
    data = data)
[1] 116
shapiro.test(model2a$residuals)
[1] 117

	Shapiro-Wilk normality test

data:  model2a$residuals
W = 0.9905, p-value = 0.2109

hist(model2a$residuals, main = "Histogram depicting the log transformed residuals for model 2")
[1] 118
qqPlot(model2a$residuals, main = "QQplot depicting the log transformed residuals for model 2")
[1] 119
describe(incidents_log)
[1] 120
   vars   n mean   sd median trimmed mad min  max range skew kurtosis   se
X1    1 200 0.32 0.13   0.29    0.32 0.1   0 0.61  0.61    0    -0.36 0.01
residualPlots(model2b, main = "Residual-vs-Predicted values plot for model 2")
[1] 121
crPlots(model2a, main = "Component residual plot for model 2")
[1] 122
durbinWatsonTest(model2a)
[1] 123
 lag Autocorrelation D-W Statistic p-value
   1       -0.116516      2.217742   0.148
 Alternative hypothesis: rho != 0
vif(model2a)
[1] 124
         empathy            years factor(training) 
        1.092467         1.085089         1.020633 
ncvTest(model2b)
[1] 125
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 1.036059, Df = 1, p = 0.30874
m2 <- aov(years ~ training, data = data)
[1] 126
summary(m2)
[1] 127
             Df Sum Sq Mean Sq F value Pr(>F)
training      1      8   8.000   0.843   0.36
Residuals   198   1879   9.488               
m2a <- aov(empathy ~ training, data = data)
[1] 128
summary(m2a)
[1] 129
             Df Sum Sq Mean Sq F value Pr(>F)
training      1     14  14.045   2.195   0.14
Residuals   198   1267   6.398               
hors2 <- update(model2a, . ~ . + training:years + empathy:training)
[1] 130
Anova(hors2, type = "III")
[1] 131
Anova Table (Type III tests)

Response: incidents_log
                  Sum Sq  Df F value    Pr(>F)    
(Intercept)      0.29041   1 21.5747 6.267e-06 ***
empathy          0.39757   1 29.5358 1.635e-07 ***
years            0.17468   1 12.9770 0.0004006 ***
factor(training) 0.01879   1  1.3960 0.2388394    
years:training   0.00105   1  0.0780 0.7803486    
empathy:training 0.00032   1  0.0236 0.8780912    
Residuals        2.61133 194                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
str(feedback)
[1] 132
[1] "Error in str(feedback) : object 'feedback' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in str(feedback): object 'feedback' not found>


####################################################################################################

[1] "Error in str(feedback) : object 'feedback' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in str(feedback): object 'feedback' not found>
####################################################################################################


contrasts(data$feedback)
[1] 133
            Feedback
No feedback        0
Feedback           1
contrasts(data$feedback) <- c(-1, 1)
[1] 134
contrasts(data$feedback)
[1] 135
            [,1]
No feedback   -1
Feedback       1
by(data$incidents, data$feedback, stat.desc)
[1] 136
data$feedback: No feedback
     nbr.val     nbr.null       nbr.na          min          max        range          sum       median         mean 
100.00000000   0.00000000   0.00000000   0.08333333   0.91666667   0.83333333  41.33333334   0.41666667   0.41333333 
     SE.mean CI.mean.0.95          var      std.dev     coef.var 
  0.01732375   0.03437407   0.03001122   0.17323748   0.41912293 
--------------------------------------------------------------------------------------- 
data$feedback: Feedback
     nbr.val     nbr.null       nbr.na          min          max        range          sum       median         mean 
100.00000000   0.00000000   0.00000000   0.08333333   0.91666667   0.83333333  53.66666667   0.50000000   0.53666667 
     SE.mean CI.mean.0.95          var      std.dev     coef.var 
  0.01797554   0.03566737   0.03231201   0.17975541   0.33494798 
by(data$years, data$feedback, stat.desc)
[1] 137
data$feedback: No feedback
     nbr.val     nbr.null       nbr.na          min          max        range          sum       median         mean 
 100.0000000    0.0000000    0.0000000    1.0000000   19.0000000   18.0000000  803.0000000    8.0000000    8.0300000 
     SE.mean CI.mean.0.95          var      std.dev     coef.var 
   0.3003214    0.5959028    9.0192929    3.0032138    0.3739992 
--------------------------------------------------------------------------------------- 
data$feedback: Feedback
     nbr.val     nbr.null       nbr.na          min          max        range          sum       median         mean 
 100.0000000    0.0000000    0.0000000    2.0000000   18.0000000   16.0000000  823.0000000    7.0000000    8.2300000 
     SE.mean CI.mean.0.95          var      std.dev     coef.var 
   0.3165008    0.6280062   10.0172727    3.1650075    0.3845696 
by(data$empathy, data$feedback, stat.desc)
[1] 138
data$feedback: No feedback
     nbr.val     nbr.null       nbr.na          min          max        range          sum       median         mean 
 100.0000000    0.0000000    0.0000000    3.0000000   16.0000000   13.0000000 1031.0000000   10.0000000   10.3100000 
     SE.mean CI.mean.0.95          var      std.dev     coef.var 
   0.2721760    0.5400563    7.4079798    2.7217604    0.2639923 
--------------------------------------------------------------------------------------- 
data$feedback: Feedback
     nbr.val     nbr.null       nbr.na          min          max        range          sum       median         mean 
 100.0000000    0.0000000    0.0000000    3.0000000   15.0000000   12.0000000 1004.0000000   10.0000000   10.0400000 
     SE.mean CI.mean.0.95          var      std.dev     coef.var 
   0.2343786    0.4650580    5.4933333    2.3437861    0.2334448 
feedback <- factor(feedback, levels = c(1:2), labels = c("No feedback", 
    "Feedback"))
[1] 139


####################################################################################################

[1] "Error in factor(feedback, levels = c(1:2), labels = c(\"No feedback\", \"Feedback\")) : \n  object 'feedback' not found\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in factor(feedback, levels = c(1:2), labels = c("No feedback", "Feedback")): object 'feedback' not found>
####################################################################################################


leveneTest(data$incidents, data$feedback, center = median)
[1] 140
Levene's Test for Homogeneity of Variance (center = median)
       Df F value Pr(>F)
group   1  1.0759 0.3009
      198               
model3 <- aov(incidents ~ empathy + years + feedback, data = data)
[1] 141
summary(model3)
[1] 142
             Df Sum Sq Mean Sq F value   Pr(>F)    
empathy       1  0.403  0.4026   14.55 0.000183 ***
years         1  0.237  0.2366    8.55 0.003861 ** 
feedback      1  0.868  0.8684   31.39 7.09e-08 ***
Residuals   196  5.423  0.0277                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
Anova(model3, type = "III")
[1] 143
Anova Table (Type III tests)

Response: incidents
            Sum Sq  Df F value    Pr(>F)    
(Intercept) 1.1779   1  42.572 5.678e-10 ***
empathy     0.6380   1  23.059 3.113e-06 ***
years       0.2819   1  10.189  0.001646 ** 
feedback    0.8684   1  31.387 7.090e-08 ***
Residuals   5.4230 196                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
model3a <- lm(incidents ~ empathy + years + feedback, data = data)
[1] 144
summary(model3a)
[1] 145

Call:
lm(formula = incidents ~ empathy + years + feedback, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.342227   0.052450   6.525 5.68e-10 ***
empathy      0.023187   0.004829   4.802 3.11e-06 ***
years       -0.012689   0.003975  -3.192  0.00165 ** 
feedback1    0.066066   0.011792   5.602 7.09e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

Anova(model3a, type = "III")
[1] 146
Anova Table (Type III tests)

Response: incidents
            Sum Sq  Df F value    Pr(>F)    
(Intercept) 1.1779   1  42.572 5.678e-10 ***
empathy     0.6380   1  23.059 3.113e-06 ***
years       0.2819   1  10.189  0.001646 ** 
feedback    0.8684   1  31.387 7.090e-08 ***
Residuals   5.4230 196                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
hist(model3$residuals, main = "Histogram depicting the normality of residuls in model 3")
[1] 147
qqPlot(model3$residuals, main = "QQplot depicting the normality of residuals in model 3")
[1] 148
shapiro.test(model3$residuals)
[1] 149

	Shapiro-Wilk normality test

data:  model3$residuals
W = 0.98772, p-value = 0.08174

ncvTest(model3a)
[1] 150
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.01731234, Df = 1, p = 0.89532
residualPlots(model3a, main = "Residual-vs-Predicted values plot for model 3")
[1] 151
durbinWatsonTest(model3)
[1] 152
 lag Autocorrelation D-W Statistic p-value
   1       0.2738264      1.444081       0
 Alternative hypothesis: rho != 0
crPlots(model3, main = "Component residual plot for model 3")
[1] 153
vif(model3)
[1] 154
 empathy    years feedback 
1.079397 1.077467 1.005211 
m3 <- aov(years ~ feedback, data = data)
[1] 155
summary(m3)
[1] 156
             Df Sum Sq Mean Sq F value Pr(>F)
feedback      1      2   2.000    0.21  0.647
Residuals   198   1885   9.518               
m3a <- aov(empathy ~ feedback, data = data)
[1] 157
summary(m3a)
[1] 158
             Df Sum Sq Mean Sq F value Pr(>F)
feedback      1    3.6   3.645   0.565  0.453
Residuals   198 1277.2   6.451               
hors3 <- update(model3, . ~ . + feedback:years + empathy:feedback)
[1] 159
Anova(hors3, type = "III")
[1] 160
Anova Table (Type III tests)

Response: incidents
                 Sum Sq  Df F value    Pr(>F)    
(Intercept)      1.1204   1 40.3486 1.478e-09 ***
empathy          0.6545   1 23.5726 2.469e-06 ***
years            0.2734   1  9.8463  0.001967 ** 
feedback         0.0179   1  0.6430  0.423624    
years:feedback   0.0178   1  0.6400  0.424678    
empathy:feedback 0.0276   1  0.9953  0.319696    
Residuals        5.3868 194                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
contrasts(data$feedback) <- c(-1, 1)
[1] 161
contrasts(data$feedback)
[1] 162
            [,1]
No feedback   -1
Feedback       1
contrasts(data$training) <- c(-1, 1)
[1] 163
contrasts(data$training)
[1] 164
            [,1]
No training   -1
Training       1
model4 <- lm(incidents ~ training, data = data)
[1] 165
summary(model4)
[1] 166

Call:
lm(formula = incidents ~ training, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.32500 -0.12500  0.00833  0.12500  0.50833 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.47500    0.01235  38.456  < 2e-16 ***
training1   -0.06667    0.01235  -5.397 1.92e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1747 on 198 degrees of freedom
Multiple R-squared:  0.1283,	Adjusted R-squared:  0.1239 
F-statistic: 29.13 on 1 and 198 DF,  p-value: 1.922e-07

model4a <- lm(incidents ~ feedback, data = data)
[1] 167
summary(model4a)
[1] 168

Call:
lm(formula = incidents ~ feedback, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.45333 -0.12000  0.00333  0.13000  0.50333 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.47500    0.01248   38.05  < 2e-16 ***
feedback1    0.06167    0.01248    4.94 1.66e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1765 on 198 degrees of freedom
Multiple R-squared:  0.1097,	Adjusted R-squared:  0.1052 
F-statistic: 24.41 on 1 and 198 DF,  p-value: 1.656e-06

AIC(model4, model4a)
[1] 169
        df       AIC
model4   3 -126.3521
model4a  3 -122.1483
BIC(model4, model4a)
[1] 170
        df       BIC
model4   3 -116.4571
model4a  3 -112.2533
AIC(model4a, model4)
[1] 171
        df       AIC
model4a  3 -122.1483
model4   3 -126.3521
BIC(model4a, model4)
[1] 172
        df       BIC
model4a  3 -112.2533
model4   3 -116.4571
m4 <- lm(incidents ~ training, data = data)
[1] 173
summary(m4)
[1] 174

Call:
lm(formula = incidents ~ training, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.32500 -0.12500  0.00833  0.12500  0.50833 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.47500    0.01235  38.456  < 2e-16 ***
training1   -0.06667    0.01235  -5.397 1.92e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1747 on 198 degrees of freedom
Multiple R-squared:  0.1283,	Adjusted R-squared:  0.1239 
F-statistic: 29.13 on 1 and 198 DF,  p-value: 1.922e-07

m4a <- lm(incidents ~ training + feedback, data = data)
[1] 175
summary(m4a)
[1] 176

Call:
lm(formula = incidents ~ training + feedback, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.38667 -0.11167 -0.01333  0.07000  0.44667 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.47500    0.01158  41.028  < 2e-16 ***
training1   -0.06667    0.01158  -5.758 3.22e-08 ***
feedback1    0.06167    0.01158   5.326 2.72e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1637 on 197 degrees of freedom
Multiple R-squared:  0.238,	Adjusted R-squared:  0.2303 
F-statistic: 30.76 on 2 and 197 DF,  p-value: 2.359e-12

AIC(m4, m4a)
[1] 177
    df       AIC
m4   3 -126.3521
m4a  4 -151.2608
BIC(m4, m4a)
[1] 178
    df       BIC
m4   3 -116.4571
m4a  4 -138.0675
model4c <- lm(incidents ~ feedback, data = data)
[1] 179
summary(model4c)
[1] 180

Call:
lm(formula = incidents ~ feedback, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.45333 -0.12000  0.00333  0.13000  0.50333 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.47500    0.01248   38.05  < 2e-16 ***
feedback1    0.06167    0.01248    4.94 1.66e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1765 on 198 degrees of freedom
Multiple R-squared:  0.1097,	Adjusted R-squared:  0.1052 
F-statistic: 24.41 on 1 and 198 DF,  p-value: 1.656e-06

model4d <- lm(incidents ~ training, data = data)
[1] 181
summary(model4d)
[1] 182

Call:
lm(formula = incidents ~ training, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.32500 -0.12500  0.00833  0.12500  0.50833 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.47500    0.01235  38.456  < 2e-16 ***
training1   -0.06667    0.01235  -5.397 1.92e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1747 on 198 degrees of freedom
Multiple R-squared:  0.1283,	Adjusted R-squared:  0.1239 
F-statistic: 29.13 on 1 and 198 DF,  p-value: 1.922e-07

AIC(model4c, model4d)
[1] 183
        df       AIC
model4c  3 -122.1483
model4d  3 -126.3521
BIC(model4c, model4d)
[1] 184
        df       BIC
model4c  3 -112.2533
model4d  3 -116.4571
m4c <- lm(incidents ~ feedback, data = data)
[1] 185
summary(m4c)
[1] 186

Call:
lm(formula = incidents ~ feedback, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.45333 -0.12000  0.00333  0.13000  0.50333 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.47500    0.01248   38.05  < 2e-16 ***
feedback1    0.06167    0.01248    4.94 1.66e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1765 on 198 degrees of freedom
Multiple R-squared:  0.1097,	Adjusted R-squared:  0.1052 
F-statistic: 24.41 on 1 and 198 DF,  p-value: 1.656e-06

m4d <- lm(incidents ~ feedback + training, data = data)
[1] 187
summary(m4d)
[1] 188

Call:
lm(formula = incidents ~ feedback + training, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.38667 -0.11167 -0.01333  0.07000  0.44667 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.47500    0.01158  41.028  < 2e-16 ***
feedback1    0.06167    0.01158   5.326 2.72e-07 ***
training1   -0.06667    0.01158  -5.758 3.22e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1637 on 197 degrees of freedom
Multiple R-squared:  0.238,	Adjusted R-squared:  0.2303 
F-statistic: 30.76 on 2 and 197 DF,  p-value: 2.359e-12

AIC(m4c, m4d)
[1] 189
    df       AIC
m4c  3 -122.1483
m4d  4 -151.2608
BIC(m4c, m4d)
[1] 190
    df       BIC
m4c  3 -112.2533
m4d  4 -138.0675
interaction.plot(x.factor = data$training, trace.factor = data$feedback, 
    response = data$incidents, fun = mean, xlab = "Feedback", 
    ylab = "Teacher interventions in bullying incidents", main = "Interaction plot indicating the group means for the training and feedback data")
[1] 191
tapply(X = data$incidents, INDEX = list(data$training, data$feedback), 
    FUN = mean)
[1] 192
            No feedback  Feedback
No training   0.4933333 0.5900000
Training      0.3333333 0.4833333
means <- tapply(X = data$incidents, INDEX = list(data$training, 
    data$feedback), FUN = mean)
[1] 193
barplot(means, beside = TRUE, legend.text = TRUE, ylab = "Percentage of bullying incidents intervened in")
[1] 194
by(data$incidents, data$training, stat.desc, basic = F)
[1] 195
data$training: No training
      median         mean      SE.mean CI.mean.0.95          var      std.dev     coef.var 
  0.50000000   0.54166667   0.01750822   0.03474010   0.03065376   0.17508215   0.32322859 
--------------------------------------------------------------------------------------- 
data$training: Training
      median         mean      SE.mean CI.mean.0.95          var      std.dev     coef.var 
  0.41666667   0.40833333   0.01742790   0.03458074   0.03037318   0.17427902   0.42680576 
by(data$incidents, data$feedback, stat.desc, basic = F)
[1] 196
data$feedback: No feedback
      median         mean      SE.mean CI.mean.0.95          var      std.dev     coef.var 
  0.41666667   0.41333333   0.01732375   0.03437407   0.03001122   0.17323748   0.41912293 
--------------------------------------------------------------------------------------- 
data$feedback: Feedback
      median         mean      SE.mean CI.mean.0.95          var      std.dev     coef.var 
  0.50000000   0.53666667   0.01797554   0.03566737   0.03231201   0.17975541   0.33494798 
by(data$incidents, list(data$training, data$feedback), stat.desc, 
    basic = F)
[1] 197
: No training
: No feedback
      median         mean      SE.mean CI.mean.0.95          var      std.dev     coef.var 
  0.41666667   0.49333333   0.02367103   0.04756871   0.02801587   0.16737943   0.33928262 
--------------------------------------------------------------------------------------- 
: Training
: No feedback
      median         mean      SE.mean CI.mean.0.95          var      std.dev     coef.var 
  0.33333333   0.33333333   0.01977768   0.03974473   0.01955782   0.13984929   0.41954786 
--------------------------------------------------------------------------------------- 
: No training
: Feedback
      median         mean      SE.mean CI.mean.0.95          var      std.dev     coef.var 
  0.58333333   0.59000000   0.02414525   0.04852170   0.02914966   0.17073271   0.28937748 
--------------------------------------------------------------------------------------- 
: Training
: Feedback
      median         mean      SE.mean CI.mean.0.95          var      std.dev     coef.var 
  0.50000000   0.48333333   0.02462876   0.04949335   0.03032880   0.17415165   0.36031376 
contrasts(data$feedback) <- c(-1, 1)
[1] 198
data$feedback
[1] 199
 [1] Feedback    No feedback Feedback    No feedback Feedback    No feedback Feedback    No feedback Feedback   
[10] No feedback Feedback    No feedback Feedback    No feedback Feedback    No feedback Feedback    No feedback
[19] Feedback    No feedback Feedback    No feedback Feedback    No feedback Feedback    No feedback Feedback   
[28] No feedback Feedback    No feedback Feedback    No feedback Feedback    No feedback Feedback    No feedback
[37] Feedback    No feedback Feedback    No feedback Feedback    No feedback Feedback    No feedback Feedback   
[46] No feedback Feedback    No feedback Feedback    No feedback
 [ reached getOption("max.print") -- omitted 150 entries ]
attr(,"contrasts")
            [,1]
No feedback   -1
Feedback       1
Levels: No feedback Feedback
contrasts(data$training) <- c(-1, 1)
[1] 200
data$training
[1] 201
 [1] Training Training Training Training Training Training Training Training Training Training Training Training
[13] Training Training Training Training Training Training Training Training Training Training Training Training
[25] Training Training Training Training Training Training Training Training Training Training Training Training
[37] Training Training Training Training Training Training Training Training Training Training Training Training
[49] Training Training
 [ reached getOption("max.print") -- omitted 150 entries ]
attr(,"contrasts")
            [,1]
No training   -1
Training       1
Levels: No training Training
model5 <- aov(incidents ~ training + feedback + training * feedback, 
    data = data)
[1] 202
summary.aov(model5)
[1] 203
                   Df Sum Sq Mean Sq F value   Pr(>F)    
training            1  0.889  0.8889  33.213 3.16e-08 ***
feedback            1  0.761  0.7606  28.418 2.68e-07 ***
training:feedback   1  0.036  0.0356   1.329     0.25    
Residuals         196  5.246  0.0268                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
Anova(model5, type = "III")
[1] 204
Anova Table (Type III tests)

Response: incidents
                  Sum Sq  Df   F value    Pr(>F)    
(Intercept)       45.125   1 1686.0940 < 2.2e-16 ***
training           0.889   1   33.2133 3.164e-08 ***
feedback           0.761   1   28.4181 2.675e-07 ***
training:feedback  0.036   1    1.3285    0.2505    
Residuals          5.246 196                        
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
leveneTest(incidents ~ training * feedback, data = data)
[1] 205
Levene's Test for Homogeneity of Variance (center = median)
       Df F value Pr(>F)
group   3  0.4046 0.7498
      196               
qqPlot(model5$residuals, main = "QQplot depicting the normality of residuals in model 5")
[1] 206
hist(model5$residuals, main = "Histogram depicting the normality of residuals in model 5")
[1] 207
shapiro.test(model5$residuals)
[1] 208

	Shapiro-Wilk normality test

data:  model5$residuals
W = 0.9767, p-value = 0.002072

shapiro.test(data$incidents)
[1] 209

	Shapiro-Wilk normality test

data:  data$incidents
W = 0.96722, p-value = 0.0001303

logincidents <- log(data$incidents + (-1 * min(data$incidents) + 
    1))
[1] 210
describe(logincidents)
[1] 211
   vars   n mean   sd median trimmed mad min  max range skew kurtosis   se
X1    1 200 0.32 0.13   0.29    0.32 0.1   0 0.61  0.61    0    -0.36 0.01
model5a <- aov(logincidents ~ training + feedback + training * 
    feedback, data = data)
[1] 212
summary.aov(model5a)
[1] 213
                   Df Sum Sq Mean Sq F value   Pr(>F)    
training            1 0.4738  0.4738   34.86 1.54e-08 ***
feedback            1 0.3978  0.3978   29.27 1.82e-07 ***
training:feedback   1 0.0257  0.0257    1.89    0.171    
Residuals         196 2.6636  0.0136                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
Anova(model5a, type = "III")
[1] 214
Anova Table (Type III tests)

Response: logincidents
                   Sum Sq  Df   F value    Pr(>F)    
(Intercept)       20.6860   1 1522.1454 < 2.2e-16 ***
training           0.4738   1   34.8630 1.537e-08 ***
feedback           0.3978   1   29.2699 1.824e-07 ***
training:feedback  0.0257   1    1.8905    0.1707    
Residuals          2.6636 196                        
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
shapiro.test(model5a$residuals)
[1] 215

	Shapiro-Wilk normality test

data:  model5a$residuals
W = 0.98649, p-value = 0.05345

hist(model5a$residuals, main = "Histogram of the log transformed residuals in model 5")
[1] 216
qqPlot(model5a$residuals, main = "QQplot of the log transormed residuals in model 5")
[1] 217
leveneTest(logincidents ~ training * feedback, data = data)
[1] 218
Levene's Test for Homogeneity of Variance (center = median)
       Df F value Pr(>F)
group   3  0.0309 0.9927
      196               
durbinWatsonTest(model5a)
[1] 219
 lag Autocorrelation D-W Statistic p-value
   1       0.1133615      1.766819   0.118
 Alternative hypothesis: rho != 0
