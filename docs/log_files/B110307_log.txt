

	####### B110307 R script #######

library(psych, quietly = T)
[1] 1
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 2
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
bullying <- read.csv("~/Desktop/rms2/code_check/RMS2_report_1920.csv")
[1] 3
describe(bullying)
[1] 4
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training     3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
str(bullying)
[1] 5
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : int  2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : int  2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
bullying$training <- as.factor(bullying$training)
[1] 6
bullying$feedback <- as.factor(bullying$feedback)
[1] 7
str(bullying)
[1] 8
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : Factor w/ 2 levels "1","2": 2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : Factor w/ 2 levels "1","2": 2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
m1 <- lm(empathy ~ years, data = bullying)
[1] 9
qqPlot(m1)
[1] 10
shapiro.test(m1$residuals)
[1] 11

	Shapiro-Wilk normality test

data:  m1$residuals
W = 0.98911, p-value = 0.1321

durbinWatsonTest(m1)
[1] 12
 lag Autocorrelation D-W Statistic p-value
   1       0.1017162      1.769879   0.122
 Alternative hypothesis: rho != 0
residualPlots(m1)
[1] 13
ncvTest(m1)
[1] 14
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.9815033, Df = 1, p = 0.32183
crPlots(m1)
[1] 15
bullying$empathy <- log(bullying$empathy)
[1] 16
m1 <- lm(empathy ~ years, data = bullying)
[1] 17
summary(m1)
[1] 18

Call:
lm(formula = empathy ~ years, data = bullying)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.00538 -0.14174  0.05342  0.17777  0.51695 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 2.045922   0.056534  36.189  < 2e-16 ***
years       0.029035   0.006505   4.463 1.35e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.2825 on 198 degrees of freedom
Multiple R-squared:  0.09142,	Adjusted R-squared:  0.08683 
F-statistic: 19.92 on 1 and 198 DF,  p-value: 1.352e-05

m2 <- lm(incidents ~ training + empathy + years, data = bullying)
[1] 19
qqPlot(m2)
[1] 20
shapiro.test(m2$residuals)
[1] 21

	Shapiro-Wilk normality test

data:  m2$residuals
W = 0.9792, p-value = 0.004582

durbinWatsonTest(m2)
[1] 22
 lag Autocorrelation D-W Statistic p-value
   1      -0.1004484      2.184406    0.23
 Alternative hypothesis: rho != 0
residualPlots(m2)
[1] 23
ncvTest(m2)
[1] 24
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0381271, Df = 1, p = 0.84519
vif(m2)
[1] 25
training  empathy    years 
1.014885 1.112263 1.110266 
crPlots(m2)
[1] 26
summary(m2)
[1] 27

Call:
lm(formula = incidents ~ training + empathy + years, data = bullying)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.33181 -0.11893 -0.01532  0.09530  0.51864 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.156441   0.089278   1.752 0.081287 .  
training2   -0.149732   0.023002  -6.510 6.17e-10 ***
empathy      0.226197   0.040823   5.541 9.61e-08 ***
years       -0.015099   0.003917  -3.855 0.000157 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1615 on 196 degrees of freedom
Multiple R-squared:  0.2628,	Adjusted R-squared:  0.2515 
F-statistic: 23.29 on 3 and 196 DF,  p-value: 6.132e-13

m3 <- lm(incidents ~ feedback + empathy + years, data = bullying)
[1] 28
qqPlot(m3)
[1] 29
shapiro.test(m3$residuals)
[1] 30

	Shapiro-Wilk normality test

data:  m3$residuals
W = 0.98719, p-value = 0.06802

durbinWatsonTest(m3)
[1] 31
 lag Autocorrelation D-W Statistic p-value
   1       0.2695744      1.447146       0
 Alternative hypothesis: rho != 0
residualPlots(m3)
[1] 32
ncvTest(m3)
[1] 33
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.02899987, Df = 1, p = 0.86478
vif(m3)
[1] 34
feedback  empathy    years 
1.002818 1.102549 1.102724 
crPlots(m3)
[1] 35
summary(m3)
[1] 36

Call:
lm(formula = incidents ~ feedback + empathy + years, data = bullying)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.33823 -0.10208 -0.01322  0.10777  0.52785 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.045255   0.092532   0.489 0.625334    
feedback2    0.129768   0.023450   5.534 9.96e-08 ***
empathy      0.208661   0.041685   5.006 1.24e-06 ***
years       -0.013690   0.004003  -3.420 0.000763 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1656 on 196 degrees of freedom
Multiple R-squared:  0.2246,	Adjusted R-squared:  0.2127 
F-statistic: 18.92 on 3 and 196 DF,  p-value: 8.062e-11

AIC(m2, m3)
[1] 37
   df       AIC
m2  5 -155.8856
m3  5 -145.7748
BIC(m2, m3)
[1] 38
   df       BIC
m2  5 -139.3940
m3  5 -129.2832
m4 <- lm(incidents ~ training + feedback + training * feedback, 
    data = bullying)
[1] 39
qqPlot(m4)
[1] 40
shapiro.test(m4$residuals)
[1] 41

	Shapiro-Wilk normality test

data:  m4$residuals
W = 0.9767, p-value = 0.002072

durbinWatsonTest(m4)
[1] 42
 lag Autocorrelation D-W Statistic p-value
   1       0.1114255      1.770733   0.136
 Alternative hypothesis: rho != 0
avPlots(m4)
[1] 43
ncvTest(m4)
[1] 44
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 1.881673, Df = 1, p = 0.17014
summary(m4)
[1] 45

Call:
lm(formula = incidents ~ training + feedback + training * feedback, 
    data = bullying)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40000 -0.10500  0.00000  0.08333  0.43333 

Coefficients:
                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)          0.49333    0.02314  21.323  < 2e-16 ***
training2           -0.16000    0.03272  -4.890 2.09e-06 ***
feedback2            0.09667    0.03272   2.954  0.00352 ** 
training2:feedback2  0.05333    0.04627   1.153  0.25047    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1636 on 196 degrees of freedom
Multiple R-squared:  0.2431,	Adjusted R-squared:  0.2315 
F-statistic: 20.99 on 3 and 196 DF,  p-value: 7.827e-12

interaction.plot(bullying$training, bullying$feedback, bullying$incidents, 
    legend = TRUE, trace.label = "feedback", xlab = "Training", 
    ylab = "mean of interventions")
[1] 46
