

	####### B118469 R script #######

rm(list = ls())
[1] 1
data <- read.csv("../RMS2_report_1920.csv")
[1] 2
library(psych, quietly = T)
[1] 3
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 4
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[10] "methods"   "base"     
library(ggplot2, quietly = T)
[1] 5
 [1] "ggplot2"   "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"    
[10] "datasets"  "methods"   "base"     
library(interactions, quietly = T)
[1] 6
 [1] "interactions" "ggplot2"      "car"          "carData"      "psych"        "readr"        "stats"       
 [8] "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
str(data)
[1] 7
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : int  2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : int  2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
describe(data)
[1] 8
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training     3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
data$subject <- as.factor(data$subject)
[1] 9
data$training <- as.factor(data$training)
[1] 10
data$feedback <- as.factor(data$feedback)
[1] 11
summary(data[c(3, 4)])
[1] 12
 training feedback
 1:100    1:100   
 2:100    2:100   
data$training <- factor(data$training, labels = c("No training undertook", 
    "Training undertook"))
[1] 13
data$feedback <- factor(data$feedback, labels = c("Has not partecipated in a feedback session", 
    "Has partecipated in a feedback session"))
[1] 14
describe(data)
[1] 15
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject*     1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training*    3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
summary(data[c(3, 4)])
[1] 16
                  training                                         feedback  
 No training undertook:100   Has not partecipated in a feedback session:100  
 Training undertook   :100   Has partecipated in a feedback session    :100  
m1 <- lm(empathy ~ years, data = data)
[1] 17
summary(m1)
[1] 18

Call:
lm(formula = empathy ~ years, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  8.40625    0.49085  17.126  < 2e-16 ***
years        0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

stdz1 <- MASS::studres(m1)
[1] 19
which(abs(stdz1) > 2)
[1] 20
 61  68  70  88  89 137 141 142 154 175 200 
 61  68  70  88  89 137 141 142 154 175 200 
hats1 <- hatvalues(m1)
[1] 21
which(hats1 > 2 * mean(hats1))
[1] 22
 61  88  89  92  94 108 109 116 131 137 140 141 154 155 163 190 200 
 61  88  89  92  94 108 109 116 131 137 140 141 154 155 163 190 200 
cooksm1 <- cooks.distance(m1)
[1] 23
which(cooksm1 > 0.02)
[1] 24
 16  61  88  89  94 108 137 141 154 163 171 175 192 200 
 16  61  88  89  94 108 137 141 154 163 171 175 192 200 
plot(m1, which = 5)
[1] 25
dataneat1 <- data[-c(61, 88, 89, 137, 141, 154, 200), ]
[1] 26
plot(empathy ~ years, xlab = "Years working as teacher (yrs)", 
    ylab = "Empathy score (unit)", main = "Plot of empathy scores against years", 
    data = data)
[1] 27
abline(m1, col = "blue")
[1] 28
lines(lowess(data$empathy, data$years), col = "red")
[1] 29
crPlots(m1)
[1] 30
m1_q <- lm(empathy ~ years + I(years^2), data = data)
[1] 31
summary(m1_q)
[1] 32

Call:
lm(formula = empathy ~ years + I(years^2), data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  1.186356   0.791848   1.498    0.136    
years        2.068508   0.181845  11.375   <2e-16 ***
I(years^2)  -0.103645   0.009861 -10.510   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

crPlots(m1_q)
[1] 33
durbinWatsonTest(m1_q)
[1] 34
 lag Autocorrelation D-W Statistic p-value
   1      0.01288905      1.973855   0.874
 Alternative hypothesis: rho != 0
qqPlot(m1_q)
[1] 35
shapiro.test(m1_q$residuals)
[1] 36

	Shapiro-Wilk normality test

data:  m1_q$residuals
W = 0.9941, p-value = 0.6155

residualPlots(m1_q)
[1] 37
ncvTest(m1_q)
[1] 38
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.5107658, Df = 1, p = 0.47481
m2 <- lm(incidents ~ training + empathy + years, data = data)
[1] 39
summary(m2)
[1] 40

Call:
lm(formula = incidents ~ training + empathy + years, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                 0.407320   0.051814   7.861 2.48e-13 ***
trainingTraining undertook -0.152427   0.023166  -6.580 4.20e-10 ***
empathy                     0.025396   0.004735   5.363 2.29e-07 ***
years                      -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

data$empathy_m <- scale(data$empathy)
[1] 41
data$years_m <- scale(data$years)
[1] 42
m2_m <- lm(incidents ~ training + empathy_m + years_m, data = data)
[1] 43
summary(m2_m)
[1] 44

Call:
lm(formula = incidents ~ training + empathy_m + years_m, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                           Estimate Std. Error t value Pr(>|t|)    
(Intercept)                 0.55121    0.01630  33.821  < 2e-16 ***
trainingTraining undertook -0.15243    0.02317  -6.580 4.20e-10 ***
empathy_m                   0.06443    0.01201   5.363 2.29e-07 ***
years_m                    -0.04337    0.01197  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

qqPlot(m2_m)
[1] 45
shapiro.test(m2_m$residuals)
[1] 46

	Shapiro-Wilk normality test

data:  m2_m$residuals
W = 0.97994, p-value = 0.005838

hist(data$incidents)
[1] 47
skew(data$incidents)
[1] 48
[1] 0.3221457
data$logincidents <- (log(data$incidents + (-1 * min(data$incidents) + 
    1)))
[1] 49
hist(data$logincidents)
[1] 50
skew(data$logincidents)
[1] 51
[1] -0.002252411
logm2_m <- lm(logincidents ~ training + empathy_m + years_m, 
    data = data)
[1] 52
summary(logm2_m)
[1] 53

Call:
lm(formula = logincidents ~ training + empathy_m + years_m, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.27676 -0.08678 -0.00271  0.07438  0.35035 

Coefficients:
                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                 0.377249   0.011606  32.504  < 2e-16 ***
trainingTraining undertook -0.111288   0.016497  -6.746 1.67e-10 ***
empathy_m                   0.047061   0.008555   5.501 1.17e-07 ***
years_m                    -0.031662   0.008526  -3.713 0.000266 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1155 on 196 degrees of freedom
Multiple R-squared:  0.2661,	Adjusted R-squared:  0.2549 
F-statistic: 23.69 on 3 and 196 DF,  p-value: 3.963e-13

stdz2 <- MASS::studres(logm2_m)
[1] 54
which(abs(stdz2) > 2)
[1] 55
  7  13  35  60  74 159 176 
  7  13  35  60  74 159 176 
hats2 <- hatvalues(logm2_m)
[1] 56
which(hats2 > 2 * mean(hats2))
[1] 57
 61  88  89  92  94 137 141 154 163 175 200 
 61  88  89  92  94 137 141 154 163 175 200 
cooksm2 <- cooks.distance(logm2_m)
[1] 58
which(cooksm2 > 0.02)
[1] 59
 13  30  35  41  60  74  88  89  94 137 
 13  30  35  41  60  74  88  89  94 137 
plot(logm2_m, which = 5)
[1] 60
qqPlot(logm2_m)
[1] 61
shapiro.test(logm2_m$residuals)
[1] 62

	Shapiro-Wilk normality test

data:  logm2_m$residuals
W = 0.9905, p-value = 0.2109

residualPlots(logm2_m)
[1] 63
ncvTest(logm2_m)
[1] 64
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 1.036059, Df = 1, p = 0.30874
durbinWatsonTest(logm2_m)
[1] 65
 lag Autocorrelation D-W Statistic p-value
   1       -0.116516      2.217742   0.134
 Alternative hypothesis: rho != 0
crPlots(logm2_m)
[1] 66
vif(logm2_m)
[1] 67
 training empathy_m   years_m 
 1.020633  1.092467  1.085089 
m3_m <- lm(incidents ~ feedback + empathy_m + years_m, data = data)
[1] 68
summary(m3_m)
[1] 69

Call:
lm(formula = incidents ~ feedback + empathy_m + years_m, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                                               Estimate Std. Error t value Pr(>|t|)    
(Intercept)                                     0.40893    0.01666  24.553  < 2e-16 ***
feedbackHas partecipated in a feedback session  0.13213    0.02358   5.602 7.09e-08 ***
empathy_m                                       0.05883    0.01225   4.802 3.11e-06 ***
years_m                                        -0.03907    0.01224  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

stdz3 <- MASS::studres(m3_m)
[1] 70
which(abs(stdz3) > 2)
[1] 71
 13  21  73  74 150 156 159 160 165 176 181 
 13  21  73  74 150 156 159 160 165 176 181 
hats3 <- hatvalues(m3_m)
[1] 72
which(hats3 > 2 * mean(hats3))
[1] 73
 61  88  89  92 137 141 154 163 175 200 
 61  88  89  92 137 141 154 163 175 200 
cooksm3 <- cooks.distance(m3_m)
[1] 74
which(cooksm3 > 0.02)
[1] 75
 73  74  89 137 156 160 165 176 
 73  74  89 137 156 160 165 176 
plot(m3_m, which = 5)
[1] 76
qqPlot(m3_m)
[1] 77
shapiro.test(m3_m$residuals)
[1] 78

	Shapiro-Wilk normality test

data:  m3_m$residuals
W = 0.98772, p-value = 0.08174

residualPlots(m3_m)
[1] 79
ncvTest(m3_m)
[1] 80
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.01731234, Df = 1, p = 0.89532
durbinWatsonTest(m3_m)
[1] 81
 lag Autocorrelation D-W Statistic p-value
   1       0.2738264      1.444081       0
 Alternative hypothesis: rho != 0
crPlots(m3_m)
[1] 82
vif(m3_m)
[1] 83
 feedback empathy_m   years_m 
 1.005211  1.079397  1.077467 
summary(logm2_m)
[1] 84

Call:
lm(formula = logincidents ~ training + empathy_m + years_m, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.27676 -0.08678 -0.00271  0.07438  0.35035 

Coefficients:
                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                 0.377249   0.011606  32.504  < 2e-16 ***
trainingTraining undertook -0.111288   0.016497  -6.746 1.67e-10 ***
empathy_m                   0.047061   0.008555   5.501 1.17e-07 ***
years_m                    -0.031662   0.008526  -3.713 0.000266 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1155 on 196 degrees of freedom
Multiple R-squared:  0.2661,	Adjusted R-squared:  0.2549 
F-statistic: 23.69 on 3 and 196 DF,  p-value: 3.963e-13

summary(m3_m)
[1] 85

Call:
lm(formula = incidents ~ feedback + empathy_m + years_m, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                                               Estimate Std. Error t value Pr(>|t|)    
(Intercept)                                     0.40893    0.01666  24.553  < 2e-16 ***
feedbackHas partecipated in a feedback session  0.13213    0.02358   5.602 7.09e-08 ***
empathy_m                                       0.05883    0.01225   4.802 3.11e-06 ***
years_m                                        -0.03907    0.01224  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

BIC(logm2_m, m3_m)
[1] 86
        df       BIC
logm2_m  5 -273.4824
m3_m     5 -127.4675
m5_m <- lm(incidents ~ training + feedback + empathy_m + years_m + 
    training * feedback, data = data)
[1] 87
summary(m5_m)
[1] 88

Call:
lm(formula = incidents ~ training + feedback + empathy_m + years_m + 
    training * feedback, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30367 -0.10365 -0.00795  0.08806  0.44359 

Coefficients:
                                                                          Estimate Std. Error t value Pr(>|t|)    
(Intercept)                                                                0.50964    0.02081  24.494  < 2e-16 ***
trainingTraining undertook                                                -0.20350    0.02987  -6.812 1.18e-10 ***
feedbackHas partecipated in a feedback session                             0.08556    0.02930   2.920  0.00391 ** 
empathy_m                                                                  0.07280    0.01098   6.630 3.25e-10 ***
years_m                                                                   -0.04840    0.01083  -4.468 1.34e-05 ***
trainingTraining undertook:feedbackHas partecipated in a feedback session  0.09733    0.04184   2.326  0.02103 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1462 on 194 degrees of freedom
Multiple R-squared:  0.4015,	Adjusted R-squared:  0.386 
F-statistic: 26.02 on 5 and 194 DF,  p-value: < 2.2e-16

residualPlots(m5_m)
[1] 89
ncvTest(m5_m)
[1] 90
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 4.398557, Df = 1, p = 0.035969
logm5_m <- lm(logincidents ~ training + feedback + empathy_m + 
    years_m + training * feedback, data = data)
[1] 91
summary(logm5_m)
[1] 92

Call:
lm(formula = logincidents ~ training + feedback + empathy_m + 
    years_m + training * feedback, data = data)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.226383 -0.071808 -0.000811  0.069089  0.284822 

Coefficients:
                                                                           Estimate Std. Error t value Pr(>|t|)    
(Intercept)                                                                0.348968   0.014712  23.720  < 2e-16 ***
trainingTraining undertook                                                -0.151903   0.021123  -7.191 1.36e-11 ***
feedbackHas partecipated in a feedback session                             0.058376   0.020716   2.818  0.00533 ** 
empathy_m                                                                  0.053400   0.007764   6.878 8.14e-11 ***
years_m                                                                   -0.035425   0.007660  -4.625 6.84e-06 ***
trainingTraining undertook:feedbackHas partecipated in a feedback session  0.077604   0.029583   2.623  0.00940 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1034 on 194 degrees of freedom
Multiple R-squared:  0.4176,	Adjusted R-squared:  0.4026 
F-statistic: 27.82 on 5 and 194 DF,  p-value: < 2.2e-16

stdz5 <- MASS::studres(logm5_m)
[1] 93
which(abs(stdz5) > 2)
[1] 94
 13  21  73  74 117 137 150 156 176 
 13  21  73  74 117 137 150 156 176 
hats5 <- hatvalues(logm5_m)
[1] 95
which(hats5 > 2 * mean(hats5))
[1] 96
 61  88  89 137 141 154 200 
 61  88  89 137 141 154 200 
cooksm5 <- cooks.distance(logm5_m)
[1] 97
which(cooksm5 > 0.02)
[1] 98
 13  73  74  89 117 137 176 
 13  73  74  89 117 137 176 
plot(logm5_m, which = 5)
[1] 99
residualPlots(logm5_m)
[1] 100
ncvTest(logm5_m)
[1] 101
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.577295, Df = 1, p = 0.44737
qqPlot(logm5_m)
[1] 102
shapiro.test(logm5_m$residuals)
[1] 103

	Shapiro-Wilk normality test

data:  logm5_m$residuals
W = 0.99434, p-value = 0.6515

durbinWatsonTest(logm5_m)
[1] 104
 lag Autocorrelation D-W Statistic p-value
   1      0.09726586      1.794988    0.17
 Alternative hypothesis: rho != 0
vif(logm5_m)
[1] 105
         training          feedback         empathy_m           years_m training:feedback 
         2.086826          2.007327          1.122147          1.092150          3.070068 
plot(logm5_m, which = 1)
[1] 106
