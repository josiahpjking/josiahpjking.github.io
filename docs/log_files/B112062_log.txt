

	####### B112062 R script #######

setwd("~/3rd year/Research Methods and Statistics 2/semester 1 researhc report")
[1] 1
data <- read.csv("~/Desktop/rms2/code_check/RMS2_report_1920.csv", 
    header = TRUE)
[1] 2
library(psych, quietly = T)
[1] 3
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 4
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
str(data)
[1] 5
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : int  2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : int  2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
describe(data)
[1] 6
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training     3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
is.factor(data$empathy)
[1] 7
[1] FALSE
is.factor(data$years)
[1] 8
[1] FALSE
shapiro.test(data$empathy)
[1] 9

	Shapiro-Wilk normality test

data:  data$empathy
W = 0.97073, p-value = 0.0003477

cov(data$empathy, data$years, method = "spearman")
[1] 10
[1] 1012.956
cor(data$empathy, data$years, method = "spearman")
[1] 11
[1] 0.3071045
cor.test(data$empathy, data$years, method = "spearman", exact = FALSE)
[1] 12

	Spearman's rank correlation rho

data:  data$empathy and data$years
S = 923838, p-value = 9.723e-06
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.3071045 

r <- cor(data$empathy, data$years, method = "spearman")
[1] 13
t <- (r * sqrt(200 - 2))/sqrt(1 - r^2)
[1] 14
t

[1] 4.540772


qt(1 - 0.05/2, df = 200 - 2)
[1] 16
[1] 1.972017
corSignificance <- cor.test(data$empathy, data$years, method = "spearman", 
    exact = FALSE)
[1] 17
corSignificance


	Spearman's rank correlation rho

data:  data$empathy and data$years
S = 923838, p-value = 9.723e-06
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.3071045 



is.factor(data$training)
[1] 19
[1] FALSE
data$training <- factor(data$training)
[1] 20
is.factor(data$training)
[1] 21
[1] TRUE
levels(data$training)
[1] 22
[1] "1" "2"
table(data$training)
[1] 23

  1   2 
100 100 
data$training <- factor(data$training, labels = c("no training", 
    "training"))
[1] 24
levels(data$training)
[1] 25
[1] "no training" "training"   
table(data$training)
[1] 26

no training    training 
        100         100 
m1 <- lm(incidents ~ training + empathy + years, data = data)
[1] 27
summary(m1)
[1] 28

Call:
lm(formula = incidents ~ training + empathy + years, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.407320   0.051814   7.861 2.48e-13 ***
trainingtraining -0.152427   0.023166  -6.580 4.20e-10 ***
empathy           0.025396   0.004735   5.363 2.29e-07 ***
years            -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

confint(m1)
[1] 29
                       2.5 %       97.5 %
(Intercept)       0.30513599  0.509504162
trainingtraining -0.19811433 -0.106739356
empathy           0.01605669  0.034734598
years            -0.02175353 -0.006415556
shapiro.test(m1$residuals)
[1] 30

	Shapiro-Wilk normality test

data:  m1$residuals
W = 0.97994, p-value = 0.005838

hist(m1$residuals)
[1] 31
qqPlot(m1)
[1] 32
residualPlots(m1)
[1] 33
ncvTest(m1)
[1] 34
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0293323, Df = 1, p = 0.86401
crPlots(m1)
[1] 35
durbinWatsonTest(m1)
[1] 36
 lag Autocorrelation D-W Statistic p-value
   1      -0.1072849      2.199897   0.184
 Alternative hypothesis: rho != 0
vif(m1)
[1] 37
training  empathy    years 
1.020633 1.092467 1.085089 
stdz <- MASS::studres(m1)
[1] 38
which(abs(stdz) > 2)
[1] 39
  7  13  35  74 159 165 176 181 
  7  13  35  74 159 165 176 181 
hats <- hatvalues(m1)
[1] 40
which(hats > 2 * mean(hats))
[1] 41
 61  88  89  92  94 137 141 154 163 175 200 
 61  88  89  92  94 137 141 154 163 175 200 
cooks <- cooks.distance(m1)
[1] 42
cutoff <- 4/(200 - 3 - 1)
[1] 43
which(cooks > cutoff)
[1] 44
 13  35  74 137 165 
 13  35  74 137 165 
data$feedback <- factor(data$feedback)
[1] 45
is.factor(data$feedback)
[1] 46
[1] TRUE
levels(data$feedback)
[1] 47
[1] "1" "2"
data$feedback <- factor(data$feedback, labels = c("no feedback", 
    "feedback"))
[1] 48
levels(data$feedback)
[1] 49
[1] "no feedback" "feedback"   
contrasts(data$feedback) <- contr.treatment(2)
[1] 50
m2 <- lm(incidents ~ feedback + empathy + years, data = data)
[1] 51
summary(m2)
[1] 52

Call:
lm(formula = incidents ~ feedback + empathy + years, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.276161   0.054108   5.104 7.84e-07 ***
feedback2    0.132132   0.023585   5.602 7.09e-08 ***
empathy      0.023187   0.004829   4.802 3.11e-06 ***
years       -0.012689   0.003975  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

hist(m2$residuals)
[1] 53
qqPlot(m2)
[1] 54
shapiro.test(m2$residuals)
[1] 55

	Shapiro-Wilk normality test

data:  m2$residuals
W = 0.98772, p-value = 0.08174

residualPlots(m2)
[1] 56
ncvTest(m2)
[1] 57
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.01731234, Df = 1, p = 0.89532
crPlots(m2)
[1] 58
durbinWatsonTest(m2)
[1] 59
 lag Autocorrelation D-W Statistic p-value
   1       0.2738264      1.444081       0
 Alternative hypothesis: rho != 0
vif(m2)
[1] 60
feedback  empathy    years 
1.005211 1.079397 1.077467 
stdz_m2 <- MASS::studres(m2)
[1] 61
which(abs(stdz_m2) > 2)
[1] 62
 13  21  73  74 150 156 159 160 165 176 181 
 13  21  73  74 150 156 159 160 165 176 181 
hats2 <- hatvalues(m2)
[1] 63
which(hats2 > 2 * mean(hats2))
[1] 64
 61  88  89  92 137 141 154 163 175 200 
 61  88  89  92 137 141 154 163 175 200 
cooks2 <- cooks.distance(m2)
[1] 65
cutoff <- 4/(200 - 3 - 1)
[1] 66
which(cooks2 > cutoff)
[1] 67
 73  74  89 137 156 160 165 176 
 73  74  89 137 156 160 165 176 
AIC(m1, m2)
[1] 68
   df       AIC
m1  5 -154.1654
m2  5 -143.9591
BIC(m1, m2)
[1] 69
   df       BIC
m1  5 -137.6738
m2  5 -127.4675
is.factor(data$training)
[1] 70
[1] TRUE
is.factor(data$feedback)
[1] 71
[1] TRUE
levels(data$training)
[1] 72
[1] "no training" "training"   
levels(data$feedback)
[1] 73
[1] "no feedback" "feedback"   
table(data$training)
[1] 74

no training    training 
        100         100 
table(data$feedback)
[1] 75

no feedback    feedback 
        100         100 
summary(lm(incidents ~ training + feedback + feedback * training, 
    data = data))
[1] 76

Call:
lm(formula = incidents ~ training + feedback + feedback * training, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40000 -0.10500  0.00000  0.08333  0.43333 

Coefficients:
                           Estimate Std. Error t value Pr(>|t|)    
(Intercept)                 0.49333    0.02314  21.323  < 2e-16 ***
trainingtraining           -0.16000    0.03272  -4.890 2.09e-06 ***
feedback2                   0.09667    0.03272   2.954  0.00352 ** 
trainingtraining:feedback2  0.05333    0.04627   1.153  0.25047    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1636 on 196 degrees of freedom
Multiple R-squared:  0.2431,	Adjusted R-squared:  0.2315 
F-statistic: 20.99 on 3 and 196 DF,  p-value: 7.827e-12

