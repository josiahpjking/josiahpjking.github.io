

	####### B122604 R script #######

library(psych, quietly = T)
[1] 1
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 2
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[10] "methods"   "base"     
read.csv("../RMS2_report_1920.csv")
[1] 3
  subject incidents training feedback empathy years
1       1 0.6666667        2        2      11    10
2       2 0.3333333        2        1      10     7
3       3 0.3333333        2        2      10     5
4       4 0.4166667        2        1       9     7
5       5 0.5000000        2        2      12    12
6       6 0.2500000        2        1      11    10
7       7 0.8333333        2        2      13     8
8       8 0.4166667        2        1      14    10
 [ reached 'max' / getOption("max.print") -- omitted 192 rows ]
cwdata <- read.csv("../RMS2_report_1920.csv")
[1] 4
table(cwdata)
[1] 5
, , training = 1, feedback = 1, empathy = 3, years = 1

       incidents
subject 0.083333333 0.166666667 0.25 0.333333333 0.416666667 0.5 0.583333333 0.666666667 0.75 0.833333333
    1             0           0    0           0           0   0           0           0    0           0
    2             0           0    0           0           0   0           0           0    0           0
    3             0           0    0           0           0   0           0           0    0           0
    4             0           0    0           0           0   0           0           0    0           0
       incidents
subject 0.916666667
    1             0
    2             0
    3             0
    4             0

 [ reached getOption("max.print") -- omitted 196 row(s) and 883 matrix slice(s) ]
summary(cwdata)
[1] 6
    subject         incidents          training      feedback      empathy          years      
 Min.   :  1.00   Min.   :0.08333   Min.   :1.0   Min.   :1.0   Min.   : 3.00   Min.   : 1.00  
 1st Qu.: 50.75   1st Qu.:0.33333   1st Qu.:1.0   1st Qu.:1.0   1st Qu.: 9.00   1st Qu.: 6.00  
 Median :100.50   Median :0.41667   Median :1.5   Median :1.5   Median :10.00   Median : 8.00  
 Mean   :100.50   Mean   :0.47500   Mean   :1.5   Mean   :1.5   Mean   :10.18   Mean   : 8.13  
 3rd Qu.:150.25   3rd Qu.:0.58333   3rd Qu.:2.0   3rd Qu.:2.0   3rd Qu.:12.00   3rd Qu.:10.00  
 Max.   :200.00   Max.   :0.91667   Max.   :2.0   Max.   :2.0   Max.   :16.00   Max.   :19.00  
cwdata$training <- as.factor(cwdata$training)
[1] 7
cwdata$feedback <- as.factor(cwdata$feedback)
[1] 8
summary(cwdata)
[1] 9
    subject         incidents       training feedback    empathy          years      
 Min.   :  1.00   Min.   :0.08333   1:100    1:100    Min.   : 3.00   Min.   : 1.00  
 1st Qu.: 50.75   1st Qu.:0.33333   2:100    2:100    1st Qu.: 9.00   1st Qu.: 6.00  
 Median :100.50   Median :0.41667                     Median :10.00   Median : 8.00  
 Mean   :100.50   Mean   :0.47500                     Mean   :10.18   Mean   : 8.13  
 3rd Qu.:150.25   3rd Qu.:0.58333                     3rd Qu.:12.00   3rd Qu.:10.00  
 Max.   :200.00   Max.   :0.91667                     Max.   :16.00   Max.   :19.00  
cwdata$empathy_m <- cwdata$empathy - mean(cwdata$empathy)
[1] 10
m1 <- lm(empathy_m ~ years, data = cwdata)
[1] 11
summary(m1)
[1] 12

Call:
lm(formula = empathy_m ~ years, data = cwdata)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) -1.76875    0.49085  -3.603 0.000397 ***
years        0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

plot(cwdata$years ~ cwdata$empathy_m, main = "relationship between empathy and experience")
[1] 13
plot(m1)
[1] 14
abline(lm(cwdata$empathy ~ cwdata$years))
[1] 15
lines(lowess(cwdata$empathy_m, cwdata$years))
[1] 16
crPlots(m1)
[1] 17
poly_m1 <- lm(cwdata$empathy_m ~ poly(cwdata$years, 2))
[1] 18
summary(poly_m1)
[1] 19

Call:
lm(formula = cwdata$empathy_m ~ poly(cwdata$years, 2))

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
                         Estimate Std. Error t value Pr(>|t|)    
(Intercept)            -6.843e-16  1.392e-01    0.00        1    
poly(cwdata$years, 2)1  9.450e+00  1.969e+00    4.80 3.13e-06 ***
poly(cwdata$years, 2)2 -2.069e+01  1.969e+00  -10.51  < 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

crPlots(poly_m1)
[1] 20
plot(poly_m1)
[1] 21
hist(poly_m1$residuals)
[1] 22
qqPlot(m1)
[1] 23
shapiro.test(poly_m1$residuals)
[1] 24

	Shapiro-Wilk normality test

data:  poly_m1$residuals
W = 0.9941, p-value = 0.6155

crPlots(poly_m1)
[1] 25
ncvTest(poly_m1)
[1] 26
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.5107658, Df = 1, p = 0.47481
durbinWatsonTest(poly_m1)
[1] 27
 lag Autocorrelation D-W Statistic p-value
   1      0.01288905      1.973855   0.866
 Alternative hypothesis: rho != 0
plot(m1)
[1] 28
hist(m1$residuals)
[1] 29
qqPlot(m1)
[1] 30
hist(cwdata$empathy_m)
[1] 31
shapiro.test(m1$residuals)
[1] 32

	Shapiro-Wilk normality test

data:  m1$residuals
W = 0.98911, p-value = 0.1321

ncvTest(m1)
[1] 33
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.9815033, Df = 1, p = 0.32183
m2 <- lm(incidents ~ empathy_m + years + training, data = cwdata)
[1] 34
summary(m2)
[1] 35

Call:
lm(formula = incidents ~ empathy_m + years + training, data = cwdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.665721   0.036551  18.214  < 2e-16 ***
empathy_m    0.025396   0.004735   5.363 2.29e-07 ***
years       -0.014085   0.003889  -3.622 0.000372 ***
training2   -0.152427   0.023166  -6.580 4.20e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

qqPlot(m2)
[1] 36
shapiro.test(m2$residuals)
[1] 37

	Shapiro-Wilk normality test

data:  m2$residuals
W = 0.97994, p-value = 0.005838

hist(m2$residuals)
[1] 38
logm2 <- lm(log(incidents + 1) ~ empathy_m + years + training, 
    data = cwdata)
[1] 39
summary(logm2)
[1] 40

Call:
lm(formula = log(incidents + 1) ~ empathy_m + years + training, 
    data = cwdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.25974 -0.08206 -0.00301  0.07026  0.33183 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.511876   0.024544  20.856  < 2e-16 ***
empathy_m    0.017470   0.003180   5.494 1.21e-07 ***
years       -0.009683   0.002611  -3.708 0.000272 ***
training2   -0.104810   0.015556  -6.737 1.75e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1089 on 196 degrees of freedom
Multiple R-squared:  0.2657,	Adjusted R-squared:  0.2544 
F-statistic: 23.63 on 3 and 196 DF,  p-value: 4.229e-13

hist(logm2$residuals)
[1] 41
shapiro.test(logm2$residuals)
[1] 42

	Shapiro-Wilk normality test

data:  logm2$residuals
W = 0.9901, p-value = 0.1845

skew(logm2$residuals)
[1] 43
[1] 0.2339685
vif(logm2)
[1] 44
empathy_m     years  training 
 1.092467  1.085089  1.020633 
residualPlot(logm2)
[1] 45
ncvTest(logm2)
[1] 46
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.8932792, Df = 1, p = 0.34459
shapiro.test(logm2$residuals)
[1] 47

	Shapiro-Wilk normality test

data:  logm2$residuals
W = 0.9901, p-value = 0.1845

crPlots(logm2)
[1] 48
durbinWatsonTest(logm2)
[1] 49
 lag Autocorrelation D-W Statistic p-value
   1      -0.1160146      2.216759   0.126
 Alternative hypothesis: rho != 0
vif(logm2)
[1] 50
empathy_m     years  training 
 1.092467  1.085089  1.020633 
summary(logm2)
[1] 51

Call:
lm(formula = log(incidents + 1) ~ empathy_m + years + training, 
    data = cwdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.25974 -0.08206 -0.00301  0.07026  0.33183 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.511876   0.024544  20.856  < 2e-16 ***
empathy_m    0.017470   0.003180   5.494 1.21e-07 ***
years       -0.009683   0.002611  -3.708 0.000272 ***
training2   -0.104810   0.015556  -6.737 1.75e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1089 on 196 degrees of freedom
Multiple R-squared:  0.2657,	Adjusted R-squared:  0.2544 
F-statistic: 23.63 on 3 and 196 DF,  p-value: 4.229e-13

confint(logm2)
[1] 52
                  2.5 %       97.5 %
(Intercept)  0.46347216  0.560279760
empathy_m    0.01119898  0.023741170
years       -0.01483306 -0.004533627
training2   -0.13548881 -0.074130633
library(car, quietly = T)
[1] 53
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[10] "methods"   "base"     
m3 <- lm(log(incidents + 1) ~ feedback + empathy_m + years, data = cwdata)
[1] 54
summary(m3)
[1] 55

Call:
lm(formula = log(incidents + 1) ~ feedback + empathy_m + years, 
    data = cwdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.25959 -0.07169 -0.00250  0.07834  0.33399 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.406562   0.024132  16.847  < 2e-16 ***
feedback2    0.090112   0.015878   5.675 4.93e-08 ***
empathy_m    0.015942   0.003251   4.904 1.97e-06 ***
years       -0.008717   0.002676  -3.257  0.00132 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.112 on 196 degrees of freedom
Multiple R-squared:  0.2232,	Adjusted R-squared:  0.2113 
F-statistic: 18.78 on 3 and 196 DF,  p-value: 9.56e-11

hist(m3$residuals)
[1] 56
shapiro.test(m3$residuals)
[1] 57

	Shapiro-Wilk normality test

data:  m3$residuals
W = 0.99557, p-value = 0.8301

qqPlot(m3)
[1] 58
plot(cooks.distance(m3))
[1] 59
ncvTest(m3)
[1] 60
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.5811934, Df = 1, p = 0.44584
residualPlots(m3)
[1] 61
crPlots(m3)
[1] 62
durbinWatsonTest(m3)
[1] 63
 lag Autocorrelation D-W Statistic p-value
   1       0.2792812      1.432218   0.002
 Alternative hypothesis: rho != 0
vif(m3)
[1] 64
 feedback empathy_m     years 
 1.005211  1.079397  1.077467 
stdz <- MASS::studres(m3)
[1] 65
stdz

          1           2           3           4           5           6           7           8           9 
 0.79137135 -0.49342034 -1.46814824  0.19262307 -0.14111701 -0.98278999  1.21024308 -0.28866148 -0.53241612 
         10          11          12          13          14          15          16          17          18 
-1.83549690  0.91796426 -0.03825820  2.11708582  0.27656538  0.38185417 -1.31151225 -1.91706007 -0.35064444 
         19          20          21          22          23          24          25          26          27 
 0.98398844  0.44229024 -2.21512663 -0.18522429 -0.67972007  0.76255217 -0.90248126 -1.44626439 -0.38853230 
         28          29          30          31          32          33          34          35          36 
-0.78105519 -0.83767364 -1.83108859 -1.01870195  0.21200812 -1.32266458 -0.07970113  1.18816940 -0.10660701 
         37          38          39          40          41          42          43          44          45 
-0.19501325  0.60743912 -0.02008398 -1.43151695  0.97736590 -0.07970113 -1.05924997 -0.88454439 -0.48768008 
         46          47          48          49          50 
-0.99523922  0.01803774  0.68487999 -0.18086849 -1.51349205 
 [ reached getOption("max.print") -- omitted 150 entries ]


which(abs(stdz) > 2)
[1] 67
 13  21  73  74  89 150 156 159 160 176 181 
 13  21  73  74  89 150 156 159 160 176 181 
AIC(logm2, m3)
[1] 68
      df       AIC
logm2  5 -313.4627
m3     5 -302.2294
BIC(logm2, m3)
[1] 69
      df       BIC
logm2  5 -296.9711
m3     5 -285.7378
library(interactions, quietly = T)
[1] 70
 [1] "interactions" "car"          "carData"      "psych"        "readr"        "stats"        "graphics"    
 [8] "grDevices"    "utils"        "datasets"     "methods"      "base"        
m5 <- lm(incidents ~ training + feedback + training * feedback, 
    data = cwdata)
[1] 71
summary(m5)
[1] 72

Call:
lm(formula = incidents ~ training + feedback + training * feedback, 
    data = cwdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40000 -0.10500  0.00000  0.08333  0.43333 

Coefficients:
                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)          0.49333    0.02314  21.323  < 2e-16 ***
training2           -0.16000    0.03272  -4.890 2.09e-06 ***
feedback2            0.09667    0.03272   2.954  0.00352 ** 
training2:feedback2  0.05333    0.04627   1.153  0.25047    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1636 on 196 degrees of freedom
Multiple R-squared:  0.2431,	Adjusted R-squared:  0.2315 
F-statistic: 20.99 on 3 and 196 DF,  p-value: 7.827e-12

cat_plot(m5, pred = feedback, modx = training, geom = "line")
[1] 73
interaction.plot(x.factor = cwdata$training, trace.factor = cwdata$feedback, 
    response = cwdata$incidents)
[1] 74
cat_plot(m5, pred = feedback, modx = training, geom = "line")
[1] 75
vif(m5)
[1] 76
         training          feedback training:feedback 
                2                 2                 3 
ncvTest(m5)
[1] 77
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 1.881673, Df = 1, p = 0.17014
qqPlot(m5)
[1] 78
hist(m5$residuals)
[1] 79
shapiro.test(m5$residuals)
[1] 80

	Shapiro-Wilk normality test

data:  m5$residuals
W = 0.9767, p-value = 0.002072

durbinWatsonTest(m5)
[1] 81
 lag Autocorrelation D-W Statistic p-value
   1       0.1114255      1.770733    0.11
 Alternative hypothesis: rho != 0
