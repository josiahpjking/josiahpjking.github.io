

	####### B110515 R script #######

setwd("~/Report RMS2")
[1] 1
library(readr, quietly = T)
[1] 2
[1] "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
RMS2_report_1920 <- read_csv("../RMS2_report_1920.csv")
[1] 3
View(RMS2_report_1920)
[1] 4
install.packages("car")
[1] 5
install.packages("sjPlot")
[1] 6
install.packages("interactions")
[1] 7
library(car, quietly = T)
[1] 8
 [1] "car"       "carData"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[10] "base"     
library(sjPlot, quietly = T)
[1] 9
 [1] "sjPlot"    "car"       "carData"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[10] "methods"   "base"     
scale(RMS2_report_1920$empathy, center = TRUE, scale = FALSE)
[1] 10
         [,1]
  [1,]  0.825
  [2,] -0.175
  [3,] -0.175
  [4,] -1.175
  [5,]  1.825
  [6,]  0.825
  [7,]  2.825
  [8,]  3.825
  [9,]  1.825
 [10,]  1.825
 [11,]  0.825
 [12,] -1.175
 [13,] -1.175
 [14,]  1.825
 [15,] -1.175
 [16,] -5.175
 [17,] -1.175
 [18,] -1.175
 [19,] -0.175
 [20,] -0.175
 [21,] -0.175
 [22,] -0.175
 [23,] -0.175
 [24,]  1.825
 [25,]  0.825
 [26,]  1.825
 [27,]  0.825
 [28,]  1.825
 [29,] -0.175
 [30,] -5.175
 [31,] -2.175
 [32,]  2.825
 [33,] -1.175
 [34,]  1.825
 [35,]  2.825
 [36,] -0.175
 [37,] -2.175
 [38,]  1.825
 [39,]  3.825
 [40,] -3.175
 [41,] -3.175
 [42,]  1.825
 [43,]  0.825
 [44,] -3.175
 [45,] -3.175
 [46,] -0.175
 [47,]  0.825
 [48,]  1.825
 [49,] -1.175
 [50,] -3.175
 [ reached getOption("max.print") -- omitted 150 rows ]
attr(,"scaled:center")
[1] 10.175
m1 <- lm(empathy ~ years, data = RMS2_report_1920)
[1] 11
summary(m1)
[1] 12

Call:
lm(formula = empathy ~ years, data = RMS2_report_1920)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  8.40625    0.49085  17.126  < 2e-16 ***
years        0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

hist(m1$residuals)
[1] 13
shapiro.test(m1$residuals)
[1] 14

	Shapiro-Wilk normality test

data:  m1$residuals
W = 0.98911, p-value = 0.1321

residualPlots(m1)
[1] 15
ncvTest(m1)
[1] 16
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.9815033, Df = 1, p = 0.32183
cor.test(~empathy + years, data = RMS2_report_1920, method = "spearman", 
    exact = FALSE, conf.level = 0.95)
[1] 17

	Spearman's rank correlation rho

data:  empathy and years
S = 923838, p-value = 9.723e-06
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.3071045 

m2 <- lm(scale(incidents) ~ scale(training) + scale(empathy) + 
    scale(years), data = RMS2_report_1920)
[1] 18
summary(m2)
[1] 19

Call:
lm(formula = scale(incidents) ~ scale(training) + scale(empathy) + 
    scale(years), data = RMS2_report_1920)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.91022 -0.65749 -0.07901  0.54149  2.84967 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)      2.053e-16  6.144e-02   0.000 1.000000    
scale(training) -4.094e-01  6.222e-02  -6.580 4.20e-10 ***
scale(empathy)   3.452e-01  6.438e-02   5.363 2.29e-07 ***
scale(years)    -2.324e-01  6.416e-02  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.8689 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

hist(m2$residuals)
[1] 20
shapiro.test(m2$residuals)
[1] 21

	Shapiro-Wilk normality test

data:  m2$residuals
W = 0.97994, p-value = 0.005838

durbinWatsonTest(m2)
[1] 22
 lag Autocorrelation D-W Statistic p-value
   1      -0.1072849      2.199897   0.168
 Alternative hypothesis: rho != 0
residualPlots(m2)
[1] 23
vif(m2)
[1] 24
scale(training)  scale(empathy)    scale(years) 
       1.020633        1.092467        1.085089 
ncvTest(m2)
[1] 25
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0293323, Df = 1, p = 0.86401
m3 <- lm(scale(incidents) ~ scale(feedback) + scale(empathy) + 
    scale(years) + scale(training), data = RMS2_report_1920)
[1] 26
summary(m3)
[1] 27

Call:
lm(formula = scale(incidents) ~ scale(feedback) + scale(empathy) + 
    scale(years) + scale(training), data = RMS2_report_1920)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.69466 -0.54099 -0.05086  0.49112  2.49972 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)      2.080e-16  5.603e-02   0.000        1    
scale(feedback)  3.592e-01  5.632e-02   6.377 1.28e-09 ***
scale(empathy)   3.697e-01  5.883e-02   6.283 2.12e-09 ***
scale(years)    -2.508e-01  5.858e-02  -4.281 2.92e-05 ***
scale(training) -4.132e-01  5.675e-02  -7.281 7.98e-12 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.7924 on 195 degrees of freedom
Multiple R-squared:  0.3848,	Adjusted R-squared:  0.3721 
F-statistic: 30.49 on 4 and 195 DF,  p-value: < 2.2e-16

hist(m3$residuals)
[1] 28
residualPlots(m3)
[1] 29
shapiro.test(m3$residuals)
[1] 30

	Shapiro-Wilk normality test

data:  m3$residuals
W = 0.98734, p-value = 0.07172

durbinWatsonTest(m3)
[1] 31
 lag Autocorrelation D-W Statistic p-value
   1      0.07303546      1.841386   0.252
 Alternative hypothesis: rho != 0
vif(m3)
[1] 32
scale(feedback)  scale(empathy)    scale(years) scale(training) 
       1.005320        1.097109        1.087722        1.020743 
ncvTest(m3)
[1] 33
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 3.684027, Df = 1, p = 0.054936
anova(m2, m3)
[1] 34
Analysis of Variance Table

Model 1: scale(incidents) ~ scale(training) + scale(empathy) + scale(years)
Model 2: scale(incidents) ~ scale(feedback) + scale(empathy) + scale(years) + 
    scale(training)
  Res.Df    RSS Df Sum of Sq      F    Pr(>F)    
1    196 147.97                                  
2    195 122.43  1    25.533 40.668 1.279e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
pf(40.668, 1, 195, lower.tail = F)
[1] 35
[1] 1.279249e-09
library(interactions, quietly = T)
[1] 36
 [1] "interactions" "sjPlot"       "car"          "carData"      "readr"        "stats"        "graphics"    
 [8] "grDevices"    "utils"        "datasets"     "methods"      "base"        
RMS2_report_1920$training <- as.factor(RMS2_report_1920$training)
[1] 37
RMS2_report_1920$feedback <- as.factor(RMS2_report_1920$feedback)
[1] 38
contrasts(RMS2_report_1920$training) <- contr.treatment
[1] 39
contrasts(RMS2_report_1920$training)
[1] 40
  2
1 0
2 1
contrasts(RMS2_report_1920$feedback) <- contr.treatment
[1] 41
contrasts(RMS2_report_1920$feedback)
[1] 42
  2
1 0
2 1
m4 <- lm(incidents ~ training + feedback + training * feedback, 
    data = RMS2_report_1920)
[1] 43
summary(m4)
[1] 44

Call:
lm(formula = incidents ~ training + feedback + training * feedback, 
    data = RMS2_report_1920)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40000 -0.10500  0.00000  0.08333  0.43333 

Coefficients:
                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)          0.49333    0.02314  21.323  < 2e-16 ***
training2           -0.16000    0.03272  -4.890 2.09e-06 ***
feedback2            0.09667    0.03272   2.954  0.00352 ** 
training2:feedback2  0.05333    0.04627   1.153  0.25047    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1636 on 196 degrees of freedom
Multiple R-squared:  0.2431,	Adjusted R-squared:  0.2315 
F-statistic: 20.99 on 3 and 196 DF,  p-value: 7.827e-12

plot_model(m4, type = "int", terms = c("training", "feedback"))
[1] 45
NULL
