

	####### B111763 R script #######

install.packages("psych")
[1] 1
install.packages("car")
[1] 2
install.packages("interactions")
[1] 3
install.packages("ggplot2")
[1] 4
install.packages("jtools")
[1] 5
library(psych, quietly = T)
[1] 6
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 7
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[10] "methods"   "base"     
library(stats, quietly = T)
[1] 8
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[10] "methods"   "base"     
library(interactions, quietly = T)
[1] 9
 [1] "interactions" "car"          "carData"      "psych"        "readr"        "stats"        "graphics"    
 [8] "grDevices"    "utils"        "datasets"     "methods"      "base"        
library(ggplot2, quietly = T)
[1] 10
 [1] "ggplot2"      "interactions" "car"          "carData"      "psych"        "readr"        "stats"       
 [8] "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
library(jtools, quietly = T)
[1] 11
 [1] "jtools"       "ggplot2"      "interactions" "car"          "carData"      "psych"        "readr"       
 [8] "stats"        "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
setwd("~/Desktop/RMS2_assignment")
[1] 12
RMS2_data <- read.csv("../RMS2_report_1920.csv")
[1] 13
describe(RMS2_data)
[1] 14
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training     3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
RMS2_data

  subject incidents training feedback empathy years
1       1 0.6666667        2        2      11    10
2       2 0.3333333        2        1      10     7
3       3 0.3333333        2        2      10     5
4       4 0.4166667        2        1       9     7
5       5 0.5000000        2        2      12    12
6       6 0.2500000        2        1      11    10
7       7 0.8333333        2        2      13     8
8       8 0.4166667        2        1      14    10
 [ reached 'max' / getOption("max.print") -- omitted 192 rows ]


RMS2_data$training <- as.factor(RMS2_data$training)
[1] 16
RMS2_data$training <- factor(RMS2_data$training, labels = c("No Training", 
    "Training"))
[1] 17
RMS2_data$feedback <- as.factor(RMS2_data$feedback)
[1] 18
RMS2_data$feedback <- factor(RMS2_data$feedback, labels = c("No Feedback", 
    "Feedback"))
[1] 19
empathyA <- scale(RMS2_data$empathy)
[1] 20
scatterplot(empathyA ~ years, data = RMS2_data, main = "Relationship between Empathy and Experience (Q1.1)", 
    xlab = "Years of Experience", ylab = "Empathy", col = "green")
[1] 21
M1 <- lm(empathyA ~ years, data = RMS2_data)
[1] 22
summary(M1)
[1] 23

Call:
lm(formula = empathyA ~ years, data = RMS2_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.97192 -0.59754  0.02792  0.64474  2.30713 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) -0.69717    0.19347  -3.603 0.000397 ***
years        0.08575    0.02226   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.9669 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

crPlots(M1, xlab = "Years of experience", ylab = "Empathy", col = "red")
[1] 24
M1A.1 <- lm(empathyA ~ years + I(years^2), data = RMS2_data)
[1] 25
crPlots(M1A.1, main = "Updated Partial Residual plot investigating linearity", 
    col = "red")
[1] 26
shapiro.test(M1A.1$residuals)
[1] 27

	Shapiro-Wilk normality test

data:  M1A.1$residuals
W = 0.9941, p-value = 0.6155

residualPlots(M1A.1, main = "Residual Plots Investigating Homoscedasticity", 
    col = "purple")
[1] 28
ncvTest(M1A.1)
[1] 29
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.5107658, Df = 1, p = 0.47481
durbinWatsonTest(M1A.1)
[1] 30
 lag Autocorrelation D-W Statistic p-value
   1      0.01288905      1.973855   0.856
 Alternative hypothesis: rho != 0
plot(M1A.1, which = 4)
[1] 31
abline(h = (4/(200 - 1 - 1)), col = "red")
[1] 32
out <- which(cooks.distance(M1A.1) > (4/(200 - 1 - 1)))
[1] 33
M1A.2 <- lm(empathyA ~ years + I(years^2), data = RMS2_data, 
    subset = -out)
[1] 34
plot(M1A.2, which = 4)
[1] 35
summary(M1A.1)
[1] 36

Call:
lm(formula = empathyA ~ years + I(years^2), data = RMS2_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.77645 -0.55225 -0.03293  0.46143  2.38949 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept) -3.542969   0.312115  -11.35   <2e-16 ***
years        0.815324   0.071676   11.38   <2e-16 ***
I(years^2)  -0.040853   0.003887  -10.51   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.776 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

M2 <- lm(RMS2_data$incidents ~ RMS2_data$training, data = RMS2_data)
[1] 37
describeBy(RMS2_data$incidents, RMS2_data$training)
[1] 38

 Descriptive statistics by group 
group: No Training
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 100 0.54 0.18    0.5    0.53 0.25 0.25 0.92  0.67 0.39    -0.73 0.02
--------------------------------------------------------------------------------------- 
group: Training
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 100 0.41 0.17   0.42     0.4 0.12 0.08 0.92  0.83 0.38    -0.05 0.02
summary(M2)
[1] 39

Call:
lm(formula = RMS2_data$incidents ~ RMS2_data$training, data = RMS2_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.32500 -0.12500  0.00833  0.12500  0.50833 

Coefficients:
                           Estimate Std. Error t value Pr(>|t|)    
(Intercept)                 0.54167    0.01747  31.009  < 2e-16 ***
RMS2_data$trainingTraining -0.13333    0.02470  -5.397 1.92e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1747 on 198 degrees of freedom
Multiple R-squared:  0.1283,	Adjusted R-squared:  0.1239 
F-statistic: 29.13 on 1 and 198 DF,  p-value: 1.922e-07

M2.1 <- lm(RMS2_data$incidents ~ RMS2_data$training + empathyA + 
    RMS2_data$years)
[1] 40
summary(M2.1)
[1] 41

Call:
lm(formula = RMS2_data$incidents ~ RMS2_data$training + empathyA + 
    RMS2_data$years)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                 0.665721   0.036551  18.214  < 2e-16 ***
RMS2_data$trainingTraining -0.152427   0.023166  -6.580 4.20e-10 ***
empathyA                    0.064430   0.012014   5.363 2.29e-07 ***
RMS2_data$years            -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

crPlots(M2.1, main = "Partial Residual plot investigating linearity", 
    xlab = "Training", ylab = "Intervention", col = "red")
[1] 42
shapiro.test(M2.1$residuals)
[1] 43

	Shapiro-Wilk normality test

data:  M2.1$residuals
W = 0.97994, p-value = 0.005838

hist(M2.1$residuals, main = "Histogram of M2.1 investigating normality", 
    col = "yellow")
[1] 44
residualPlots(M2.1, main = "Residual Plots investigating homoscedasticity", 
    col = "purple")
[1] 45
ncvTest(M2.1)
[1] 46
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0293323, Df = 1, p = 0.86401
durbinWatsonTest(M2.1)
[1] 47
 lag Autocorrelation D-W Statistic p-value
   1      -0.1072849      2.199897   0.162
 Alternative hypothesis: rho != 0
vif(M2.1)
[1] 48
RMS2_data$training           empathyA    RMS2_data$years 
          1.020633           1.092467           1.085089 
plot(M2.1, which = 4)
[1] 49
abline(h = (4/(200 - 3 - 1)), col = "red")
[1] 50
out2 <- which(cooks.distance(M2.1) > (4/(200 - 3 - 1)))
[1] 51
summary(M2.1)
[1] 52

Call:
lm(formula = RMS2_data$incidents ~ RMS2_data$training + empathyA + 
    RMS2_data$years)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                 0.665721   0.036551  18.214  < 2e-16 ***
RMS2_data$trainingTraining -0.152427   0.023166  -6.580 4.20e-10 ***
empathyA                    0.064430   0.012014   5.363 2.29e-07 ***
RMS2_data$years            -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

M3 <- lm(RMS2_data$incidents ~ RMS2_data$feedback, data = RMS2_data)
[1] 53
describeBy(RMS2_data$incidents, RMS2_data$feedback)
[1] 54

 Descriptive statistics by group 
group: No Feedback
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 100 0.41 0.17   0.42     0.4 0.12 0.08 0.92  0.83  0.6     0.36 0.02
--------------------------------------------------------------------------------------- 
group: Feedback
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 100 0.54 0.18    0.5    0.53 0.25 0.08 0.92  0.83 0.11    -0.44 0.02
summary(M3)
[1] 55

Call:
lm(formula = RMS2_data$incidents ~ RMS2_data$feedback, data = RMS2_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.45333 -0.12000  0.00333  0.13000  0.50333 

Coefficients:
                           Estimate Std. Error t value Pr(>|t|)    
(Intercept)                 0.41333    0.01765   23.41  < 2e-16 ***
RMS2_data$feedbackFeedback  0.12333    0.02496    4.94 1.66e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1765 on 198 degrees of freedom
Multiple R-squared:  0.1097,	Adjusted R-squared:  0.1052 
F-statistic: 24.41 on 1 and 198 DF,  p-value: 1.656e-06

M3.1 <- lm(RMS2_data$incidents ~ RMS2_data$feedback + empathyA + 
    RMS2_data$years)
[1] 56
summary(M3.1)
[1] 57

Call:
lm(formula = RMS2_data$incidents ~ RMS2_data$feedback + empathyA + 
    RMS2_data$years)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                 0.512093   0.035846  14.286  < 2e-16 ***
RMS2_data$feedbackFeedback  0.132132   0.023585   5.602 7.09e-08 ***
empathyA                    0.058827   0.012251   4.802 3.11e-06 ***
RMS2_data$years            -0.012689   0.003975  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

crPlots(M3.1, main = "Partial Residual Plots investigating linearity", 
    xlab = "Feedback", ylab = "Intervention", col = "red")
[1] 58
shapiro.test(M3.1$residuals)
[1] 59

	Shapiro-Wilk normality test

data:  M3.1$residuals
W = 0.98772, p-value = 0.08174

residualPlots(M3.1, main = "Residual Plots investigating homoscedasticity", 
    col = "purple")
[1] 60
ncvTest(M3.1)
[1] 61
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.01731234, Df = 1, p = 0.89532
durbinWatsonTest(M3.1)
[1] 62
 lag Autocorrelation D-W Statistic p-value
   1       0.2738264      1.444081       0
 Alternative hypothesis: rho != 0
vif(M3.1)
[1] 63
RMS2_data$feedback           empathyA    RMS2_data$years 
          1.005211           1.079397           1.077467 
summary(M3.1)
[1] 64

Call:
lm(formula = RMS2_data$incidents ~ RMS2_data$feedback + empathyA + 
    RMS2_data$years)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                 0.512093   0.035846  14.286  < 2e-16 ***
RMS2_data$feedbackFeedback  0.132132   0.023585   5.602 7.09e-08 ***
empathyA                    0.058827   0.012251   4.802 3.11e-06 ***
RMS2_data$years            -0.012689   0.003975  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

plot(M3.1, which = 4)
[1] 65
abline(h = (4/(200 - 3 - 1)), col = "red")
[1] 66
out3 <- which(cooks.distance(M3.1) > (4/(200 - 3 - 1)))
[1] 67
summary(M3.1)
[1] 68

Call:
lm(formula = RMS2_data$incidents ~ RMS2_data$feedback + empathyA + 
    RMS2_data$years)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                 0.512093   0.035846  14.286  < 2e-16 ***
RMS2_data$feedbackFeedback  0.132132   0.023585   5.602 7.09e-08 ***
empathyA                    0.058827   0.012251   4.802 3.11e-06 ***
RMS2_data$years            -0.012689   0.003975  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

M4 <- lm(RMS2_data$incidents ~ RMS2_data$feedback + empathyA + 
    RMS2_data$years)
[1] 69
M2.1 <- lm(RMS2_data$incidents ~ RMS2_data$training + empathyA + 
    RMS2_data$years)
[1] 70
BIC(M2.1, M4)
[1] 71
     df       BIC
M2.1  5 -137.6738
M4    5 -127.4675
M5 <- lm(incidents ~ training + feedback + training:feedback, 
    data = RMS2_data)
[1] 72
shapiro.test(M5$residuals)
[1] 73

	Shapiro-Wilk normality test

data:  M5$residuals
W = 0.9767, p-value = 0.002072

hist(M5$residuals, main = "Histogram to investigate normality for M5", 
    col = "yellow")
[1] 74
residualPlots(M5, main = "Residual Plots to investigate homoscedasticity", 
    col = "purple")
[1] 75
ncvTest(M5)
[1] 76
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 1.881673, Df = 1, p = 0.17014
durbinWatsonTest(M5)
[1] 77
 lag Autocorrelation D-W Statistic p-value
   1       0.1114255      1.770733   0.106
 Alternative hypothesis: rho != 0
vif(M5)
[1] 78
         training          feedback training:feedback 
                2                 2                 3 
cat_plot(M5, pred = training, modx = feedback, geom = "line", 
    main = "Interaction between training and feedback")
[1] 79
