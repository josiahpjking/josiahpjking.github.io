

	####### B122965 R script #######

library(psych, quietly = T)
[1] 1
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(lm.beta, quietly = T)
[1] 2
 [1] "lm.beta"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[10] "base"     
library(car, quietly = T)
[1] 3
 [1] "car"       "carData"   "lm.beta"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"    
[10] "datasets"  "methods"   "base"     
library(base, quietly = T)
[1] 4
 [1] "car"       "carData"   "lm.beta"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"    
[10] "datasets"  "methods"   "base"     
library(interactions, quietly = T)
[1] 5
 [1] "interactions" "car"          "carData"      "lm.beta"      "psych"        "readr"        "stats"       
 [8] "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
data <- read.csv("../RMS2_report_1920.csv", header = T)
[1] 6
describe(data)[, c(2:4, 8:12)]
[1] 7
            n   mean    sd  min    max  range  skew kurtosis
subject   200 100.50 57.88 1.00 200.00 199.00  0.00    -1.22
incidents 200   0.48  0.19 0.08   0.92   0.83  0.32    -0.31
training  200   1.50  0.50 1.00   2.00   1.00  0.00    -2.01
feedback  200   1.50  0.50 1.00   2.00   1.00  0.00    -2.01
empathy   200  10.18  2.54 3.00  16.00  13.00 -0.37     0.23
years     200   8.13  3.08 1.00  19.00  18.00  0.52     0.48
str(data)
[1] 8
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : int  2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : int  2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
data$training <- as.factor(data$training)
[1] 9
data$feedback <- as.factor(data$feedback)
[1] 10
str(data$training)
[1] 11
 Factor w/ 2 levels "1","2": 2 2 2 2 2 2 2 2 2 2 ...
NULL
summary(data$training)
[1] 12
  1   2 
100 100 
data$training <- factor(data$training, labels = c("No ", "Yes"))
[1] 13
str(data$training)
[1] 14
 Factor w/ 2 levels "No ","Yes": 2 2 2 2 2 2 2 2 2 2 ...
NULL
summary(data$training)
[1] 15
No  Yes 
100 100 
data$feedback <- factor(data$feedback, labels = c("No", "Yes"))
[1] 16
str(data$feedback)
[1] 17
 Factor w/ 2 levels "No","Yes": 2 1 2 1 2 1 2 1 2 1 ...
NULL
summary(data$feedback)
[1] 18
 No Yes 
100 100 
m1 <- lm(empathy ~ years, data = data)
[1] 19
m1 <- lm.beta(m1)
[1] 20
summary(m1)
[1] 21

Call:
lm(formula = empathy ~ years, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Standardized Std. Error t value Pr(>|t|)    
(Intercept)  8.40625      0.00000    0.49085  17.126  < 2e-16 ***
years        0.21756      0.26404    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

cooks <- cooks.distance(m1)
[1] 22
names(which(cooks > (4/(200 - 1 - 1))))
[1] 23
 [1] "16"  "61"  "88"  "89"  "94"  "108" "137" "141" "154" "163" "171" "175" "192" "200"
plot(m1, which = 4)
[1] 24
m1a <- lm(empathy ~ years, data = data[-c(88, 137, 154)])
[1] 25
summary(lm.beta(m1a))
[1] 26

Call:
lm(formula = empathy ~ years, data = data[-c(88, 137, 154)])

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Standardized Std. Error t value Pr(>|t|)    
(Intercept)  8.40625      0.00000    0.49085  17.126  < 2e-16 ***
years        0.21756      0.26404    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

qqPlot(m1)
[1] 27
hist(m1$residuals)
[1] 28
residualPlots(m1)
[1] 29
plot(m1, which = 1)
[1] 30
durbinWatsonTest(m1)
[1] 31
 lag Autocorrelation D-W Statistic p-value
   1       0.1017162      1.769879   0.102
 Alternative hypothesis: rho != 0
m2 <- lm(incidents ~ empathy + years, data = data)
[1] 32
summary(m2)
[1] 33

Call:
lm(formula = incidents ~ empathy + years, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.41333 -0.11682 -0.02057  0.10135  0.46713 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.351145   0.056325   6.234 2.71e-09 ***
empathy      0.021449   0.005177   4.143 5.08e-05 ***
years       -0.011610   0.004266  -2.722  0.00708 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1787 on 197 degrees of freedom
Multiple R-squared:  0.09222,	Adjusted R-squared:  0.08301 
F-statistic: 10.01 on 2 and 197 DF,  p-value: 7.259e-05

m3 <- update(m2, . ~ . + training, data = data)
[1] 34
summary(m3)
[1] 35

Call:
lm(formula = incidents ~ empathy + years + training, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.407320   0.051814   7.861 2.48e-13 ***
empathy      0.025396   0.004735   5.363 2.29e-07 ***
years       -0.014085   0.003889  -3.622 0.000372 ***
trainingYes -0.152427   0.023166  -6.580 4.20e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

anova(m2, m3)
[1] 36
Analysis of Variance Table

Model 1: incidents ~ empathy + years
Model 2: incidents ~ empathy + years + training
  Res.Df    RSS Df Sum of Sq      F  Pr(>F)    
1    197 6.2914                                
2    196 5.1532  1    1.1382 43.292 4.2e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
cooks <- cooks.distance(m2)
[1] 37
names(which(cooks > (4/(200 - 2 - 1))))
[1] 38
 [1] "16"  "30"  "60"  "74"  "88"  "89"  "94"  "137" "165" "181"
plot(m2, which = 4)
[1] 39
m2a <- lm(incidents ~ empathy + years, data = data[-c(74, 88, 
    137)])
[1] 40
summary(m2a)
[1] 41

Call:
lm(formula = incidents ~ empathy + years, data = data[-c(74, 
    88, 137)])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.41333 -0.11682 -0.02057  0.10135  0.46713 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.351145   0.056325   6.234 2.71e-09 ***
empathy      0.021449   0.005177   4.143 5.08e-05 ***
years       -0.011610   0.004266  -2.722  0.00708 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1787 on 197 degrees of freedom
Multiple R-squared:  0.09222,	Adjusted R-squared:  0.08301 
F-statistic: 10.01 on 2 and 197 DF,  p-value: 7.259e-05

cooks <- cooks.distance(m3)
[1] 42
names(which(cooks > (4/(200 - 3 - 1))))
[1] 43
[1] "13"  "35"  "74"  "137" "165"
plot(m3, which = 4)
[1] 44
m3a <- lm(incidents ~ empathy + years + incidents, data = data[-c(13, 
    74, 137)])
[1] 45
summary(m3a)
[1] 46

Call:
lm(formula = incidents ~ empathy + years + incidents, data = data[-c(13, 
    74, 137)])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.41333 -0.11682 -0.02057  0.10135  0.46713 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.351145   0.056325   6.234 2.71e-09 ***
empathy      0.021449   0.005177   4.143 5.08e-05 ***
years       -0.011610   0.004266  -2.722  0.00708 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1787 on 197 degrees of freedom
Multiple R-squared:  0.09222,	Adjusted R-squared:  0.08301 
F-statistic: 10.01 on 2 and 197 DF,  p-value: 7.259e-05

qqPlot(m2)
[1] 47
hist(m2$residuals)
[1] 48
residualPlots(m2)
[1] 49
crPlots(m2)
[1] 50
durbinWatsonTest(m2)
[1] 51
 lag Autocorrelation D-W Statistic p-value
   1      0.09754768       1.79735   0.176
 Alternative hypothesis: rho != 0
vif(m2)
[1] 52
empathy   years 
1.07494 1.07494 
qqPlot(m3)
[1] 53
hist(m3$residuals)
[1] 54
residualPlots(m3)
[1] 55
crPlots(m3)
[1] 56
durbinWatsonTest(m3)
[1] 57
 lag Autocorrelation D-W Statistic p-value
   1      -0.1072849      2.199897   0.178
 Alternative hypothesis: rho != 0
vif(m3)
[1] 58
 empathy    years training 
1.092467 1.085089 1.020633 
m4 <- update(m2, . ~ . + feedback, data = data)
[1] 59
summary(m4)
[1] 60

Call:
lm(formula = incidents ~ empathy + years + feedback, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.276161   0.054108   5.104 7.84e-07 ***
empathy      0.023187   0.004829   4.802 3.11e-06 ***
years       -0.012689   0.003975  -3.192  0.00165 ** 
feedbackYes  0.132132   0.023585   5.602 7.09e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

anova(m2, m4)
[1] 61
Analysis of Variance Table

Model 1: incidents ~ empathy + years
Model 2: incidents ~ empathy + years + feedback
  Res.Df    RSS Df Sum of Sq      F   Pr(>F)    
1    197 6.2914                                 
2    196 5.4230  1   0.86841 31.387 7.09e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
cooks <- cooks.distance(m4)
[1] 62
names(which(cooks > (4/(200 - 3 - 1))))
[1] 63
[1] "73"  "74"  "89"  "137" "156" "160" "165" "176"
plot(m4, which = 4)
[1] 64
m4a <- lm(incidents ~ empathy + years + incidents, data = data[-c(30, 
    88, 89)])
[1] 65
summary(m4a)
[1] 66

Call:
lm(formula = incidents ~ empathy + years + incidents, data = data[-c(30, 
    88, 89)])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.41333 -0.11682 -0.02057  0.10135  0.46713 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.351145   0.056325   6.234 2.71e-09 ***
empathy      0.021449   0.005177   4.143 5.08e-05 ***
years       -0.011610   0.004266  -2.722  0.00708 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1787 on 197 degrees of freedom
Multiple R-squared:  0.09222,	Adjusted R-squared:  0.08301 
F-statistic: 10.01 on 2 and 197 DF,  p-value: 7.259e-05

qqPlot(m4)
[1] 67
hist(m4$residuals)
[1] 68
residualPlots(m4)
[1] 69
crPlots(m4)
[1] 70
durbinWatsonTest(m4)
[1] 71
 lag Autocorrelation D-W Statistic p-value
   1       0.2738264      1.444081       0
 Alternative hypothesis: rho != 0
vif(m4)
[1] 72
 empathy    years feedback 
1.079397 1.077467 1.005211 
AIC(m3, m4)
[1] 73
   df       AIC
m3  5 -154.1654
m4  5 -143.9591
BIC(m3, m4)
[1] 74
   df       BIC
m3  5 -137.6738
m4  5 -127.4675
m5 <- lm(incidents ~ empathy + years + training * feedback, data = data)
[1] 75
summary(m5)
[1] 76

Call:
lm(formula = incidents ~ empathy + years + training * feedback, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30367 -0.10365 -0.00795  0.08806  0.44359 

Coefficients:
                         Estimate Std. Error t value Pr(>|t|)    
(Intercept)              0.345467   0.048515   7.121 2.04e-11 ***
empathy                  0.028695   0.004328   6.630 3.25e-10 ***
years                   -0.015720   0.003518  -4.468 1.34e-05 ***
trainingYes             -0.203496   0.029874  -6.812 1.18e-10 ***
feedbackYes              0.085558   0.029299   2.920  0.00391 ** 
trainingYes:feedbackYes  0.097334   0.041840   2.326  0.02103 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1462 on 194 degrees of freedom
Multiple R-squared:  0.4015,	Adjusted R-squared:  0.386 
F-statistic: 26.02 on 5 and 194 DF,  p-value: < 2.2e-16

cooks <- cooks.distance(m5)
[1] 77
names(which(cooks > (4/(200 - 5 - 1))))
[1] 78
[1] "13"  "73"  "74"  "89"  "117" "137" "160" "165" "176"
plot(m4, which = 4)
[1] 79
m4a <- lm(incidents ~ empathy + years + incidents, data = data[-c(30, 
    88, 89)])
[1] 80
summary(m4a)
[1] 81

Call:
lm(formula = incidents ~ empathy + years + incidents, data = data[-c(30, 
    88, 89)])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.41333 -0.11682 -0.02057  0.10135  0.46713 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.351145   0.056325   6.234 2.71e-09 ***
empathy      0.021449   0.005177   4.143 5.08e-05 ***
years       -0.011610   0.004266  -2.722  0.00708 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1787 on 197 degrees of freedom
Multiple R-squared:  0.09222,	Adjusted R-squared:  0.08301 
F-statistic: 10.01 on 2 and 197 DF,  p-value: 7.259e-05

qqPlot(m5)
[1] 82
hist(m5$residuals)
[1] 83
residualPlots(m5)
[1] 84
plot(m5, which = 1)
[1] 85
durbinWatsonTest(m5)
[1] 86
 lag Autocorrelation D-W Statistic p-value
   1      0.09456969      1.801048   0.196
 Alternative hypothesis: rho != 0
