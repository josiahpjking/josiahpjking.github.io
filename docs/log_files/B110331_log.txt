

	####### B110331 R script #######

data <- read.csv("../RMS2_report_1920.csv")
[1] 1
summary(data)
[1] 2
    subject         incidents          training      feedback      empathy          years      
 Min.   :  1.00   Min.   :0.08333   Min.   :1.0   Min.   :1.0   Min.   : 3.00   Min.   : 1.00  
 1st Qu.: 50.75   1st Qu.:0.33333   1st Qu.:1.0   1st Qu.:1.0   1st Qu.: 9.00   1st Qu.: 6.00  
 Median :100.50   Median :0.41667   Median :1.5   Median :1.5   Median :10.00   Median : 8.00  
 Mean   :100.50   Mean   :0.47500   Mean   :1.5   Mean   :1.5   Mean   :10.18   Mean   : 8.13  
 3rd Qu.:150.25   3rd Qu.:0.58333   3rd Qu.:2.0   3rd Qu.:2.0   3rd Qu.:12.00   3rd Qu.:10.00  
 Max.   :200.00   Max.   :0.91667   Max.   :2.0   Max.   :2.0   Max.   :16.00   Max.   :19.00  
View(data)
[1] 3
library(psych, quietly = T)
[1] 4
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 5
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[10] "methods"   "base"     
data$incidents[data$incidents > 1] <- NA
[1] 6
data$incidents[data$incidents < 0] <- NA
[1] 7
describe(data$incidents)
[1] 8
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 200 0.48 0.19   0.42    0.47 0.12 0.08 0.92  0.83 0.32    -0.31 0.01
View(data$incidents)
[1] 9
data$training[data$training < 1] <- NA
[1] 10
data$training[data$training > 2] <- NA
[1] 11
describe(data$training)
[1] 12
   vars   n mean  sd median trimmed  mad min max range skew kurtosis   se
X1    1 200  1.5 0.5    1.5     1.5 0.74   1   2     1    0    -2.01 0.04
View(data$training)
[1] 13
data$feedback[data$feedback < 1] <- NA
[1] 14
data$feedback[data$feedback > 2] <- NA
[1] 15
describe(data$feedback)
[1] 16
   vars   n mean  sd median trimmed  mad min max range skew kurtosis   se
X1    1 200  1.5 0.5    1.5     1.5 0.74   1   2     1    0    -2.01 0.04
View(data$feedback)
[1] 17
data$empathy[data$empathy < 1] <- NA
[1] 18
data$empathy[data$empathy > 20] <- NA
[1] 19
describe(data$empathy)
[1] 20
   vars   n  mean   sd median trimmed  mad min max range  skew kurtosis   se
X1    1 200 10.18 2.54     10   10.24 2.97   3  16    13 -0.37     0.23 0.18
View(data$empathy)
[1] 21
data$years[data$years < 0] <- NA
[1] 22
data$years[data$years > 30] <- NA
[1] 23
View(data$years)
[1] 24
scaled_empathy <- scale((log(data$empathy)), center = TRUE, scale = TRUE)
[1] 25
summary(scaled_empathy)
[1] 26
       V1          
 Min.   :-4.00223  
 1st Qu.:-0.28663  
 Median : 0.06971  
 Mean   : 0.00000  
 3rd Qu.: 0.68633  
 Max.   : 1.65930  
scaled_years <- scale(data$years, center = TRUE, scale = TRUE)
[1] 27
summary(scaled_years)
[1] 28
       V1          
 Min.   :-2.31566  
 1st Qu.:-0.69177  
 Median :-0.04222  
 Mean   : 0.00000  
 3rd Qu.: 0.60733  
 Max.   : 3.53032  
scaled_incidents <- scale(data$incidents, center = TRUE, scale = TRUE)
[1] 29
summary(scaled_incidents)
[1] 30
       V1         
 Min.   :-2.0987  
 1st Qu.:-0.7591  
 Median :-0.3126  
 Mean   : 0.0000  
 3rd Qu.: 0.5805  
 Max.   : 2.3667  
m1 <- lm(data$empathy ~ data$years)
[1] 31
summary(m1)
[1] 32

Call:
lm(formula = data$empathy ~ data$years)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  8.40625    0.49085  17.126  < 2e-16 ***
data$years   0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

shapiro.test(m1$residuals)
[1] 33

	Shapiro-Wilk normality test

data:  m1$residuals
W = 0.98911, p-value = 0.1321

ncvTest(m1)
[1] 34
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.9815033, Df = 1, p = 0.32183
durbinWatsonTest(m1)
[1] 35
 lag Autocorrelation D-W Statistic p-value
   1       0.1017162      1.769879   0.104
 Alternative hypothesis: rho != 0
plot(m1)
[1] 36
m1a <- lm(data$empathy ~ log(data$years))
[1] 37
summary(m1a)
[1] 38

Call:
lm(formula = data$empathy ~ log(data$years))

Residuals:
    Min      1Q  Median      3Q     Max 
-7.4808 -1.6231 -0.0087  1.3740  5.8244 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)       5.1909     0.7642   6.792 1.26e-10 ***
log(data$years)   2.4758     0.3709   6.674 2.44e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.298 on 198 degrees of freedom
Multiple R-squared:  0.1837,	Adjusted R-squared:  0.1795 
F-statistic: 44.55 on 1 and 198 DF,  p-value: 2.436e-10

plot(m1a)
[1] 39
m2 <- lm(data$incidents ~ data$training + log(data$empathy) + 
    data$years)
[1] 40
summary(m2)
[1] 41

Call:
lm(formula = data$incidents ~ data$training + log(data$empathy) + 
    data$years)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.33181 -0.11893 -0.01532  0.09530  0.51864 

Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)        0.306173   0.093417   3.277 0.001239 ** 
data$training     -0.149732   0.023002  -6.510 6.17e-10 ***
log(data$empathy)  0.226197   0.040823   5.541 9.61e-08 ***
data$years        -0.015099   0.003917  -3.855 0.000157 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1615 on 196 degrees of freedom
Multiple R-squared:  0.2628,	Adjusted R-squared:  0.2515 
F-statistic: 23.29 on 3 and 196 DF,  p-value: 6.132e-13

shapiro.test((m2$residuals))
[1] 42

	Shapiro-Wilk normality test

data:  (m2$residuals)
W = 0.9792, p-value = 0.004582

ncvTest(m2)
[1] 43
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0381271, Df = 1, p = 0.84519
residualPlot(m2)
[1] 44
durbinWatsonTest(m2)
[1] 45
 lag Autocorrelation D-W Statistic p-value
   1      -0.1004484      2.184406   0.196
 Alternative hypothesis: rho != 0
vif(m2)
[1] 46
    data$training log(data$empathy)        data$years 
         1.014885          1.112263          1.110266 
plot(m2)
[1] 47
qqPlot(m2)
[1] 48
summary(m2)
[1] 49

Call:
lm(formula = data$incidents ~ data$training + log(data$empathy) + 
    data$years)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.33181 -0.11893 -0.01532  0.09530  0.51864 

Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)        0.306173   0.093417   3.277 0.001239 ** 
data$training     -0.149732   0.023002  -6.510 6.17e-10 ***
log(data$empathy)  0.226197   0.040823   5.541 9.61e-08 ***
data$years        -0.015099   0.003917  -3.855 0.000157 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1615 on 196 degrees of freedom
Multiple R-squared:  0.2628,	Adjusted R-squared:  0.2515 
F-statistic: 23.29 on 3 and 196 DF,  p-value: 6.132e-13

m3 <- lm(data$incidents ~ data$feedback + log(data$empathy) + 
    data$years)
[1] 50
summary(m3)
[1] 51

Call:
lm(formula = data$incidents ~ data$feedback + log(data$empathy) + 
    data$years)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.33823 -0.10208 -0.01322  0.10777  0.52785 

Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)       -0.084513   0.098905  -0.854 0.393879    
data$feedback      0.129768   0.023450   5.534 9.96e-08 ***
log(data$empathy)  0.208661   0.041685   5.006 1.24e-06 ***
data$years        -0.013690   0.004003  -3.420 0.000763 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1656 on 196 degrees of freedom
Multiple R-squared:  0.2246,	Adjusted R-squared:  0.2127 
F-statistic: 18.92 on 3 and 196 DF,  p-value: 8.062e-11

shapiro.test(m3$residuals)
[1] 52

	Shapiro-Wilk normality test

data:  m3$residuals
W = 0.98719, p-value = 0.06802

qqPlot(m3)
[1] 53
ncvTest(m3)
[1] 54
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.02899987, Df = 1, p = 0.86478
residualPlot(m3)
[1] 55
durbinWatsonTest(m3)
[1] 56
 lag Autocorrelation D-W Statistic p-value
   1       0.2695744      1.447146       0
 Alternative hypothesis: rho != 0
vif(m3)
[1] 57
    data$feedback log(data$empathy)        data$years 
         1.002818          1.102549          1.102724 
plot(m3)
[1] 58
summary(m3)
[1] 59

Call:
lm(formula = data$incidents ~ data$feedback + log(data$empathy) + 
    data$years)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.33823 -0.10208 -0.01322  0.10777  0.52785 

Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)       -0.084513   0.098905  -0.854 0.393879    
data$feedback      0.129768   0.023450   5.534 9.96e-08 ***
log(data$empathy)  0.208661   0.041685   5.006 1.24e-06 ***
data$years        -0.013690   0.004003  -3.420 0.000763 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1656 on 196 degrees of freedom
Multiple R-squared:  0.2246,	Adjusted R-squared:  0.2127 
F-statistic: 18.92 on 3 and 196 DF,  p-value: 8.062e-11

AIC(m2, m3)
[1] 60
   df       AIC
m2  5 -155.8856
m3  5 -145.7748
m5 <- lm(data$incidents ~ data$feedback + data$training + data$feedback:data$training)
[1] 61
summary(m5)
[1] 62

Call:
lm(formula = data$incidents ~ data$feedback + data$training + 
    data$feedback:data$training)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40000 -0.10500  0.00000  0.08333  0.43333 

Coefficients:
                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                  0.61000    0.11568   5.273 3.53e-07 ***
data$feedback                0.04333    0.07316   0.592  0.55433    
data$training               -0.21333    0.07316  -2.916  0.00396 ** 
data$feedback:data$training  0.05333    0.04627   1.153  0.25047    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1636 on 196 degrees of freedom
Multiple R-squared:  0.2431,	Adjusted R-squared:  0.2315 
F-statistic: 20.99 on 3 and 196 DF,  p-value: 7.827e-12

shapiro.test(m5$residuals)
[1] 63

	Shapiro-Wilk normality test

data:  m5$residuals
W = 0.9767, p-value = 0.002072

qqPlot(m5)
[1] 64
ncvTest(m5)
[1] 65
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 1.881673, Df = 1, p = 0.17014
residualPlot(m5)
[1] 66
durbinWatsonTest(m5)
[1] 67
 lag Autocorrelation D-W Statistic p-value
   1       0.1114255      1.770733   0.106
 Alternative hypothesis: rho != 0
plot(m5)
[1] 68
m5a <- lm(data$incidents ~ data$feedback + data$training + data$feedback:data$training + 
    (log(data$empathy)) + data$years)
[1] 69
summary(m5a)
[1] 70

Call:
lm(formula = data$incidents ~ data$feedback + data$training + 
    data$feedback:data$training + (log(data$empathy)) + data$years)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30743 -0.10623 -0.00903  0.09145  0.43453 

Coefficients:
                             Estimate Std. Error t value Pr(>|t|)    
(Intercept)                  0.283400   0.124447   2.277   0.0239 *  
data$feedback               -0.006504   0.065841  -0.099   0.9214    
data$training               -0.288786   0.066299  -4.356 2.15e-05 ***
log(data$empathy)            0.246719   0.037347   6.606 3.70e-10 ***
data$years                  -0.016575   0.003560  -4.656 5.97e-06 ***
data$feedback:data$training  0.091682   0.041750   2.196   0.0293 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1463 on 194 degrees of freedom
Multiple R-squared:  0.4007,	Adjusted R-squared:  0.3852 
F-statistic: 25.94 on 5 and 194 DF,  p-value: < 2.2e-16

shapiro.test(m5a$residuals)
[1] 71

	Shapiro-Wilk normality test

data:  m5a$residuals
W = 0.98745, p-value = 0.07444

qqPlot(m5a)
[1] 72
ncvTest(m5a)
[1] 73
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 4.103152, Df = 1, p = 0.042803
residualPlot(m5a)
[1] 74
durbinWatsonTest(m5a)
[1] 75
 lag Autocorrelation D-W Statistic p-value
   1      0.09641801      1.792641    0.12
 Alternative hypothesis: rho != 0
plot(m5a)
[1] 76
AIC(m5, m5a)
[1] 77
    df       AIC
m5   5 -150.6118
m5a  7 -193.2894
vif(m5a)
[1] 78
              data$feedback               data$training           log(data$empathy)                  data$years 
                  10.123662                   10.264910                    1.133333                    1.116779 
data$feedback:data$training 
                  19.335379 
summary(m5a)
[1] 79

Call:
lm(formula = data$incidents ~ data$feedback + data$training + 
    data$feedback:data$training + (log(data$empathy)) + data$years)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30743 -0.10623 -0.00903  0.09145  0.43453 

Coefficients:
                             Estimate Std. Error t value Pr(>|t|)    
(Intercept)                  0.283400   0.124447   2.277   0.0239 *  
data$feedback               -0.006504   0.065841  -0.099   0.9214    
data$training               -0.288786   0.066299  -4.356 2.15e-05 ***
log(data$empathy)            0.246719   0.037347   6.606 3.70e-10 ***
data$years                  -0.016575   0.003560  -4.656 5.97e-06 ***
data$feedback:data$training  0.091682   0.041750   2.196   0.0293 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1463 on 194 degrees of freedom
Multiple R-squared:  0.4007,	Adjusted R-squared:  0.3852 
F-statistic: 25.94 on 5 and 194 DF,  p-value: < 2.2e-16

