

	####### B109942 R script #######

install.packages("psych")
[1] 1
library(psych, quietly = T)
[1] 2
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
install.packages("car")
[1] 3
library(car, quietly = T)
[1] 4
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[10] "methods"   "base"     
install.packages("ez")
[1] 5
library(ez, quietly = T)
[1] 6
 [1] "ez"        "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"    
[10] "datasets"  "methods"   "base"     
install.packages("tidyr")
[1] 7
library(tidyr, quietly = T)
[1] 8
 [1] "tidyr"     "ez"        "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices"
[10] "utils"     "datasets"  "methods"   "base"     
install.packages("ggplot2")
[1] 9
library(ggplot2, quietly = T)
[1] 10
 [1] "ggplot2"   "tidyr"     "ez"        "car"       "carData"   "psych"     "readr"     "stats"     "graphics" 
[10] "grDevices" "utils"     "datasets"  "methods"   "base"     
install.packages("lme4")
[1] 11
library(lme4, quietly = T)
[1] 12
 [1] "lme4"      "Matrix"    "ggplot2"   "tidyr"     "ez"        "car"       "carData"   "psych"     "readr"    
[10] "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
data <- read.csv("../RMS2_report_1920.csv")
[1] 13
describe(data)
[1] 14
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training     3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
sapply(data, class)
[1] 15
  subject incidents  training  feedback   empathy     years 
"integer" "numeric" "integer" "integer" "integer" "integer" 
data$incidents[data$incidents > 1] <- NA
[1] 16
data$training[data$training > 2] <- NA
[1] 17
data$feedback[data$feedback > 2] <- NA
[1] 18
data$empathy[data$empathy > 20] <- NA
[1] 19
data$years[data$years > 30] <- NA
[1] 20
data$training <- as.factor(data$training)
[1] 21
data$feedback <- as.factor(data$feedback)
[1] 22
sapply(data, class)
[1] 23
  subject incidents  training  feedback   empathy     years 
"integer" "numeric"  "factor"  "factor" "integer" "integer" 
empathymean <- data$empathy - mean(data$empathy)
[1] 24
yearsmean <- data$years - mean(data$years)
[1] 25
lm <- lm(empathymean ~ yearsmean, data = data)
[1] 26
summary(lm)
[1] 27

Call:
lm(formula = empathymean ~ yearsmean, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept) -6.013e-16  1.735e-01   0.000 1.000000    
yearsmean    2.176e-01  5.648e-02   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

qqPlot(lm)
[1] 28
hist(lm$residuals)
[1] 29
shapiro.test(lm$residuals)
[1] 30

	Shapiro-Wilk normality test

data:  lm$residuals
W = 0.98911, p-value = 0.1321

residualPlots(lm)
[1] 31
ncvTest(lm)
[1] 32
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.9815033, Df = 1, p = 0.32183
crPlots(lm)
[1] 33
durbinWatsonTest(lm)
[1] 34
 lag Autocorrelation D-W Statistic p-value
   1       0.1017162      1.769879   0.092
 Alternative hypothesis: rho != 0
cooks <- cooks.distance(lm)
[1] 35
which(cooks > (4/(200 - 2 - 1)))
[1] 36
 16  61  88  89  94 108 137 141 154 163 171 175 192 200 
 16  61  88  89  94 108 137 141 154 163 171 175 192 200 
names(which(cooks > (4/200 - 2 - 1)))
[1] 37
 [1] "1"  "2"  "3"  "4"  "5"  "6"  "7"  "8"  "9"  "10" "11" "12" "13" "14" "15" "16" "17" "18" "19" "20" "21" "22"
[23] "23" "24" "25" "26" "27" "28" "29" "30" "31" "32" "33" "34" "35" "36" "37" "38" "39" "40" "41" "42" "43" "44"
[45] "45" "46" "47" "48" "49" "50"
 [ reached getOption("max.print") -- omitted 150 entries ]
plot(lm, which = 4)
[1] 38
lm2 <- lm(empathymean ~ yearsmean + I(years^2), data = data)
[1] 39
qqPlot(lm2)
[1] 40
shapiro.test(lm2$residuals)
[1] 41

	Shapiro-Wilk normality test

data:  lm2$residuals
W = 0.9941, p-value = 0.6155

residualPlot(lm2)
[1] 42
crPlots(lm2, xlab = "Years")
[1] 43
durbinWatsonTest(lm2)
[1] 44
 lag Autocorrelation D-W Statistic p-value
   1      0.01288905      1.973855    0.85
 Alternative hypothesis: rho != 0
cooks <- cooks.distance(lm2)
[1] 45
which(cooks > (4/(200 - 2 - 1)))
[1] 46
 61  89 137 141 154 163 165 175 
 61  89 137 141 154 163 165 175 
names(which(cooks > (4/200 - 2 - 1)))
[1] 47
 [1] "1"  "2"  "3"  "4"  "5"  "6"  "7"  "8"  "9"  "10" "11" "12" "13" "14" "15" "16" "17" "18" "19" "20" "21" "22"
[23] "23" "24" "25" "26" "27" "28" "29" "30" "31" "32" "33" "34" "35" "36" "37" "38" "39" "40" "41" "42" "43" "44"
[45] "45" "46" "47" "48" "49" "50"
 [ reached getOption("max.print") -- omitted 150 entries ]
plot(lm2, which = 4)
[1] 48
lm3 <- lm(data$incidents ~ data$training + data$empathy + data$years, 
    data = data)
[1] 49
summary(lm3)
[1] 50

Call:
lm(formula = data$incidents ~ data$training + data$empathy + 
    data$years, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.407320   0.051814   7.861 2.48e-13 ***
data$training2 -0.152427   0.023166  -6.580 4.20e-10 ***
data$empathy    0.025396   0.004735   5.363 2.29e-07 ***
data$years     -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

qqPlot(lm3)
[1] 51
shapiro.test((lm3$residuals))
[1] 52

	Shapiro-Wilk normality test

data:  (lm3$residuals)
W = 0.97994, p-value = 0.005838

residualPlot(lm3)
[1] 53
crPlots(lm3)
[1] 54
durbinWatsonTest(lm3)
[1] 55
 lag Autocorrelation D-W Statistic p-value
   1      -0.1072849      2.199897   0.164
 Alternative hypothesis: rho != 0
vif(lm3)
[1] 56
data$training  data$empathy    data$years 
     1.020633      1.092467      1.085089 
cooks <- cooks.distance(lm2)
[1] 57
which(cooks > (4/(200 - 4 - 1)))
[1] 58
 61  89 137 141 154 163 165 175 
 61  89 137 141 154 163 165 175 
names(which(cooks > (4/200 - 4 - 1)))
[1] 59
 [1] "1"  "2"  "3"  "4"  "5"  "6"  "7"  "8"  "9"  "10" "11" "12" "13" "14" "15" "16" "17" "18" "19" "20" "21" "22"
[23] "23" "24" "25" "26" "27" "28" "29" "30" "31" "32" "33" "34" "35" "36" "37" "38" "39" "40" "41" "42" "43" "44"
[45] "45" "46" "47" "48" "49" "50"
 [ reached getOption("max.print") -- omitted 150 entries ]
plot(lm3, which = 4)
[1] 60
lm4 <- lm(data$incidents ~ data$feedback + data$empathy + data$years, 
    data = data)
[1] 61
summary(lm4)
[1] 62

Call:
lm(formula = data$incidents ~ data$feedback + data$empathy + 
    data$years, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.276161   0.054108   5.104 7.84e-07 ***
data$feedback2  0.132132   0.023585   5.602 7.09e-08 ***
data$empathy    0.023187   0.004829   4.802 3.11e-06 ***
data$years     -0.012689   0.003975  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

qqPlot(lm4)
[1] 63
shapiro.test(lm4$residuals)
[1] 64

	Shapiro-Wilk normality test

data:  lm4$residuals
W = 0.98772, p-value = 0.08174

residualPlot(lm4)
[1] 65
crPlots(lm4)
[1] 66
durbinWatsonTest(lm4)
[1] 67
 lag Autocorrelation D-W Statistic p-value
   1       0.2738264      1.444081       0
 Alternative hypothesis: rho != 0
vif(lm4)
[1] 68
data$feedback  data$empathy    data$years 
     1.005211      1.079397      1.077467 
cooks <- cooks.distance(lm4)
[1] 69
which(cooks > (4/(200 - 4 - 1)))
[1] 70
 73  74  89 137 156 160 165 176 
 73  74  89 137 156 160 165 176 
names(which(cooks > (4/200 - 4 - 1)))
[1] 71
 [1] "1"  "2"  "3"  "4"  "5"  "6"  "7"  "8"  "9"  "10" "11" "12" "13" "14" "15" "16" "17" "18" "19" "20" "21" "22"
[23] "23" "24" "25" "26" "27" "28" "29" "30" "31" "32" "33" "34" "35" "36" "37" "38" "39" "40" "41" "42" "43" "44"
[45] "45" "46" "47" "48" "49" "50"
 [ reached getOption("max.print") -- omitted 150 entries ]
plot(lm4, which = 4)
[1] 72
AIC(lm3, lm4)
[1] 73
    df       AIC
lm3  5 -154.1654
lm4  5 -143.9591
BIC(lm3, lm4)
[1] 74
    df       BIC
lm3  5 -137.6738
lm4  5 -127.4675
lm5 <- lm(data$incidents ~ data$empathy + data$years + data$training * 
    data$feedback)
[1] 75
summary(lm5)
[1] 76

Call:
lm(formula = data$incidents ~ data$empathy + data$years + data$training * 
    data$feedback)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30367 -0.10365 -0.00795  0.08806  0.44359 

Coefficients:
                               Estimate Std. Error t value Pr(>|t|)    
(Intercept)                    0.345467   0.048515   7.121 2.04e-11 ***
data$empathy                   0.028695   0.004328   6.630 3.25e-10 ***
data$years                    -0.015720   0.003518  -4.468 1.34e-05 ***
data$training2                -0.203496   0.029874  -6.812 1.18e-10 ***
data$feedback2                 0.085558   0.029299   2.920  0.00391 ** 
data$training2:data$feedback2  0.097334   0.041840   2.326  0.02103 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1462 on 194 degrees of freedom
Multiple R-squared:  0.4015,	Adjusted R-squared:  0.386 
F-statistic: 26.02 on 5 and 194 DF,  p-value: < 2.2e-16

qqPlot(lm5)
[1] 77
shapiro.test(lm5$residuals)
[1] 78

	Shapiro-Wilk normality test

data:  lm5$residuals
W = 0.98794, p-value = 0.08817

residualPlot(lm5)
[1] 79
durbinWatsonTest(lm5)
[1] 80
 lag Autocorrelation D-W Statistic p-value
   1      0.09456969      1.801048   0.182
 Alternative hypothesis: rho != 0
vif(lm5)
[1] 81
               data$empathy                  data$years               data$training               data$feedback 
                   1.122147                    1.092150                    2.086826                    2.007327 
data$training:data$feedback 
                   3.070068 
cooks <- cooks.distance(lm5)
[1] 82
which(cooks > (4/(200 - 5 - 1)))
[1] 83
 13  73  74  89 117 137 160 165 176 
 13  73  74  89 117 137 160 165 176 
names(which(cooks > (4/(200 - 5 - 1))))
[1] 84
[1] "13"  "73"  "74"  "89"  "117" "137" "160" "165" "176"
plot(lm5, which = 4)
[1] 85
