

	####### B122518 R script #######

library(psych, quietly = T)
[1] 1
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(ggplot2, quietly = T)
[1] 2
 [1] "ggplot2"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 3
 [1] "car"       "carData"   "ggplot2"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[11] "methods"   "base"     
library(interactions, quietly = T)
[1] 4
 [1] "interactions" "car"          "carData"      "ggplot2"      "psych"        "readr"        "stats"        "graphics"    
 [9] "grDevices"    "utils"        "datasets"     "methods"      "base"        
library(jtools, quietly = T)
[1] 5
 [1] "jtools"       "interactions" "car"          "carData"      "ggplot2"      "psych"        "readr"        "stats"       
 [9] "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
read.csv("~/Desktop/rms2/code_check/RMS2_report_1920.csv")
[1] 6
  subject incidents training feedback empathy years
1       1 0.6666667        2        2      11    10
2       2 0.3333333        2        1      10     7
3       3 0.3333333        2        2      10     5
4       4 0.4166667        2        1       9     7
5       5 0.5000000        2        2      12    12
6       6 0.2500000        2        1      11    10
7       7 0.8333333        2        2      13     8
8       8 0.4166667        2        1      14    10
 [ reached 'max' / getOption("max.print") -- omitted 192 rows ]
Data <- read.csv("~/Desktop/rms2/code_check/RMS2_report_1920.csv")
[1] 7
describe(Data)
[1] 8
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training     3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
str(Data)
[1] 9
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : int  2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : int  2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
Center_empathy <- scale(Data$empathy, scale = FALSE)
[1] 10
Center_years <- scale(Data$years, scale = FALSE)
[1] 11
Data$training <- as.factor(Data$training)
[1] 12
Data$feedback <- as.factor(Data$feedback)
[1] 13
M1 <- lm(Center_empathy ~ Center_years, data = Data)
[1] 14
summary(M1)
[1] 15

Call:
lm(formula = Center_empathy ~ Center_years, data = Data)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)  -6.013e-16  1.735e-01   0.000 1.000000    
Center_years  2.176e-01  5.648e-02   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

plot(Data$empathy, Data$years, main = "Scatterplot of empathy score and years of experience", 
    ylab = "Empathy score", xlab = "Years of experience")
[1] 16
abline(M1, col = "green")
[1] 17
lines(lowess(Data$empathy, Data$years))
[1] 18
standardised_M1 <- MASS::studres(M1)
[1] 19
which(abs(standardised_M1) > 2)
[1] 20
 61  68  70  88  89 137 141 142 154 175 200 
 61  68  70  88  89 137 141 142 154 175 200 
hats_M1 <- hatvalues(M1)
[1] 21
which(hats_M1 > 2 * mean(hats_M1))
[1] 22
 61  88  89  92  94 108 109 116 131 137 140 141 154 155 163 190 200 
 61  88  89  92  94 108 109 116 131 137 140 141 154 155 163 190 200 
cd_M1 <- cooks.distance(M1)
[1] 23
which(cd_M1 > 0.02)
[1] 24
 16  61  88  89  94 108 137 141 154 163 171 175 192 200 
 16  61  88  89  94 108 137 141 154 163 171 175 192 200 
Data1 <- Data[-c(61, 88, 89, 137, 154, 200), ]
[1] 25
summary(lm(Center_empathy ~ Center_years, data = Data1))
[1] 26

Call:
lm(formula = Center_empathy ~ Center_years, data = Data1)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)  -6.013e-16  1.735e-01   0.000 1.000000    
Center_years  2.176e-01  5.648e-02   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

hist(M1$residuals)
[1] 27
qqPlot(M1)
[1] 28
shapiro.test(M1$residuals)
[1] 29

	Shapiro-Wilk normality test

data:  M1$residuals
W = 0.98911, p-value = 0.1321

residualPlots(M1)
[1] 30
crPlots(M1)
[1] 31
M2 <- lm(Center_empathy ~ Center_years + I(Center_years^2), data = Data)
[1] 32
crPlots(M2)
[1] 33
ncvTest(M2)
[1] 34
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.5107658, Df = 1, p = 0.47481
summary(M2)
[1] 35

Call:
lm(formula = Center_empathy ~ Center_years + I(Center_years^2), 
    data = Data)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)        0.977696   0.167423   5.840 2.13e-08 ***
Center_years       0.383236   0.047986   7.986 1.13e-13 ***
I(Center_years^2) -0.103645   0.009861 -10.510  < 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

M3 <- lm(Data$incidents ~ training + Center_empathy + Center_years, 
    data = Data)
[1] 36
summary(M3)
[1] 37

Call:
lm(formula = Data$incidents ~ training + Center_empathy + Center_years, 
    data = Data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.551213   0.016298  33.821  < 2e-16 ***
training2      -0.152427   0.023166  -6.580 4.20e-10 ***
Center_empathy  0.025396   0.004735   5.363 2.29e-07 ***
Center_years   -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

standardised_M3 <- MASS::studres(M3)
[1] 38
which(abs(standardised_M3) > 2)
[1] 39
  7  13  35  74 159 165 176 181 
  7  13  35  74 159 165 176 181 
hats_M3 <- hatvalues(M3)
[1] 40
which(hats_M3 > 2 * mean(hats_M3))
[1] 41
 61  88  89  92  94 137 141 154 163 175 200 
 61  88  89  92  94 137 141 154 163 175 200 
cd_M3 <- cooks.distance(M3)
[1] 42
which(cd_M3 > 0.02)
[1] 43
 13  35  74  77 137 165 
 13  35  74  77 137 165 
hist(M3$residuals)
[1] 44
qqPlot(M3)
[1] 45
residualPlots(M3)
[1] 46
ncvTest(M3)
[1] 47
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0293323, Df = 1, p = 0.86401
crPlots(M3)
[1] 48
durbinWatsonTest(M3)
[1] 49
 lag Autocorrelation D-W Statistic p-value
   1      -0.1072849      2.199897   0.166
 Alternative hypothesis: rho != 0
vif(M3)
[1] 50
      training Center_empathy   Center_years 
      1.020633       1.092467       1.085089 
M4 <- lm(incidents ~ feedback + training + Center_empathy + Center_years, 
    data = Data)
[1] 51
summary(M4)
[1] 52

Call:
lm(formula = incidents ~ feedback + training + Center_empathy + 
    Center_years, data = Data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.31626 -0.10096 -0.00949  0.09165  0.46650 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.485055   0.018126  26.760  < 2e-16 ***
feedback2       0.133715   0.020968   6.377 1.28e-09 ***
training2      -0.153824   0.021128  -7.281 7.98e-12 ***
Center_empathy  0.027191   0.004328   6.283 2.12e-09 ***
Center_years   -0.015199   0.003551  -4.281 2.92e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1479 on 195 degrees of freedom
Multiple R-squared:  0.3848,	Adjusted R-squared:  0.3721 
F-statistic: 30.49 on 4 and 195 DF,  p-value: < 2.2e-16

standardised_M4 <- MASS::studres(M4)
[1] 53
which(abs(standardised_M4) > 2)
[1] 54
 13  74 101 117 150 156 159 160 176 181 
 13  74 101 117 150 156 159 160 176 181 
hats_M4 <- hatvalues(M4)
[1] 55
which(hats_M4 > 2 * mean(hats_M4))
[1] 56
 61  88  89  92 137 141 154 175 200 
 61  88  89  92 137 141 154 175 200 
cd_M4 <- cooks.distance(M4)
[1] 57
which(cd_M4 > 0.02)
[1] 58
 13  35  73  74 117 131 137 141 156 160 176 
 13  35  73  74 117 131 137 141 156 160 176 
hist(M4$residuals)
[1] 59
qqPlot(M4)
[1] 60
residualPlots(M4)
[1] 61
ncvTest(M4)
[1] 62
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 3.684027, Df = 1, p = 0.054936
crPlots(M4)
[1] 63
durbinWatsonTest(M4)
[1] 64
 lag Autocorrelation D-W Statistic p-value
   1      0.07303546      1.841386   0.232
 Alternative hypothesis: rho != 0
vif(M4)
[1] 65
      feedback       training Center_empathy   Center_years 
      1.005320       1.020743       1.097109       1.087722 
AIC(M3, M4)
[1] 66
   df       AIC
M3  5 -154.1654
M4  6 -190.0499
BIC(M3, M4)
[1] 67
   df       BIC
M3  5 -137.6738
M4  6 -170.2600
M5 <- lm(incidents ~ training + feedback + training:feedback, 
    data = Data)
[1] 68
summary(M5)
[1] 69

Call:
lm(formula = incidents ~ training + feedback + training:feedback, 
    data = Data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40000 -0.10500  0.00000  0.08333  0.43333 

Coefficients:
                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)          0.49333    0.02314  21.323  < 2e-16 ***
training2           -0.16000    0.03272  -4.890 2.09e-06 ***
feedback2            0.09667    0.03272   2.954  0.00352 ** 
training2:feedback2  0.05333    0.04627   1.153  0.25047    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1636 on 196 degrees of freedom
Multiple R-squared:  0.2431,	Adjusted R-squared:  0.2315 
F-statistic: 20.99 on 3 and 196 DF,  p-value: 7.827e-12

standardised_M5 <- MASS::studres(M5)
[1] 70
which(abs(standardised_M5) > 2)
[1] 71
  7  13  89 131 150 159 160 165 176 181 
  7  13  89 131 150 159 160 165 176 181 
hats_M5 <- hatvalues(M5)
[1] 72
which(hats_M5 > 2 * mean(hats_M5))
[1] 73
named integer(0)
cd_M5 <- cooks.distance(M5)
[1] 74
which(cd_M5 > 0.02)
[1] 75
  7  13  89 131 150 159 160 165 176 181 
  7  13  89 131 150 159 160 165 176 181 
hist(M5$residuals)
[1] 76
ncvTest(M5)
[1] 77
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 1.881673, Df = 1, p = 0.17014
durbinWatsonTest(M5)
[1] 78
 lag Autocorrelation D-W Statistic p-value
   1       0.1114255      1.770733    0.11
 Alternative hypothesis: rho != 0
vif(M5)
[1] 79
         training          feedback training:feedback 
                2                 2                 3 
cat_plot(M5, pred = training, modx = feedback, x.label = "Training", 
    y.label = "Incidents Intervention (%)", legend.main = "Feedback", 
    geom = "line")
[1] 80
