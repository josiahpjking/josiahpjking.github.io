

	####### B121522 R script #######

setwd("/Users/sarahrockowitz/Desktop/data")
[1] 1
data <- read.csv("../RMS2_report_1920.csv")
[1] 2
install.packages("psych")
[1] 3
library(psych, quietly = T)
[1] 4
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
install.packages("car")
[1] 5
library(car, quietly = T)
[1] 6
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[10] "methods"   "base"     
install.packages("jtools")
[1] 7
library(jtools, quietly = T)
[1] 8
 [1] "jtools"    "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"    
[10] "datasets"  "methods"   "base"     
install.packages("interactions")
[1] 9
library(interactions, quietly = T)
[1] 10
 [1] "interactions" "jtools"       "car"          "carData"      "psych"        "readr"        "stats"       
 [8] "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
install.packages("ggpubr")
[1] 11
library(ggpubr, quietly = T)
[1] 12
 [1] "ggpubr"       "magrittr"     "ggplot2"      "interactions" "jtools"       "car"          "carData"     
 [8] "psych"        "readr"        "stats"        "graphics"     "grDevices"    "utils"        "datasets"    
[15] "methods"      "base"        
install.packages("lsr")
[1] 13
library(lsr, quietly = T)
[1] 14
 [1] "lsr"          "ggpubr"       "magrittr"     "ggplot2"      "interactions" "jtools"       "car"         
 [8] "carData"      "psych"        "readr"        "stats"        "graphics"     "grDevices"    "utils"       
[15] "datasets"     "methods"      "base"        
install.packages("emmeans")
[1] 15
library(emmeans, quietly = T)
[1] 16
 [1] "emmeans"      "lsr"          "ggpubr"       "magrittr"     "ggplot2"      "interactions" "jtools"      
 [8] "car"          "carData"      "psych"        "readr"        "stats"        "graphics"     "grDevices"   
[15] "utils"        "datasets"     "methods"      "base"        
install.packages("effects")
[1] 17
library(effects, quietly = T)
[1] 18
 [1] "effects"      "emmeans"      "lsr"          "ggpubr"       "magrittr"     "ggplot2"      "interactions"
 [8] "jtools"       "car"          "carData"      "psych"        "readr"        "stats"        "graphics"    
[15] "grDevices"    "utils"        "datasets"     "methods"      "base"        
summary(data)
[1] 19
    subject         incidents          training      feedback      empathy          years      
 Min.   :  1.00   Min.   :0.08333   Min.   :1.0   Min.   :1.0   Min.   : 3.00   Min.   : 1.00  
 1st Qu.: 50.75   1st Qu.:0.33333   1st Qu.:1.0   1st Qu.:1.0   1st Qu.: 9.00   1st Qu.: 6.00  
 Median :100.50   Median :0.41667   Median :1.5   Median :1.5   Median :10.00   Median : 8.00  
 Mean   :100.50   Mean   :0.47500   Mean   :1.5   Mean   :1.5   Mean   :10.18   Mean   : 8.13  
 3rd Qu.:150.25   3rd Qu.:0.58333   3rd Qu.:2.0   3rd Qu.:2.0   3rd Qu.:12.00   3rd Qu.:10.00  
 Max.   :200.00   Max.   :0.91667   Max.   :2.0   Max.   :2.0   Max.   :16.00   Max.   :19.00  
str(data)
[1] 20
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : int  2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : int  2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
class(data$incidents)
[1] 21
[1] "numeric"
class(data$training)
[1] 22
[1] "integer"
class(data$feedback)
[1] 23
[1] "integer"
class(data$empathy)
[1] 24
[1] "integer"
class(data$years)
[1] 25
[1] "integer"
data$training <- as.factor(data$training)
[1] 26
data$feedback <- as.factor(data$feedback)
[1] 27
str(data)
[1] 28
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : Factor w/ 2 levels "1","2": 2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : Factor w/ 2 levels "1","2": 2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
describe(data$empathy)
[1] 29
   vars   n  mean   sd median trimmed  mad min max range  skew kurtosis   se
X1    1 200 10.18 2.54     10   10.24 2.97   3  16    13 -0.37     0.23 0.18
describe(data$years)
[1] 30
   vars   n mean   sd median trimmed  mad min max range skew kurtosis   se
X1    1 200 8.13 3.08      8    7.97 2.97   1  19    18 0.52     0.48 0.22
m1 <- lm(data$empathy ~ data$years)
[1] 31
summary(m1)
[1] 32

Call:
lm(formula = data$empathy ~ data$years)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  8.40625    0.49085  17.126  < 2e-16 ***
data$years   0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

cooks1 <- cooks.distance(m1)
[1] 33
names(which(cooks1 > (4/200 - 1 - 1)))
[1] 34
 [1] "1"  "2"  "3"  "4"  "5"  "6"  "7"  "8"  "9"  "10" "11" "12" "13" "14" "15" "16" "17" "18" "19" "20" "21" "22"
[23] "23" "24" "25" "26" "27" "28" "29" "30" "31" "32" "33" "34" "35" "36" "37" "38" "39" "40" "41" "42" "43" "44"
[45] "45" "46" "47" "48" "49" "50"
 [ reached getOption("max.print") -- omitted 150 entries ]
plot(m1, which = 4)
[1] 35
m1a <- lm(empathy ~ years, data = data[-c(88, 137, 154)])
[1] 36
summary(m1a)
[1] 37

Call:
lm(formula = empathy ~ years, data = data[-c(88, 137, 154)])

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  8.40625    0.49085  17.126  < 2e-16 ***
years        0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

crPlots(m1)
[1] 38
qqPlot(m1)
[1] 39
hist(m1$residuals, main = "Histogram of Normality")
[1] 40
shapiro.test(m1$residuals)
[1] 41

	Shapiro-Wilk normality test

data:  m1$residuals
W = 0.98911, p-value = 0.1321

residualPlots(m1)
[1] 42
ncvTest(m1)
[1] 43
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.9815033, Df = 1, p = 0.32183
durbinWatsonTest(m1)
[1] 44
 lag Autocorrelation D-W Statistic p-value
   1       0.1017162      1.769879   0.106
 Alternative hypothesis: rho != 0
shapiro.test(data$empathy)
[1] 45

	Shapiro-Wilk normality test

data:  data$empathy
W = 0.97073, p-value = 0.0003477

shapiro.test(data$years)
[1] 46

	Shapiro-Wilk normality test

data:  data$years
W = 0.97276, p-value = 0.0006279

hist(data$empathy)
[1] 47
hist(data$years)
[1] 48
cor.test(data$empathy, data$years, method = "spearman")
[1] 49

	Spearman's rank correlation rho

data:  data$empathy and data$years
S = 923838, p-value = 9.723e-06
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.3071045 

contrasts(data$training)
[1] 50
  2
1 0
2 1
m2 <- lm(data$incidents ~ data$training + data$empathy + data$years)
[1] 51
summary(m2)
[1] 52

Call:
lm(formula = data$incidents ~ data$training + data$empathy + 
    data$years)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.407320   0.051814   7.861 2.48e-13 ***
data$training2 -0.152427   0.023166  -6.580 4.20e-10 ***
data$empathy    0.025396   0.004735   5.363 2.29e-07 ***
data$years     -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

cooks <- cooks.distance(m2)
[1] 53
names(which(cooks > (4/200 - 3 - 1)))
[1] 54
 [1] "1"  "2"  "3"  "4"  "5"  "6"  "7"  "8"  "9"  "10" "11" "12" "13" "14" "15" "16" "17" "18" "19" "20" "21" "22"
[23] "23" "24" "25" "26" "27" "28" "29" "30" "31" "32" "33" "34" "35" "36" "37" "38" "39" "40" "41" "42" "43" "44"
[45] "45" "46" "47" "48" "49" "50"
 [ reached getOption("max.print") -- omitted 150 entries ]
plot(m2, which = 4)
[1] 55
m2a <- lm(incidents ~ training + empathy + years, data = data[-c(13, 
    74, 137)])
[1] 56
summary(m2a)
[1] 57

Call:
lm(formula = incidents ~ training + empathy + years, data = data[-c(13, 
    74, 137)])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.407320   0.051814   7.861 2.48e-13 ***
training2   -0.152427   0.023166  -6.580 4.20e-10 ***
empathy      0.025396   0.004735   5.363 2.29e-07 ***
years       -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

qqPlot(m2)
[1] 58
hist(m2$residuals, main = "Histogram of Normality")
[1] 59
shapiro.test(m2$residuals)
[1] 60

	Shapiro-Wilk normality test

data:  m2$residuals
W = 0.97994, p-value = 0.005838

residualPlots(m2)
[1] 61
ncvTest(m2)
[1] 62
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0293323, Df = 1, p = 0.86401
crPlots(m2)
[1] 63
durbinWatsonTest(m2)
[1] 64
 lag Autocorrelation D-W Statistic p-value
   1      -0.1072849      2.199897   0.166
 Alternative hypothesis: rho != 0
vif(m2)
[1] 65
data$training  data$empathy    data$years 
     1.020633      1.092467      1.085089 
data$logincidents <- log(data$incidents + 1)
[1] 66
m2a1 <- lm(data$logincidents ~ data$training + data$empathy + 
    data$years)
[1] 67
summary(m2a1)
[1] 68

Call:
lm(formula = data$logincidents ~ data$training + data$empathy + 
    data$years)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.25974 -0.08206 -0.00301  0.07026  0.33183 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.334118   0.034793   9.603  < 2e-16 ***
data$training2 -0.104810   0.015556  -6.737 1.75e-10 ***
data$empathy    0.017470   0.003180   5.494 1.21e-07 ***
data$years     -0.009683   0.002611  -3.708 0.000272 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1089 on 196 degrees of freedom
Multiple R-squared:  0.2657,	Adjusted R-squared:  0.2544 
F-statistic: 23.63 on 3 and 196 DF,  p-value: 4.229e-13

residualPlots(m2a1)
[1] 69
ncvTest(m2a1)
[1] 70
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.8932792, Df = 1, p = 0.34459
crPlots(m2a1)
[1] 71
durbinWatsonTest(m2a1)
[1] 72
 lag Autocorrelation D-W Statistic p-value
   1      -0.1160146      2.216759   0.146
 Alternative hypothesis: rho != 0
qqPlot(m2a1)
[1] 73
hist(m2a1$residuals, main = "Histogram of Normality")
[1] 74
shapiro.test(m2a1$residuals)
[1] 75

	Shapiro-Wilk normality test

data:  m2a1$residuals
W = 0.9901, p-value = 0.1845

vif(m2a1)
[1] 76
data$training  data$empathy    data$years 
     1.020633      1.092467      1.085089 
m3 <- lm(data$incidents ~ data$feedback + data$empathy + data$years)
[1] 77
summary(m3)
[1] 78

Call:
lm(formula = data$incidents ~ data$feedback + data$empathy + 
    data$years)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.276161   0.054108   5.104 7.84e-07 ***
data$feedback2  0.132132   0.023585   5.602 7.09e-08 ***
data$empathy    0.023187   0.004829   4.802 3.11e-06 ***
data$years     -0.012689   0.003975  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

contrasts(data$feedback)
[1] 79
  2
1 0
2 1
cooks2 <- cooks.distance(m3)
[1] 80
names(which(cooks2 > (4/200 - 4 - 1)))
[1] 81
 [1] "1"  "2"  "3"  "4"  "5"  "6"  "7"  "8"  "9"  "10" "11" "12" "13" "14" "15" "16" "17" "18" "19" "20" "21" "22"
[23] "23" "24" "25" "26" "27" "28" "29" "30" "31" "32" "33" "34" "35" "36" "37" "38" "39" "40" "41" "42" "43" "44"
[45] "45" "46" "47" "48" "49" "50"
 [ reached getOption("max.print") -- omitted 150 entries ]
plot(m3, which = 4)
[1] 82
m3a <- lm(incidents ~ feedback + empathy + years, data = data[-c(13, 
    134, 176)])
[1] 83
summary(m3a)
[1] 84

Call:
lm(formula = incidents ~ feedback + empathy + years, data = data[-c(13, 
    134, 176)])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.276161   0.054108   5.104 7.84e-07 ***
feedback2    0.132132   0.023585   5.602 7.09e-08 ***
empathy      0.023187   0.004829   4.802 3.11e-06 ***
years       -0.012689   0.003975  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

qqPlot(m3)
[1] 85
hist(m3$residuals)
[1] 86
shapiro.test(m3$residuals)
[1] 87

	Shapiro-Wilk normality test

data:  m3$residuals
W = 0.98772, p-value = 0.08174

residualPlots(m3)
[1] 88
ncvTest(m3)
[1] 89
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.01731234, Df = 1, p = 0.89532
crPlots(m3)
[1] 90
durbinWatsonTest(m3)
[1] 91
 lag Autocorrelation D-W Statistic p-value
   1       0.2738264      1.444081       0
 Alternative hypothesis: rho != 0
vif(m3)
[1] 92
data$feedback  data$empathy    data$years 
     1.005211      1.079397      1.077467 
m3a1 <- lm(data$incidents ~ data$feedback + data$empathy + data$years + 
    data$training)
[1] 93
summary(m3a1)
[1] 94

Call:
lm(formula = data$incidents ~ data$feedback + data$empathy + 
    data$years + data$training)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.31626 -0.10096 -0.00949  0.09165  0.46650 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.331953   0.048708   6.815 1.15e-10 ***
data$feedback2  0.133715   0.020968   6.377 1.28e-09 ***
data$empathy    0.027191   0.004328   6.283 2.12e-09 ***
data$years     -0.015199   0.003551  -4.281 2.92e-05 ***
data$training2 -0.153824   0.021128  -7.281 7.98e-12 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1479 on 195 degrees of freedom
Multiple R-squared:  0.3848,	Adjusted R-squared:  0.3721 
F-statistic: 30.49 on 4 and 195 DF,  p-value: < 2.2e-16

qqPlot(m3a1)
[1] 95
hist(m3a1$residuals)
[1] 96
shapiro.test(m3a1$residuals)
[1] 97

	Shapiro-Wilk normality test

data:  m3a1$residuals
W = 0.98734, p-value = 0.07172

residualPlots(m3a1)
[1] 98
ncvTest(m3a1)
[1] 99
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 3.684027, Df = 1, p = 0.054936
crPlots(m3a1)
[1] 100
durbinWatsonTest(m3a1)
[1] 101
 lag Autocorrelation D-W Statistic p-value
   1      0.07303546      1.841386   0.286
 Alternative hypothesis: rho != 0
summary(m3a1)
[1] 102

Call:
lm(formula = data$incidents ~ data$feedback + data$empathy + 
    data$years + data$training)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.31626 -0.10096 -0.00949  0.09165  0.46650 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.331953   0.048708   6.815 1.15e-10 ***
data$feedback2  0.133715   0.020968   6.377 1.28e-09 ***
data$empathy    0.027191   0.004328   6.283 2.12e-09 ***
data$years     -0.015199   0.003551  -4.281 2.92e-05 ***
data$training2 -0.153824   0.021128  -7.281 7.98e-12 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1479 on 195 degrees of freedom
Multiple R-squared:  0.3848,	Adjusted R-squared:  0.3721 
F-statistic: 30.49 on 4 and 195 DF,  p-value: < 2.2e-16

AIC(m2a1, m3)
[1] 103
     df       AIC
m2a1  5 -313.4627
m3    5 -143.9591
BIC(m2a1, m3)
[1] 104
     df       BIC
m2a1  5 -296.9711
m3    5 -127.4675
m4 <- lm(incidents ~ empathy + years + training * feedback, data = data)
[1] 105
summary(m4)
[1] 106

Call:
lm(formula = incidents ~ empathy + years + training * feedback, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30367 -0.10365 -0.00795  0.08806  0.44359 

Coefficients:
                     Estimate Std. Error t value Pr(>|t|)    
(Intercept)          0.345467   0.048515   7.121 2.04e-11 ***
empathy              0.028695   0.004328   6.630 3.25e-10 ***
years               -0.015720   0.003518  -4.468 1.34e-05 ***
training2           -0.203496   0.029874  -6.812 1.18e-10 ***
feedback2            0.085558   0.029299   2.920  0.00391 ** 
training2:feedback2  0.097334   0.041840   2.326  0.02103 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1462 on 194 degrees of freedom
Multiple R-squared:  0.4015,	Adjusted R-squared:  0.386 
F-statistic: 26.02 on 5 and 194 DF,  p-value: < 2.2e-16

cooks3 <- cooks.distance(m4)
[1] 107
names(which(cooks3 > (4/200 - 4 - 1)))
[1] 108
 [1] "1"  "2"  "3"  "4"  "5"  "6"  "7"  "8"  "9"  "10" "11" "12" "13" "14" "15" "16" "17" "18" "19" "20" "21" "22"
[23] "23" "24" "25" "26" "27" "28" "29" "30" "31" "32" "33" "34" "35" "36" "37" "38" "39" "40" "41" "42" "43" "44"
[45] "45" "46" "47" "48" "49" "50"
 [ reached getOption("max.print") -- omitted 150 entries ]
plot(m4, which = 4)
[1] 109
m4a <- lm(incidents ~ training * feedback, data = data[-c(13, 
    160, 176)])
[1] 110
summary(m4a)
[1] 111

Call:
lm(formula = incidents ~ training * feedback, data = data[-c(13, 
    160, 176)])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40000 -0.10500  0.00000  0.08333  0.43333 

Coefficients:
                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)          0.49333    0.02314  21.323  < 2e-16 ***
training2           -0.16000    0.03272  -4.890 2.09e-06 ***
feedback2            0.09667    0.03272   2.954  0.00352 ** 
training2:feedback2  0.05333    0.04627   1.153  0.25047    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1636 on 196 degrees of freedom
Multiple R-squared:  0.2431,	Adjusted R-squared:  0.2315 
F-statistic: 20.99 on 3 and 196 DF,  p-value: 7.827e-12

qqPlot(m4)
[1] 112
hist(m4$residuals, xlab = "x", main = "Histogram of Normality")
[1] 113
shapiro.test(m4$residuals)
[1] 114

	Shapiro-Wilk normality test

data:  m4$residuals
W = 0.98794, p-value = 0.08817

residualPlots(m4)
[1] 115
durbinWatsonTest(m4)
[1] 116
 lag Autocorrelation D-W Statistic p-value
   1      0.09456969      1.801048   0.196
 Alternative hypothesis: rho != 0
vif(m4)
[1] 117
          empathy             years          training          feedback training:feedback 
         1.122147          1.092150          2.086826          2.007327          3.070068 
with(data, tapply(incidents, list(training = training, feedback = feedback), 
    mean))
[1] 118
        feedback
training         1         2
       1 0.4933333 0.5900000
       2 0.3333333 0.4833333
m4a1 <- lm(incidents ~ empathy + years + feedback * training, 
    data = data)
[1] 119
summary(m4a1)
[1] 120

Call:
lm(formula = incidents ~ empathy + years + feedback * training, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30367 -0.10365 -0.00795  0.08806  0.44359 

Coefficients:
                     Estimate Std. Error t value Pr(>|t|)    
(Intercept)          0.345467   0.048515   7.121 2.04e-11 ***
empathy              0.028695   0.004328   6.630 3.25e-10 ***
years               -0.015720   0.003518  -4.468 1.34e-05 ***
feedback2            0.085558   0.029299   2.920  0.00391 ** 
training2           -0.203496   0.029874  -6.812 1.18e-10 ***
feedback2:training2  0.097334   0.041840   2.326  0.02103 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1462 on 194 degrees of freedom
Multiple R-squared:  0.4015,	Adjusted R-squared:  0.386 
F-statistic: 26.02 on 5 and 194 DF,  p-value: < 2.2e-16

effect("feedback*training", m4a1)
[1] 121

 feedback*training effect
        training
feedback         1         2
       1 0.5096358 0.3061393
       2 0.5951938 0.4890311
emmip(m4a1, feedback ~ training)
[1] 122
