

	####### B119168 R script #######

setwd("~/Documents/RMS 2/Coursework")
[1] 1
mydata <- read.csv("~/Desktop/rms2/code_check/RMS2_report_1920.csv")
[1] 2
library(psych, quietly = T)
[1] 3
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 4
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
library(DescTools, quietly = T)
[1] 5
 [1] "DescTools" "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[11] "methods"   "base"     
library(interactions, quietly = T)
[1] 6
 [1] "interactions" "DescTools"    "car"          "carData"      "psych"        "readr"        "stats"        "graphics"    
 [9] "grDevices"    "utils"        "datasets"     "methods"      "base"        
mydata$training <- factor(mydata$training, labels = c("No Training", 
    "Training"))
[1] 7
mydata$feedback <- factor(mydata$feedback, labels = c("No Feedback", 
    "Feedback"))
[1] 8
mydata$subject <- factor(mydata$subject)
[1] 9
summary(mydata)
[1] 10
    subject      incidents              training          feedback      empathy          years      
 1      :  1   Min.   :0.08333   No Training:100   No Feedback:100   Min.   : 3.00   Min.   : 1.00  
 2      :  1   1st Qu.:0.33333   Training   :100   Feedback   :100   1st Qu.: 9.00   1st Qu.: 6.00  
 3      :  1   Median :0.41667                                       Median :10.00   Median : 8.00  
 4      :  1   Mean   :0.47500                                       Mean   :10.18   Mean   : 8.13  
 5      :  1   3rd Qu.:0.58333                                       3rd Qu.:12.00   3rd Qu.:10.00  
 6      :  1   Max.   :0.91667                                       Max.   :16.00   Max.   :19.00  
 (Other):194                                                                                        
describe(mydata)
[1] 11
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject*     1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training*    3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
str(mydata)
[1] 12
'data.frame':	200 obs. of  6 variables:
 $ subject  : Factor w/ 200 levels "1","2","3","4",..: 1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : Factor w/ 2 levels "No Training",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : Factor w/ 2 levels "No Feedback",..: 2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
hist(mydata$incidents, main = "Incident Intervention", xlab = "Percentage of Incidents")
[1] 13
hist(mydata$empathy, main = "Teacher Empathy", xlab = "Empathy Score")
[1] 14
hist(mydata$years, main = "Teaching Experience", xlab = "Number of Years")
[1] 15
yearsCentered <- mydata$years - mean(mydata$years)
[1] 16
model_empathy_years <- lm(empathy ~ yearsCentered, data = mydata)
[1] 17
summary(model_empathy_years)
[1] 18

Call:
lm(formula = empathy ~ yearsCentered, data = mydata)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)   10.17500    0.17347  58.657  < 2e-16 ***
yearsCentered  0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

stdz <- MASS::studres(model_empathy_years)
[1] 19
which(abs(stdz) > 2)
[1] 20
 61  68  70  88  89 137 141 142 154 175 200 
 61  68  70  88  89 137 141 142 154 175 200 
hats <- hatvalues(model_empathy_years)
[1] 21
head(hats, 200)
[1] 22
          1           2           3           4           5           6           7           8           9          10 
0.006853526 0.005676819 0.010192832 0.005676819 0.012938483 0.006853526 0.005008958 0.006853526 0.005676819 0.005401194 
         11          12          13          14          15          16          17          18          19          20 
0.007404777 0.009365956 0.005676819 0.005676819 0.005676819 0.018949232 0.017571106 0.005676819 0.010192832 0.012938483 
         21          22          23          24          25          26          27          28          29          30 
0.009365956 0.014040983 0.005008958 0.005676819 0.005676819 0.007404777 0.005676819 0.005676819 0.007404777 0.010192832 
         31          32          33          34          35          36          37          38          39          40 
0.005676819 0.005008958 0.010192832 0.005401194 0.017571106 0.010192832 0.014040983 0.010192832 0.009365956 0.010192832 
         41          42          43          44          45          46          47          48          49          50 
0.010192832 0.005401194 0.012938483 0.014040983 0.010192832 0.005008958 0.007404777 0.007404777 0.007404777 0.014040983 
 [ reached getOption("max.print") -- omitted 150 entries ]
which(hats > 2 * mean(hats))
[1] 23
 61  88  89  92  94 108 109 116 131 137 140 141 154 155 163 190 200 
 61  88  89  92  94 108 109 116 131 137 140 141 154 155 163 190 200 
plot(cooks.distance(model_empathy_years), ylab = "Cook's Distance", 
    main = "Cook's Distance Plot")
[1] 24
abline(h = cooks.distance(model_empathy_years) > (4/(200 - 1 - 
    1)), col = "pink")
[1] 25
which(cooks.distance(model_empathy_years) > (4/(200 - 1 - 1)))
[1] 26
 16  61  88  89  94 108 137 141 154 163 171 175 192 200 
 16  61  88  89  94 108 137 141 154 163 171 175 192 200 
CVRs <- covratio(model_empathy_years)
[1] 27
1 + 3 * (2)/200
[1] 28
[1] 1.03
1 - 3 * (2)/200
[1] 29
[1] 0.97
which(CVRs > 1.03 | CVRs < 0.97)
[1] 30
 68 109 142 175 190 
 68 109 142 175 190 
hist(model_empathy_years$residuals, xlab = "Residuals", main = "Histogram of Residuals")
[1] 31
shapiro.test(model_empathy_years$residuals)
[1] 32

	Shapiro-Wilk normality test

data:  model_empathy_years$residuals
W = 0.98911, p-value = 0.1321

residualPlots(model_empathy_years, xlab = "Years", main = "Residual Plots")
[1] 33
ncvTest(model_empathy_years)
[1] 34
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.9815033, Df = 1, p = 0.32183
durbinWatsonTest(model_empathy_years)
[1] 35
 lag Autocorrelation D-W Statistic p-value
   1       0.1017162      1.769879   0.126
 Alternative hypothesis: rho != 0
plot(mydata$empathy ~ yearsCentered, xlab = "Years of Experience", 
    ylab = "Empathy", main = "Relationship between Empathy and Experience")
[1] 36
abline(lm(mydata$empathy ~ yearsCentered))
[1] 37
lines(lowess(yearsCentered, mydata$empathy))
[1] 38
centeredm1 <- lm(empathy ~ yearsCentered + I(yearsCentered^2), 
    data = mydata)
[1] 39
summary(centeredm1)
[1] 40

Call:
lm(formula = empathy ~ yearsCentered + I(yearsCentered^2), data = mydata)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)        11.152696   0.167423  66.614  < 2e-16 ***
yearsCentered       0.383236   0.047986   7.986 1.13e-13 ***
I(yearsCentered^2) -0.103645   0.009861 -10.510  < 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

hist(centeredm1$residuals, xlab = "Residuals", main = "Histogram of Residuals")
[1] 41
shapiro.test(centeredm1$residuals)
[1] 42

	Shapiro-Wilk normality test

data:  centeredm1$residuals
W = 0.9941, p-value = 0.6155

residualPlots(centeredm1, xlab = "Years", main = "Residual Plots")
[1] 43
ncvTest(centeredm1)
[1] 44
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.5107658, Df = 1, p = 0.47481
durbinWatsonTest(centeredm1)
[1] 45
 lag Autocorrelation D-W Statistic p-value
   1      0.01288905      1.973855   0.792
 Alternative hypothesis: rho != 0
crPlots(centeredm1)
[1] 46
vif(centeredm1)
[1] 47
     yearsCentered I(yearsCentered^2) 
          1.120963           1.120963 
cor.test(mydata$years, mydata$empathy, alternative = "two.sided", 
    method = "spearman", exact = F)
[1] 48

	Spearman's rank correlation rho

data:  mydata$years and mydata$empathy
S = 923838, p-value = 9.723e-06
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.3071045 

empathyCentered <- mydata$empathy - mean(mydata$empathy)
[1] 49
contrasts(mydata$training)
[1] 50
            Training
No Training        0
Training           1
contrasts(mydata$feedback)
[1] 51
            Feedback
No Feedback        0
Feedback           1
modelinterventions <- lm(incidents ~ training + empathyCentered + 
    yearsCentered, data = mydata)
[1] 52
summary(modelinterventions)
[1] 53

Call:
lm(formula = incidents ~ training + empathyCentered + yearsCentered, 
    data = mydata)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.551213   0.016298  33.821  < 2e-16 ***
trainingTraining -0.152427   0.023166  -6.580 4.20e-10 ***
empathyCentered   0.025396   0.004735   5.363 2.29e-07 ***
yearsCentered    -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

stdzinterventions <- MASS::studres(modelinterventions)
[1] 54
which(abs(stdzinterventions) > 2)
[1] 55
  7  13  35  74 159 165 176 181 
  7  13  35  74 159 165 176 181 
hatsinterventions <- hatvalues(modelinterventions)
[1] 56
head(hatsinterventions, 200)
[1] 57
         1          2          3          4          5          6          7          8          9         10         11 
0.01228875 0.01050612 0.01460984 0.01175403 0.01917551 0.01228875 0.01552392 0.02045647 0.01312775 0.01209596 0.01282306 
        12         13         14         15         16         17         18         19         20         21         22 
0.01887947 0.01175403 0.01312775 0.01175403 0.03896604 0.02934399 0.01175403 0.01460984 0.02037708 0.01610229 0.01838715 
        23         24         25         26         27         28         29         30         31         32         33 
0.01017972 0.01312775 0.01096403 0.01536910 0.01096403 0.01312775 0.01198283 0.03408432 0.01470775 0.01552392 0.01509311 
        34         35         36         37         38         39         40         41         42         43         44 
0.01209596 0.02541158 0.01460984 0.02029486 0.01876074 0.02205168 0.02117709 0.02117709 0.01209596 0.01892339 0.02380744 
        45         46         47         48         49         50 
0.02117709 0.01017972 0.01282306 0.01536910 0.01284842 0.02380744 
 [ reached getOption("max.print") -- omitted 150 entries ]
which(hatsinterventions > 2 * mean(hatsinterventions))
[1] 58
 61  88  89  92  94 137 141 154 163 175 200 
 61  88  89  92  94 137 141 154 163 175 200 
plot(cooks.distance(modelinterventions), ylab = "Cook's Distance", 
    main = "Cook's Distance Plot")
[1] 59
abline(h = cooks.distance(modelinterventions) > (4/(200 - 3 - 
    1)), col = "green")
[1] 60
which(cooks.distance(modelinterventions) > (4/(200 - 3 - 1)))
[1] 61
 13  35  74 137 165 
 13  35  74 137 165 
CVRsinterventions <- covratio(modelinterventions)
[1] 62
1 + 3 * (4)/200
[1] 63
[1] 1.06
1 - 3 * (4)/200
[1] 64
[1] 0.94
which(CVRsinterventions > 1.06 | CVRsinterventions < 0.94)
[1] 65
  7  13  61  88  89 141 154 155 159 163 175 176 181 200 
  7  13  61  88  89 141 154 155 159 163 175 176 181 200 
hist(modelinterventions$residuals, xlab = "Residuals", main = "Histogram of Intervention and Training Residuals")
[1] 66
shapiro.test(modelinterventions$residuals)
[1] 67

	Shapiro-Wilk normality test

data:  modelinterventions$residuals
W = 0.97994, p-value = 0.005838

summary(mydata$incidents)
[1] 68
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
0.08333 0.33333 0.41667 0.47500 0.58333 0.91667 
loginterventions <- log(mydata$incidents + 0.91667)
[1] 69
logmodelinterventions <- lm(loginterventions ~ training + empathyCentered + 
    yearsCentered, data = mydata)
[1] 70
summary(logmodelinterventions)
[1] 71

Call:
lm(formula = loginterventions ~ training + empathyCentered + 
    yearsCentered, data = mydata)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.27676 -0.08678 -0.00271  0.07438  0.35035 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.377252   0.011606  32.505  < 2e-16 ***
trainingTraining -0.111288   0.016497  -6.746 1.67e-10 ***
empathyCentered   0.018550   0.003372   5.501 1.17e-07 ***
yearsCentered    -0.010283   0.002769  -3.713 0.000266 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1155 on 196 degrees of freedom
Multiple R-squared:  0.2661,	Adjusted R-squared:  0.2549 
F-statistic: 23.69 on 3 and 196 DF,  p-value: 3.963e-13

hist(logmodelinterventions$residuals, xlab = "Residuals", main = "Histogram of Logged Intervention and Training Residuals")
[1] 72
shapiro.test(logmodelinterventions$residuals)
[1] 73

	Shapiro-Wilk normality test

data:  logmodelinterventions$residuals
W = 0.9905, p-value = 0.2109

residualPlots(logmodelinterventions, main = "Residual Plots")
[1] 74
ncvTest(logmodelinterventions)
[1] 75
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 1.036052, Df = 1, p = 0.30874
durbinWatsonTest(logmodelinterventions)
[1] 76
 lag Autocorrelation D-W Statistic p-value
   1       -0.116516      2.217742   0.152
 Alternative hypothesis: rho != 0
crPlots(logmodelinterventions)
[1] 77
vif(logmodelinterventions)
[1] 78
       training empathyCentered   yearsCentered 
       1.020633        1.092467        1.085089 
modelinterventions2 <- lm(incidents ~ feedback + empathyCentered + 
    yearsCentered + training, data = mydata)
[1] 79
summary(modelinterventions2)
[1] 80

Call:
lm(formula = incidents ~ feedback + empathyCentered + yearsCentered + 
    training, data = mydata)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.31626 -0.10096 -0.00949  0.09165  0.46650 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.485055   0.018126  26.760  < 2e-16 ***
feedbackFeedback  0.133715   0.020968   6.377 1.28e-09 ***
empathyCentered   0.027191   0.004328   6.283 2.12e-09 ***
yearsCentered    -0.015199   0.003551  -4.281 2.92e-05 ***
trainingTraining -0.153824   0.021128  -7.281 7.98e-12 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1479 on 195 degrees of freedom
Multiple R-squared:  0.3848,	Adjusted R-squared:  0.3721 
F-statistic: 30.49 on 4 and 195 DF,  p-value: < 2.2e-16

stdzinterventions2 <- MASS::studres(modelinterventions2)
[1] 81
which(abs(stdzinterventions2) > 2)
[1] 82
 13  74 101 117 150 156 159 160 176 181 
 13  74 101 117 150 156 159 160 176 181 
hatsinterventions2 <- hatvalues(modelinterventions2)
[1] 83
head(hatsinterventions2, 200)
[1] 84
         1          2          3          4          5          6          7          8          9         10         11 
0.01712163 0.01549576 0.02001541 0.01701625 0.02394476 0.01751286 0.02125280 0.02488761 0.01874782 0.01688360 0.01833535 
        12         13         14         15         16         17         18         19         20         21         22 
0.02484967 0.01655041 0.01759398 0.01655041 0.04465575 0.03320873 0.01701625 0.02001541 0.02623618 0.02051573 0.02288861 
        23         24         25         26         27         28         29         30         31         32         33 
0.01507666 0.01759398 0.01630229 0.01967881 0.01630229 0.01759398 0.01721607 0.04013609 0.01924406 0.01989413 0.02022237 
        34         35         36         37         38         39         40         41         42         43         44 
0.01688360 0.03028111 0.01927124 0.02532118 0.02291673 0.02753489 0.02665096 0.02577547 0.01688360 0.02343332 0.02910788 
        45         46         47         48         49         50 
0.02577547 0.01533766 0.01833535 0.01967881 0.01780984 0.02910788 
 [ reached getOption("max.print") -- omitted 150 entries ]
which(hatsinterventions2 > 2 * mean(hatsinterventions2))
[1] 85
 61  88  89  92 137 141 154 175 200 
 61  88  89  92 137 141 154 175 200 
plot(cooks.distance(modelinterventions2), ylab = "Cook's Distance", 
    main = "Cook's Distance Plot")
[1] 86
abline(h = cooks.distance(modelinterventions2) > (4/(200 - 3 - 
    1)), col = "pink")
[1] 87
which(cooks.distance(modelinterventions2) > (4/(200 - 3 - 1)))
[1] 88
 13  35  74 117 131 137 141 156 160 176 
 13  35  74 117 131 137 141 156 160 176 
CVRsinterventions2 <- covratio(modelinterventions2)
[1] 89
1 + 3 * (4)/200
[1] 90
[1] 1.06
1 - 3 * (4)/200
[1] 91
[1] 0.94
which(CVRsinterventions2 > 1.06 | CVRsinterventions2 < 0.94)
[1] 92
 13  16  61  70  88  89  92  94 101 108 117 140 150 154 155 156 159 160 163 176 190 200 
 13  16  61  70  88  89  92  94 101 108 117 140 150 154 155 156 159 160 163 176 190 200 
hist(modelinterventions2$residuals, xlab = "Residuals", main = "Histogram of Intervention and Feedback Residuals")
[1] 93
shapiro.test(modelinterventions2$residuals)
[1] 94

	Shapiro-Wilk normality test

data:  modelinterventions2$residuals
W = 0.98734, p-value = 0.07172

residualPlots(modelinterventions2, main = "Residual Plots")
[1] 95
ncvTest(modelinterventions2)
[1] 96
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 3.684027, Df = 1, p = 0.054936
durbinWatsonTest(modelinterventions2)
[1] 97
 lag Autocorrelation D-W Statistic p-value
   1      0.07303546      1.841386   0.254
 Alternative hypothesis: rho != 0
crPlots(modelinterventions2)
[1] 98
vif(modelinterventions2)
[1] 99
       feedback empathyCentered   yearsCentered        training 
       1.005320        1.097109        1.087722        1.020743 
model_interactions <- lm(incidents ~ training + empathyCentered + 
    yearsCentered + feedback + training * feedback, data = mydata)
[1] 100
summary(model_interactions)
[1] 101

Call:
lm(formula = incidents ~ training + empathyCentered + yearsCentered + 
    feedback + training * feedback, data = mydata)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30367 -0.10365 -0.00795  0.08806  0.44359 

Coefficients:
                                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)                        0.509636   0.020807  24.494  < 2e-16 ***
trainingTraining                  -0.203496   0.029874  -6.812 1.18e-10 ***
empathyCentered                    0.028695   0.004328   6.630 3.25e-10 ***
yearsCentered                     -0.015720   0.003518  -4.468 1.34e-05 ***
feedbackFeedback                   0.085558   0.029299   2.920  0.00391 ** 
trainingTraining:feedbackFeedback  0.097334   0.041840   2.326  0.02103 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1462 on 194 degrees of freedom
Multiple R-squared:  0.4015,	Adjusted R-squared:  0.386 
F-statistic: 26.02 on 5 and 194 DF,  p-value: < 2.2e-16

stdzinteraction <- MASS::studres(model_interactions)
[1] 102
which(abs(stdzinteraction) > 2)
[1] 103
 13  73 117 150 156 159 160 176 181 
 13  73 117 150 156 159 160 176 181 
hatsinteractions <- hatvalues(model_interactions)
[1] 104
head(hatsinteractions, 200)
[1] 105
         1          2          3          4          5          6          7          8          9         10         11 
0.02224625 0.02079595 0.02561420 0.02297973 0.02926555 0.02283851 0.02822387 0.02845329 0.02524477 0.02137580 0.02437488 
        12         13         14         15         16         17         18         19         20         21         22 
0.03179714 0.02108507 0.02168485 0.02108507 0.05253776 0.03658992 0.02297973 0.02561420 0.03271035 0.02482345 0.02754072 
        23         24         25         26         27         28         29         30         31         32         33 
0.02000879 0.02168485 0.02210604 0.02357605 0.02210604 0.02168485 0.02258795 0.04857153 0.02320282 0.02362375 0.02517907 
        34         35         36         37         38         39         40         41         42         43         44 
0.02137580 0.03603175 0.02413468 0.02987940 0.02662504 0.03447682 0.03354032 0.02956526 0.02137580 0.02812864 0.03574527 
        45         46         47         48         49         50 
0.02956526 0.02086326 0.02437488 0.02357605 0.02255318 0.03574527 
 [ reached getOption("max.print") -- omitted 150 entries ]
which(hatsinteractions > 2 * mean(hatsinteractions))
[1] 106
 61  88  89 137 141 154 200 
 61  88  89 137 141 154 200 
plot(cooks.distance(model_interactions), ylab = "Cook's Distance", 
    main = "Cook's Distance Plot")
[1] 107
abline(h = cooks.distance(model_interactions) > (4/(200 - 5 - 
    1)), col = "green")
[1] 108
which(cooks.distance(model_interactions) > (4/(200 - 5 - 1)))
[1] 109
 13  73  74  89 117 137 160 165 176 
 13  73  74  89 117 137 160 165 176 
CVRsinteractions <- covratio(model_interactions)
[1] 110
1 + 5 * (4)/200
[1] 111
[1] 1.1
1 - 5 * (4)/200
[1] 112
[1] 0.9
which(CVRsinterventions > 1.1 | CVRsinterventions < 0.9)
[1] 113
 13 154 
 13 154 
hist(model_interactions$residuals, xlab = "Residuals", main = "Histogram of Interaction Residuals")
[1] 114
shapiro.test(model_interactions$residuals)
[1] 115

	Shapiro-Wilk normality test

data:  model_interactions$residuals
W = 0.98794, p-value = 0.08817

residualPlots(model_interactions, main = "Residual Plots")
[1] 116
ncvTest(model_interactions)
[1] 117
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 4.398557, Df = 1, p = 0.035969
durbinWatsonTest(model_interactions)
[1] 118
 lag Autocorrelation D-W Statistic p-value
   1      0.09456969      1.801048   0.216
 Alternative hypothesis: rho != 0
vif(model_interactions)
[1] 119
         training   empathyCentered     yearsCentered          feedback training:feedback 
         2.086826          1.122147          1.092150          2.007327          3.070068 
cat_plot(model_interactions, pred = training, modx = feedback, 
    plot.points = TRUE, x.label = "Training", y.label = "Incidents", 
    legend.main = "Feedback")
[1] 120
model_empathy_years_SA <- lm(empathy ~ yearsCentered, subset = c(-16, 
    -61, -88, -89, -94, -108, -137, -141, -154, -163, -171, -175, 
    -192, -200), data = mydata)
[1] 121
summary(model_empathy_years_SA)
[1] 122

Call:
lm(formula = empathy ~ yearsCentered, data = mydata, subset = c(-16, 
    -61, -88, -89, -94, -108, -137, -141, -154, -163, -171, -175, 
    -192, -200))

Residuals:
   Min     1Q Median     3Q    Max 
-4.681 -1.378  0.008  1.307  5.532 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)   10.50166    0.15131  69.404  < 2e-16 ***
yearsCentered  0.26223    0.05804   4.518 1.11e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.064 on 184 degrees of freedom
Multiple R-squared:  0.09986,	Adjusted R-squared:  0.09497 
F-statistic: 20.41 on 1 and 184 DF,  p-value: 1.114e-05

centeredm1_SA <- lm(empathy ~ yearsCentered + I(yearsCentered^2), 
    subset = c(-61, -89, -137, -141, -154, -163, -165, -175), 
    data = mydata)
[1] 123
summary(centeredm1_SA)
[1] 124

Call:
lm(formula = empathy ~ yearsCentered + I(yearsCentered^2), data = mydata, 
    subset = c(-61, -89, -137, -141, -154, -163, -165, -175))

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5344 -1.1205  0.1144  1.2235  4.8795 

Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)        11.17359    0.17329  64.480  < 2e-16 ***
yearsCentered       0.39440    0.05054   7.804 3.97e-13 ***
I(yearsCentered^2) -0.10772    0.01353  -7.962 1.54e-13 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.912 on 189 degrees of freedom
Multiple R-squared:  0.3587,	Adjusted R-squared:  0.3519 
F-statistic: 52.86 on 2 and 189 DF,  p-value: < 2.2e-16

modelinterventions_SA <- lm(incidents ~ training + empathyCentered + 
    yearsCentered, subset = c(-13, -35, -74, -137, -165), data = mydata)
[1] 125
summary(modelinterventions_SA)
[1] 126

Call:
lm(formula = incidents ~ training + empathyCentered + yearsCentered, 
    data = mydata, subset = c(-13, -35, -74, -137, -165))

Residuals:
     Min       1Q   Median       3Q      Max 
-0.28818 -0.11426 -0.00621  0.09990  0.40582 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.546086   0.015423  35.408  < 2e-16 ***
trainingTraining -0.153846   0.021969  -7.003 4.16e-11 ***
empathyCentered   0.028505   0.004568   6.240 2.76e-09 ***
yearsCentered    -0.016177   0.003838  -4.215 3.84e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1521 on 191 degrees of freedom
Multiple R-squared:  0.3042,	Adjusted R-squared:  0.2932 
F-statistic: 27.83 on 3 and 191 DF,  p-value: 5.621e-15

logmodelinterventions_SA <- lm(loginterventions ~ training + 
    empathyCentered + yearsCentered, subset = c(-13, -30, -35, 
    -60, -74, -88, -94, -137), data = mydata)
[1] 127
summary(logmodelinterventions_SA)
[1] 128

Call:
lm(formula = loginterventions ~ training + empathyCentered + 
    yearsCentered, data = mydata, subset = c(-13, -30, -35, -60, 
    -74, -88, -94, -137))

Residuals:
      Min        1Q    Median        3Q       Max 
-0.214502 -0.081578 -0.001217  0.071777  0.256612 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.375545   0.010831  34.674  < 2e-16 ***
trainingTraining -0.105954   0.015681  -6.757 1.72e-10 ***
empathyCentered   0.019440   0.003347   5.809 2.64e-08 ***
yearsCentered    -0.012095   0.002751  -4.397 1.84e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1074 on 188 degrees of freedom
Multiple R-squared:  0.2893,	Adjusted R-squared:  0.2779 
F-statistic:  25.5 on 3 and 188 DF,  p-value: 6.89e-14

modelinterventions2_SA <- lm(incidents ~ feedback + empathyCentered + 
    yearsCentered, c(-73, -74, -89, -137, -156, -160, -165, -176), 
    data = mydata)
[1] 129
summary(modelinterventions2_SA)
[1] 130

Call:
lm(formula = incidents ~ feedback + empathyCentered + yearsCentered, 
    data = mydata, subset = c(-73, -74, -89, -137, -156, -160, 
        -165, -176))

Residuals:
     Min       1Q   Median       3Q      Max 
-0.33584 -0.10475 -0.01065  0.11221  0.43819 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.398183   0.015387  25.877  < 2e-16 ***
feedbackFeedback  0.143324   0.021760   6.586 4.39e-10 ***
empathyCentered   0.026288   0.004614   5.697 4.63e-08 ***
yearsCentered    -0.011985   0.003870  -3.097  0.00225 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1506 on 188 degrees of freedom
Multiple R-squared:  0.2838,	Adjusted R-squared:  0.2724 
F-statistic: 24.83 on 3 and 188 DF,  p-value: 1.402e-13

model_interactions_SA <- lm(incidents ~ feedback + training + 
    empathyCentered + yearsCentered + training * feedback, subset = c(-13, 
    -73, -74, -89, -117, -137, -160, -165, -176), data = mydata)
[1] 131
summary(model_interactions_SA)
[1] 132

Call:
lm(formula = incidents ~ feedback + training + empathyCentered + 
    yearsCentered + training * feedback, data = mydata, subset = c(-13, 
    -73, -74, -89, -117, -137, -160, -165, -176))

Residuals:
     Min       1Q   Median       3Q      Max 
-0.28269 -0.09632  0.00081  0.09067  0.34167 

Coefficients:
                                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)                        0.494958   0.019144  25.855  < 2e-16 ***
feedbackFeedback                   0.094956   0.027103   3.504 0.000576 ***
trainingTraining                  -0.184679   0.027340  -6.755 1.80e-10 ***
empathyCentered                    0.030839   0.004103   7.516 2.35e-12 ***
yearsCentered                     -0.016135   0.003427  -4.708 4.89e-06 ***
feedbackFeedback:trainingTraining  0.084936   0.038572   2.202 0.028899 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1315 on 185 degrees of freedom
Multiple R-squared:  0.4496,	Adjusted R-squared:  0.4348 
F-statistic: 30.23 on 5 and 185 DF,  p-value: < 2.2e-16

