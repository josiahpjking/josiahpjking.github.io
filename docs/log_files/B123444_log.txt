

	####### B123444 R script #######

library(psych)
[1] 1
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car)
[1] 2
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
library(lm.beta, quietly = T)
[1] 3
 [1] "lm.beta"   "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[11] "methods"   "base"     
library(interactions, quietly = T)
[1] 4
 [1] "interactions" "lm.beta"      "car"          "carData"      "psych"        "readr"        "stats"        "graphics"    
 [9] "grDevices"    "utils"        "datasets"     "methods"      "base"        
library(readr, quietly = T)
[1] 5
 [1] "interactions" "lm.beta"      "car"          "carData"      "psych"        "readr"        "stats"        "graphics"    
 [9] "grDevices"    "utils"        "datasets"     "methods"      "base"        
df <- read_csv("~/Desktop/rms2/code_check/RMS2_report_1920.csv")
[1] 6
describe(df)
[1] 7
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training     3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
summary(df)
[1] 8
    subject         incidents          training      feedback      empathy          years      
 Min.   :  1.00   Min.   :0.08333   Min.   :1.0   Min.   :1.0   Min.   : 3.00   Min.   : 1.00  
 1st Qu.: 50.75   1st Qu.:0.33333   1st Qu.:1.0   1st Qu.:1.0   1st Qu.: 9.00   1st Qu.: 6.00  
 Median :100.50   Median :0.41667   Median :1.5   Median :1.5   Median :10.00   Median : 8.00  
 Mean   :100.50   Mean   :0.47500   Mean   :1.5   Mean   :1.5   Mean   :10.18   Mean   : 8.13  
 3rd Qu.:150.25   3rd Qu.:0.58333   3rd Qu.:2.0   3rd Qu.:2.0   3rd Qu.:12.00   3rd Qu.:10.00  
 Max.   :200.00   Max.   :0.91667   Max.   :2.0   Max.   :2.0   Max.   :16.00   Max.   :19.00  
str(df)
[1] 9
Classes ‘spec_tbl_df’, ‘tbl_df’, ‘tbl’ and 'data.frame':	200 obs. of  6 variables:
 $ subject  : num  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : num  2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : num  2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : num  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : num  10 7 5 7 12 10 8 10 7 9 ...
 - attr(*, "spec")=
  .. cols(
  ..   subject = col_double(),
  ..   incidents = col_double(),
  ..   training = col_double(),
  ..   feedback = col_double(),
  ..   empathy = col_double(),
  ..   years = col_double()
  .. )
NULL
df$training <- as.factor(df$training)
[1] 10
df$feedback <- as.factor(df$feedback)
[1] 11
levels(df$training)
[1] 12
[1] "1" "2"
df$training <- factor(df$training, labels = c("No", "Yes"))
[1] 13
table(df$training)
[1] 14

 No Yes 
100 100 
levels(df$feedback)
[1] 15
[1] "1" "2"
df$feedback <- factor(df$feedback, labels = c("No", "Yes"))
[1] 16
table(df$feedback)
[1] 17

 No Yes 
100 100 
plot(df$empathy, df$incidents, xlab = "Empathy", ylab = "Bullying Incidents")
[1] 18
abline(lm(incidents ~ empathy, data = df), col = "red")
[1] 19
plot(df$years, df$incidents, xlab = "Experience (years)", ylab = "Bullying Incidents")
[1] 20
abline(lm(incidents ~ years, data = df), col = "red")
[1] 21
plot(df$training, df$incidents, xlab = "Training", ylab = "Bullying Incidence")
[1] 22
plot(df$feedback, df$incidents, xlab = "Feedback", ylab = "Bullying Incidence")
[1] 23
plot(df$years, df$empathy, xlab = "Teaching experience (years)", 
    ylab = "Empathy")
[1] 24
abline(lm(empathy ~ years, data = df), col = "red")
[1] 25
M1 <- lm(empathy ~ years, data = df)
[1] 26
summary(M1)
[1] 27

Call:
lm(formula = empathy ~ years, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  8.40625    0.49085  17.126  < 2e-16 ***
years        0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

summary(lm.beta(M1))
[1] 28

Call:
lm(formula = empathy ~ years, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Standardized Std. Error t value Pr(>|t|)    
(Intercept)  8.40625      0.00000    0.49085  17.126  < 2e-16 ***
years        0.21756      0.26404    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

qqPlot(M1)
[1] 29
hist(M1$residuals)
[1] 30
shapiro.test(M1$residuals)
[1] 31

	Shapiro-Wilk normality test

data:  M1$residuals
W = 0.98911, p-value = 0.1321

residualPlots(M1)
[1] 32
ncvTest(M1)
[1] 33
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.9815033, Df = 1, p = 0.32183
crPlots(M1)
[1] 34
M1a <- lm(empathy ~ years + I(years^2), data = df)
[1] 35
summary(M1a)
[1] 36

Call:
lm(formula = empathy ~ years + I(years^2), data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  1.186356   0.791848   1.498    0.136    
years        2.068508   0.181845  11.375   <2e-16 ***
I(years^2)  -0.103645   0.009861 -10.510   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

summary(lm.beta(M1a))
[1] 37

Call:
lm(formula = empathy ~ years + I(years^2), data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
             Estimate Standardized Std. Error t value Pr(>|t|)    
(Intercept)  1.186356     0.000000   0.791848   1.498    0.136    
years        2.068508     2.510418   0.181845  11.375   <2e-16 ***
I(years^2)  -0.103645    -2.319583   0.009861 -10.510   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

qqPlot(M1a)
[1] 38
hist(M1a$residuals)
[1] 39
shapiro.test(M1a$residuals)
[1] 40

	Shapiro-Wilk normality test

data:  M1a$residuals
W = 0.9941, p-value = 0.6155

residualPlots(M1a)
[1] 41
ncvTest(M1a)
[1] 42
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.5107658, Df = 1, p = 0.47481
crPlots(M1a)
[1] 43
durbinWatsonTest(M1a)
[1] 44
 lag Autocorrelation D-W Statistic p-value
   1      0.01288905      1.973855   0.876
 Alternative hypothesis: rho != 0
df2 <- subset(df, select = c(incidents, training, feedback, empathy, 
    years))
[1] 45
describe(df2)
[1] 46
          vars   n mean   sd median trimmed  mad  min  max range skew kurtosis   se
incidents    1 200 0.48 0.19   0.42    0.47 0.12 0.08 0.92  0.83 0.32    -0.31 0.01
training*    2 200 1.50 0.50   1.50    1.50 0.74 1.00 2.00  1.00 0.00    -2.01 0.04
feedback*    3 200 1.50 0.50   1.50    1.50 0.74 1.00 2.00  1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 2 rows ]
summary(df2)
[1] 47
   incidents       training  feedback     empathy          years      
 Min.   :0.08333   No :100   No :100   Min.   : 3.00   Min.   : 1.00  
 1st Qu.:0.33333   Yes:100   Yes:100   1st Qu.: 9.00   1st Qu.: 6.00  
 Median :0.41667                       Median :10.00   Median : 8.00  
 Mean   :0.47500                       Mean   :10.18   Mean   : 8.13  
 3rd Qu.:0.58333                       3rd Qu.:12.00   3rd Qu.:10.00  
 Max.   :0.91667                       Max.   :16.00   Max.   :19.00  
str(df2)
[1] 48
Classes ‘tbl_df’, ‘tbl’ and 'data.frame':	200 obs. of  5 variables:
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : Factor w/ 2 levels "No","Yes": 2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : num  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : num  10 7 5 7 12 10 8 10 7 9 ...
NULL
df2$training <- factor(df2$training, labels = c("No", "Yes"))
[1] 49
df2$feedback <- factor(df2$feedback, labels = c("No", "Yes"))
[1] 50
df2$empathy_m <- df2$empathy - mean(df2$empathy)
[1] 51
df2$years_m <- df2$years - mean(df2$years)
[1] 52
describe(df2$empathy_m)
[1] 53
   vars   n mean   sd median trimmed  mad   min  max range  skew kurtosis   se
X1    1 200    0 2.54  -0.18    0.06 2.97 -7.18 5.82    13 -0.37     0.23 0.18
describe(df2$years_m)
[1] 54
   vars   n mean   sd median trimmed  mad   min   max range skew kurtosis   se
X1    1 200    0 3.08  -0.13   -0.16 2.97 -7.13 10.87    18 0.52     0.48 0.22
plot(df2$empathy_m, df2$incidents, xlab = "Average score of empathy", 
    ylab = "Bullying incidents")
[1] 55
abline(lm(incidents ~ empathy_m, data = df2), col = "red")
[1] 56
plot(df2$years_m, df2$incidents, xlab = "Average years of teaching", 
    ylab = "Bullying incidents")
[1] 57
abline(lm(incidents ~ years_m, data = df2), col = "red")
[1] 58
contrasts(df2$training) <- contr.sum(2)
[1] 59
M2b <- lm(incidents ~ training, data = df2)
[1] 60
summary(M2b)
[1] 61

Call:
lm(formula = incidents ~ training, data = df2)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.32500 -0.12500  0.00833  0.12500  0.50833 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.47500    0.01235  38.456  < 2e-16 ***
training1    0.06667    0.01235   5.397 1.92e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1747 on 198 degrees of freedom
Multiple R-squared:  0.1283,	Adjusted R-squared:  0.1239 
F-statistic: 29.13 on 1 and 198 DF,  p-value: 1.922e-07

M2 <- lm(incidents ~ empathy_m + years_m + training + empathy_m * 
    years_m, data = df2)
[1] 62
summary(M2)
[1] 63

Call:
lm(formula = incidents ~ empathy_m + years_m + training + empathy_m * 
    years_m, data = df2)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35876 -0.11866 -0.01450  0.09379  0.52507 

Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)        0.478347   0.011765  40.658  < 2e-16 ***
empathy_m          0.024587   0.004774   5.150 6.33e-07 ***
years_m           -0.016881   0.004493  -3.757 0.000227 ***
training1          0.074772   0.011626   6.431 9.53e-10 ***
empathy_m:years_m -0.001631   0.001318  -1.238 0.217352    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1619 on 195 degrees of freedom
Multiple R-squared:  0.2623,	Adjusted R-squared:  0.2471 
F-statistic: 17.33 on 4 and 195 DF,  p-value: 3.512e-12

df2$training <- recode(df2$training, "1=2; 2=1")
[1] 64
M2a <- lm(incidents ~ empathy_m + years_m + training + empathy_m * 
    years_m, data = df2)
[1] 65
summary(M2a)
[1] 66

Call:
lm(formula = incidents ~ empathy_m + years_m + training + empathy_m * 
    years_m, data = df2)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35876 -0.11866 -0.01450  0.09379  0.52507 

Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)        0.553119   0.016349  33.833  < 2e-16 ***
empathy_m          0.024587   0.004774   5.150 6.33e-07 ***
years_m           -0.016881   0.004493  -3.757 0.000227 ***
trainingYes       -0.149544   0.023252  -6.431 9.53e-10 ***
empathy_m:years_m -0.001631   0.001318  -1.238 0.217352    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1619 on 195 degrees of freedom
Multiple R-squared:  0.2623,	Adjusted R-squared:  0.2471 
F-statistic: 17.33 on 4 and 195 DF,  p-value: 3.512e-12

qqPlot(M2)
[1] 67
hist(M2$residuals)
[1] 68
residualPlots(M2)
[1] 69
durbinWatsonTest(M2)
[1] 70
 lag Autocorrelation D-W Statistic p-value
   1      -0.1155045      2.214556   0.176
 Alternative hypothesis: rho != 0
vif(M2)
[1] 71
        empathy_m           years_m          training empathy_m:years_m 
         1.113302          1.452530          1.030979          1.449782 
cooks <- cooks.distance(M2)
[1] 72
which(cooks > (4/(200 - 3 - 1)))
[1] 73
 13  35  60  61  74  77  89 137 154 165 181 
 13  35  60  61  74  77  89 137 154 165 181 
plot(M2, which = 4)
[1] 74
M2_test <- lm(incidents ~ empathy_m + years_m + training + empathy_m * 
    years_m, data = df2[-c(35, 77, 137), ])
[1] 75
summary(M2_test)
[1] 76

Call:
lm(formula = incidents ~ empathy_m + years_m + training + empathy_m * 
    years_m, data = df2[-c(35, 77, 137), ])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35051 -0.11565 -0.00969  0.09253  0.52729 

Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)        0.551731   0.016050  34.376  < 2e-16 ***
empathy_m          0.024039   0.004837   4.970 1.48e-06 ***
years_m           -0.020609   0.004514  -4.566 8.87e-06 ***
trainingYes       -0.154563   0.022771  -6.788 1.38e-10 ***
empathy_m:years_m -0.002138   0.001361  -1.571    0.118    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1581 on 192 degrees of freedom
Multiple R-squared:  0.2905,	Adjusted R-squared:  0.2757 
F-statistic: 19.65 on 4 and 192 DF,  p-value: 1.419e-13

contrasts(df2$feedback) <- contr.sum(2)
[1] 77
M3b <- lm(incidents ~ feedback, data = df2)
[1] 78
summary(M3b)
[1] 79

Call:
lm(formula = incidents ~ feedback, data = df2)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.45333 -0.12000  0.00333  0.13000  0.50333 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.47500    0.01248   38.05  < 2e-16 ***
feedback1   -0.06167    0.01248   -4.94 1.66e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1765 on 198 degrees of freedom
Multiple R-squared:  0.1097,	Adjusted R-squared:  0.1052 
F-statistic: 24.41 on 1 and 198 DF,  p-value: 1.656e-06

M3 <- lm(incidents ~ empathy_m + years_m + feedback + empathy_m * 
    years_m, data = df2)
[1] 80
summary(M3)
[1] 81

Call:
lm(formula = incidents ~ empathy_m + years_m + feedback + empathy_m * 
    years_m, data = df2)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35780 -0.10832 -0.01194  0.10634  0.53712 

Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)        0.479874   0.012017  39.934  < 2e-16 ***
empathy_m          0.022111   0.004841   4.568 8.73e-06 ***
years_m           -0.016825   0.004591  -3.665 0.000319 ***
feedback1         -0.065776   0.011730  -5.608 6.94e-08 ***
empathy_m:years_m -0.002375   0.001340  -1.773 0.077789 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1654 on 195 degrees of freedom
Multiple R-squared:  0.2299,	Adjusted R-squared:  0.2141 
F-statistic: 14.56 on 4 and 195 DF,  p-value: 2.022e-10

df2$feedback <- recode(df2$feedback, "1=2; 2=1")
[1] 82
M3a <- lm(incidents ~ empathy_m + years_m + feedback + empathy_m * 
    years_m, data = df2)
[1] 83
summary(M3a)
[1] 84

Call:
lm(formula = incidents ~ empathy_m + years_m + feedback + empathy_m * 
    years_m, data = df2)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35780 -0.10832 -0.01194  0.10634  0.53712 

Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)        0.414098   0.016819  24.621  < 2e-16 ***
empathy_m          0.022111   0.004841   4.568 8.73e-06 ***
years_m           -0.016825   0.004591  -3.665 0.000319 ***
feedbackYes        0.131552   0.023459   5.608 6.94e-08 ***
empathy_m:years_m -0.002375   0.001340  -1.773 0.077789 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1654 on 195 degrees of freedom
Multiple R-squared:  0.2299,	Adjusted R-squared:  0.2141 
F-statistic: 14.56 on 4 and 195 DF,  p-value: 2.022e-10

qqPlot(M3)
[1] 85
hist(M3$residuals)
[1] 86
residualPlots(M3)
[1] 87
durbinWatsonTest(M3)
[1] 88
 lag Autocorrelation D-W Statistic p-value
   1       0.2545421      1.476006       0
 Alternative hypothesis: rho != 0
vif(M3)
[1] 89
        empathy_m           years_m          feedback empathy_m:years_m 
         1.096636          1.452710          1.005406          1.435512 
cooks <- cooks.distance(M3)
[1] 90
which(cooks > (4/(200 - 3 - 1)))
[1] 91
 35  73  74  89 137 142 156 160 165 176 181 200 
 35  73  74  89 137 142 156 160 165 176 181 200 
plot(M3, which = 4)
[1] 92
M3_test <- lm(incidents ~ empathy_m + years_m + feedback + empathy_m * 
    years_m, data = df2[-c(89, 137, 200), ])
[1] 93
summary(M3_test)
[1] 94

Call:
lm(formula = incidents ~ empathy_m + years_m + feedback + empathy_m * 
    years_m, data = df2[-c(89, 137, 200), ])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35855 -0.10938 -0.01454  0.10199  0.53813 

Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)        0.412991   0.016673  24.770  < 2e-16 ***
empathy_m          0.022392   0.005035   4.447 1.47e-05 ***
years_m           -0.016883   0.004591  -3.677 0.000306 ***
feedbackYes        0.135999   0.023321   5.832 2.29e-08 ***
empathy_m:years_m -0.003177   0.001452  -2.187 0.029914 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1633 on 192 degrees of freedom
Multiple R-squared:  0.2429,	Adjusted R-squared:  0.2272 
F-statistic:  15.4 on 4 and 192 DF,  p-value: 6.07e-11

AIC(M2, M3)
[1] 95
   df       AIC
M2  6 -153.7302
M3  6 -145.1576
BIC(M2, M3)
[1] 96
   df       BIC
M2  6 -133.9403
M3  6 -125.3677
M4 <- lm(incidents ~ empathy_m + years_m + training + feedback + 
    training * feedback, data = df2)
[1] 97
summary(M4)
[1] 98

Call:
lm(formula = incidents ~ empathy_m + years_m + training + feedback + 
    training * feedback, data = df2)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30367 -0.10365 -0.00795  0.08806  0.44359 

Coefficients:
                         Estimate Std. Error t value Pr(>|t|)    
(Intercept)              0.509636   0.020807  24.494  < 2e-16 ***
empathy_m                0.028695   0.004328   6.630 3.25e-10 ***
years_m                 -0.015720   0.003518  -4.468 1.34e-05 ***
trainingYes             -0.203496   0.029874  -6.812 1.18e-10 ***
feedbackYes              0.085558   0.029299   2.920  0.00391 ** 
trainingYes:feedbackYes  0.097334   0.041840   2.326  0.02103 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1462 on 194 degrees of freedom
Multiple R-squared:  0.4015,	Adjusted R-squared:  0.386 
F-statistic: 26.02 on 5 and 194 DF,  p-value: < 2.2e-16

cat_plot(M4, pred = training, modx = feedback, data = df2)
[1] 99
qqPlot(M4)
[1] 100
hist(M4$residuals)
[1] 101
residualPlots(M4)
[1] 102
durbinWatsonTest(M4)
[1] 103
 lag Autocorrelation D-W Statistic p-value
   1      0.09456969      1.801048   0.214
 Alternative hypothesis: rho != 0
vif(M4)
[1] 104
        empathy_m           years_m          training          feedback training:feedback 
         1.122147          1.092150          2.086826          2.007327          3.070068 
cooks <- cooks.distance(M4)
[1] 105
which(cooks > (4/(200 - 4 - 1)))
[1] 106
 13  73  74  89 117 137 160 165 176 
 13  73  74  89 117 137 160 165 176 
plot(M4, which = 4)
[1] 107
M4_test <- lm(incidents ~ empathy_m + years_m + training + feedback + 
    training * feedback, data = df2[-c(89, 137, 200), ])
[1] 108
summary(M4_test)
[1] 109

Call:
lm(formula = incidents ~ empathy_m + years_m + training + feedback + 
    training * feedback, data = df2[-c(89, 137, 200), ])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30950 -0.10389 -0.00852  0.08789  0.44410 

Coefficients:
                         Estimate Std. Error t value Pr(>|t|)    
(Intercept)              0.508521   0.020886  24.348  < 2e-16 ***
empathy_m                0.029801   0.004505   6.614 3.65e-10 ***
years_m                 -0.016437   0.003747  -4.387 1.90e-05 ***
trainingYes             -0.203471   0.029875  -6.811 1.23e-10 ***
feedbackYes              0.081295   0.029455   2.760  0.00634 ** 
trainingYes:feedbackYes  0.106342   0.041928   2.536  0.01200 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1454 on 191 degrees of freedom
Multiple R-squared:  0.4033,	Adjusted R-squared:  0.3877 
F-statistic: 25.82 on 5 and 191 DF,  p-value: < 2.2e-16

