

	####### B110704 R script #######

rm(list = ls())
[1] 1
setwd("Eilidh Fleming")
[1] 2
library(psych, quietly = T)
[1] 3
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 4
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[10] "methods"   "base"     
library(standardize, quietly = T)
[1] 5
 [1] "standardize" "car"         "carData"     "psych"       "readr"       "stats"       "graphics"    "grDevices"  
 [9] "utils"       "datasets"    "methods"     "base"       
library(interactions, quietly = T)
[1] 6
 [1] "interactions" "standardize"  "car"          "carData"      "psych"        "readr"        "stats"       
 [8] "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
library(effects, quietly = T)
[1] 7
 [1] "effects"      "interactions" "standardize"  "car"          "carData"      "psych"        "readr"       
 [8] "stats"        "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
library(ggplot2, quietly = T)
[1] 8
 [1] "ggplot2"      "effects"      "interactions" "standardize"  "car"          "carData"      "psych"       
 [8] "readr"        "stats"        "graphics"     "grDevices"    "utils"        "datasets"     "methods"     
[15] "base"        
data <- read.csv("../RMS2_report_1920.csv")
[1] 9
describe(data)[, c(2:4, 8, 9)]
[1] 10
            n   mean    sd  min    max
subject   200 100.50 57.88 1.00 200.00
incidents 200   0.48  0.19 0.08   0.92
training  200   1.50  0.50 1.00   2.00
feedback  200   1.50  0.50 1.00   2.00
empathy   200  10.18  2.54 3.00  16.00
years     200   8.13  3.08 1.00  19.00
str(data)
[1] 11
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : int  2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : int  2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
data$training <- as.factor(data$training)
[1] 12
data$feedback <- as.factor(data$feedback)
[1] 13
str(data$training)
[1] 14
 Factor w/ 2 levels "1","2": 2 2 2 2 2 2 2 2 2 2 ...
NULL
data$training <- factor(data$training, labels = c("no training", 
    "training"))
[1] 15
summary(data$training)
[1] 16
no training    training 
        100         100 
str(data$feedback)
[1] 17
 Factor w/ 2 levels "1","2": 2 1 2 1 2 1 2 1 2 1 ...
NULL
data$feedback <- factor(data$feedback, labels = c("no feedback", 
    "feedback"))
[1] 18
summary(data$feedback)
[1] 19
no feedback    feedback 
        100         100 
describe(data)[c(2:4, 8, 9, 11, 12)]
[1] 20
            n   mean    sd  min    max  skew kurtosis
subject   200 100.50 57.88 1.00 200.00  0.00    -1.22
incidents 200   0.48  0.19 0.08   0.92  0.32    -0.31
training* 200   1.50  0.50 1.00   2.00  0.00    -2.01
feedback* 200   1.50  0.50 1.00   2.00  0.00    -2.01
empathy   200  10.18  2.54 3.00  16.00 -0.37     0.23
years     200   8.13  3.08 1.00  19.00  0.52     0.48
summary(data[, 3:4])
[1] 21
        training          feedback  
 no training:100   no feedback:100  
 training   :100   feedback   :100  
plot(data$years, data$empathy, xlab = "Empathy", ylab = "Experience", 
    pch = 16)
[1] 22
plot(data$training, data$incidents, xlab = "Training", ylab = "Intervention")
[1] 23
plot(data$feedback, data$incidents, xlab = "Feedback", ylab = "Intervention")
[1] 24
data$yearscentered <- scale(data$years, center = TRUE, scale = FALSE)
[1] 25
data$yearscentered
[1] 26
        [,1]
  [1,]  1.87
  [2,] -1.13
  [3,] -3.13
  [4,] -1.13
  [5,]  3.87
  [6,]  1.87
  [7,] -0.13
  [8,]  1.87
  [9,] -1.13
 [10,]  0.87
 [11,] -2.13
 [12,]  2.87
 [13,] -1.13
 [14,] -1.13
 [15,] -1.13
 [16,] -5.13
 [17,]  4.87
 [18,] -1.13
 [19,] -3.13
 [20,]  3.87
 [21,]  2.87
 [22,] -4.13
 [23,] -0.13
 [24,] -1.13
 [25,] -1.13
 [26,] -2.13
 [27,] -1.13
 [28,] -1.13
 [29,] -2.13
 [30,] -3.13
 [31,] -1.13
 [32,] -0.13
 [33,] -3.13
 [34,]  0.87
 [35,]  4.87
 [36,] -3.13
 [37,] -4.13
 [38,] -3.13
 [39,]  2.87
 [40,] -3.13
 [41,] -3.13
 [42,]  0.87
 [43,]  3.87
 [44,] -4.13
 [45,] -3.13
 [46,] -0.13
 [47,] -2.13
 [48,] -2.13
 [49,] -2.13
 [50,] -4.13
 [ reached getOption("max.print") -- omitted 150 rows ]
attr(,"scaled:center")
[1] 8.13
q1 <- lm(empathy ~ yearscentered + I(yearscentered^2), data = data)
[1] 27
summary(q1)
[1] 28

Call:
lm(formula = empathy ~ yearscentered + I(yearscentered^2), data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)        11.152696   0.167423  66.614  < 2e-16 ***
yearscentered       0.383236   0.047986   7.986 1.13e-13 ***
I(yearscentered^2) -0.103645   0.009861 -10.510  < 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

plot(q1)
[1] 29
cooks.distance(q1)
[1] 30
           1            2            3            4            5            6            7            8            9 
1.991618e-04 2.011084e-04 1.082881e-03 1.469039e-03 9.601502e-04 1.991618e-04 2.245250e-03 4.817469e-03 1.163649e-03 
          10           11           12           13           14           15           16           17           18 
2.435946e-04 8.373873e-04 5.155949e-03 1.469039e-03 1.163649e-03 1.469039e-03 6.826838e-03 4.054001e-03 1.469039e-03 
          19           20           21           22           23           24           25           26           27 
1.082881e-03 1.342130e-03 1.753273e-03 8.256882e-03 7.549940e-04 1.163649e-03 9.931143e-05 2.965868e-03 9.931143e-05 
          28           29           30           31           32           33           34           35           36 
1.163649e-03 1.166570e-05 1.488122e-02 3.903105e-03 2.245250e-03 3.717199e-06 2.435946e-04 9.898777e-03 1.082881e-03 
          37           38           39           40           41           42           43           44           45 
6.696324e-05 8.999457e-03 6.062062e-03 3.603638e-03 3.603638e-03 2.435946e-04 7.977232e-06 1.099522e-03 3.603638e-03 
          46           47           48           49           50 
7.549940e-04 8.373873e-04 2.965868e-03 4.887030e-04 1.099522e-03 
 [ reached getOption("max.print") -- omitted 150 entries ]
which(cooks.distance(q1) > (4/(200 - 2 - 1)))
[1] 31
 61  89 137 141 154 163 165 175 
 61  89 137 141 154 163 165 175 
cooks <- cooks.distance(q1)
[1] 32
names(which(cooks > (4/(200 - 2 - 1))))
[1] 33
[1] "61"  "89"  "137" "141" "154" "163" "165" "175"
plot(q1, which = 4)
[1] 34
q1b <- lm(empathy ~ yearscentered + I(yearscentered^2), data = data[-c(89, 
    154, 175), ])
[1] 35
summary(q1b)
[1] 36

Call:
lm(formula = empathy ~ yearscentered + I(yearscentered^2), data = data[-c(89, 
    154, 175), ])

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5295 -1.2903  0.1354  1.3148  4.8900 

Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)        11.16343    0.16771  66.563  < 2e-16 ***
yearscentered       0.39723    0.04748   8.366 1.15e-14 ***
I(yearscentered^2) -0.10774    0.01110  -9.710  < 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.918 on 194 degrees of freedom
Multiple R-squared:  0.4117,	Adjusted R-squared:  0.4056 
F-statistic: 67.87 on 2 and 194 DF,  p-value: < 2.2e-16

q1_coef <- summary(q1)
[1] 37
q1b_coef <- summary(q1b)
[1] 38
compare <- data.frame(round(q1_coef$coefficients[, 2], 4), round(q1_coef$coefficients[, 
    4], 23), round(q1b_coef$coefficients[, 2], 4), round(q1b_coef$coefficients[, 
    4], 23))
[1] 39
colnames(compare) <- c("q1 Coef", "q1 p-value", "q1b Coef", "q1b p-value")
[1] 40
compare

                   q1 Coef q1 p-value q1b Coef  q1b p-value
(Intercept)         0.1674 0.0000e+00   0.1677 0.000000e+00
yearscentered       0.0480 1.1347e-13   0.0475 1.152822e-14
I(yearscentered^2)  0.0099 8.5000e-21   0.0111 2.041990e-18


crPlots(q1)
[1] 42
qqPlot(q1)
[1] 43
hist(q1$residuals)
[1] 44
ncvTest(q1)
[1] 45
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.5107658, Df = 1, p = 0.47481
durbinWatsonTest(q1)
[1] 46
 lag Autocorrelation D-W Statistic p-value
   1      0.01288905      1.973855   0.852
 Alternative hypothesis: rho != 0
Years <- data$yearscentered
[1] 47
Empathy <- data$empathy
[1] 48
ggplot(data, aes(Years, Empathy)) + geom_point() + geom_smooth(method = "lm", 
    formula = y ~ x + I(x^2))
[1] 49
data$yearscentered <- scale(data$years, center = TRUE, scale = FALSE)
[1] 50
data$yearscentered
[1] 51
        [,1]
  [1,]  1.87
  [2,] -1.13
  [3,] -3.13
  [4,] -1.13
  [5,]  3.87
  [6,]  1.87
  [7,] -0.13
  [8,]  1.87
  [9,] -1.13
 [10,]  0.87
 [11,] -2.13
 [12,]  2.87
 [13,] -1.13
 [14,] -1.13
 [15,] -1.13
 [16,] -5.13
 [17,]  4.87
 [18,] -1.13
 [19,] -3.13
 [20,]  3.87
 [21,]  2.87
 [22,] -4.13
 [23,] -0.13
 [24,] -1.13
 [25,] -1.13
 [26,] -2.13
 [27,] -1.13
 [28,] -1.13
 [29,] -2.13
 [30,] -3.13
 [31,] -1.13
 [32,] -0.13
 [33,] -3.13
 [34,]  0.87
 [35,]  4.87
 [36,] -3.13
 [37,] -4.13
 [38,] -3.13
 [39,]  2.87
 [40,] -3.13
 [41,] -3.13
 [42,]  0.87
 [43,]  3.87
 [44,] -4.13
 [45,] -3.13
 [46,] -0.13
 [47,] -2.13
 [48,] -2.13
 [49,] -2.13
 [50,] -4.13
 [ reached getOption("max.print") -- omitted 150 rows ]
attr(,"scaled:center")
[1] 8.13
data$empathycentered <- scale(data$empathy, center = TRUE, scale = FALSE)
[1] 52
data$empathycentered
[1] 53
         [,1]
  [1,]  0.825
  [2,] -0.175
  [3,] -0.175
  [4,] -1.175
  [5,]  1.825
  [6,]  0.825
  [7,]  2.825
  [8,]  3.825
  [9,]  1.825
 [10,]  1.825
 [11,]  0.825
 [12,] -1.175
 [13,] -1.175
 [14,]  1.825
 [15,] -1.175
 [16,] -5.175
 [17,] -1.175
 [18,] -1.175
 [19,] -0.175
 [20,] -0.175
 [21,] -0.175
 [22,] -0.175
 [23,] -0.175
 [24,]  1.825
 [25,]  0.825
 [26,]  1.825
 [27,]  0.825
 [28,]  1.825
 [29,] -0.175
 [30,] -5.175
 [31,] -2.175
 [32,]  2.825
 [33,] -1.175
 [34,]  1.825
 [35,]  2.825
 [36,] -0.175
 [37,] -2.175
 [38,]  1.825
 [39,]  3.825
 [40,] -3.175
 [41,] -3.175
 [42,]  1.825
 [43,]  0.825
 [44,] -3.175
 [45,] -3.175
 [46,] -0.175
 [47,]  0.825
 [48,]  1.825
 [49,] -1.175
 [50,] -3.175
 [ reached getOption("max.print") -- omitted 150 rows ]
attr(,"scaled:center")
[1] 10.175
q2 <- lm(incidents ~ training + empathycentered + yearscentered, 
    data = data)
[1] 54
summary(q2)
[1] 55

Call:
lm(formula = incidents ~ training + empathycentered + yearscentered, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.551213   0.016298  33.821  < 2e-16 ***
trainingtraining -0.152427   0.023166  -6.580 4.20e-10 ***
empathycentered   0.025396   0.004735   5.363 2.29e-07 ***
yearscentered    -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

cooks.distance(q2)
[1] 56
           1            2            3            4            5            6            7            8            9 
8.944216e-03 6.037640e-04 1.580166e-03 1.157586e-04 2.267305e-03 2.463011e-03 1.984548e-02 5.677361e-04 1.944568e-04 
          10           11           12           13           14           15           16           17           18 
8.352021e-03 1.128037e-02 4.313448e-06 3.236546e-02 1.944568e-04 4.507881e-03 1.199988e-02 5.292933e-03 3.038642e-04 
          19           20           21           22           23           24           25           26           27 
1.388896e-02 1.191856e-03 5.545830e-03 2.331353e-04 4.149247e-05 1.916593e-03 3.842138e-05 7.640178e-03 4.412825e-04 
          28           29           30           31           32           33           34           35           36 
2.090638e-03 6.876907e-06 1.807617e-02 9.838395e-05 1.163536e-04 9.397321e-04 3.097993e-05 3.081942e-02 6.774535e-05 
          37           38           39           40           41           42           43           44           45 
1.941980e-03 1.641118e-03 3.582645e-03 8.038933e-03 1.947800e-02 3.097993e-05 1.902071e-04 3.790865e-03 6.225899e-04 
          46           47           48           49           50 
2.110962e-03 2.233083e-03 1.764713e-03 1.280276e-03 1.044204e-02 
 [ reached getOption("max.print") -- omitted 150 entries ]
which(cooks.distance(q2) > (4/(200 - 4 - 1)))
[1] 57
 13  35  74 137 165 
 13  35  74 137 165 
cooks <- cooks.distance(q2)
[1] 58
names(which(cooks > (4/(200 - 4 - 1))))
[1] 59
[1] "13"  "35"  "74"  "137" "165"
plot(q2, which = 4)
[1] 60
q2b <- lm(incidents ~ training + empathycentered + yearscentered, 
    data = data[-c(13, 74, 137), ])
[1] 61
summary(q2b)
[1] 62

Call:
lm(formula = incidents ~ training + empathycentered + yearscentered, 
    data = data[-c(13, 74, 137), ])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.29350 -0.11585 -0.00812  0.10001  0.40267 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.549455   0.015645  35.119  < 2e-16 ***
trainingtraining -0.153719   0.022279  -6.900 7.28e-11 ***
empathycentered   0.029033   0.004656   6.236 2.77e-09 ***
yearscentered    -0.016244   0.003864  -4.204 4.01e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1552 on 193 degrees of freedom
Multiple R-squared:  0.2988,	Adjusted R-squared:  0.2879 
F-statistic: 27.41 on 3 and 193 DF,  p-value: 8.212e-15

q2_coef <- summary(q2)
[1] 63
q2b_coef <- summary(q2b)
[1] 64
compare <- data.frame(round(q2_coef$coefficients[, 2], 5), round(q2_coef$coefficients[, 
    4], 20), round(q2b_coef$coefficients[, 2], 5), round(q2b_coef$coefficients[, 
    4], 20))
[1] 65
colnames(compare) <- c("q2 Coef", "q2 p-value", "q2b Coef", "q2b p-value")
[1] 66
compare

                 q2 Coef   q2 p-value q2b Coef  q2b p-value
(Intercept)      0.01630 0.000000e+00  0.01565 0.000000e+00
trainingtraining 0.02317 4.200364e-10  0.02228 7.277021e-11
empathycentered  0.00474 2.292908e-07  0.00466 2.774207e-09
yearscentered    0.00389 3.723650e-04  0.00386 4.013999e-05


qqPlot(q2)
[1] 68
hist(q2$residuals)
[1] 69
ncvTest(q2)
[1] 70
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0293323, Df = 1, p = 0.86401
crPlots(q2)
[1] 71
durbinWatsonTest(q2)
[1] 72
 lag Autocorrelation D-W Statistic p-value
   1      -0.1072849      2.199897   0.204
 Alternative hypothesis: rho != 0
vif(q2)
[1] 73
       training empathycentered   yearscentered 
       1.020633        1.092467        1.085089 
q3 <- lm(incidents ~ feedback + training + empathycentered + 
    yearscentered, data = data)
[1] 74
summary(q3)
[1] 75

Call:
lm(formula = incidents ~ feedback + training + empathycentered + 
    yearscentered, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.31626 -0.10096 -0.00949  0.09165  0.46650 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.485055   0.018126  26.760  < 2e-16 ***
feedbackfeedback  0.133715   0.020968   6.377 1.28e-09 ***
trainingtraining -0.153824   0.021128  -7.281 7.98e-12 ***
empathycentered   0.027191   0.004328   6.283 2.12e-09 ***
yearscentered    -0.015199   0.003551  -4.281 2.92e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1479 on 195 degrees of freedom
Multiple R-squared:  0.3848,	Adjusted R-squared:  0.3721 
F-statistic: 30.49 on 4 and 195 DF,  p-value: < 2.2e-16

cooks.distance(q3)
[1] 76
           1            2            3            4            5            6            7            8            9 
6.993859e-03 1.555403e-05 5.799632e-03 1.617538e-03 4.501393e-04 9.394531e-04 1.701849e-02 2.323864e-05 1.794505e-04 
          10           11           12           13           14           15           16           17           18 
6.452812e-03 9.226001e-03 1.441990e-03 3.406085e-02 1.733781e-03 2.775397e-03 4.639622e-03 1.201860e-02 4.588141e-05 
          19           20           21           22           23           24           25           26           27 
1.118606e-02 5.619500e-03 1.221461e-02 1.649083e-04 2.942409e-04 5.725458e-03 1.190188e-03 4.990018e-03 3.193301e-06 
          28           29           30           31           32           33           34           35           36 
6.978812e-04 9.390332e-04 9.542631e-03 1.470601e-03 1.533623e-03 4.176873e-03 3.841762e-04 2.346537e-02 3.329237e-04 
          37           38           39           40           41           42           43           44           45 
2.407395e-04 5.268522e-03 8.959685e-04 4.072166e-03 1.436492e-02 3.841762e-04 2.037944e-03 9.393481e-04 2.250966e-05 
          46           47           48           49           50 
8.904401e-04 7.035440e-04 5.419468e-03 2.025109e-04 5.615437e-03 
 [ reached getOption("max.print") -- omitted 150 entries ]
which(cooks.distance(q3) > (4/(200 - 4 - 1)))
[1] 77
 13  35  74 117 131 137 141 156 160 176 
 13  35  74 117 131 137 141 156 160 176 
cooks <- cooks.distance(q3)
[1] 78
names(which(cooks > (4/(200 - 4 - 1))))
[1] 79
 [1] "13"  "35"  "74"  "117" "131" "137" "141" "156" "160" "176"
plot(q3, which = 4)
[1] 80
q3b <- lm(incidents ~ feedback + training + empathycentered + 
    yearscentered, data = data[-c(13, 137, 176), ])
[1] 81
summary(q3b)
[1] 82

Call:
lm(formula = incidents ~ feedback + training + empathycentered + 
    yearscentered, data = data[-c(13, 137, 176), ])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.31479 -0.10102 -0.00300  0.09041  0.35676 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.479439   0.017312  27.693  < 2e-16 ***
feedbackfeedback  0.132020   0.019981   6.607 3.76e-10 ***
trainingtraining -0.153003   0.020113  -7.607 1.22e-12 ***
empathycentered   0.029143   0.004167   6.993 4.34e-11 ***
yearscentered    -0.017169   0.003489  -4.921 1.85e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.14 on 192 degrees of freedom
Multiple R-squared:  0.4232,	Adjusted R-squared:  0.4112 
F-statistic: 35.22 on 4 and 192 DF,  p-value: < 2.2e-16

q3_coef <- summary(q3)
[1] 83
q3b_coef <- summary(q3b)
[1] 84
compare <- data.frame(round(q3_coef$coefficients[, 2], 4), round(q3_coef$coefficients[, 
    4], 10), round(q3b_coef$coefficients[, 2], 4), round(q3b_coef$coefficients[, 
    4], 10))
[1] 85
colnames(compare) <- c("q3 Coef", "q3 p-value", "q3b Coef", "q3b p-value")
[1] 86
compare

                 q3 Coef  q3 p-value q3b Coef q3b p-value
(Intercept)       0.0181 0.00000e+00   0.0173  0.0000e+00
feedbackfeedback  0.0210 1.30000e-09   0.0200  4.0000e-10
trainingtraining  0.0211 0.00000e+00   0.0201  0.0000e+00
empathycentered   0.0043 2.10000e-09   0.0042  0.0000e+00
yearscentered     0.0036 2.92145e-05   0.0035  1.8458e-06


qqPlot(q3)
[1] 88
hist(q3$residuals)
[1] 89
ncvTest(q3)
[1] 90
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 3.684027, Df = 1, p = 0.054936
crPlots(q3)
[1] 91
durbinWatsonTest(q3)
[1] 92
 lag Autocorrelation D-W Statistic p-value
   1      0.07303546      1.841386   0.228
 Alternative hypothesis: rho != 0
vif(q3)
[1] 93
       feedback        training empathycentered   yearscentered 
       1.005320        1.020743        1.097109        1.087722 
anova(q2, q3)
[1] 94
Analysis of Variance Table

Model 1: incidents ~ training + empathycentered + yearscentered
Model 2: incidents ~ feedback + training + empathycentered + yearscentered
  Res.Df    RSS Df Sum of Sq      F    Pr(>F)    
1    196 5.1532                                  
2    195 4.2639  1   0.88925 40.668 1.279e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
AIC(q2, q3)
[1] 95
   df       AIC
q2  5 -154.1654
q3  6 -190.0499
BIC(q2, q3)
[1] 96
   df       BIC
q2  5 -137.6738
q3  6 -170.2600
str(data$training)
[1] 97
 Factor w/ 2 levels "no training",..: 2 2 2 2 2 2 2 2 2 2 ...
NULL
str(data$feedback)
[1] 98
 Factor w/ 2 levels "no feedback",..: 2 1 2 1 2 1 2 1 2 1 ...
NULL
contrasts(data$training)
[1] 99
            training
no training        0
training           1
contrasts(data$feedback)
[1] 100
            feedback
no feedback        0
feedback           1
head(data, 20)
[1] 101
  subject incidents training    feedback empathy years yearscentered empathycentered
1       1 0.6666667 training    feedback      11    10          1.87           0.825
2       2 0.3333333 training no feedback      10     7         -1.13          -0.175
3       3 0.3333333 training    feedback      10     5         -3.13          -0.175
4       4 0.4166667 training no feedback       9     7         -1.13          -1.175
5       5 0.5000000 training    feedback      12    12          3.87           1.825
6       6 0.2500000 training no feedback      11    10          1.87           0.825
 [ reached 'max' / getOption("max.print") -- omitted 14 rows ]
describeBy(data$incidents, group = list(data$training, data$feedback), 
    mat = T)
[1] 102
    item      group1      group2 vars  n      mean        sd    median   trimmed     mad        min       max
X11    1 no training no feedback    1 50 0.4933333 0.1673794 0.4166667 0.4770833 0.12355 0.25000000 0.9166667
X12    2    training no feedback    1 50 0.3333333 0.1398493 0.3333333 0.3270833 0.12355 0.08333333 0.5833333
X13    3 no training    feedback    1 50 0.5900000 0.1707327 0.5833333 0.5875000 0.12355 0.25000000 0.9166667
        range       skew   kurtosis         se
X11 0.6666667 0.81813067 -0.0698501 0.02367103
X12 0.5000000 0.15233791 -0.9575614 0.01977768
X13 0.6666667 0.04793352 -0.8075298 0.02414525
 [ reached 'max' / getOption("max.print") -- omitted 1 rows ]
q5 <- lm(incidents ~ feedback + training + empathycentered + 
    yearscentered + feedback * training, data = data)
[1] 103
summary(q5)
[1] 104

Call:
lm(formula = incidents ~ feedback + training + empathycentered + 
    yearscentered + feedback * training, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30367 -0.10365 -0.00795  0.08806  0.44359 

Coefficients:
                                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)                        0.509636   0.020807  24.494  < 2e-16 ***
feedbackfeedback                   0.085558   0.029299   2.920  0.00391 ** 
trainingtraining                  -0.203496   0.029874  -6.812 1.18e-10 ***
empathycentered                    0.028695   0.004328   6.630 3.25e-10 ***
yearscentered                     -0.015720   0.003518  -4.468 1.34e-05 ***
feedbackfeedback:trainingtraining  0.097334   0.041840   2.326  0.02103 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1462 on 194 degrees of freedom
Multiple R-squared:  0.4015,	Adjusted R-squared:  0.386 
F-statistic: 26.02 on 5 and 194 DF,  p-value: < 2.2e-16

cooks.distance(q5)
[1] 105
           1            2            3            4            5            6            7            8            9 
6.098024e-03 3.530955e-05 8.401261e-03 3.001752e-03 9.144864e-05 4.738831e-04 1.589300e-02 2.138040e-04 7.248803e-04 
          10           11           12           13           14           15           16           17           18 
5.522340e-03 8.291397e-03 2.972169e-03 3.374707e-02 2.703540e-03 2.084847e-03 2.339903e-03 1.382228e-02 3.493265e-04 
          19           20           21           22           23           24           25           26           27 
9.882739e-03 8.477814e-03 1.507815e-02 5.817974e-04 7.818364e-04 7.571669e-03 2.333517e-03 3.886011e-03 1.672631e-04 
          28           29           30           31           32           33           34           35           36 
3.255841e-04 1.873516e-03 6.380355e-03 2.337533e-03 2.369321e-03 6.052129e-03 8.977552e-04 1.987897e-02 8.695217e-04 
          37           38           39           40           41           42           43           44           45 
1.770039e-05 6.755880e-03 2.535936e-04 2.664510e-03 1.179401e-02 8.977552e-04 3.261500e-03 2.688995e-04 2.270568e-04 
          46           47           48           49           50 
4.793762e-04 2.754126e-04 7.056800e-03 2.308944e-05 3.845940e-03 
 [ reached getOption("max.print") -- omitted 150 entries ]
which(cooks.distance(q5) > (4/(200 - 4 - 1)))
[1] 106
 13  73  74  89 117 137 160 165 176 
 13  73  74  89 117 137 160 165 176 
cooks <- cooks.distance(q5)
[1] 107
names(which(cooks > (4/(200 - 4 - 1))))
[1] 108
[1] "13"  "73"  "74"  "89"  "117" "137" "160" "165" "176"
plot(q5, which = 4)
[1] 109
q5b <- lm(incidents ~ feedback + training + empathycentered + 
    yearscentered + feedback * training, data = data[-c(13, 137, 
    176), ])
[1] 110
summary(q5b)
[1] 111

Call:
lm(formula = incidents ~ feedback + training + empathycentered + 
    yearscentered + feedback * training, data = data[-c(13, 137, 
    176), ])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.29641 -0.09999 -0.00384  0.09683  0.33452 

Coefficients:
                                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)                        0.501859   0.019923  25.190  < 2e-16 ***
feedbackfeedback                   0.087979   0.028093   3.132  0.00201 ** 
trainingtraining                  -0.197969   0.028484  -6.950 5.60e-11 ***
empathycentered                    0.030659   0.004183   7.330 6.34e-12 ***
yearscentered                     -0.017844   0.003468  -5.146 6.58e-07 ***
feedbackfeedback:trainingtraining  0.088478   0.040074   2.208  0.02845 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1386 on 191 degrees of freedom
Multiple R-squared:  0.4376,	Adjusted R-squared:  0.4228 
F-statistic: 29.72 on 5 and 191 DF,  p-value: < 2.2e-16

q5_coef <- summary(q5)
[1] 112
q5b_coef <- summary(q5b)
[1] 113
compare <- data.frame(round(q5_coef$coefficients[, 2], 5), round(q5_coef$coefficients[, 
    4], 5), round(q5b_coef$coefficients[, 2], 5), round(q5b_coef$coefficients[, 
    4], 5))
[1] 114
colnames(compare) <- c("q5 Coef", "q5 p-value", "q5b Coef", "q5b p-value")
[1] 115
compare

                                  q5 Coef q5 p-value q5b Coef q5b p-value
(Intercept)                       0.02081    0.00000  0.01992     0.00000
feedbackfeedback                  0.02930    0.00391  0.02809     0.00201
trainingtraining                  0.02987    0.00000  0.02848     0.00000
empathycentered                   0.00433    0.00000  0.00418     0.00000
yearscentered                     0.00352    0.00001  0.00347     0.00000
feedbackfeedback:trainingtraining 0.04184    0.02103  0.04007     0.02845


qqPlot(q5)
[1] 117
hist(q5$residuals)
[1] 118
ncvTest(q5)
[1] 119
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 4.398557, Df = 1, p = 0.035969
residualPlots(q5)
[1] 120
durbinWatsonTest(q5)
[1] 121
 lag Autocorrelation D-W Statistic p-value
   1      0.09456969      1.801048    0.18
 Alternative hypothesis: rho != 0
vif(q5)
[1] 122
         feedback          training   empathycentered     yearscentered feedback:training 
         2.007327          2.086826          1.122147          1.092150          3.070068 
q5plot <- lm(incidents ~ feedback + training + feedback * training, 
    data = data)
[1] 123
cat_plot(q5plot, pred = feedback, modx = training)
[1] 124
