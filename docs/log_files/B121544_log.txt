

	####### B121544 R script #######

rm(list = ls())
[1] 1
library("car", quietly = T)
[1] 2
 [1] "car"       "carData"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library("psych", quietly = T)
[1] 3
 [1] "psych"     "car"       "carData"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
library("interactions", quietly = T)
[1] 4
 [1] "interactions" "psych"        "car"          "carData"      "readr"        "stats"        "graphics"     "grDevices"   
 [9] "utils"        "datasets"     "methods"      "base"        
library("stats", quietly = T)
[1] 5
 [1] "interactions" "psych"        "car"          "carData"      "readr"        "stats"        "graphics"     "grDevices"   
 [9] "utils"        "datasets"     "methods"      "base"        
data <- read.csv("~/Desktop/rms2/code_check/RMS2_report_1920.csv")
[1] 6
describe(data)
[1] 7
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training     3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
describe(data)[c(1:4, 8, 9)]
[1] 8
          vars   n   mean    sd  min    max
subject      1 200 100.50 57.88 1.00 200.00
incidents    2 200   0.48  0.19 0.08   0.92
training     3 200   1.50  0.50 1.00   2.00
feedback     4 200   1.50  0.50 1.00   2.00
empathy      5 200  10.18  2.54 3.00  16.00
years        6 200   8.13  3.08 1.00  19.00
data$years_m <- data$years - mean(data$years)
[1] 9
str(data)
[1] 10
'data.frame':	200 obs. of  7 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : int  2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : int  2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
 $ years_m  : num  1.87 -1.13 -3.13 -1.13 3.87 ...
NULL
data$training <- factor(data$training, labels = c("No Training", 
    "Training"))
[1] 11
data$feedback <- factor(data$feedback, labels = c("No Feedback", 
    "Feedback"))
[1] 12
str(data)
[1] 13
'data.frame':	200 obs. of  7 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : Factor w/ 2 levels "No Training",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : Factor w/ 2 levels "No Feedback",..: 2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
 $ years_m  : num  1.87 -1.13 -3.13 -1.13 3.87 ...
NULL
par(mfrow = c(2, 2))
[1] 14
$mfrow
[1] 2 2

m1 <- lm(empathy ~ years_m, data = data)
[1] 15
summary(m1)
[1] 16

Call:
lm(formula = empathy ~ years_m, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 10.17500    0.17347  58.657  < 2e-16 ***
years_m      0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

plot(m1)
[1] 17
shapiro.test(m1$residuals)
[1] 18

	Shapiro-Wilk normality test

data:  m1$residuals
W = 0.98911, p-value = 0.1321

par(mfrow = c(1, 1))
[1] 19
$mfrow
[1] 2 2

qqPlot(m1)
[1] 20
hist <- hist(m1$residuals)
[1] 21
durbinWatsonTest(m1)
[1] 22
 lag Autocorrelation D-W Statistic p-value
   1       0.1017162      1.769879   0.078
 Alternative hypothesis: rho != 0
par(mfrow = c(1, 1))
[1] 23
$mfrow
[1] 1 1

crPlots(m1, main = "Relationship between years experience and Empathy")
[1] 24
ncvTest(m1)
[1] 25
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.9815033, Df = 1, p = 0.32183
residualPlots(m1)
[1] 26
data$years_sq <- (data$years_m)^2
[1] 27
m1.1 <- lm(empathy ~ years_m + years_sq, data = data)
[1] 28
summary(m1.1)
[1] 29

Call:
lm(formula = empathy ~ years_m + years_sq, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept) 11.152696   0.167423  66.614  < 2e-16 ***
years_m      0.383236   0.047986   7.986 1.13e-13 ***
years_sq    -0.103645   0.009861 -10.510  < 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

vif(m1.1)
[1] 30
 years_m years_sq 
1.120963 1.120963 
plot(m1.1, 4)
[1] 31
residualPlots(m1.1)
[1] 32
crPlots(m1.1)
[1] 33
summary(m1.1)
[1] 34

Call:
lm(formula = empathy ~ years_m + years_sq, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept) 11.152696   0.167423  66.614  < 2e-16 ***
years_m      0.383236   0.047986   7.986 1.13e-13 ***
years_sq    -0.103645   0.009861 -10.510  < 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

m2 <- lm(incidents ~ years_m + empathy, data = data)
[1] 35
summary(m2)
[1] 36

Call:
lm(formula = incidents ~ years_m + empathy, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.41333 -0.11682 -0.02057  0.10135  0.46713 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.256755   0.054171   4.740 4.09e-06 ***
years_m     -0.011610   0.004266  -2.722  0.00708 ** 
empathy      0.021449   0.005177   4.143 5.08e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1787 on 197 degrees of freedom
Multiple R-squared:  0.09222,	Adjusted R-squared:  0.08301 
F-statistic: 10.01 on 2 and 197 DF,  p-value: 7.259e-05

m2.1 <- lm(incidents ~ years_m + empathy + training, data = data)
[1] 37
summary(m2.1)
[1] 38

Call:
lm(formula = incidents ~ years_m + empathy + training, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.292813   0.049456   5.921 1.41e-08 ***
years_m          -0.014085   0.003889  -3.622 0.000372 ***
empathy           0.025396   0.004735   5.363 2.29e-07 ***
trainingTraining -0.152427   0.023166  -6.580 4.20e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

plot(m2.1, 4)
[1] 39
shapiro.test(m2.1$residuals)
[1] 40

	Shapiro-Wilk normality test

data:  m2.1$residuals
W = 0.97994, p-value = 0.005838

par(mfrow = c(1, 1))
[1] 41
$mfrow
[1] 1 1

qqPlot(m2.1)
[1] 42
hist <- hist(m2.1$residuals)
[1] 43
durbinWatsonTest(m2.1)
[1] 44
 lag Autocorrelation D-W Statistic p-value
   1      -0.1072849      2.199897   0.164
 Alternative hypothesis: rho != 0
crPlots(m2.1)
[1] 45
ncvTest(m2.1)
[1] 46
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0293323, Df = 1, p = 0.86401
residualPlots(m2.1)
[1] 47
anova(m2)
[1] 48
Analysis of Variance Table

Response: incidents
           Df Sum Sq Mean Sq F value    Pr(>F)    
years_m     1 0.0910 0.09096  2.8482   0.09306 .  
empathy     1 0.5482 0.54821 17.1657 5.082e-05 ***
Residuals 197 6.2914 0.03194                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
anova(m2.1)
[1] 49
Analysis of Variance Table

Response: incidents
           Df Sum Sq Mean Sq F value    Pr(>F)    
years_m     1 0.0910 0.09096  3.4597   0.06438 .  
empathy     1 0.5482 0.54821 20.8509 8.759e-06 ***
training    1 1.1382 1.13821 43.2917 4.200e-10 ***
Residuals 196 5.1532 0.02629                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary(m2.1)
[1] 50

Call:
lm(formula = incidents ~ years_m + empathy + training, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.292813   0.049456   5.921 1.41e-08 ***
years_m          -0.014085   0.003889  -3.622 0.000372 ***
empathy           0.025396   0.004735   5.363 2.29e-07 ***
trainingTraining -0.152427   0.023166  -6.580 4.20e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

m3.1 <- lm(incidents ~ years_m + empathy + training + feedback, 
    data = data)
[1] 51
summary(m3.1)
[1] 52

Call:
lm(formula = incidents ~ years_m + empathy + training + feedback, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.31626 -0.10096 -0.00949  0.09165  0.46650 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.208388   0.047005   4.433 1.55e-05 ***
years_m          -0.015199   0.003551  -4.281 2.92e-05 ***
empathy           0.027191   0.004328   6.283 2.12e-09 ***
trainingTraining -0.153824   0.021128  -7.281 7.98e-12 ***
feedbackFeedback  0.133715   0.020968   6.377 1.28e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1479 on 195 degrees of freedom
Multiple R-squared:  0.3848,	Adjusted R-squared:  0.3721 
F-statistic: 30.49 on 4 and 195 DF,  p-value: < 2.2e-16

shapiro.test(m3.1$residuals)
[1] 53

	Shapiro-Wilk normality test

data:  m3.1$residuals
W = 0.98734, p-value = 0.07172

par(mfrow = c(1, 1))
[1] 54
$mfrow
[1] 1 1

qqPlot(m3.1)
[1] 55
hist <- hist(m3.1$residuals)
[1] 56
durbinWatsonTest(m3.1)
[1] 57
 lag Autocorrelation D-W Statistic p-value
   1      0.07303546      1.841386   0.284
 Alternative hypothesis: rho != 0
crPlots(m3.1)
[1] 58
ncvTest(m3.1)
[1] 59
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 3.684027, Df = 1, p = 0.054936
residualPlots(m3.1)
[1] 60
anova(m3.1)
[1] 61
Analysis of Variance Table

Response: incidents
           Df Sum Sq Mean Sq F value    Pr(>F)    
years_m     1 0.0910 0.09096  4.1599   0.04274 *  
empathy     1 0.5482 0.54821 25.0708 1.233e-06 ***
training    1 1.1382 1.13821 52.0533 1.169e-11 ***
feedback    1 0.8892 0.88925 40.6676 1.279e-09 ***
Residuals 195 4.2639 0.02187                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
AIC(m2.1, m3.1)
[1] 62
     df       AIC
m2.1  5 -154.1654
m3.1  6 -190.0499
BIC(m2.1, m3.1)
[1] 63
     df       BIC
m2.1  5 -137.6738
m3.1  6 -170.2600
levels(data$training) <- c(0, 1)
[1] 64
levels(data$feedback) <- c(0, 1)
[1] 65
data$training <- as.numeric(levels(data$training))[data$training]
[1] 66
data$feedback <- as.numeric(levels(data$feedback))[data$feedback]
[1] 67
m5 <- lm(incidents ~ years_m + empathy + training + feedback + 
    training * feedback, data = data)
[1] 68
summary(m5)
[1] 69

Call:
lm(formula = incidents ~ years_m + empathy + training + feedback + 
    training * feedback, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30367 -0.10365 -0.00795  0.08806  0.44359 

Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)        0.217665   0.046653   4.666 5.72e-06 ***
years_m           -0.015720   0.003518  -4.468 1.34e-05 ***
empathy            0.028695   0.004328   6.630 3.25e-10 ***
training          -0.203496   0.029874  -6.812 1.18e-10 ***
feedback           0.085558   0.029299   2.920  0.00391 ** 
training:feedback  0.097334   0.041840   2.326  0.02103 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1462 on 194 degrees of freedom
Multiple R-squared:  0.4015,	Adjusted R-squared:  0.386 
F-statistic: 26.02 on 5 and 194 DF,  p-value: < 2.2e-16

shapiro.test(m5$residuals)
[1] 70

	Shapiro-Wilk normality test

data:  m5$residuals
W = 0.98794, p-value = 0.08817

par(mfrow = c(1, 1))
[1] 71
$mfrow
[1] 1 1

qqPlot(m5)
[1] 72
hist <- hist(m5$residuals)
[1] 73
durbinWatsonTest(m5)
[1] 74
 lag Autocorrelation D-W Statistic p-value
   1      0.09456969      1.801048   0.162
 Alternative hypothesis: rho != 0
residualPlots(m5)
[1] 75
-m5$coefficients[2]/m5$coefficients[4]
[1] 76
    years_m 
-0.07724861 
-m5$coefficients[3]/m5$coefficients[4]
[1] 77
  empathy 
0.1410093 
interact_plot(m5, pred = training, modx = feedback, plot.points = TRUE, 
    x.label = "No training -> training", y.label = "Incidents", 
    legend.main = "1=Feedback\n              0=No Feedback")
[1] 78
sim_slopes(m5, pred = training, modx = feedback, johnson_neyman = FALSE, 
    cond.int = TRUE)
[1] 79
SIMPLE SLOPES ANALYSIS 

When feedback = 0.00 (0): 

                               Est.   S.E.   t val.      p
--------------------------- ------- ------ -------- ------
Slope of training             -0.20   0.03    -6.81   0.00
Conditional intercept          0.41   0.01    27.86   0.00

When feedback = 1.00 (1): 

                               Est.   S.E.   t val.      p
--------------------------- ------- ------ -------- ------
Slope of training             -0.11   0.03    -3.63   0.00
Conditional intercept          0.54   0.01    37.02   0.00

