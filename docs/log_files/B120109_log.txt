

	####### B120109 R script #######

library(psych, quietly = T)
[1] 1
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 2
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
library(agricolae, quietly = T)
[1] 3
 [1] "agricolae" "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[11] "methods"   "base"     
library(lsr, quietly = T)
[1] 4
 [1] "lsr"       "agricolae" "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"    
[11] "datasets"  "methods"   "base"     
library(interactions, quietly = T)
[1] 5
 [1] "interactions" "lsr"          "agricolae"    "car"          "carData"      "psych"        "readr"        "stats"       
 [9] "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
library(jtools, quietly = T)
[1] 6
 [1] "jtools"       "interactions" "lsr"          "agricolae"    "car"          "carData"      "psych"        "readr"       
 [9] "stats"        "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
library(sandwich, quietly = T)
[1] 7
 [1] "sandwich"     "jtools"       "interactions" "lsr"          "agricolae"    "car"          "carData"      "psych"       
 [9] "readr"        "stats"        "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
library(gplots, quietly = T)
[1] 8
 [1] "gplots"       "sandwich"     "jtools"       "interactions" "lsr"          "agricolae"    "car"          "carData"     
 [9] "psych"        "readr"        "stats"        "graphics"     "grDevices"    "utils"        "datasets"     "methods"     
[17] "base"        
report <- read.csv("~/Desktop/rms2/code_check/RMS2_report_1920.csv")
[1] 9
summary(report)
[1] 10
    subject         incidents          training      feedback      empathy          years      
 Min.   :  1.00   Min.   :0.08333   Min.   :1.0   Min.   :1.0   Min.   : 3.00   Min.   : 1.00  
 1st Qu.: 50.75   1st Qu.:0.33333   1st Qu.:1.0   1st Qu.:1.0   1st Qu.: 9.00   1st Qu.: 6.00  
 Median :100.50   Median :0.41667   Median :1.5   Median :1.5   Median :10.00   Median : 8.00  
 Mean   :100.50   Mean   :0.47500   Mean   :1.5   Mean   :1.5   Mean   :10.18   Mean   : 8.13  
 3rd Qu.:150.25   3rd Qu.:0.58333   3rd Qu.:2.0   3rd Qu.:2.0   3rd Qu.:12.00   3rd Qu.:10.00  
 Max.   :200.00   Max.   :0.91667   Max.   :2.0   Max.   :2.0   Max.   :16.00   Max.   :19.00  
describe(report)
[1] 11
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training     3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
report$subject
[1] 12
 [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
[41] 41 42 43 44 45 46 47 48 49 50
 [ reached getOption("max.print") -- omitted 150 entries ]
report$incidents
[1] 13
 [1] 0.66666667 0.33333333 0.33333333 0.41666667 0.50000000 0.25000000 0.83333333 0.41666667 0.50000000 0.16666667
[11] 0.75000000 0.33333333 0.91666667 0.50000000 0.58333333 0.16666667 0.16666667 0.33333333 0.75000000 0.41666667
[21] 0.16666667 0.41666667 0.41666667 0.58333333 0.41666667 0.25000000 0.50000000 0.33333333 0.41666667 0.08333333
[31] 0.33333333 0.50000000 0.33333333 0.41666667 0.75000000 0.41666667 0.50000000 0.58333333 0.58333333 0.16666667
[41] 0.66666667 0.41666667 0.33333333 0.25000000 0.41666667 0.25000000 0.58333333 0.58333333 0.50000000 0.16666667
 [ reached getOption("max.print") -- omitted 150 entries ]
describe(report$incidents)
[1] 14
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 200 0.48 0.19   0.42    0.47 0.12 0.08 0.92  0.83 0.32    -0.31 0.01
describe(report$training)
[1] 15
   vars   n mean  sd median trimmed  mad min max range skew kurtosis   se
X1    1 200  1.5 0.5    1.5     1.5 0.74   1   2     1    0    -2.01 0.04
is.factor(report$training)
[1] 16
[1] FALSE
report$training <- as.factor(report$training)
[1] 17
report$training <- factor(report$training, labels = c("no training", 
    "training"))
[1] 18
report$feedback <- as.factor(report$feedback)
[1] 19
report$feedback <- factor(report$feedback, labels = c("no feedback", 
    "feedback"))
[1] 20
str(report)
[1] 21
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : Factor w/ 2 levels "no training",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : Factor w/ 2 levels "no feedback",..: 2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
describe(report$empathy)
[1] 22
   vars   n  mean   sd median trimmed  mad min max range  skew kurtosis   se
X1    1 200 10.18 2.54     10   10.24 2.97   3  16    13 -0.37     0.23 0.18
describe(report$years)
[1] 23
   vars   n mean   sd median trimmed  mad min max range skew kurtosis   se
X1    1 200 8.13 3.08      8    7.97 2.97   1  19    18 0.52     0.48 0.22
plot(report$empathy ~ report$years)
[1] 24
hist(report$empathy, ylab = "Percentage of teachers", xlab = "Empathy score", 
    main = "Histogram of empathy scores")
[1] 25
hist(report$years, main = "Histogram of years of experience", 
    ylab = "Number of teachers", xlab = "Years of experience")
[1] 26
hist(report$incidents, main = "Histogram of interference in bulying", 
    ylab = "Percentage of teachers", xlab = "Percentage of interference")
[1] 27
empathy1 <- (report$empathy - mean(report$empathy))
[1] 28
years1 <- (report$years - mean(report$years))
[1] 29
years2 <- years1^2
[1] 30
lm1 <- lm(report$empathy ~ report$years)
[1] 31
summary(lm1)
[1] 32

Call:
lm(formula = report$empathy ~ report$years)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)   8.40625    0.49085  17.126  < 2e-16 ***
report$years  0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

par(mfrow = c(2, 2))
[1] 33
$mfrow
[1] 1 1

plot(lm1, which = c(2:5))
[1] 34
plot(lm1, which = c(4:5))
[1] 35
qqPlot(lm1)
[1] 36
shapiro.test(lm1$residuals)
[1] 37

	Shapiro-Wilk normality test

data:  lm1$residuals
W = 0.98911, p-value = 0.1321

residualPlots(lm1)
[1] 38
ncvTest(lm1)
[1] 39
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.9815033, Df = 1, p = 0.32183
crPlots(lm1)
[1] 40
plot(cooks.distance(lm1))
[1] 41
which(cooks.distance(lm1) > (4/(200 - 1 - 1)))
[1] 42
 16  61  88  89  94 108 137 141 154 163 171 175 192 200 
 16  61  88  89  94 108 137 141 154 163 171 175 192 200 
stdz <- MASS::studres(lm1)
[1] 43
which(abs(stdz) > 2)
[1] 44
 61  68  70  88  89 137 141 142 154 175 200 
 61  68  70  88  89 137 141 142 154 175 200 
hats <- hatvalues(lm1)
[1] 45
which((hats) > 2 * mean(hats))
[1] 46
 61  88  89  92  94 108 109 116 131 137 140 141 154 155 163 190 200 
 61  88  89  92  94 108 109 116 131 137 140 141 154 155 163 190 200 
hist(lm1$residuals)
[1] 47
abline(lm1)
[1] 48
lm1.1 <- lm(empathy1 ~ report$years + I(years1^2))
[1] 49
crPlots(lm1.1)
[1] 50
residualPlots(lm1.1)
[1] 51
shapiro.test(lm1.1$residuals)
[1] 52

	Shapiro-Wilk normality test

data:  lm1.1$residuals
W = 0.9941, p-value = 0.6155

summary(lm1.1)
[1] 53

Call:
lm(formula = empathy1 ~ report$years + I(years1^2))

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  -2.138015   0.395457  -5.406 1.85e-07 ***
report$years  0.383236   0.047986   7.986 1.13e-13 ***
I(years1^2)  -0.103645   0.009861 -10.510  < 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

ncvTest(lm1)
[1] 54
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.9815033, Df = 1, p = 0.32183
plot(lm1.1, which = c(4:5))
[1] 55
durbinWatsonTest(lm1.1)
[1] 56
 lag Autocorrelation D-W Statistic p-value
   1      0.01288905      1.973855   0.822
 Alternative hypothesis: rho != 0
AIC(lm1, lm1.1)
[1] 57
      df      AIC
lm1    3 930.5187
lm1.1  4 843.4851
plot(report$years, report$empathy)
[1] 58
summ(lm1.1)
[1] 59
MODEL INFO:
Observations: 200
Dependent Variable: empathy1
Type: OLS linear regression 

MODEL FIT:
F(2,197) = 66.75, p = 0.00
R² = 0.40
Adj. R² = 0.40 

Standard errors: OLS
-------------------------------------------------
                      Est.   S.E.   t val.      p
------------------ ------- ------ -------- ------
(Intercept)          -2.14   0.40    -5.41   0.00
report$years          0.38   0.05     7.99   0.00
I(years1^2)          -0.10   0.01   -10.51   0.00
-------------------------------------------------
contrasts(report$training) <- contr.treatment
[1] 60
contrasts(report$feedback) <- contr.treatment
[1] 61
incident <- log(report$incidents + (-1 * min(report$incidents) + 
    1))
[1] 62
hist(incident)
[1] 63
lm2 <- lm(incident ~ empathy1 + years1 + training, data = report)
[1] 64
summary(lm2)
[1] 65

Call:
lm(formula = incident ~ empathy1 + years1 + training, data = report)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.27676 -0.08678 -0.00271  0.07438  0.35035 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.377249   0.011606  32.504  < 2e-16 ***
empathy1     0.018550   0.003372   5.501 1.17e-07 ***
years1      -0.010283   0.002769  -3.713 0.000266 ***
training2   -0.111288   0.016497  -6.746 1.67e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1155 on 196 degrees of freedom
Multiple R-squared:  0.2661,	Adjusted R-squared:  0.2549 
F-statistic: 23.69 on 3 and 196 DF,  p-value: 3.963e-13

plot(lm2, which = (2:5))
[1] 66
qqPlot(lm2)
[1] 67
shapiro.test(lm2$residuals)
[1] 68

	Shapiro-Wilk normality test

data:  lm2$residuals
W = 0.9905, p-value = 0.2109

residualPlots(lm2)
[1] 69
ncvTest(lm2)
[1] 70
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 1.036059, Df = 1, p = 0.30874
crPlots(lm2)
[1] 71
durbinWatsonTest(lm2)
[1] 72
 lag Autocorrelation D-W Statistic p-value
   1       -0.116516      2.217742   0.138
 Alternative hypothesis: rho != 0
vif(lm2)
[1] 73
empathy1   years1 training 
1.092467 1.085089 1.020633 
hist(lm2$residuals)
[1] 74
effect_plot(lm2, pred = training)
[1] 75
summ(lm2)
[1] 76
MODEL INFO:
Observations: 200
Dependent Variable: incident
Type: OLS linear regression 

MODEL FIT:
F(3,196) = 23.69, p = 0.00
R² = 0.27
Adj. R² = 0.25 

Standard errors: OLS
------------------------------------------------
                     Est.   S.E.   t val.      p
----------------- ------- ------ -------- ------
(Intercept)          0.38   0.01    32.50   0.00
empathy1             0.02   0.00     5.50   0.00
years1              -0.01   0.00    -3.71   0.00
training2           -0.11   0.02    -6.75   0.00
------------------------------------------------
lm3 <- lm(incident ~ empathy1 + years1 + feedback, data = report)
[1] 77
summary(lm3)
[1] 78

Call:
lm(formula = incident ~ empathy1 + years1 + feedback, data = report)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.27663 -0.07576 -0.00237  0.08302  0.35261 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.273797   0.011893  23.021  < 2e-16 ***
empathy1     0.016926   0.003448   4.909 1.92e-06 ***
years1      -0.009257   0.002839  -3.261  0.00131 ** 
feedback2    0.095615   0.016841   5.677 4.87e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1188 on 196 degrees of freedom
Multiple R-squared:  0.2235,	Adjusted R-squared:  0.2116 
F-statistic:  18.8 on 3 and 196 DF,  p-value: 9.283e-11

plot(cooks.distance(lm3))
[1] 79
plot(lm3, which = 5)
[1] 80
hats1 <- hatvalues(lm3)
[1] 81
which((hats1) > 2 * mean(hats1))
[1] 82
 61  88  89  92 137 141 154 163 175 200 
 61  88  89  92 137 141 154 163 175 200 
plot(lm3, which = (2:5))
[1] 83
qqPlot(lm3)
[1] 84
shapiro.test(lm3$residuals)
[1] 85

	Shapiro-Wilk normality test

data:  lm3$residuals
W = 0.99572, p-value = 0.8487

residualPlots(lm3)
[1] 86
ncvTest(lm3)
[1] 87
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.6746094, Df = 1, p = 0.41145
crPlots(lm3)
[1] 88
vif(lm3)
[1] 89
empathy1   years1 feedback 
1.079397 1.077467 1.005211 
durbinWatsonTest(lm3)
[1] 90
 lag Autocorrelation D-W Statistic p-value
   1       0.2794347      1.431864       0
 Alternative hypothesis: rho != 0
summ(lm3)
[1] 91
MODEL INFO:
Observations: 200
Dependent Variable: incident
Type: OLS linear regression 

MODEL FIT:
F(3,196) = 18.80, p = 0.00
R² = 0.22
Adj. R² = 0.21 

Standard errors: OLS
------------------------------------------------
                     Est.   S.E.   t val.      p
----------------- ------- ------ -------- ------
(Intercept)          0.27   0.01    23.02   0.00
empathy1             0.02   0.00     4.91   0.00
years1              -0.01   0.00    -3.26   0.00
feedback2            0.10   0.02     5.68   0.00
------------------------------------------------
BIC(lm2, lm3)
[1] 92
    df       BIC
lm2  5 -273.4824
lm3  5 -262.1757
AIC(lm2, lm3)
[1] 93
    df       AIC
lm2  5 -289.9740
lm3  5 -278.6673
lm4 <- lm(incident ~ empathy1 + years1 + training * feedback, 
    data = report)
[1] 94
summary(lm4)
[1] 95

Call:
lm(formula = incident ~ empathy1 + years1 + training * feedback, 
    data = report)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.226383 -0.071808 -0.000811  0.069089  0.284822 

Coefficients:
                     Estimate Std. Error t value Pr(>|t|)    
(Intercept)          0.348968   0.014712  23.720  < 2e-16 ***
empathy1             0.021048   0.003060   6.878 8.14e-11 ***
years1              -0.011505   0.002488  -4.625 6.84e-06 ***
training2           -0.151903   0.021123  -7.191 1.36e-11 ***
feedback2            0.058376   0.020716   2.818  0.00533 ** 
training2:feedback2  0.077604   0.029583   2.623  0.00940 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1034 on 194 degrees of freedom
Multiple R-squared:  0.4176,	Adjusted R-squared:  0.4026 
F-statistic: 27.82 on 5 and 194 DF,  p-value: < 2.2e-16

plot(lm4, which = (2:5))
[1] 96
qqPlot(lm4)
[1] 97
shapiro.test(lm4$residuals)
[1] 98

	Shapiro-Wilk normality test

data:  lm4$residuals
W = 0.99434, p-value = 0.6515

residualPlots(lm4)
[1] 99
ncvTest(lm4)
[1] 100
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.577295, Df = 1, p = 0.44737
durbinWatsonTest(lm4)
[1] 101
 lag Autocorrelation D-W Statistic p-value
   1      0.09726586      1.794988   0.166
 Alternative hypothesis: rho != 0
vif(lm4)
[1] 102
         empathy1            years1          training          feedback training:feedback 
         1.122147          1.092150          2.086826          2.007327          3.070068 
cat_plot(lm4, pred = training, modx = feedback, plot.points = TRUE)
[1] 103
summ(lm4)
[1] 104
MODEL INFO:
Observations: 200
Dependent Variable: incident
Type: OLS linear regression 

MODEL FIT:
F(5,194) = 27.82, p = 0.00
R² = 0.42
Adj. R² = 0.40 

Standard errors: OLS
--------------------------------------------------------
                             Est.   S.E.   t val.      p
------------------------- ------- ------ -------- ------
(Intercept)                  0.35   0.01    23.72   0.00
empathy1                     0.02   0.00     6.88   0.00
years1                      -0.01   0.00    -4.62   0.00
training2                   -0.15   0.02    -7.19   0.00
feedback2                    0.06   0.02     2.82   0.01
training2:feedback2          0.08   0.03     2.62   0.01
--------------------------------------------------------
vcov(lm4)
[1] 105
                      (Intercept)      empathy1        years1     training2     feedback2 training2:feedback2
(Intercept)          2.164386e-04  4.812323e-06 -2.068507e-06 -2.207891e-04 -2.156982e-04        2.210213e-04
empathy1             4.812323e-06  9.365326e-06 -2.139958e-06 -1.258128e-05 -3.805039e-06        1.352334e-05
years1              -2.068507e-06 -2.139958e-06  6.188393e-06  5.952482e-06  5.274789e-07       -4.685893e-06
training2           -2.207891e-04 -1.258128e-05  5.952482e-06  4.461657e-04  2.187281e-04       -4.466310e-04
feedback2           -2.156982e-04 -3.805039e-06  5.274789e-07  2.187281e-04  4.291687e-04       -4.330008e-04
training2:feedback2  2.210213e-04  1.352334e-05 -4.685893e-06 -4.466310e-04 -4.330008e-04        8.751786e-04
