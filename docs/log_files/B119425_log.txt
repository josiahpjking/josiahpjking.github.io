

	####### B119425 R script #######

datay <- read.csv("~/Desktop/rms2/code_check/RMS2_report_1920.csv")
[1] 1
install.packages("car")
[1] 2
install.packages("psych")
[1] 3
install.packages("ez")
[1] 4
install.packages("interactions")
[1] 5
install.packages("sandwich")
[1] 6
install.packages("stR")
[1] 7
library(car, quietly = T)
[1] 8
 [1] "car"       "carData"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(psych, quietly = T)
[1] 9
 [1] "psych"     "car"       "carData"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
library(ez, quietly = T)
[1] 10
 [1] "ez"        "psych"     "car"       "carData"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[11] "methods"   "base"     
library(interactions, quietly = T)
[1] 11
 [1] "interactions" "ez"           "psych"        "car"          "carData"      "readr"        "stats"        "graphics"    
 [9] "grDevices"    "utils"        "datasets"     "methods"      "base"        
library(sandwich, quietly = T)
[1] 12
 [1] "sandwich"     "interactions" "ez"           "psych"        "car"          "carData"      "readr"        "stats"       
 [9] "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
library(stR, quietly = T)
[1] 13
[1] "Error in library(stR, quietly = T) : there is no package called ‘stR’\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<packageNotFoundError in library(stR, quietly = T): there is no package called ‘stR’>


####################################################################################################

[1] "Error in library(stR, quietly = T) : there is no package called ‘stR’\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<packageNotFoundError in library(stR, quietly = T): there is no package called ‘stR’>
####################################################################################################


M1 <- lm(empathy ~ years, data = datay)
[1] 14
summary(M1)
[1] 15

Call:
lm(formula = empathy ~ years, data = datay)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  8.40625    0.49085  17.126  < 2e-16 ***
years        0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

plot(datay$empathy ~ datay$years, main = "Relationship between experience and empathy", 
    xlab = "Years of experience", ylab = "Empathy level")
[1] 16
abline(M1)
[1] 17
line(datay$empathy ~ datay$years)
[1] 18
cor(datay$empathy, datay$years, method = "spearman")
[1] 19
[1] 0.3071045
hist(datay$empathy, main = "Histogram to show distribution of empathy", 
    xlab = "Empathy")
[1] 20
boxplot(datay$empathy, datay$years, data = datay, main = "Outliers for empathy and years of experience", 
    xlab = "Empathy and Years", col = "red")
[1] 21
M1a <- lm(empathy ~ years, data = datay[-c(137, 154)])
[1] 22
summary(M1a)
[1] 23

Call:
lm(formula = empathy ~ years, data = datay[-c(137, 154)])

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  8.40625    0.49085  17.126  < 2e-16 ***
years        0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

ncvTest(M1)
[1] 24
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.9815033, Df = 1, p = 0.32183
crPlots(model = M1, main = "Assumption check for linearity")
[1] 25
log(datay$years, base = 10)
[1] 26
 [1] 1.0000000 0.8450980 0.6989700 0.8450980 1.0791812 1.0000000 0.9030900 1.0000000 0.8450980 0.9542425 0.7781513 1.0413927
[13] 0.8450980 0.8450980 0.8450980 0.4771213 1.1139434 0.8450980 0.6989700 1.0791812 1.0413927 0.6020600 0.9030900 0.8450980
[25] 0.8450980 0.7781513 0.8450980 0.8450980 0.7781513 0.6989700 0.8450980 0.9030900 0.6989700 0.9542425 1.1139434 0.6989700
[37] 0.6020600 0.6989700 1.0413927 0.6989700 0.6989700 0.9542425 1.0791812 0.6020600 0.6989700 0.9030900 0.7781513 0.7781513
[49] 0.7781513 0.6020600
 [ reached getOption("max.print") -- omitted 150 entries ]
hist(log(datay$years, base = 10))
[1] 27
M1b <- lm(empathy ~ log(datay$years, base = 10), data = datay)
[1] 28
crPlots(model = M1b, main = "Plot to show relationship between empathy and experience", 
    xlab = "Years", ylab = "Empathy")
[1] 29
shapiro.test(datay$empathy)
[1] 30

	Shapiro-Wilk normality test

data:  datay$empathy
W = 0.97073, p-value = 0.0003477

residualPlot(M1, main = "Residuals distribution")
[1] 31
qqPlot(M1)
[1] 32
residualPlot(M1, main = "Residuals distribution before log transformation")
[1] 33
residualPlot(M1b, main = "Residuals distribution after log transformation")
[1] 34
qqPlot(M1b)
[1] 35
hist(M1$residuals, main = "Histogam to show distribution of residuals before log transformation")
[1] 36
hist(M1b$residuals, main = "Histogam to show distribution of residuals after log transformation")
[1] 37
M2 <- lm(incidents ~ training + empathy + years, data = datay)
[1] 38
summary(M2)
[1] 39

Call:
lm(formula = incidents ~ training + empathy + years, data = datay)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.559747   0.060141   9.307  < 2e-16 ***
training    -0.152427   0.023166  -6.580 4.20e-10 ***
empathy      0.025396   0.004735   5.363 2.29e-07 ***
years       -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

as.factor(datay$training)
[1] 40
 [1] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
 [ reached getOption("max.print") -- omitted 150 entries ]
Levels: 1 2
anova(lm(datay$incidents ~ as.factor(datay$training)))
[1] 41
Analysis of Variance Table

Response: datay$incidents
                           Df Sum Sq Mean Sq F value    Pr(>F)    
as.factor(datay$training)   1 0.8889 0.88889  29.131 1.922e-07 ***
Residuals                 198 6.0417 0.03051                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
str(datay)
[1] 42
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : int  2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : int  2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
datay$training <- factor(datay$training, labels = c("no training", 
    "training"))
[1] 43
crPlots(model = M2)
[1] 44
shapiro.test(M2$residuals)
[1] 45

	Shapiro-Wilk normality test

data:  M2$residuals
W = 0.97994, p-value = 0.005838

qqPlot(M2)
[1] 46
residualPlot(M2, main = "Residual plot for question 2")
[1] 47
durbinWatsonTest(M2)
[1] 48
 lag Autocorrelation D-W Statistic p-value
   1      -0.1072849      2.199897    0.17
 Alternative hypothesis: rho != 0
ncvTest(M2)
[1] 49
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0293323, Df = 1, p = 0.86401
vif(M2)
[1] 50
training  empathy    years 
1.020633 1.092467 1.085089 
plot(cooks.distance(M2), main = "Cooks distance plot")
[1] 51
abline(h = cooks.distance(M2) > (4/(200 - 3 - 1)), col = "red")
[1] 52
which(cooks.distance(M2) > (4/(200 - 3 - 1)))
[1] 53
 13  35  74 137 165 
 13  35  74 137 165 
plot(M2, which = 4, main = "Cooks distance to search for outliers in Question 2")
[1] 54
M2a <- lm(incidents ~ training + empathy + years, data = datay[-c(13, 
    74, 137)])
[1] 55
summary(M2a)
[1] 56

Call:
lm(formula = incidents ~ training + empathy + years, data = datay[-c(13, 
    74, 137)])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.407320   0.051814   7.861 2.48e-13 ***
trainingtraining -0.152427   0.023166  -6.580 4.20e-10 ***
empathy           0.025396   0.004735   5.363 2.29e-07 ***
years            -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

datay$feedback <- factor(datay$feedback, labels = c("no feedback", 
    "feedback"))
[1] 57
summary(datay)
[1] 58
    subject         incidents              training          feedback      empathy          years      
 Min.   :  1.00   Min.   :0.08333   no training:100   no feedback:100   Min.   : 3.00   Min.   : 1.00  
 1st Qu.: 50.75   1st Qu.:0.33333   training   :100   feedback   :100   1st Qu.: 9.00   1st Qu.: 6.00  
 Median :100.50   Median :0.41667                                       Median :10.00   Median : 8.00  
 Mean   :100.50   Mean   :0.47500                                       Mean   :10.18   Mean   : 8.13  
 3rd Qu.:150.25   3rd Qu.:0.58333                                       3rd Qu.:12.00   3rd Qu.:10.00  
 Max.   :200.00   Max.   :0.91667                                       Max.   :16.00   Max.   :19.00  
contrasts(datay$feedback)
[1] 59
            feedback
no feedback        0
feedback           1
summary(lm(incidents ~ feedback + empathy + years, data = datay))
[1] 60

Call:
lm(formula = incidents ~ feedback + empathy + years, data = datay)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.276161   0.054108   5.104 7.84e-07 ***
feedbackfeedback  0.132132   0.023585   5.602 7.09e-08 ***
empathy           0.023187   0.004829   4.802 3.11e-06 ***
years            -0.012689   0.003975  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

M3 <- lm(incidents ~ training + empathy + years + feedback, data = datay)
[1] 61
summary(M3)
[1] 62

Call:
lm(formula = incidents ~ training + empathy + years + feedback, 
    data = datay)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.31626 -0.10096 -0.00949  0.09165  0.46650 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.331953   0.048708   6.815 1.15e-10 ***
trainingtraining -0.153824   0.021128  -7.281 7.98e-12 ***
empathy           0.027191   0.004328   6.283 2.12e-09 ***
years            -0.015199   0.003551  -4.281 2.92e-05 ***
feedbackfeedback  0.133715   0.020968   6.377 1.28e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1479 on 195 degrees of freedom
Multiple R-squared:  0.3848,	Adjusted R-squared:  0.3721 
F-statistic: 30.49 on 4 and 195 DF,  p-value: < 2.2e-16

as.factor(datay$feedback)
[1] 63
 [1] feedback    no feedback feedback    no feedback feedback    no feedback feedback    no feedback feedback    no feedback
[11] feedback    no feedback feedback    no feedback feedback    no feedback feedback    no feedback feedback    no feedback
[21] feedback    no feedback feedback    no feedback feedback    no feedback feedback    no feedback feedback    no feedback
[31] feedback    no feedback feedback    no feedback feedback    no feedback feedback    no feedback feedback    no feedback
[41] feedback    no feedback feedback    no feedback feedback    no feedback feedback    no feedback feedback    no feedback
 [ reached getOption("max.print") -- omitted 150 entries ]
Levels: no feedback feedback
str(datay)
[1] 64
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : Factor w/ 2 levels "no training",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : Factor w/ 2 levels "no feedback",..: 2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
crPlots(M3)
[1] 65
durbinWatsonTest(M3)
[1] 66
 lag Autocorrelation D-W Statistic p-value
   1      0.07303546      1.841386   0.278
 Alternative hypothesis: rho != 0
vif(M3)
[1] 67
training  empathy    years feedback 
1.020743 1.097109 1.087722 1.005320 
hist(M3$residuals)
[1] 68
shapiro.test(M3$residuals)
[1] 69

	Shapiro-Wilk normality test

data:  M3$residuals
W = 0.98734, p-value = 0.07172

qqPlot(M3)
[1] 70
residualPlot(M3, main = "Residual plot")
[1] 71
ncvTest(M3)
[1] 72
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 3.684027, Df = 1, p = 0.054936
plot(cooks.distance(M3), main = "Cooks distance plot")
[1] 73
abline(h = cooks.distance(M3) > (4/(200 - 4 - 1)), col = "red")
[1] 74
which(cooks.distance(M3) > (4/(200 - 4 - 1)))
[1] 75
 13  35  74 117 131 137 141 156 160 176 
 13  35  74 117 131 137 141 156 160 176 
plot(M3, which = 4, main = "Cooks distance to search for outliers")
[1] 76
M3a <- lm(incidents ~ training + empathy + years + feedback, 
    data = datay[-c(13, 137, 176)])
[1] 77
summary(M3a)
[1] 78

Call:
lm(formula = incidents ~ training + empathy + years + feedback, 
    data = datay[-c(13, 137, 176)])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.31626 -0.10096 -0.00949  0.09165  0.46650 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.331953   0.048708   6.815 1.15e-10 ***
trainingtraining -0.153824   0.021128  -7.281 7.98e-12 ***
empathy           0.027191   0.004328   6.283 2.12e-09 ***
years            -0.015199   0.003551  -4.281 2.92e-05 ***
feedbackfeedback  0.133715   0.020968   6.377 1.28e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1479 on 195 degrees of freedom
Multiple R-squared:  0.3848,	Adjusted R-squared:  0.3721 
F-statistic: 30.49 on 4 and 195 DF,  p-value: < 2.2e-16

AIC(M2, M3)
[1] 79
   df       AIC
M2  5 -154.1654
M3  6 -190.0499
BIC(M2, M3)
[1] 80
   df       BIC
M2  5 -137.6738
M3  6 -170.2600
anova(M2, M3)
[1] 81
Analysis of Variance Table

Model 1: incidents ~ training + empathy + years
Model 2: incidents ~ training + empathy + years + feedback
  Res.Df    RSS Df Sum of Sq      F    Pr(>F)    
1    196 5.1532                                  
2    195 4.2639  1   0.88925 40.668 1.279e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
contrasts(datay$training) <- contr.treatment(2, base = 1, contrasts = TRUE, 
    sparse = FALSE)
[1] 82
contrasts(datay$feedback) <- contr.treatment(2, base = 1, contrasts = TRUE, 
    sparse = FALSE)
[1] 83
str(datay)
[1] 84
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : Factor w/ 2 levels "no training",..: 2 2 2 2 2 2 2 2 2 2 ...
  ..- attr(*, "contrasts")= num [1:2, 1] 0 1
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr  "no training" "training"
  .. .. ..$ : chr "2"
 $ feedback : Factor w/ 2 levels "no feedback",..: 2 1 2 1 2 1 2 1 2 1 ...
  ..- attr(*, "contrasts")= num [1:2, 1] 0 1
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr  "no feedback" "feedback"
  .. .. ..$ : chr "2"
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
M5 <- lm(incidents ~ training + feedback + training * feedback, 
    data = datay)
[1] 85
summary(M5)
[1] 86

Call:
lm(formula = incidents ~ training + feedback + training * feedback, 
    data = datay)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40000 -0.10500  0.00000  0.08333  0.43333 

Coefficients:
                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)          0.49333    0.02314  21.323  < 2e-16 ***
training2           -0.16000    0.03272  -4.890 2.09e-06 ***
feedback2            0.09667    0.03272   2.954  0.00352 ** 
training2:feedback2  0.05333    0.04627   1.153  0.25047    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1636 on 196 degrees of freedom
Multiple R-squared:  0.2431,	Adjusted R-squared:  0.2315 
F-statistic: 20.99 on 3 and 196 DF,  p-value: 7.827e-12

residualPlot(M5)
[1] 87
cat_plot(M5, pred = training, modx = feedback, plot.points = TRUE)
[1] 88
M5a <- lm(incidents ~ training + feedback, data = datay)
[1] 89
summary(M5a)
[1] 90

Call:
lm(formula = incidents ~ training + feedback, data = datay)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.38667 -0.11167 -0.01333  0.07000  0.44667 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.48000    0.02005  23.937  < 2e-16 ***
training2   -0.13333    0.02315  -5.758 3.22e-08 ***
feedback2    0.12333    0.02315   5.326 2.72e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1637 on 197 degrees of freedom
Multiple R-squared:  0.238,	Adjusted R-squared:  0.2303 
F-statistic: 30.76 on 2 and 197 DF,  p-value: 2.359e-12

M5b <- aov(incidents ~ training + feedback, data = datay)
[1] 91
summary(M5b)
[1] 92
             Df Sum Sq Mean Sq F value   Pr(>F)    
training      1  0.889  0.8889   33.16 3.22e-08 ***
feedback      1  0.761  0.7606   28.37 2.72e-07 ***
Residuals   197  5.281  0.0268                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
