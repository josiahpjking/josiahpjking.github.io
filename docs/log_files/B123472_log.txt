

	####### B123472 R script #######

install.packages("psych")
[1] 1
install.packages("car")
[1] 2
install.packages("interactions")
[1] 3
install.packages("ggplot2")
[1] 4
install.packages("jtools")
[1] 5
library(psych, quietly = T)
[1] 6
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 7
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[10] "methods"   "base"     
library(stats, quietly = T)
[1] 8
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[10] "methods"   "base"     
library(interactions, quietly = T)
[1] 9
 [1] "interactions" "car"          "carData"      "psych"        "readr"        "stats"        "graphics"    
 [8] "grDevices"    "utils"        "datasets"     "methods"      "base"        
library(ggplot2, quietly = T)
[1] 10
 [1] "ggplot2"      "interactions" "car"          "carData"      "psych"        "readr"        "stats"       
 [8] "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
library(jtools, quietly = T)
[1] 11
 [1] "jtools"       "ggplot2"      "interactions" "car"          "carData"      "psych"        "readr"       
 [8] "stats"        "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
setwd("~/Desktop/RMS 2")
[1] 12
data <- read.csv("../RMS2_report_1920.csv")
[1] 13
data$incidents[data$incidents > 1]
[1] 14
numeric(0)
data$training[data$training > 2]
[1] 15
integer(0)
data$training[data$training < 1]
[1] 16
integer(0)
data$feedback[data$feedback > 2]
[1] 17
integer(0)
data$feedback[data$feedback < 1]
[1] 18
integer(0)
data$empathy[data$empathy > 20]
[1] 19
integer(0)
data$empathy[data$empathy < 1]
[1] 20
integer(0)
data$years[data$years > 30]
[1] 21
integer(0)
data$training <- as.factor(data$training)
[1] 22
data$training <- factor(data$training, labels = c("No training", 
    "Training"))
[1] 23
data$feedback <- as.factor(data$feedback)
[1] 24
data$feedback <- factor(data$feedback, labels = c("No feedback", 
    "Feedback"))
[1] 25
str(data$feedback)
[1] 26
 Factor w/ 2 levels "No feedback",..: 2 1 2 1 2 1 2 1 2 1 ...
NULL
str(data$training)
[1] 27
 Factor w/ 2 levels "No training",..: 2 2 2 2 2 2 2 2 2 2 ...
NULL
empathy1 <- scale(data$empathy)
[1] 28
scatterplot(empathy1 ~ years, data = data, main = "Relationship between empathy and years of experience", 
    xlab = "years of experience", ylab = "Empathy(SD Units)")
[1] 29
m1.0 <- lm(empathy1 ~ data$years)
[1] 30
crPlots(m1.0, main = "component residual plot")
[1] 31
m1.2 <- lm(empathy1 ~ data$years + I(data$years^2))
[1] 32
crPlots(m1.2)
[1] 33
hist(m1.2$residuals, xlab = "Residuals", main = "Histogram of residuals for the relationship betwen empathy and years", 
    col = "light blue")
[1] 34
describe(m1.2$residuals)
[1] 35
   vars   n mean   sd median trimmed  mad   min  max range skew kurtosis   se
X1    1 200    0 0.77  -0.03       0 0.75 -1.78 2.39  4.17 0.09    -0.12 0.05
shapiro.test(m1.2$residuals)
[1] 36

	Shapiro-Wilk normality test

data:  m1.2$residuals
W = 0.9941, p-value = 0.6155

ncvTest(m1.2)
[1] 37
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.5107658, Df = 1, p = 0.47481
durbinWatsonTest(m1.2)
[1] 38
 lag Autocorrelation D-W Statistic p-value
   1      0.01288905      1.973855   0.816
 Alternative hypothesis: rho != 0
summary(m1.2)
[1] 39

Call:
lm(formula = empathy1 ~ data$years + I(data$years^2))

Residuals:
     Min       1Q   Median       3Q      Max 
-1.77645 -0.55225 -0.03293  0.46143  2.38949 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)     -3.542969   0.312115  -11.35   <2e-16 ***
data$years       0.815324   0.071676   11.38   <2e-16 ***
I(data$years^2) -0.040853   0.003887  -10.51   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.776 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

confint(m1.2)
[1] 40
                      2.5 %      97.5 %
(Intercept)     -4.15848502 -2.92745274
data$years       0.67397298  0.95667546
I(data$years^2) -0.04851815 -0.03318759
sqrt(0.404)
[1] 41
[1] 0.6356099
plot(m1.2, which = 4)
[1] 42
abline(h = (4/(200 - 1 - 1)), col = "red")
[1] 43
out <- which(cooks.distance(m1.2) > (4/(200 - 1 - 1)))
[1] 44
m1.3 <- lm(empathy1 ~ years + I(years^2), data = data, subset = -out)
[1] 45
summary(m1.3)
[1] 46

Call:
lm(formula = empathy1 ~ years + I(years^2), data = data, subset = -out)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.78730 -0.44165  0.04509  0.48225  1.92331 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept) -3.676544   0.378560  -9.712  < 2e-16 ***
years        0.845811   0.092315   9.162  < 2e-16 ***
I(years^2)  -0.042457   0.005333  -7.962 1.54e-13 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.7537 on 189 degrees of freedom
Multiple R-squared:  0.3587,	Adjusted R-squared:  0.3519 
F-statistic: 52.86 on 2 and 189 DF,  p-value: < 2.2e-16

sqrt(0.3587)
[1] 47
[1] 0.5989157
m2.0 <- lm(incidents ~ training, data = data)
[1] 48
describeBy(data$incidents, data$training)
[1] 49

 Descriptive statistics by group 
group: No training
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 100 0.54 0.18    0.5    0.53 0.25 0.25 0.92  0.67 0.39    -0.73 0.02
--------------------------------------------------------------------------------------- 
group: Training
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 100 0.41 0.17   0.42     0.4 0.12 0.08 0.92  0.83 0.38    -0.05 0.02
summary(m2.0)
[1] 50

Call:
lm(formula = incidents ~ training, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.32500 -0.12500  0.00833  0.12500  0.50833 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.54167    0.01747  31.009  < 2e-16 ***
trainingTraining -0.13333    0.02470  -5.397 1.92e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1747 on 198 degrees of freedom
Multiple R-squared:  0.1283,	Adjusted R-squared:  0.1239 
F-statistic: 29.13 on 1 and 198 DF,  p-value: 1.922e-07

plot(incidents ~ training, data = data, main = "Fig2. Difference in incidents beween training and no training groups", 
    col = "light blue")
[1] 51
m2.1 <- lm(incidents ~ training + years + empathy1 + training:years + 
    training:empathy1 + years:empathy1, data = data)
[1] 52
summary(m2.1)
[1] 53

Call:
lm(formula = incidents ~ training + years + empathy1 + training:years + 
    training:empathy1 + years:empathy1, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.34846 -0.11808 -0.01311  0.09610  0.52309 

Coefficients:
                           Estimate Std. Error t value Pr(>|t|)    
(Intercept)                0.697508   0.051627  13.510  < 2e-16 ***
trainingTraining          -0.168235   0.069923  -2.406  0.01707 *  
years                     -0.017663   0.005786  -3.053  0.00259 ** 
empathy1                   0.102563   0.031310   3.276  0.00125 ** 
trainingTraining:years     0.002333   0.008272   0.282  0.77820    
trainingTraining:empathy1 -0.011519   0.024620  -0.468  0.64041    
years:empathy1            -0.004250   0.003434  -1.238  0.21739    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1627 on 193 degrees of freedom
Multiple R-squared:  0.2632,	Adjusted R-squared:  0.2403 
F-statistic: 11.49 on 6 and 193 DF,  p-value: 5.588e-11

m2.2 <- lm(incidents ~ training + years + empathy1, data = data)
[1] 54
hist(m2.2$residuals, main = "Histograms of residuals of training, years and empathy on incidents", 
    xlab = "residuals", col = "light yellow")
[1] 55
shapiro.test(m2.1$residuals)
[1] 56

	Shapiro-Wilk normality test

data:  m2.1$residuals
W = 0.9786, p-value = 0.003783

describe(m2.2$residuals)
[1] 57
   vars   n mean   sd median trimmed  mad   min  max range skew kurtosis   se
X1    1 200    0 0.16  -0.01   -0.01 0.16 -0.36 0.53  0.89 0.47     -0.1 0.01
ncvTest(m2.2)
[1] 58
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0293323, Df = 1, p = 0.86401
crPlots(m2.2)
[1] 59
durbinWatsonTest(m2.2)
[1] 60
 lag Autocorrelation D-W Statistic p-value
   1      -0.1072849      2.199897    0.19
 Alternative hypothesis: rho != 0
vif(m2.2)
[1] 61
training    years empathy1 
1.020633 1.085089 1.092467 
summary(m2.2)
[1] 62

Call:
lm(formula = incidents ~ training + years + empathy1, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.665721   0.036551  18.214  < 2e-16 ***
trainingTraining -0.152427   0.023166  -6.580 4.20e-10 ***
years            -0.014085   0.003889  -3.622 0.000372 ***
empathy1          0.064430   0.012014   5.363 2.29e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

plot(m2.2, which = 4)
[1] 63
abline(h = (4/(200 - 3 - 1)), col = "red")
[1] 64
out_Q2 <- which(cooks.distance(m2.2) > (4/(200 - 3 - 1)))
[1] 65
out_Q2

 13  35  74 137 165 
 13  35  74 137 165 


m2.4 <- lm(incidents ~ training + years + empathy1, data = data, 
    subset = -out_Q2)
[1] 67
summary(m2.4)
[1] 68

Call:
lm(formula = incidents ~ training + years + empathy1, data = data, 
    subset = -out_Q2)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.28818 -0.11426 -0.00621  0.09990  0.40582 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.677603   0.035597  19.035  < 2e-16 ***
trainingTraining -0.153846   0.021969  -7.003 4.16e-11 ***
years            -0.016177   0.003838  -4.215 3.84e-05 ***
empathy1          0.072319   0.011590   6.240 2.76e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1521 on 191 degrees of freedom
Multiple R-squared:  0.3042,	Adjusted R-squared:  0.2932 
F-statistic: 27.83 on 3 and 191 DF,  p-value: 5.621e-15

summary(m2.2)
[1] 69

Call:
lm(formula = incidents ~ training + years + empathy1, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.665721   0.036551  18.214  < 2e-16 ***
trainingTraining -0.152427   0.023166  -6.580 4.20e-10 ***
years            -0.014085   0.003889  -3.622 0.000372 ***
empathy1          0.064430   0.012014   5.363 2.29e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

m3.0 <- lm(incidents ~ feedback, data = data)
[1] 70
describeBy(data$incidents, data$feedback)
[1] 71

 Descriptive statistics by group 
group: No feedback
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 100 0.41 0.17   0.42     0.4 0.12 0.08 0.92  0.83  0.6     0.36 0.02
--------------------------------------------------------------------------------------- 
group: Feedback
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 100 0.54 0.18    0.5    0.53 0.25 0.08 0.92  0.83 0.11    -0.44 0.02
summary(m3.0)
[1] 72

Call:
lm(formula = incidents ~ feedback, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.45333 -0.12000  0.00333  0.13000  0.50333 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.41333    0.01765   23.41  < 2e-16 ***
feedbackFeedback  0.12333    0.02496    4.94 1.66e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1765 on 198 degrees of freedom
Multiple R-squared:  0.1097,	Adjusted R-squared:  0.1052 
F-statistic: 24.41 on 1 and 198 DF,  p-value: 1.656e-06

contrasts(data$feedback) <- contr.treatment(2, base = 1)
[1] 73
m3.0 <- lm(incidents ~ feedback, data = data)
[1] 74
summary(m3.0)
[1] 75

Call:
lm(formula = incidents ~ feedback, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.45333 -0.12000  0.00333  0.13000  0.50333 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.41333    0.01765   23.41  < 2e-16 ***
feedback2    0.12333    0.02496    4.94 1.66e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1765 on 198 degrees of freedom
Multiple R-squared:  0.1097,	Adjusted R-squared:  0.1052 
F-statistic: 24.41 on 1 and 198 DF,  p-value: 1.656e-06

describeBy(data$incidents, data$feedback)
[1] 76

 Descriptive statistics by group 
group: No feedback
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 100 0.41 0.17   0.42     0.4 0.12 0.08 0.92  0.83  0.6     0.36 0.02
--------------------------------------------------------------------------------------- 
group: Feedback
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 100 0.54 0.18    0.5    0.53 0.25 0.08 0.92  0.83 0.11    -0.44 0.02
plot(incidents ~ feedback, data = data, main = "Fig.3- Difference in incidents between feedback and no feedback groups", 
    col = "light blue")
[1] 77
m3.1 <- lm(data$incidents ~ data$feedback + data$years + empathy1 + 
    data$feedback:data$years + data$feedback:empathy1 + data$years:empathy1)
[1] 78
summary(m3.1)
[1] 79

Call:
lm(formula = data$incidents ~ data$feedback + data$years + empathy1 + 
    data$feedback:data$years + data$feedback:empathy1 + data$years:empathy1)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.33723 -0.11354 -0.01438  0.10407  0.53107 

Coefficients:
                           Estimate Std. Error t value Pr(>|t|)    
(Intercept)                0.531756   0.055946   9.505  < 2e-16 ***
data$feedback2             0.168512   0.069247   2.433  0.01587 *  
data$years                -0.014382   0.006491  -2.216  0.02788 *  
empathy1                   0.093194   0.030946   3.011  0.00295 ** 
data$feedback2:data$years -0.004527   0.008014  -0.565  0.57280    
data$feedback2:empathy1    0.025292   0.024688   1.024  0.30689    
data$years:empathy1       -0.005918   0.003442  -1.720  0.08709 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1658 on 193 degrees of freedom
Multiple R-squared:  0.2345,	Adjusted R-squared:  0.2107 
F-statistic: 9.853 on 6 and 193 DF,  p-value: 1.788e-09

m3.2 <- lm(incidents ~ feedback + years + empathy1, data = data)
[1] 80
hist(m3.2$residuals, main = "Histogram of residuals for years, empathy on incidents", 
    col = "light pink")
[1] 81
shapiro.test(m2.1$residuals)
[1] 82

	Shapiro-Wilk normality test

data:  m2.1$residuals
W = 0.9786, p-value = 0.003783

describe(m3.2$residuals)
[1] 83
   vars   n mean   sd median trimmed  mad   min  max range skew kurtosis   se
X1    1 200    0 0.17  -0.01   -0.01 0.17 -0.36 0.54  0.89 0.41      0.1 0.01
residualPlots(m3.2)
[1] 84
ncvTest(m3.2)
[1] 85
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.01731234, Df = 1, p = 0.89532
crPlots(m3.2)
[1] 86
durbinWatsonTest(m3.2)
[1] 87
 lag Autocorrelation D-W Statistic p-value
   1       0.2738264      1.444081       0
 Alternative hypothesis: rho != 0
vif(m3.2)
[1] 88
feedback    years empathy1 
1.005211 1.077467 1.079397 
summary(m3.2)
[1] 89

Call:
lm(formula = incidents ~ feedback + years + empathy1, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.512093   0.035846  14.286  < 2e-16 ***
feedback2    0.132132   0.023585   5.602 7.09e-08 ***
years       -0.012689   0.003975  -3.192  0.00165 ** 
empathy1     0.058827   0.012251   4.802 3.11e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

confint(m3.2)
[1] 90
                  2.5 %       97.5 %
(Intercept)  0.44139942  0.582785691
feedback2    0.08561885  0.178644455
years       -0.02052811 -0.004849104
empathy1     0.03466751  0.082987043
plot(m3.2, which = 4)
[1] 91
cooks <- cooks.distance(m3.2)
[1] 92
abline(h = (4/(200 - 3 - 1)), col = "red")
[1] 93
out_Q3 <- which(cooks > (4/(200 - 3 - 1)))
[1] 94
out_Q3

 73  74  89 137 156 160 165 176 
 73  74  89 137 156 160 165 176 


m3.4 <- lm(incidents ~ feedback + years + empathy1, data = data, 
    subset = -out_Q3)
[1] 96
summary(m3.4)
[1] 97

Call:
lm(formula = incidents ~ feedback + years + empathy1, data = data, 
    subset = -out_Q3)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.33584 -0.10475 -0.01065  0.11221  0.43819 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.49562    0.03461  14.322  < 2e-16 ***
feedback2    0.14332    0.02176   6.586 4.39e-10 ***
years       -0.01199    0.00387  -3.097  0.00225 ** 
empathy1     0.06670    0.01171   5.697 4.63e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1506 on 188 degrees of freedom
Multiple R-squared:  0.2838,	Adjusted R-squared:  0.2724 
F-statistic: 24.83 on 3 and 188 DF,  p-value: 1.402e-13

summary(m3.2)
[1] 98

Call:
lm(formula = incidents ~ feedback + years + empathy1, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.512093   0.035846  14.286  < 2e-16 ***
feedback2    0.132132   0.023585   5.602 7.09e-08 ***
years       -0.012689   0.003975  -3.192  0.00165 ** 
empathy1     0.058827   0.012251   4.802 3.11e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

AIC(m3.2, m2.2)
[1] 99
     df       AIC
m3.2  5 -143.9591
m2.2  5 -154.1654
BIC(m3.2, m2.2)
[1] 100
     df       BIC
m3.2  5 -127.4675
m2.2  5 -137.6738
m4.0 <- lm(incidents ~ training + empathy1 + years + feedback, 
    data = data)
[1] 101
summary(m4.0)
[1] 102

Call:
lm(formula = incidents ~ training + empathy1 + years + feedback, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.31626 -0.10096 -0.00949  0.09165  0.46650 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.608620   0.034515  17.634  < 2e-16 ***
trainingTraining -0.153824   0.021128  -7.281 7.98e-12 ***
empathy1          0.068984   0.010980   6.283 2.12e-09 ***
years            -0.015199   0.003551  -4.281 2.92e-05 ***
feedback2         0.133715   0.020968   6.377 1.28e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1479 on 195 degrees of freedom
Multiple R-squared:  0.3848,	Adjusted R-squared:  0.3721 
F-statistic: 30.49 on 4 and 195 DF,  p-value: < 2.2e-16

m4.1 <- lm(incidents ~ years + empathy1 + training, data = data)
[1] 103
summary(m4.1)
[1] 104

Call:
lm(formula = incidents ~ years + empathy1 + training, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.665721   0.036551  18.214  < 2e-16 ***
years            -0.014085   0.003889  -3.622 0.000372 ***
empathy1          0.064430   0.012014   5.363 2.29e-07 ***
trainingTraining -0.152427   0.023166  -6.580 4.20e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

anova(m4.1, m4.0)
[1] 105
Analysis of Variance Table

Model 1: incidents ~ years + empathy1 + training
Model 2: incidents ~ training + empathy1 + years + feedback
  Res.Df    RSS Df Sum of Sq      F    Pr(>F)    
1    196 5.1532                                  
2    195 4.2639  1   0.88925 40.668 1.279e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
pf(53.006, 1, 195, lower.tail = F)
[1] 106
[1] 7.979576e-12
hist(m4.0$residuals)
[1] 107
shapiro.test(m2.1$residuals)
[1] 108

	Shapiro-Wilk normality test

data:  m2.1$residuals
W = 0.9786, p-value = 0.003783

describe(m3.2$residuals)
[1] 109
   vars   n mean   sd median trimmed  mad   min  max range skew kurtosis   se
X1    1 200    0 0.17  -0.01   -0.01 0.17 -0.36 0.54  0.89 0.41      0.1 0.01
residualPlot(m4.0)
[1] 110
ncvTest(m3.2)
[1] 111
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.01731234, Df = 1, p = 0.89532
crPlots(m4.0)
[1] 112
durbinWatsonTest(m4.0)
[1] 113
 lag Autocorrelation D-W Statistic p-value
   1      0.07303546      1.841386   0.274
 Alternative hypothesis: rho != 0
vif(m4.0)
[1] 114
training empathy1    years feedback 
1.020743 1.097109 1.087722 1.005320 
m5.0 <- lm(incidents ~ feedback + training + training:feedback, 
    data = data)
[1] 115
aggregate(data$incidents, list(data$training, data$feedback), 
    mean)
[1] 116
      Group.1     Group.2         x
1 No training No feedback 0.4933333
2    Training No feedback 0.3333333
3 No training    Feedback 0.5900000
4    Training    Feedback 0.4833333
summary(m5.0)
[1] 117

Call:
lm(formula = incidents ~ feedback + training + training:feedback, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40000 -0.10500  0.00000  0.08333  0.43333 

Coefficients:
                           Estimate Std. Error t value Pr(>|t|)    
(Intercept)                 0.49333    0.02314  21.323  < 2e-16 ***
feedback2                   0.09667    0.03272   2.954  0.00352 ** 
trainingTraining           -0.16000    0.03272  -4.890 2.09e-06 ***
feedback2:trainingTraining  0.05333    0.04627   1.153  0.25047    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1636 on 196 degrees of freedom
Multiple R-squared:  0.2431,	Adjusted R-squared:  0.2315 
F-statistic: 20.99 on 3 and 196 DF,  p-value: 7.827e-12

hist(m5.0$residuals, main = "Histogram of residuals of training and feedback on incidents", 
    col = "light blue")
[1] 118
shapiro.test(m5.0$residuals)
[1] 119

	Shapiro-Wilk normality test

data:  m5.0$residuals
W = 0.9767, p-value = 0.002072

describe(m5.0$residuals)
[1] 120
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 200    0 0.16      0   -0.01 0.13 -0.4 0.43  0.83 0.33    -0.25 0.01
residualPlot(m5.0)
[1] 121
ncvTest(m5.0)
[1] 122
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 1.881673, Df = 1, p = 0.17014
m5.1 <- lm(incidents ~ feedback + training, data = data)
[1] 123
crPlots(m5.1)
[1] 124
durbinWatsonTest(m5.0)
[1] 125
 lag Autocorrelation D-W Statistic p-value
   1       0.1114255      1.770733   0.142
 Alternative hypothesis: rho != 0
vif(m5.0)
[1] 126
         feedback          training feedback:training 
                2                 2                 3 
summary(m5.0)
[1] 127

Call:
lm(formula = incidents ~ feedback + training + training:feedback, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40000 -0.10500  0.00000  0.08333  0.43333 

Coefficients:
                           Estimate Std. Error t value Pr(>|t|)    
(Intercept)                 0.49333    0.02314  21.323  < 2e-16 ***
feedback2                   0.09667    0.03272   2.954  0.00352 ** 
trainingTraining           -0.16000    0.03272  -4.890 2.09e-06 ***
feedback2:trainingTraining  0.05333    0.04627   1.153  0.25047    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1636 on 196 degrees of freedom
Multiple R-squared:  0.2431,	Adjusted R-squared:  0.2315 
F-statistic: 20.99 on 3 and 196 DF,  p-value: 7.827e-12

plot(m5.0, which = 4)
[1] 128
abline(h = (4/(200 - 3 - 1)), col = "red")
[1] 129
out_Q5 <- which(cooks.distance(m5.0) > (4/(200 - 3 - 1)))
[1] 130
m5.1 <- lm(incidents ~ feedback + training + training:feedback, 
    data = data, subset = -out_Q5)
[1] 131
summary(m5.1)
[1] 132

Call:
lm(formula = incidents ~ feedback + training + training:feedback, 
    data = data, subset = -out_Q5)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30851 -0.12190  0.00000  0.09058  0.28192 

Coefficients:
                           Estimate Std. Error t value Pr(>|t|)    
(Intercept)                 0.46809    0.02091  22.382  < 2e-16 ***
feedback2                   0.10800    0.02974   3.632 0.000364 ***
trainingTraining           -0.13475    0.02913  -4.626 6.97e-06 ***
feedback2:trainingTraining  0.03384    0.04163   0.813 0.417260    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1434 on 186 degrees of freedom
Multiple R-squared:  0.273,	Adjusted R-squared:  0.2613 
F-statistic: 23.28 on 3 and 186 DF,  p-value: 7.654e-13

cat_plot(m5.0, pred = training, modx = feedback, geom = "line", 
    main.title = "Fig.5 - Interaction between trainig and feedback")
[1] 133
