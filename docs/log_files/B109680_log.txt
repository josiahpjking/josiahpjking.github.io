

	####### B109680 R script #######

library("psych")
[1] 1
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library("car")
[1] 2
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
library("interactions")
[1] 3
 [1] "interactions" "car"          "carData"      "psych"        "readr"        "stats"        "graphics"     "grDevices"   
 [9] "utils"        "datasets"     "methods"      "base"        
setwd("~/Downloads")
[1] 4
data <- read.csv("~/Desktop/rms2/code_check/RMS2_report_1920.csv")
[1] 5
describe(data)
[1] 6
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training     3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
describe(data)[, c(2:4, 8, 9:13)]
[1] 7
            n   mean    sd  min    max  range  skew kurtosis   se
subject   200 100.50 57.88 1.00 200.00 199.00  0.00    -1.22 4.09
incidents 200   0.48  0.19 0.08   0.92   0.83  0.32    -0.31 0.01
training  200   1.50  0.50 1.00   2.00   1.00  0.00    -2.01 0.04
feedback  200   1.50  0.50 1.00   2.00   1.00  0.00    -2.01 0.04
empathy   200  10.18  2.54 3.00  16.00  13.00 -0.37     0.23 0.18
 [ reached 'max' / getOption("max.print") -- omitted 1 rows ]
data$empathy <- (data$empathy - mean(data$empathy))
[1] 8
plot(data$years, data$empathy)
[1] 9
M1 <- lm(data$empathy ~ data$years)
[1] 10
plot(M1)
[1] 11
cor(data$years, data$empathy)
[1] 12
[1] 0.2640369
cor.test(data$years, data$empathy)
[1] 13

	Pearson's product-moment correlation

data:  data$years and data$empathy
t = 3.852, df = 198, p-value = 0.0001582
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.1300604 0.3885445
sample estimates:
      cor 
0.2640369 

plot(data$years, data$empathy, main = "Empathy vs. Years", xlab = "Years of Experience", 
    ylab = "Empathy")
[1] 14
abline(M1)
[1] 15
lines(lowess(data$years, data$empathy))
[1] 16
plot(M1, which = 2)
[1] 17
hist(data$empathy)
[1] 18
hist(data$years)
[1] 19
shapiro.test(data$empathy)
[1] 20

	Shapiro-Wilk normality test

data:  data$empathy
W = 0.97073, p-value = 0.0003477

shapiro.test(data$years)
[1] 21

	Shapiro-Wilk normality test

data:  data$years
W = 0.97276, p-value = 0.0006279

plot(M1, which = 3)
[1] 22
residualPlots(M1)
[1] 23
ncvTest(M1)
[1] 24
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.9815033, Df = 1, p = 0.32183
crPlots(M1)
[1] 25
durbinWatsonTest(M1)
[1] 26
 lag Autocorrelation D-W Statistic p-value
   1       0.1017162      1.769879   0.126
 Alternative hypothesis: rho != 0
M2 <- lm(empathy ~ years + I(years^2), data = data)
[1] 27
summary(M2)
[1] 28

Call:
lm(formula = empathy ~ years + I(years^2), data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept) -8.988644   0.791848  -11.35   <2e-16 ***
years        2.068508   0.181845   11.38   <2e-16 ***
I(years^2)  -0.103645   0.009861  -10.51   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

plot(M2)
[1] 29
plot(M2, which = 2)
[1] 30
plot(M2, which = 3)
[1] 31
residualPlots(M2)
[1] 32
ncvTest(M2)
[1] 33
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.5107658, Df = 1, p = 0.47481
crPlots(M2)
[1] 34
durbinWatsonTest(M2)
[1] 35
 lag Autocorrelation D-W Statistic p-value
   1      0.01288905      1.973855   0.894
 Alternative hypothesis: rho != 0
which(cooks.distance(M1) > (4/(200 - 1 - 1)))
[1] 36
 16  61  88  89  94 108 137 141 154 163 171 175 192 200 
 16  61  88  89  94 108 137 141 154 163 171 175 192 200 
LM2 <- lm(empathy ~ years + I(years^2), data = data, subset = -c(16, 
    61, 88, 89, 94, 108, 137, 141, 154, 163, 171, 192, 200))
[1] 37
summary(LM2)
[1] 38

Call:
lm(formula = empathy ~ years + I(years^2), data = data, subset = -c(16, 
    61, 88, 89, 94, 108, 137, 141, 154, 163, 171, 192, 200))

Residuals:
    Min      1Q  Median      3Q     Max 
-4.4650 -1.1546 -0.1477  1.1896  5.8063 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) -7.60572    1.24998  -6.085 6.62e-09 ***
years        1.76021    0.30013   5.865 2.05e-08 ***
I(years^2)  -0.08706    0.01700  -5.121 7.62e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.965 on 184 degrees of freedom
Multiple R-squared:  0.2025,	Adjusted R-squared:  0.1939 
F-statistic: 23.36 on 2 and 184 DF,  p-value: 9.072e-10

BIC(M2, LM2)
[1] 39
    df      BIC
M2   4 856.6783
LM2  4 801.1631
data$training <- as.factor(data$training)
[1] 40
M3 <- (lm(data$incidents ~ data$training + data$empathy + data$years))
[1] 41
summary(M3)
[1] 42

Call:
lm(formula = data$incidents ~ data$training + data$empathy + 
    data$years)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.665721   0.036551  18.214  < 2e-16 ***
data$training2 -0.152427   0.023166  -6.580 4.20e-10 ***
data$empathy    0.025396   0.004735   5.363 2.29e-07 ***
data$years     -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

plot(M3)
[1] 43
plot(data$training, data$incidents)
[1] 44
str(data)
[1] 45
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : Factor w/ 2 levels "1","2": 2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : int  2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : num  0.825 -0.175 -0.175 -1.175 1.825 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
plot(M3, which = 2)
[1] 46
shapiro.test(data$incidents)
[1] 47

	Shapiro-Wilk normality test

data:  data$incidents
W = 0.96722, p-value = 0.0001303

plot(M3, which = 3)
[1] 48
residualPlots(M3)
[1] 49
ncvTest(M3)
[1] 50
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0293323, Df = 1, p = 0.86401
crPlots(M3)
[1] 51
durbinWatsonTest(M3)
[1] 52
 lag Autocorrelation D-W Statistic p-value
   1      -0.1072849      2.199897   0.168
 Alternative hypothesis: rho != 0
data$feedback <- as.factor(data$feedback)
[1] 53
M4 <- (lm(data$incidents ~ data$feedback + data$empathy + data$years))
[1] 54
summary(M4)
[1] 55

Call:
lm(formula = data$incidents ~ data$feedback + data$empathy + 
    data$years)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.512093   0.035846  14.286  < 2e-16 ***
data$feedback2  0.132132   0.023585   5.602 7.09e-08 ***
data$empathy    0.023187   0.004829   4.802 3.11e-06 ***
data$years     -0.012689   0.003975  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

plot(data$feedback, data$incidents)
[1] 56
plot(cooks.distance(M3))
[1] 57
qqPlot(M4)
[1] 58
shapiro.test(M4$residuals)
[1] 59

	Shapiro-Wilk normality test

data:  M4$residuals
W = 0.98772, p-value = 0.08174

residualPlots(M4)
[1] 60
ncvTest(M4)
[1] 61
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.01731234, Df = 1, p = 0.89532
crPlots(M4)
[1] 62
durbinWatsonTest(M4)
[1] 63
 lag Autocorrelation D-W Statistic p-value
   1       0.2738264      1.444081       0
 Alternative hypothesis: rho != 0
AIC(M3, M4)
[1] 64
   df       AIC
M3  5 -154.1654
M4  5 -143.9591
BIC(M3, M4)
[1] 65
   df       BIC
M3  5 -137.6738
M4  5 -127.4675
M5 <- lm(incidents ~ training + feedback + training * feedback + 
    years + empathy, data = data)
[1] 66
summary(M5)
[1] 67

Call:
lm(formula = incidents ~ training + feedback + training * feedback + 
    years + empathy, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30367 -0.10365 -0.00795  0.08806  0.44359 

Coefficients:
                     Estimate Std. Error t value Pr(>|t|)    
(Intercept)          0.637438   0.036309  17.556  < 2e-16 ***
training2           -0.203496   0.029874  -6.812 1.18e-10 ***
feedback2            0.085558   0.029299   2.920  0.00391 ** 
years               -0.015720   0.003518  -4.468 1.34e-05 ***
empathy              0.028695   0.004328   6.630 3.25e-10 ***
training2:feedback2  0.097334   0.041840   2.326  0.02103 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1462 on 194 degrees of freedom
Multiple R-squared:  0.4015,	Adjusted R-squared:  0.386 
F-statistic: 26.02 on 5 and 194 DF,  p-value: < 2.2e-16

cat_plot(M5, pred = training, modx = feedback, geom = "line", 
    data = data)
[1] 68
plot(M5)
[1] 69
qqPlot(M5)
[1] 70
shapiro.test(M5$residuals)
[1] 71

	Shapiro-Wilk normality test

data:  M5$residuals
W = 0.98794, p-value = 0.08817

residualPlot(M5)
[1] 72
ncvTest(M5)
[1] 73
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 4.398557, Df = 1, p = 0.035969
durbinWatsonTest(M5)
[1] 74
 lag Autocorrelation D-W Statistic p-value
   1      0.09456969      1.801048   0.186
 Alternative hypothesis: rho != 0
vif(M5)
[1] 75
         training          feedback             years           empathy training:feedback 
         2.086826          2.007327          1.092150          1.122147          3.070068 
