

	####### B111729 R script #######

library(psych, quietly = T)
[1] 1
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 2
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[10] "methods"   "base"     
library(interactions, quietly = T)
[1] 3
 [1] "interactions" "car"          "carData"      "psych"        "readr"        "stats"        "graphics"    
 [8] "grDevices"    "utils"        "datasets"     "methods"      "base"        
library(lm.beta, quietly = T)
[1] 4
 [1] "lm.beta"      "interactions" "car"          "carData"      "psych"        "readr"        "stats"       
 [8] "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
library(tidyr, quietly = T)
[1] 5
 [1] "tidyr"        "lm.beta"      "interactions" "car"          "carData"      "psych"        "readr"       
 [8] "stats"        "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
data <- read_csv("../RMS2_report_1920.csv")
[1] 6
str(data)
[1] 7
Classes ‘spec_tbl_df’, ‘tbl_df’, ‘tbl’ and 'data.frame':	200 obs. of  6 variables:
 $ subject  : num  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : num  2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : num  2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : num  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : num  10 7 5 7 12 10 8 10 7 9 ...
 - attr(*, "spec")=
  .. cols(
  ..   subject = col_double(),
  ..   incidents = col_double(),
  ..   training = col_double(),
  ..   feedback = col_double(),
  ..   empathy = col_double(),
  ..   years = col_double()
  .. )
NULL
describe(data)
[1] 8
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training     3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
summary(data)
[1] 9
    subject         incidents          training      feedback      empathy          years      
 Min.   :  1.00   Min.   :0.08333   Min.   :1.0   Min.   :1.0   Min.   : 3.00   Min.   : 1.00  
 1st Qu.: 50.75   1st Qu.:0.33333   1st Qu.:1.0   1st Qu.:1.0   1st Qu.: 9.00   1st Qu.: 6.00  
 Median :100.50   Median :0.41667   Median :1.5   Median :1.5   Median :10.00   Median : 8.00  
 Mean   :100.50   Mean   :0.47500   Mean   :1.5   Mean   :1.5   Mean   :10.18   Mean   : 8.13  
 3rd Qu.:150.25   3rd Qu.:0.58333   3rd Qu.:2.0   3rd Qu.:2.0   3rd Qu.:12.00   3rd Qu.:10.00  
 Max.   :200.00   Max.   :0.91667   Max.   :2.0   Max.   :2.0   Max.   :16.00   Max.   :19.00  
data$training <- as.factor(data$training)
[1] 10
class(data$training)
[1] 11
[1] "factor"
levels(data$training)
[1] 12
[1] "1" "2"
data$feedback <- as.factor(data$feedback)
[1] 13
class(data$feedback)
[1] 14
[1] "factor"
levels(data$feedback)
[1] 15
[1] "1" "2"
data$empathy_m <- data$empathy - mean(data$empathy)
[1] 16
summary(data$empathy_m)
[1] 17
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 -7.175  -1.175  -0.175   0.000   1.825   5.825 
m1 <- lm(empathy_m ~ years, data = data)
[1] 18
summary(m1)
[1] 19

Call:
lm(formula = empathy_m ~ years, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) -1.76875    0.49085  -3.603 0.000397 ***
years        0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

par(mfrow = c(2, 2))
[1] 20
$mfrow
[1] 2 2

plot(m1)
[1] 21
qqPlot(m1)
[1] 22
hist(m1$residuals)
[1] 23
shapiro.test(m1$residuals)
[1] 24

	Shapiro-Wilk normality test

data:  m1$residuals
W = 0.98911, p-value = 0.1321

residualPlots(m1)
[1] 25
ncvTest(m1)
[1] 26
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.9815033, Df = 1, p = 0.32183
durbinWatsonTest(m1)
[1] 27
 lag Autocorrelation D-W Statistic p-value
   1       0.1017162      1.769879    0.08
 Alternative hypothesis: rho != 0
crPlots(m1, xlab = "Years", ylab = "ComponentResidul Empathy")
[1] 28
m1_poly <- lm(data$empathy_m ~ poly(data$years, 2))
[1] 29
summary(m1_poly)
[1] 30

Call:
lm(formula = data$empathy_m ~ poly(data$years, 2))

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
                       Estimate Std. Error t value Pr(>|t|)    
(Intercept)          -6.843e-16  1.392e-01    0.00        1    
poly(data$years, 2)1  9.450e+00  1.969e+00    4.80 3.13e-06 ***
poly(data$years, 2)2 -2.069e+01  1.969e+00  -10.51  < 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

crPlots(m1_poly, xlab = "Polynomial Years", ylab = "ComponentResidul Empathy")
[1] 31
residualPlots(m1_poly)
[1] 32
qqPlot(m1_poly)
[1] 33
hist(m1_poly$residuals)
[1] 34
shapiro.test(m1_poly$residuals)
[1] 35

	Shapiro-Wilk normality test

data:  m1_poly$residuals
W = 0.9941, p-value = 0.6155

durbinWatsonTest(m1_poly)
[1] 36
 lag Autocorrelation D-W Statistic p-value
   1      0.01288905      1.973855    0.84
 Alternative hypothesis: rho != 0
m2 <- lm(incidents ~ training + empathy_m + years, data = data)
[1] 37
summary(m2)
[1] 38

Call:
lm(formula = incidents ~ training + empathy_m + years, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.665721   0.036551  18.214  < 2e-16 ***
training2   -0.152427   0.023166  -6.580 4.20e-10 ***
empathy_m    0.025396   0.004735   5.363 2.29e-07 ***
years       -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

qqPlot(m2)
[1] 39
hist(m2$residuals)
[1] 40
shapiro.test(m2$residuals)
[1] 41

	Shapiro-Wilk normality test

data:  m2$residuals
W = 0.97994, p-value = 0.005838

log(data$incidents)
[1] 42
 [1] -0.40546511 -1.09861229 -1.09861229 -0.87546874 -0.69314718 -1.38629436 -0.18232156 -0.87546874 -0.69314718
[10] -1.79175947 -0.28768207 -1.09861229 -0.08701138 -0.69314718 -0.53899650 -1.79175947 -1.79175947 -1.09861229
[19] -0.28768207 -0.87546874 -1.79175947 -0.87546874 -0.87546874 -0.53899650 -0.87546874 -1.38629436 -0.69314718
[28] -1.09861229 -0.87546874 -2.48490665 -1.09861229 -0.69314718 -1.09861229 -0.87546874 -0.28768207 -0.87546874
[37] -0.69314718 -0.53899650 -0.53899650 -1.79175947 -0.40546511 -0.87546874 -1.09861229 -1.38629436 -0.87546874
[46] -1.38629436 -0.53899650 -0.53899650 -0.69314718 -1.79175947
 [ reached getOption("max.print") -- omitted 150 entries ]
m2_log <- lm(log(incidents + 1) ~ training + empathy_m + years, 
    data = data)
[1] 43
summary(m2_log)
[1] 44

Call:
lm(formula = log(incidents + 1) ~ training + empathy_m + years, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.25974 -0.08206 -0.00301  0.07026  0.33183 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.511876   0.024544  20.856  < 2e-16 ***
training2   -0.104810   0.015556  -6.737 1.75e-10 ***
empathy_m    0.017470   0.003180   5.494 1.21e-07 ***
years       -0.009683   0.002611  -3.708 0.000272 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1089 on 196 degrees of freedom
Multiple R-squared:  0.2657,	Adjusted R-squared:  0.2544 
F-statistic: 23.63 on 3 and 196 DF,  p-value: 4.229e-13

qqPlot(m2_log$residuals)
[1] 45
hist(m2_log$residuals)
[1] 46
shapiro.test(m2_log$residuals)
[1] 47

	Shapiro-Wilk normality test

data:  m2_log$residuals
W = 0.9901, p-value = 0.1845

vif(m2_log)
[1] 48
 training empathy_m     years 
 1.020633  1.092467  1.085089 
durbinWatsonTest(m2_log)
[1] 49
 lag Autocorrelation D-W Statistic p-value
   1      -0.1160146      2.216759   0.158
 Alternative hypothesis: rho != 0
residualPlot(m2_log)
[1] 50
ncvTest(m2_log)
[1] 51
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.8932792, Df = 1, p = 0.34459
crPlots(m2_log)
[1] 52
cooksm2 <- cooks.distance(m2_log)
[1] 53
which(cooksm2 > (4/(200 - 3 - 1)))
[1] 54
 13  30  35  60  74  88  94 137 
 13  30  35  60  74  88  94 137 
plot(m2_log, which = 4)
[1] 55
m2_sens <- lm(log(incidents) ~ empathy_m + years + training, 
    data = data[-c(35, 74, 137), ])
[1] 56
summary(m2_sens)
[1] 57

Call:
lm(formula = log(incidents) ~ empathy_m + years + training, data = data[-c(35, 
    74, 137), ])

Residuals:
     Min       1Q   Median       3Q      Max 
-1.21985 -0.22592  0.04355  0.24736  0.97578 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept) -0.279492   0.086964  -3.214  0.00154 ** 
empathy_m    0.073130   0.011286   6.480 7.48e-10 ***
years       -0.045126   0.009415  -4.793 3.27e-06 ***
training2   -0.381487   0.053995  -7.065 2.84e-11 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.3761 on 193 degrees of freedom
Multiple R-squared:  0.3176,	Adjusted R-squared:  0.307 
F-statistic: 29.94 on 3 and 193 DF,  p-value: 6.125e-16

m2_coef <- summary(m2_log)
[1] 58
m2s_coef <- summary(m2_sens)
[1] 59
compare <- data.frame(round(m2_coef$coefficients[, 2], 3), round(m2_coef$coefficients[, 
    4], 4), round(m2s_coef$coefficients[, 2], 3), round(m2s_coef$coefficients[, 
    4], 4))
[1] 60
colnames(compare) <- c("M2 Coef", "M2 p-value", "M2s coef", "M2s p-value")
[1] 61
compare

            M2 Coef M2 p-value M2s coef M2s p-value
(Intercept)   0.025      0e+00    0.087      0.0015
training2     0.016      0e+00    0.011      0.0000
empathy_m     0.003      0e+00    0.009      0.0000
years         0.003      3e-04    0.054      0.0000


m3 <- lm(log(incidents + 1) ~ feedback + empathy_m + years, data = data)
[1] 63
summary(m3)
[1] 64

Call:
lm(formula = log(incidents + 1) ~ feedback + empathy_m + years, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.25959 -0.07169 -0.00250  0.07834  0.33399 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.406562   0.024132  16.847  < 2e-16 ***
feedback2    0.090112   0.015878   5.675 4.93e-08 ***
empathy_m    0.015942   0.003251   4.904 1.97e-06 ***
years       -0.008717   0.002676  -3.257  0.00132 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.112 on 196 degrees of freedom
Multiple R-squared:  0.2232,	Adjusted R-squared:  0.2113 
F-statistic: 18.78 on 3 and 196 DF,  p-value: 9.56e-11

qqPlot(m3)
[1] 65
hist(m3$residuals)
[1] 66
shapiro.test(m3$residuals)
[1] 67

	Shapiro-Wilk normality test

data:  m3$residuals
W = 0.99557, p-value = 0.8301

vif(m3)
[1] 68
 feedback empathy_m     years 
 1.005211  1.079397  1.077467 
residualPlot(m3)
[1] 69
ncvTest(m3)
[1] 70
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.5811934, Df = 1, p = 0.44584
crPlots(m3)
[1] 71
durbinWatsonTest(m3)
[1] 72
 lag Autocorrelation D-W Statistic p-value
   1       0.2792812      1.432218       0
 Alternative hypothesis: rho != 0
AIC(m2_log, m3)
[1] 73
       df       AIC
m2_log  5 -313.4627
m3      5 -302.2294
BIC(m2_log, m3)
[1] 74
       df       BIC
m2_log  5 -296.9711
m3      5 -285.7378
m5 <- lm(incidents ~ feedback + training + feedback * training, 
    data = data)
[1] 75
summary(m5)
[1] 76

Call:
lm(formula = incidents ~ feedback + training + feedback * training, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40000 -0.10500  0.00000  0.08333  0.43333 

Coefficients:
                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)          0.49333    0.02314  21.323  < 2e-16 ***
feedback2            0.09667    0.03272   2.954  0.00352 ** 
training2           -0.16000    0.03272  -4.890 2.09e-06 ***
feedback2:training2  0.05333    0.04627   1.153  0.25047    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1636 on 196 degrees of freedom
Multiple R-squared:  0.2431,	Adjusted R-squared:  0.2315 
F-statistic: 20.99 on 3 and 196 DF,  p-value: 7.827e-12

residualPlot(m5)
[1] 77
ncvTest(m5)
[1] 78
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 1.881673, Df = 1, p = 0.17014
durbinWatsonTest(m5)
[1] 79
 lag Autocorrelation D-W Statistic p-value
   1       0.1114255      1.770733    0.11
 Alternative hypothesis: rho != 0
cat_plot(m5, pred = feedback, modx = training, geom = "line")
[1] 80
interaction.plot(x.factor = data$training, trace.factor = data$feedback, 
    response = data$incidents)
[1] 81
