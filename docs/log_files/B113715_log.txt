

	####### B113715 R script #######

data <- read.csv("~/Desktop/rms2/code_check/RMS2_report_1920.csv")
[1] 1
library(psych, quietly = T)
[1] 2
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 3
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
library(interactions, quietly = T)
[1] 4
 [1] "interactions" "car"          "carData"      "psych"        "readr"        "stats"        "graphics"     "grDevices"   
 [9] "utils"        "datasets"     "methods"      "base"        
summary(data)
[1] 5
    subject         incidents          training      feedback      empathy          years      
 Min.   :  1.00   Min.   :0.08333   Min.   :1.0   Min.   :1.0   Min.   : 3.00   Min.   : 1.00  
 1st Qu.: 50.75   1st Qu.:0.33333   1st Qu.:1.0   1st Qu.:1.0   1st Qu.: 9.00   1st Qu.: 6.00  
 Median :100.50   Median :0.41667   Median :1.5   Median :1.5   Median :10.00   Median : 8.00  
 Mean   :100.50   Mean   :0.47500   Mean   :1.5   Mean   :1.5   Mean   :10.18   Mean   : 8.13  
 3rd Qu.:150.25   3rd Qu.:0.58333   3rd Qu.:2.0   3rd Qu.:2.0   3rd Qu.:12.00   3rd Qu.:10.00  
 Max.   :200.00   Max.   :0.91667   Max.   :2.0   Max.   :2.0   Max.   :16.00   Max.   :19.00  
str(data)
[1] 6
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : int  2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : int  2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
describeBy(data)
[1] 7
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training     3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
data$training <- as.factor(data$training)
[1] 8
data$feedback <- as.factor(data$feedback)
[1] 9
str(data)
[1] 10
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : Factor w/ 2 levels "1","2": 2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : Factor w/ 2 levels "1","2": 2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
data$empathy_min <- data$empathy - min(data$empathy)
[1] 11
scatterplot(data$years, data$empathy_min, xlab = "Years of Teaching Experience", 
    ylab = "Empathy", main = "Relationship between years of teaching experience and empathy")
[1] 12
shapiro.test(data$empathy_min)
[1] 13

	Shapiro-Wilk normality test

data:  data$empathy_min
W = 0.97073, p-value = 0.0003477

shapiro.test(data$years)
[1] 14

	Shapiro-Wilk normality test

data:  data$years
W = 0.97276, p-value = 0.0006279

hist(data$empathy_min, xlab = "Empathy", main = "Histogram of empathy")
[1] 15
hist(data$years, ylim = c(0, 60), xlab = "Years of experience", 
    main = "Histogram of years of experience")
[1] 16
r <- cor(data$years, data$empathy_min, method = "spearman")
[1] 17
r

[1] 0.3071045


t <- (r * sqrt(200 - 2))/sqrt(1 - r^2)
[1] 19
t

[1] 4.540772


qt(p = 1 - (0.05/2), df = 200 - 2)
[1] 21
[1] 1.972017
corsignificance <- cor.test(data$years, data$empathy_min, method = "spearman")
[1] 22
corsignificance


	Spearman's rank correlation rho

data:  data$years and data$empathy_min
S = 923838, p-value = 9.723e-06
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.3071045 



M0 <- lm(incidents ~ training + empathy_min + years, data = data)
[1] 24
summary(M0)
[1] 25

Call:
lm(formula = incidents ~ training + empathy_min + years, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.483507   0.042477  11.383  < 2e-16 ***
training2   -0.152427   0.023166  -6.580 4.20e-10 ***
empathy_min  0.025396   0.004735   5.363 2.29e-07 ***
years       -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

cooks <- cooks.distance(M0)
[1] 26
which(cooks > (4/196))
[1] 27
 13  35  74 137 165 
 13  35  74 137 165 
plot(M0, which = 4)
[1] 28
qqnorm(M0$residuals, ylim = c(-0.4, 0.6))
[1] 29
$x
 [1]  1.42209043 -0.40564971 -0.53160442  0.31205332  0.79777685 -0.81512633  2.10835840 -0.29892142  0.35178434 -2.10835840
[11]  1.62108225  0.09413741  2.80703377  0.36514925  1.16257987 -1.00478581 -0.74710530 -0.28584087  1.78046434  0.51722371
[21] -1.16257987 -0.20829325  0.15731068  0.86872055 -0.08155574 -1.53412054  0.47470115 -0.73063848  0.03133798 -1.62108225
[31] -0.14463381  0.25982340 -0.44682697 -0.04388007  1.91887623 -0.11934757  0.65107202  0.62039160  0.88714656 -1.23993348
[41]  1.72238389 -0.03133798 -0.18274259 -0.71436744  0.44682697 -0.88714656  0.90587881  0.76377724  0.66664331 -1.38845020
 [ reached getOption("max.print") -- omitted 150 entries ]

$y
           1            2            3            4            5            6            7            8            9 
 0.273266775 -0.076924541 -0.105093625  0.031804436  0.109373549 -0.143399892  0.360973070 -0.052920155  0.038950839 
          10           11           12           13           14           15           16           17           18 
-0.266213410  0.300261940  0.004809270  0.531804436  0.038950839  0.198471102 -0.172951158 -0.133688312 -0.051528898 
          19           20           21           22           23           24           25           26           27 
 0.311573042  0.076831503 -0.187253039 -0.035844833  0.020493335  0.122284172 -0.018986851 -0.225133703  0.064346482 
          28           29           30           31           32           33           34           35           36 
-0.127715828 -0.007675749 -0.228115408 -0.026133254  0.027639737 -0.079697982 -0.016213410  0.348062447 -0.021760291 
          37           38           39           40           41           42           43           44           45 
 0.098279787  0.094115088  0.127831053 -0.195573361  0.304426639 -0.016213410 -0.031897475 -0.126324570  0.054426639 
          46           47           48           49           50 
-0.146173332  0.133595273  0.108199630  0.101053227 -0.209657903 
 [ reached getOption("max.print") -- omitted 150 entries ]

hist(M0$residuals, ylim = c(0, 50))
[1] 30
shapiro.test(M0$residuals)
[1] 31

	Shapiro-Wilk normality test

data:  M0$residuals
W = 0.97994, p-value = 0.005838

residualPlots(M0, ylim = c(-0.6, 0.6))
[1] 32
ncvTest(M0)
[1] 33
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0293323, Df = 1, p = 0.86401
crPlots(M0, ylim = c(-0.6, 0.6))
[1] 34
durbinWatsonTest(M0)
[1] 35
 lag Autocorrelation D-W Statistic p-value
   1      -0.1072849      2.199897    0.17
 Alternative hypothesis: rho != 0
vif(M0)
[1] 36
   training empathy_min       years 
   1.020633    1.092467    1.085089 
data$incidents_log <- log(data$incidents + (-1 * min(data$incidents) + 
    1))
[1] 37
M1 <- lm(incidents_log ~ training + empathy_min + years, data = data)
[1] 38
summary(M1)
[1] 39

Call:
lm(formula = incidents_log ~ training + empathy_min + years, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.27676 -0.08678 -0.00271  0.07438  0.35035 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.327758   0.030249  10.835  < 2e-16 ***
training2   -0.111288   0.016497  -6.746 1.67e-10 ***
empathy_min  0.018550   0.003372   5.501 1.17e-07 ***
years       -0.010283   0.002769  -3.713 0.000266 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1155 on 196 degrees of freedom
Multiple R-squared:  0.2661,	Adjusted R-squared:  0.2549 
F-statistic: 23.69 on 3 and 196 DF,  p-value: 3.963e-13

qqnorm(M1$residuals)
[1] 40
$x
 [1]  1.494672250 -0.419295753 -0.560703032  0.351784345  0.832724719 -0.832724719  2.108358399 -0.272809053  0.405649708
[10] -2.241402728  1.669592577  0.094137414  2.807033768  0.419295753  1.213339622 -1.213339622 -0.887146559 -0.285840875
[19]  1.780464342  0.546095926 -1.295928846 -0.195501964  0.208293252  0.887146559 -0.031337982 -1.534120544  0.488776411
[28] -0.682377942  0.056429069 -2.004654462 -0.144633812  0.285840875 -0.460719309 -0.018800820  2.241402728 -0.094137414
[37]  0.730638483  0.635657014  0.905878812 -1.388450197  1.845258117 -0.006266612 -0.208293252 -0.730638483  0.460719309
[46] -0.850584865  0.924934461  0.780664237  0.747105302 -1.621082251
 [ reached getOption("max.print") -- omitted 150 entries ]

$y
           1            2            3            4            5            6            7            8            9 
 0.197497370 -0.051191406 -0.071757863  0.031896802  0.088288504 -0.107884280  0.239914999 -0.030001947  0.036872364 
          10           11           12           13           14           15           16           17           18 
-0.210825166  0.207657752  0.008491193  0.350350533  0.036872364  0.149679837 -0.142676729 -0.114043194 -0.032641720 
          19           20           21           22           23           24           25           26           27 
 0.215924210  0.064763256 -0.153159337 -0.017502569  0.023630343  0.094030777 -0.005202571 -0.167566879  0.055422050 
          28           29           30           31           32           33           34           35           36 
-0.088290780  0.003063887 -0.202152981 -0.014092033  0.028605905 -0.053208176 -0.003185802  0.242540975 -0.007219341 
          37           38           39           40           41           42           43           44           45 
 0.080221426  0.073464321  0.098064317 -0.159209646  0.220279976 -0.003185802 -0.018324952 -0.095384902  0.048429719 
          46           47           48           49           50 
-0.109901049  0.102297236  0.083747549  0.082238195 -0.169492874 
 [ reached getOption("max.print") -- omitted 150 entries ]

hist(M1$residuals)
[1] 41
shapiro.test(M1$residuals)
[1] 42

	Shapiro-Wilk normality test

data:  M1$residuals
W = 0.9905, p-value = 0.2109

summary(M1)
[1] 43

Call:
lm(formula = incidents_log ~ training + empathy_min + years, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.27676 -0.08678 -0.00271  0.07438  0.35035 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.327758   0.030249  10.835  < 2e-16 ***
training2   -0.111288   0.016497  -6.746 1.67e-10 ***
empathy_min  0.018550   0.003372   5.501 1.17e-07 ***
years       -0.010283   0.002769  -3.713 0.000266 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1155 on 196 degrees of freedom
Multiple R-squared:  0.2661,	Adjusted R-squared:  0.2549 
F-statistic: 23.69 on 3 and 196 DF,  p-value: 3.963e-13

M2 <- lm(incidents_log ~ feedback + empathy_min + years, data = data)
[1] 44
summary(M2)
[1] 45

Call:
lm(formula = incidents_log ~ feedback + empathy_min + years, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.27663 -0.07576 -0.00237  0.08302  0.35261 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.227612   0.031463   7.234 1.03e-11 ***
feedback2    0.095615   0.016841   5.677 4.87e-08 ***
empathy_min  0.016926   0.003448   4.909 1.92e-06 ***
years       -0.009257   0.002839  -3.261  0.00131 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1188 on 196 degrees of freedom
Multiple R-squared:  0.2235,	Adjusted R-squared:  0.2116 
F-statistic:  18.8 on 3 and 196 DF,  p-value: 9.283e-11

qqnorm(M2$residuals, ylim = c(-0.4, 0.4))
[1] 46
$x
 [1]  0.780664237 -0.502949184 -1.494672250  0.208293252 -0.106734011 -0.984234960  1.267434417 -0.285840875 -0.590284394
[10] -1.780464342  0.905878812 -0.031337982  2.004654462  0.351784345  0.446826965 -1.267434417 -1.845258117 -0.338481986
[19]  1.004785806  0.488776411 -2.432379059 -0.233980651 -0.730638483  0.763777244 -0.887146559 -1.457421739 -0.405649708
[28] -0.780664237 -0.815126333 -1.669592577 -1.025770021  0.246881415 -1.295928846 -0.068986959  1.213339622 -0.081555738
[37] -0.246881415  0.560703032  0.006266612 -1.422090432  0.964091607 -0.056429069 -1.047215930 -0.850584865 -0.488776411
[46] -1.004785806  0.056429069  0.620391602 -0.221118713 -1.534120544
 [ reached getOption("max.print") -- omitted 150 entries ]

$y
           1            2            3            4            5            6            7            8            9 
 0.093465967 -0.058152338 -0.172281960  0.023312356 -0.016171713 -0.116300189  0.141182952 -0.033547314 -0.062457033 
          10           11           12           13           14           15           16           17           18 
-0.216591397  0.107731005 -0.004197909  0.246150594  0.033158461  0.045479898 -0.153650575 -0.224400118 -0.041226165 
          19           20           21           22           23           24           25           26           27 
 0.115400113  0.052671504 -0.259840418 -0.021385008 -0.079972246  0.090316874 -0.106155482 -0.170254618 -0.045530861 
          28           29           30           31           32           33           34           35           36 
-0.092004683 -0.098486374 -0.215179155 -0.119915487  0.025489352 -0.155355787 -0.008952033  0.138678108 -0.012127944 
          37           38           39           40           41           42           43           44           45 
-0.022523536  0.071802746 -0.002122708 -0.168988792  0.114885336 -0.008952033 -0.124408684 -0.104137884 -0.056964921 
          46           47           48           49           50 
-0.117888145  0.002370489  0.081059810 -0.020935580 -0.178245856 
 [ reached getOption("max.print") -- omitted 150 entries ]

hist(M2$residuals, ylim = c(0, 40))
[1] 47
shapiro.test(M2$residuals)
[1] 48

	Shapiro-Wilk normality test

data:  M2$residuals
W = 0.99572, p-value = 0.8487

residualPlots(M2, ylim = c(-0.6, 0.6))
[1] 49
ncvTest(M2)
[1] 50
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.6746094, Df = 1, p = 0.41145
crPlots(M2)
[1] 51
durbinWatsonTest(M2)
[1] 52
 lag Autocorrelation D-W Statistic p-value
   1       0.2794347      1.431864       0
 Alternative hypothesis: rho != 0
vif(M2)
[1] 53
   feedback empathy_min       years 
   1.005211    1.079397    1.077467 
summary(M2)
[1] 54

Call:
lm(formula = incidents_log ~ feedback + empathy_min + years, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.27663 -0.07576 -0.00237  0.08302  0.35261 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.227612   0.031463   7.234 1.03e-11 ***
feedback2    0.095615   0.016841   5.677 4.87e-08 ***
empathy_min  0.016926   0.003448   4.909 1.92e-06 ***
years       -0.009257   0.002839  -3.261  0.00131 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1188 on 196 degrees of freedom
Multiple R-squared:  0.2235,	Adjusted R-squared:  0.2116 
F-statistic:  18.8 on 3 and 196 DF,  p-value: 9.283e-11

AIC(M1, M2)
[1] 55
   df       AIC
M1  5 -289.9740
M2  5 -278.6673
BIC(M1, M2)
[1] 56
   df       BIC
M1  5 -273.4824
M2  5 -262.1757
M3 <- lm(incidents_log ~ training + feedback + training * feedback + 
    empathy_min + years, data = data)
[1] 57
summary(M3)
[1] 58

Call:
lm(formula = incidents_log ~ training + feedback + training * 
    feedback + empathy_min + years, data = data)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.226383 -0.071808 -0.000811  0.069089  0.284822 

Coefficients:
                     Estimate Std. Error t value Pr(>|t|)    
(Intercept)          0.291484   0.028680  10.163  < 2e-16 ***
training2           -0.151903   0.021123  -7.191 1.36e-11 ***
feedback2            0.058376   0.020716   2.818  0.00533 ** 
empathy_min          0.021048   0.003060   6.878 8.14e-11 ***
years               -0.011505   0.002488  -4.625 6.84e-06 ***
training2:feedback2  0.077604   0.029583   2.623  0.00940 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1034 on 194 degrees of freedom
Multiple R-squared:  0.4176,	Adjusted R-squared:  0.4026 
F-statistic: 27.82 on 5 and 194 DF,  p-value: < 2.2e-16

cat_plot(M3, pred = training, modx = feedback, x.label = "Training", 
    y.label = "No. of Incidents", legend.main = "Feedback", geom = "line", 
    point.shape = TRUE)
[1] 59
qqnorm(M3$residuals, ylim = c(-0.3, 0.3))
[1] 60
$x
 [1]  1.18757726  0.17001289 -1.35631175  0.98423496  0.22111871 -0.31205332  1.62108225  0.35178434 -0.29892142 -1.42209043
[11]  1.29592885  0.78066424  2.80703377  0.94433204  0.79777685 -0.57543077 -1.78046434  0.41929575  1.42209043  1.35631175
[21] -2.24140273  0.50294918 -0.37857970  1.49467225 -0.69828337 -1.06915463 -0.17001289 -0.24688141 -0.56070303 -1.23993348
[31] -0.73063848  0.85058486 -1.18757726  0.59028439  1.72238389  0.54609593  0.08155574  1.26743442  0.27280905 -0.83272472
[41]  1.53412054  0.60526941 -0.76377724 -0.22111871 -0.14463381 -0.32523926  0.32523926  1.45742174  0.13198014 -0.96409161
 [ reached getOption("max.print") -- omitted 150 entries ]

$y
          1           2           3           4           5           6           7           8           9          10 
 0.13063757  0.01676147 -0.14222838  0.10234804  0.02137397 -0.03876433  0.16561482  0.03162290 -0.03615126 -0.14542540 
         11          12          13          14          15          16          17          18          19          20 
 0.13591068  0.08382970  0.28482202  0.09982850  0.08415132 -0.06711928 -0.17224081  0.03780952  0.14545369  0.13882522 
         21          22          23          24          25          26          27          28          29          30 
-0.21629895  0.04678485 -0.04317473  0.15698691 -0.07572783 -0.10583256 -0.01510321 -0.02533465 -0.06618482 -0.12415189 
         31          32          33          34          35          36          37          38          39          40 
-0.07712218  0.09028548 -0.12118033  0.06221397  0.17434988  0.05828990  0.01352583  0.13397682  0.02493122 -0.08620530 
         41          42          43          44          45          46          47          48          49          50 
 0.15730456  0.06221397 -0.08274112 -0.02360237 -0.01454569 -0.04072636  0.03055016  0.14548186  0.01548786 -0.09771035 
 [ reached getOption("max.print") -- omitted 150 entries ]

hist(M3$residuals, ylim = c(0, 40))
[1] 61
shapiro.test(M3$residuals)
[1] 62

	Shapiro-Wilk normality test

data:  M3$residuals
W = 0.99434, p-value = 0.6515

residualPlots(M3, ylim = c(-0.3, 0.3))
[1] 63
ncvTest(M3)
[1] 64
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.577295, Df = 1, p = 0.44737
durbinWatsonTest(M3)
[1] 65
 lag Autocorrelation D-W Statistic p-value
   1      0.09726586      1.794988    0.17
 Alternative hypothesis: rho != 0
vif(M3)
[1] 66
         training          feedback       empathy_min             years training:feedback 
         2.086826          2.007327          1.122147          1.092150          3.070068 
summary(M3)
[1] 67

Call:
lm(formula = incidents_log ~ training + feedback + training * 
    feedback + empathy_min + years, data = data)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.226383 -0.071808 -0.000811  0.069089  0.284822 

Coefficients:
                     Estimate Std. Error t value Pr(>|t|)    
(Intercept)          0.291484   0.028680  10.163  < 2e-16 ***
training2           -0.151903   0.021123  -7.191 1.36e-11 ***
feedback2            0.058376   0.020716   2.818  0.00533 ** 
empathy_min          0.021048   0.003060   6.878 8.14e-11 ***
years               -0.011505   0.002488  -4.625 6.84e-06 ***
training2:feedback2  0.077604   0.029583   2.623  0.00940 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1034 on 194 degrees of freedom
Multiple R-squared:  0.4176,	Adjusted R-squared:  0.4026 
F-statistic: 27.82 on 5 and 194 DF,  p-value: < 2.2e-16

