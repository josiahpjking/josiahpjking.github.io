

	####### B120880 R script #######

library(car, quietly = T)
[1] 1
 [1] "car"       "carData"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[10] "base"     
library(readr, quietly = T)
[1] 2
 [1] "car"       "carData"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[10] "base"     
library(psych, quietly = T)
[1] 3
 [1] "psych"     "car"       "carData"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[10] "methods"   "base"     
install.packages("ez")
[1] 4
library(ez, quietly = T)
[1] 5
 [1] "ez"        "psych"     "car"       "carData"   "readr"     "stats"     "graphics"  "grDevices" "utils"    
[10] "datasets"  "methods"   "base"     
install.packages("emmeans", dependencies = TRUE)
[1] 6
library(emmeans, quietly = T)
[1] 7
 [1] "emmeans"   "ez"        "psych"     "car"       "carData"   "readr"     "stats"     "graphics"  "grDevices"
[10] "utils"     "datasets"  "methods"   "base"     
install.packages("ggplot2", dependencies = TRUE)
[1] 8
library(ggplot2, quietly = T)
[1] 9
 [1] "ggplot2"   "emmeans"   "ez"        "psych"     "car"       "carData"   "readr"     "stats"     "graphics" 
[10] "grDevices" "utils"     "datasets"  "methods"   "base"     
install.packages("jtools")
[1] 10
library(jtools, quietly = T)
[1] 11
 [1] "jtools"    "ggplot2"   "emmeans"   "ez"        "psych"     "car"       "carData"   "readr"     "stats"    
[10] "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
install.packages("interactions")
[1] 12
library(interactions, quietly = T)
[1] 13
 [1] "interactions" "jtools"       "ggplot2"      "emmeans"      "ez"           "psych"        "car"         
 [8] "carData"      "readr"        "stats"        "graphics"     "grDevices"    "utils"        "datasets"    
[15] "methods"      "base"        
rms2 <- read.csv("../RMS2_report_1920.csv")
[1] 14
View(rms2)
[1] 15
describe(rms2)
[1] 16
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training     3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
str(rms2)
[1] 17
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : int  2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : int  2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
rms2$training <- as.factor(rms2$training)
[1] 18
rms2$feedback <- as.factor(rms2$feedback)
[1] 19
str(rms2$training)
[1] 20
 Factor w/ 2 levels "1","2": 2 2 2 2 2 2 2 2 2 2 ...
NULL
summary(rms2$training)
[1] 21
  1   2 
100 100 
str(rms2$feedback)
[1] 22
 Factor w/ 2 levels "1","2": 2 1 2 1 2 1 2 1 2 1 ...
NULL
summary(rms2$feedback)
[1] 23
  1   2 
100 100 
rms2$training <- factor(rms2$training, labels = c("No training", 
    "Training"))
[1] 24
summary(rms2$training)
[1] 25
No training    Training 
        100         100 
rms2$feedback <- factor(rms2$feedback, labels = c("No feedback", 
    "Feedback"))
[1] 26
summary(rms2$feedback)
[1] 27
No feedback    Feedback 
        100         100 
describe(rms2)
[1] 28
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training*    3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
hist(rms2$empathy, col = "pink")
[1] 29
empathymean <- rms2$empathy - mean(rms2$empathy)
[1] 30
hist(empathymean, col = "pink")
[1] 31
lm1a <- lm(empathymean ~ years, data = rms2)
[1] 32
summary(lm1a)
[1] 33

Call:
lm(formula = empathymean ~ years, data = rms2)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) -1.76875    0.49085  -3.603 0.000397 ***
years        0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

plot(lm1a, which = 5, col = "red")
[1] 34
plot(cooks.distance(lm1a), col = "red")
[1] 35
abline(h = cooks.distance(lm1a) > (4/(200 - 1 - 1)), col = "red")
[1] 36
cooks <- cooks.distance(lm1a)
[1] 37
which(cooks > (4/(200 - 1 - 1)))
[1] 38
 16  61  88  89  94 108 137 141 154 163 171 175 192 200 
 16  61  88  89  94 108 137 141 154 163 171 175 192 200 
plot(lm1a, which = 4, col = "red")
[1] 39
lm1out <- lm(empathymean ~ years, data = rms2[-c(88, 137, 154)])
[1] 40
summary(lm1out)
[1] 41

Call:
lm(formula = empathymean ~ years, data = rms2[-c(88, 137, 154)])

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) -1.76875    0.49085  -3.603 0.000397 ***
years        0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

summary(lm1a)
[1] 42

Call:
lm(formula = empathymean ~ years, data = rms2)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) -1.76875    0.49085  -3.603 0.000397 ***
years        0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

qqPlot(lm1a, col = "green")
[1] 43
shapiro.test(lm1a$residuals)
[1] 44

	Shapiro-Wilk normality test

data:  lm1a$residuals
W = 0.98911, p-value = 0.1321

residualPlots(lm1a, col = "green")
[1] 45
crPlots(lm1a, col = "green")
[1] 46
durbinWatsonTest(lm1a)
[1] 47
 lag Autocorrelation D-W Statistic p-value
   1       0.1017162      1.769879   0.106
 Alternative hypothesis: rho != 0
lm1b <- lm(empathymean ~ poly(rms2$years, 2, raw = TRUE))
[1] 48
summary(lm1b)
[1] 49

Call:
lm(formula = empathymean ~ poly(rms2$years, 2, raw = TRUE))

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
                                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)                      -8.988644   0.791848  -11.35   <2e-16 ***
poly(rms2$years, 2, raw = TRUE)1  2.068508   0.181845   11.38   <2e-16 ***
poly(rms2$years, 2, raw = TRUE)2 -0.103645   0.009861  -10.51   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

plot(lm1b, which = 5, col = "purple")
[1] 50
plot(cooks.distance(lm1b), col = "purple")
[1] 51
abline(h = cooks.distance(lm1b) > (4/(200 - 1 - 1)), col = "green")
[1] 52
cooks2 <- cooks.distance(lm1b)
[1] 53
which(cooks > (4/(200 - 1 - 1)))
[1] 54
 16  61  88  89  94 108 137 141 154 163 171 175 192 200 
 16  61  88  89  94 108 137 141 154 163 171 175 192 200 
plot(lm1b, which = 4, col = "green")
[1] 55
lm1c <- lm(empathymean ~ poly(rms2$years, 2, raw = TRUE), data = rms2[-c(89, 
    154, 175)])
[1] 56
summary(lm1c)
[1] 57

Call:
lm(formula = empathymean ~ poly(rms2$years, 2, raw = TRUE), data = rms2[-c(89, 
    154, 175)])

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
                                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)                      -8.988644   0.791848  -11.35   <2e-16 ***
poly(rms2$years, 2, raw = TRUE)1  2.068508   0.181845   11.38   <2e-16 ***
poly(rms2$years, 2, raw = TRUE)2 -0.103645   0.009861  -10.51   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

summary(lm1b)
[1] 58

Call:
lm(formula = empathymean ~ poly(rms2$years, 2, raw = TRUE))

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
                                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)                      -8.988644   0.791848  -11.35   <2e-16 ***
poly(rms2$years, 2, raw = TRUE)1  2.068508   0.181845   11.38   <2e-16 ***
poly(rms2$years, 2, raw = TRUE)2 -0.103645   0.009861  -10.51   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

qqPlot(lm1b, col = "green")
[1] 59
shapiro.test(lm1b$residuals)
[1] 60

	Shapiro-Wilk normality test

data:  lm1b$residuals
W = 0.9941, p-value = 0.6155

residualPlots(lm1b, col = "green")
[1] 61
ncvTest(lm1b)
[1] 62
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.5107658, Df = 1, p = 0.47481
crPlots(lm1b, col = "green")
[1] 63
durbinWatsonTest(lm1b)
[1] 64
 lag Autocorrelation D-W Statistic p-value
   1      0.01288905      1.973855    0.84
 Alternative hypothesis: rho != 0
mr1 <- lm(incidents ~ training + empathymean + years, data = rms2)
[1] 65
summary(mr1)
[1] 66

Call:
lm(formula = incidents ~ training + empathymean + years, data = rms2)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.665721   0.036551  18.214  < 2e-16 ***
trainingTraining -0.152427   0.023166  -6.580 4.20e-10 ***
empathymean       0.025396   0.004735   5.363 2.29e-07 ***
years            -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

plot(mr1, which = 5, col = "red")
[1] 67
plot(cooks.distance(mr1), col = "red")
[1] 68
abline(h = cooks.distance(mr1) > (4/(200 - 3 - 1)), col = "pink")
[1] 69
which(cooks.distance(mr1) > (4/(200 - 3 - 1)))
[1] 70
 13  35  74 137 165 
 13  35  74 137 165 
plot(mr1, which = 4, col = "pink")
[1] 71
mr1a <- lm(incidents ~ training + empathymean + years, data = rms2[-c(13, 
    74, 137)])
[1] 72
summary(mr1a)
[1] 73

Call:
lm(formula = incidents ~ training + empathymean + years, data = rms2[-c(13, 
    74, 137)])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.665721   0.036551  18.214  < 2e-16 ***
trainingTraining -0.152427   0.023166  -6.580 4.20e-10 ***
empathymean       0.025396   0.004735   5.363 2.29e-07 ***
years            -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

summary(mr1)
[1] 74

Call:
lm(formula = incidents ~ training + empathymean + years, data = rms2)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.665721   0.036551  18.214  < 2e-16 ***
trainingTraining -0.152427   0.023166  -6.580 4.20e-10 ***
empathymean       0.025396   0.004735   5.363 2.29e-07 ***
years            -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

mr1out <- lm(incidents ~ training + empathymean + years, data = rms2[-c(13, 
    74, 137)])
[1] 75
summary(mr1out)
[1] 76

Call:
lm(formula = incidents ~ training + empathymean + years, data = rms2[-c(13, 
    74, 137)])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.665721   0.036551  18.214  < 2e-16 ***
trainingTraining -0.152427   0.023166  -6.580 4.20e-10 ***
empathymean       0.025396   0.004735   5.363 2.29e-07 ***
years            -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

summary(mr1)
[1] 77

Call:
lm(formula = incidents ~ training + empathymean + years, data = rms2)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.665721   0.036551  18.214  < 2e-16 ***
trainingTraining -0.152427   0.023166  -6.580 4.20e-10 ***
empathymean       0.025396   0.004735   5.363 2.29e-07 ***
years            -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

crPlots(mr1, col = "purple")
[1] 78
residualPlots(mr1, col = "purple")
[1] 79
ncvTest(mr1)
[1] 80
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0293323, Df = 1, p = 0.86401
qqPlot(mr1, col = "purple")
[1] 81
durbinWatsonTest(mr1)
[1] 82
 lag Autocorrelation D-W Statistic p-value
   1      -0.1072849      2.199897    0.16
 Alternative hypothesis: rho != 0
vif(mr1)
[1] 83
   training empathymean       years 
   1.020633    1.092467    1.085089 
check <- lm(incidents ~ feedback, data = rms2)
[1] 84
checktraining <- lm(incidents ~ feedback + training, data = rms2)
[1] 85
summary(check)
[1] 86

Call:
lm(formula = incidents ~ feedback, data = rms2)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.45333 -0.12000  0.00333  0.13000  0.50333 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.41333    0.01765   23.41  < 2e-16 ***
feedbackFeedback  0.12333    0.02496    4.94 1.66e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1765 on 198 degrees of freedom
Multiple R-squared:  0.1097,	Adjusted R-squared:  0.1052 
F-statistic: 24.41 on 1 and 198 DF,  p-value: 1.656e-06

summary(checktraining)
[1] 87

Call:
lm(formula = incidents ~ feedback + training, data = rms2)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.38667 -0.11167 -0.01333  0.07000  0.44667 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.48000    0.02005  23.937  < 2e-16 ***
feedbackFeedback  0.12333    0.02315   5.326 2.72e-07 ***
trainingTraining -0.13333    0.02315  -5.758 3.22e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1637 on 197 degrees of freedom
Multiple R-squared:  0.238,	Adjusted R-squared:  0.2303 
F-statistic: 30.76 on 2 and 197 DF,  p-value: 2.359e-12

mr2 <- lm(incidents ~ feedback + empathymean + years, data = rms2)
[1] 88
summary(mr2)
[1] 89

Call:
lm(formula = incidents ~ feedback + empathymean + years, data = rms2)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.512093   0.035846  14.286  < 2e-16 ***
feedbackFeedback  0.132132   0.023585   5.602 7.09e-08 ***
empathymean       0.023187   0.004829   4.802 3.11e-06 ***
years            -0.012689   0.003975  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

plot(cooks.distance(mr2), col = "green")
[1] 90
abline(h = cooks.distance(mr2) > (4/(200 - 3 - 1)), col = "pink")
[1] 91
which(cooks.distance(mr2) > (4/(200 - 3 - 1)))
[1] 92
 73  74  89 137 156 160 165 176 
 73  74  89 137 156 160 165 176 
plot(mr2, which = 4, col = "purple")
[1] 93
mr2a <- lm(incidents ~ feedback + empathymean + years, data = rms2[-c(13, 
    137, 176)])
[1] 94
summary(mr2a)
[1] 95

Call:
lm(formula = incidents ~ feedback + empathymean + years, data = rms2[-c(13, 
    137, 176)])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.512093   0.035846  14.286  < 2e-16 ***
feedbackFeedback  0.132132   0.023585   5.602 7.09e-08 ***
empathymean       0.023187   0.004829   4.802 3.11e-06 ***
years            -0.012689   0.003975  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

summary(mr2)
[1] 96

Call:
lm(formula = incidents ~ feedback + empathymean + years, data = rms2)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.512093   0.035846  14.286  < 2e-16 ***
feedbackFeedback  0.132132   0.023585   5.602 7.09e-08 ***
empathymean       0.023187   0.004829   4.802 3.11e-06 ***
years            -0.012689   0.003975  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

plot(mr2, which = 5, col = "purple")
[1] 97
mr2out <- lm(incidents ~ feedback + empathymean + years, data = rms2[-c(13, 
    137, 176)])
[1] 98
summary(mr2out)
[1] 99

Call:
lm(formula = incidents ~ feedback + empathymean + years, data = rms2[-c(13, 
    137, 176)])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.512093   0.035846  14.286  < 2e-16 ***
feedbackFeedback  0.132132   0.023585   5.602 7.09e-08 ***
empathymean       0.023187   0.004829   4.802 3.11e-06 ***
years            -0.012689   0.003975  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

summary(mr2)
[1] 100

Call:
lm(formula = incidents ~ feedback + empathymean + years, data = rms2)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.512093   0.035846  14.286  < 2e-16 ***
feedbackFeedback  0.132132   0.023585   5.602 7.09e-08 ***
empathymean       0.023187   0.004829   4.802 3.11e-06 ***
years            -0.012689   0.003975  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

plot(mr2, which = 5, col = "purple")
[1] 101
crPlots(mr2, col = "purple")
[1] 102
residualPlots(mr2, col = "purple")
[1] 103
ncvTest(mr2)
[1] 104
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.01731234, Df = 1, p = 0.89532
qqPlot(mr2, col = "purple")
[1] 105
durbinWatsonTest(mr2)
[1] 106
 lag Autocorrelation D-W Statistic p-value
   1       0.2738264      1.444081       0
 Alternative hypothesis: rho != 0
vif(mr2)
[1] 107
   feedback empathymean       years 
   1.005211    1.079397    1.077467 
AIC(mr1, mr2)
[1] 108
    df       AIC
mr1  5 -154.1654
mr2  5 -143.9591
BIC(mr1, mr2)
[1] 109
    df       BIC
mr1  5 -137.6738
mr2  5 -127.4675
mr3 <- lm(rms2$incidents ~ rms2$training * rms2$feedback)
[1] 110
summary(mr3)
[1] 111

Call:
lm(formula = rms2$incidents ~ rms2$training * rms2$feedback)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40000 -0.10500  0.00000  0.08333  0.43333 

Coefficients:
                                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                                  0.49333    0.02314  21.323  < 2e-16 ***
rms2$trainingTraining                       -0.16000    0.03272  -4.890 2.09e-06 ***
rms2$feedbackFeedback                        0.09667    0.03272   2.954  0.00352 ** 
rms2$trainingTraining:rms2$feedbackFeedback  0.05333    0.04627   1.153  0.25047    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1636 on 196 degrees of freedom
Multiple R-squared:  0.2431,	Adjusted R-squared:  0.2315 
F-statistic: 20.99 on 3 and 196 DF,  p-value: 7.827e-12

durbinWatsonTest(mr3)
[1] 112
 lag Autocorrelation D-W Statistic p-value
   1       0.1114255      1.770733   0.112
 Alternative hypothesis: rho != 0
qqPlot(mr3)
[1] 113
residualPlots(mr3, col = "purple")
[1] 114
emcatcat <- emmeans(mr3, ~training | feedback)
[1] 115
summary(emcatcat)
[1] 116
feedback = No feedback:
 training    emmean     SE  df lower.CL upper.CL
 No training  0.493 0.0231 196    0.448    0.539
 Training     0.333 0.0231 196    0.288    0.379

feedback = Feedback:
 training    emmean     SE  df lower.CL upper.CL
 No training  0.590 0.0231 196    0.544    0.636
 Training     0.483 0.0231 196    0.438    0.529

Confidence level used: 0.95 
contrast(emcatcat, "pairwise", by = "feedback", adjust = "none")
[1] 117
feedback = No feedback:
 contrast               estimate     SE  df t.ratio p.value
 No training - Training    0.160 0.0327 196 4.890   <.0001 

feedback = Feedback:
 contrast               estimate     SE  df t.ratio p.value
 No training - Training    0.107 0.0327 196 3.260   0.0013 

emmip(mr3, feedback ~ training, CIs = TRUE, col = "purple")
[1] 118
interaction.plot(x.factor = rms2$training, trace.factor = rms2$feedback, 
    response = rms2$incidents, main = "Interaction Plot of Feedback and Training", 
    col = "Purple")
[1] 119
