

	####### B124398 R script #######

library(psych, quietly = T)
[1] 1
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 2
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[10] "methods"   "base"     
library(interactions, quietly = T)
[1] 3
 [1] "interactions" "car"          "carData"      "psych"        "readr"        "stats"        "graphics"    
 [8] "grDevices"    "utils"        "datasets"     "methods"      "base"        
setwd("~/Downloads")
[1] 4
data <- read.csv("../RMS2_report_1920.csv")
[1] 5
describe(data)[, c(2:4, 8, 9)]
[1] 6
            n   mean    sd  min    max
subject   200 100.50 57.88 1.00 200.00
incidents 200   0.48  0.19 0.08   0.92
training  200   1.50  0.50 1.00   2.00
feedback  200   1.50  0.50 1.00   2.00
empathy   200  10.18  2.54 3.00  16.00
years     200   8.13  3.08 1.00  19.00
plot(data$years, data$empathy, xlab = "Years of Experience", 
    ylab = "Empathy", main = "Empathy vs Years of Experience")
[1] 7
data$empathy <- data$empathy - mean(data$empathy)
[1] 8
lm(data$years ~ data$empathy)
[1] 9

Call:
lm(formula = data$years ~ data$empathy)

Coefficients:
 (Intercept)  data$empathy  
      8.1300        0.3204  

lm1 <- lm(data$empathy ~ data$years)
[1] 10
plot(data$years, data$empathy, xlab = "Years of Experience", 
    ylab = "Empathy", main = "Empathy vs Years of Experience")
[1] 11
abline(lm1)
[1] 12
summary(lm1)
[1] 13

Call:
lm(formula = data$empathy ~ data$years)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) -1.76875    0.49085  -3.603 0.000397 ***
data$years   0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

plot(lm1)
[1] 14
lm2 <- lm(data$empathy ~ data$years + I(data$years^2))
[1] 15
summary(lm2)
[1] 16

Call:
lm(formula = data$empathy ~ data$years + I(data$years^2))

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)     -8.988644   0.791848  -11.35   <2e-16 ***
data$years       2.068508   0.181845   11.38   <2e-16 ***
I(data$years^2) -0.103645   0.009861  -10.51   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

plot(lm2)
[1] 17
plot(lm2, which = 4)
[1] 18
which(cooks.distance(lm2) > (4/(200 - 1 - 1)))
[1] 19
 61  89 137 141 154 163 165 175 
 61  89 137 141 154 163 165 175 
LM2 <- lm(data$empathy ~ data$years + I(years^2), data = data, 
    subset = -c(61, 89, 137, 141, 154, 163, 165, 175))
[1] 20
summary(LM2)
[1] 21

Call:
lm(formula = data$empathy ~ data$years + I(years^2), data = data, 
    subset = -c(61, 89, 137, 141, 154, 163, 165, 175))

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5344 -1.1205  0.1144  1.2235  4.8795 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) -9.32753    0.96042  -9.712  < 2e-16 ***
data$years   2.14585    0.23421   9.162  < 2e-16 ***
I(years^2)  -0.10772    0.01353  -7.962 1.54e-13 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.912 on 189 degrees of freedom
Multiple R-squared:  0.3587,	Adjusted R-squared:  0.3519 
F-statistic: 52.86 on 2 and 189 DF,  p-value: < 2.2e-16

plot(lm2, which = 2)
[1] 22
hist(lm2$residuals, xlab = "Residuals of Empathy and Years of Experience", 
    main = "Histogram of Residuals")
[1] 23
residualPlots(lm2)
[1] 24
crPlots(lm2)
[1] 25
durbinWatsonTest(lm2)
[1] 26
 lag Autocorrelation D-W Statistic p-value
   1      0.01288905      1.973855    0.82
 Alternative hypothesis: rho != 0
shapiro.test(lm2$residuals)
[1] 27

	Shapiro-Wilk normality test

data:  lm2$residuals
W = 0.9941, p-value = 0.6155

ncvTest(lm2)
[1] 28
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.5107658, Df = 1, p = 0.47481
confint(lm2)
[1] 29
                      2.5 %      97.5 %
(Intercept)     -10.5502312 -7.42705651
data$years        1.7098945  2.42712124
I(data$years^2)  -0.1230923 -0.08419814
data$training <- as.factor(data$training)
[1] 30
data$training <- factor(data$training, labels = c("No Training", 
    "Training"))
[1] 31
str(data$training)
[1] 32
 Factor w/ 2 levels "No Training",..: 2 2 2 2 2 2 2 2 2 2 ...
NULL
summary(data$training)
[1] 33
No Training    Training 
        100         100 
m1 <- lm(data$incidents ~ data$training + data$empathy + data$years)
[1] 34
summary(m1)
[1] 35

Call:
lm(formula = data$incidents ~ data$training + data$empathy + 
    data$years)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                       Estimate Std. Error t value Pr(>|t|)    
(Intercept)            0.665721   0.036551  18.214  < 2e-16 ***
data$trainingTraining -0.152427   0.023166  -6.580 4.20e-10 ***
data$empathy           0.025396   0.004735   5.363 2.29e-07 ***
data$years            -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

plot(m1)
[1] 36
qqPlot(m1)
[1] 37
shapiro.test(m1$residuals)
[1] 38

	Shapiro-Wilk normality test

data:  m1$residuals
W = 0.97994, p-value = 0.005838

hist(m1$residuals, xlab = "Residuals of Model 1", main = "Histogram of Residuals of Model 1")
[1] 39
residualPlots(m1)
[1] 40
crPlots(m1)
[1] 41
durbinWatsonTest(m1)
[1] 42
 lag Autocorrelation D-W Statistic p-value
   1      -0.1072849      2.199897   0.192
 Alternative hypothesis: rho != 0
ncvTest(m1)
[1] 43
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0293323, Df = 1, p = 0.86401
confint(m1)
[1] 44
                            2.5 %       97.5 %
(Intercept)            0.59363751  0.737803982
data$trainingTraining -0.19811433 -0.106739356
data$empathy           0.01605669  0.034734598
data$years            -0.02175353 -0.006415556
data$feedback <- as.factor(data$feedback)
[1] 45
data$feedback <- factor(data$feedback, labels = c("No Feedback", 
    "Feedback"))
[1] 46
str(data$feedback)
[1] 47
 Factor w/ 2 levels "No Feedback",..: 2 1 2 1 2 1 2 1 2 1 ...
NULL
summary(data$training)
[1] 48
No Training    Training 
        100         100 
plot(data$feedback, data$incidents, xlab = "Feedback", ylab = "Incidents", 
    main = "Box Plot of Feedback on Interventions on Bullying")
[1] 49
M2 <- lm(data$incidents ~ data$feedback + data$empathy + data$years)
[1] 50
summary(M2)
[1] 51

Call:
lm(formula = data$incidents ~ data$feedback + data$empathy + 
    data$years)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                       Estimate Std. Error t value Pr(>|t|)    
(Intercept)            0.512093   0.035846  14.286  < 2e-16 ***
data$feedbackFeedback  0.132132   0.023585   5.602 7.09e-08 ***
data$empathy           0.023187   0.004829   4.802 3.11e-06 ***
data$years            -0.012689   0.003975  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

qqPlot(M2)
[1] 52
shapiro.test(M2$residuals)
[1] 53

	Shapiro-Wilk normality test

data:  M2$residuals
W = 0.98772, p-value = 0.08174

hist(M2$residuals, xlab = "Residuals of Model 2", main = "Histogram of Residuals of Model 2")
[1] 54
residualPlots(M2)
[1] 55
crPlots(M2)
[1] 56
durbinWatsonTest(M2)
[1] 57
 lag Autocorrelation D-W Statistic p-value
   1       0.2738264      1.444081       0
 Alternative hypothesis: rho != 0
ncvTest(M2)
[1] 58
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.01731234, Df = 1, p = 0.89532
confint(M2)
[1] 59
                            2.5 %       97.5 %
(Intercept)            0.44139942  0.582785691
data$feedbackFeedback  0.08561885  0.178644455
data$empathy           0.01366456  0.032710219
data$years            -0.02052811 -0.004849104
AIC(m1, M2)
[1] 60
   df       AIC
m1  5 -154.1654
M2  5 -143.9591
BIC(m1, M2)
[1] 61
   df       BIC
m1  5 -137.6738
M2  5 -127.4675
M3 <- lm(incidents ~ training + feedback + years + empathy + 
    training * feedback, data = data)
[1] 62
summary(M3)
[1] 63

Call:
lm(formula = incidents ~ training + feedback + years + empathy + 
    training * feedback, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30367 -0.10365 -0.00795  0.08806  0.44359 

Coefficients:
                                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)                        0.637438   0.036309  17.556  < 2e-16 ***
trainingTraining                  -0.203496   0.029874  -6.812 1.18e-10 ***
feedbackFeedback                   0.085558   0.029299   2.920  0.00391 ** 
years                             -0.015720   0.003518  -4.468 1.34e-05 ***
empathy                            0.028695   0.004328   6.630 3.25e-10 ***
trainingTraining:feedbackFeedback  0.097334   0.041840   2.326  0.02103 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1462 on 194 degrees of freedom
Multiple R-squared:  0.4015,	Adjusted R-squared:  0.386 
F-statistic: 26.02 on 5 and 194 DF,  p-value: < 2.2e-16

cat_plot(M3, pred = training, modx = feedback, geom = "line", 
    main = "Training and Feedback Interactions", data = data)
[1] 64
qqPlot(M3)
[1] 65
shapiro.test(M3$residuals)
[1] 66

	Shapiro-Wilk normality test

data:  M3$residuals
W = 0.98794, p-value = 0.08817

hist(M3$residuals, xlab = "residuals of Model 3", main = "Histogram of Residuals of Model 2")
[1] 67
residualPlot(M3)
[1] 68
ncvTest(M3)
[1] 69
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 4.398557, Df = 1, p = 0.035969
confint(M3)
[1] 70
                                        2.5 %       97.5 %
(Intercept)                        0.56582638  0.709049411
trainingTraining                  -0.26241518 -0.144577748
feedbackFeedback                   0.02777246  0.143343544
years                             -0.02265877 -0.008780863
empathy                            0.02015864  0.037231125
trainingTraining:feedbackFeedback  0.01481491  0.179852742
