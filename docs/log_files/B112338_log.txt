

	####### B112338 R script #######

library(psych, quietly = T)
[1] 1
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 2
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[10] "methods"   "base"     
bullying <- read.csv("../RMS2_report_1920.csv")
[1] 3
describe <- describe(bullying)[, c(3:4, 8:9)]
[1] 4
describe

            mean    sd  min    max
subject   100.50 57.88 1.00 200.00
incidents   0.48  0.19 0.08   0.92
training    1.50  0.50 1.00   2.00
feedback    1.50  0.50 1.00   2.00
empathy    10.18  2.54 3.00  16.00
years       8.13  3.08 1.00  19.00


str(bullying)
[1] 6
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : int  2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : int  2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
bullying$training <- as.factor(bullying$training)
[1] 7
is.factor(bullying$training)
[1] 8
[1] TRUE
bullying$feedback <- as.factor(bullying$feedback)
[1] 9
is.factor(bullying$feedback)
[1] 10
[1] TRUE
m1 <- lm(empathy ~ years, data = bullying)
[1] 11
shapiro.test(m1$residuals)
[1] 12

	Shapiro-Wilk normality test

data:  m1$residuals
W = 0.98911, p-value = 0.1321

qqPlot(m1, main = "QQ plot for m1")
[1] 13
residualPlots(m1)
[1] 14
ncvTest(m1)
[1] 15
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.9815033, Df = 1, p = 0.32183
durbinWatsonTest(m1)
[1] 16
 lag Autocorrelation D-W Statistic p-value
   1       0.1017162      1.769879   0.118
 Alternative hypothesis: rho != 0
crPlots(m1)
[1] 17
bullying$empathy <- log(bullying$empathy)
[1] 18
m1 <- lm(empathy ~ years, data = bullying)
[1] 19
summary(m1)
[1] 20

Call:
lm(formula = empathy ~ years, data = bullying)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.00538 -0.14174  0.05342  0.17777  0.51695 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 2.045922   0.056534  36.189  < 2e-16 ***
years       0.029035   0.006505   4.463 1.35e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.2825 on 198 degrees of freedom
Multiple R-squared:  0.09142,	Adjusted R-squared:  0.08683 
F-statistic: 19.92 on 1 and 198 DF,  p-value: 1.352e-05

boxplot(bullying$incidents)
[1] 21
m2 <- lm(incidents ~ training + empathy + years, data = bullying)
[1] 22
shapiro.test(m2$residuals)
[1] 23

	Shapiro-Wilk normality test

data:  m2$residuals
W = 0.9792, p-value = 0.004582

qqPlot(m2)
[1] 24
residualPlots(m2)
[1] 25
ncvTest(m2)
[1] 26
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0381271, Df = 1, p = 0.84519
durbinWatsonTest(m2)
[1] 27
 lag Autocorrelation D-W Statistic p-value
   1      -0.1004484      2.184406   0.192
 Alternative hypothesis: rho != 0
crPlots(m2)
[1] 28
vif(m2)
[1] 29
training  empathy    years 
1.014885 1.112263 1.110266 
summary(m2)
[1] 30

Call:
lm(formula = incidents ~ training + empathy + years, data = bullying)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.33181 -0.11893 -0.01532  0.09530  0.51864 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.156441   0.089278   1.752 0.081287 .  
training2   -0.149732   0.023002  -6.510 6.17e-10 ***
empathy      0.226197   0.040823   5.541 9.61e-08 ***
years       -0.015099   0.003917  -3.855 0.000157 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1615 on 196 degrees of freedom
Multiple R-squared:  0.2628,	Adjusted R-squared:  0.2515 
F-statistic: 23.29 on 3 and 196 DF,  p-value: 6.132e-13

m3 <- lm(incidents ~ feedback + empathy + years, data = bullying)
[1] 31
shapiro.test(m3$residuals)
[1] 32

	Shapiro-Wilk normality test

data:  m3$residuals
W = 0.98719, p-value = 0.06802

qqPlot(m3)
[1] 33
residualPlots(m3)
[1] 34
ncvTest(m3)
[1] 35
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.02899987, Df = 1, p = 0.86478
durbinWatsonTest(m3)
[1] 36
 lag Autocorrelation D-W Statistic p-value
   1       0.2695744      1.447146       0
 Alternative hypothesis: rho != 0
crPlots(m3)
[1] 37
vif(m3)
[1] 38
feedback  empathy    years 
1.002818 1.102549 1.102724 
summary(m3)
[1] 39

Call:
lm(formula = incidents ~ feedback + empathy + years, data = bullying)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.33823 -0.10208 -0.01322  0.10777  0.52785 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.045255   0.092532   0.489 0.625334    
feedback2    0.129768   0.023450   5.534 9.96e-08 ***
empathy      0.208661   0.041685   5.006 1.24e-06 ***
years       -0.013690   0.004003  -3.420 0.000763 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1656 on 196 degrees of freedom
Multiple R-squared:  0.2246,	Adjusted R-squared:  0.2127 
F-statistic: 18.92 on 3 and 196 DF,  p-value: 8.062e-11

AIC(m2, m3)
[1] 40
   df       AIC
m2  5 -155.8856
m3  5 -145.7748
BIC(m2, m3)
[1] 41
   df       BIC
m2  5 -139.3940
m3  5 -129.2832
m4 <- lm(incidents ~ training + feedback + training:feedback, 
    data = bullying)
[1] 42
shapiro.test(m4$residuals)
[1] 43

	Shapiro-Wilk normality test

data:  m4$residuals
W = 0.9767, p-value = 0.002072

qqPlot(m4)
[1] 44
residualPlots(m4)
[1] 45
ncvTest(m4)
[1] 46
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 1.881673, Df = 1, p = 0.17014
durbinWatsonTest(m4)
[1] 47
 lag Autocorrelation D-W Statistic p-value
   1       0.1114255      1.770733   0.154
 Alternative hypothesis: rho != 0
vif(m4)
[1] 48
         training          feedback training:feedback 
                2                 2                 3 
avPlots(m4)
[1] 49
summary(m4)
[1] 50

Call:
lm(formula = incidents ~ training + feedback + training:feedback, 
    data = bullying)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40000 -0.10500  0.00000  0.08333  0.43333 

Coefficients:
                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)          0.49333    0.02314  21.323  < 2e-16 ***
training2           -0.16000    0.03272  -4.890 2.09e-06 ***
feedback2            0.09667    0.03272   2.954  0.00352 ** 
training2:feedback2  0.05333    0.04627   1.153  0.25047    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1636 on 196 degrees of freedom
Multiple R-squared:  0.2431,	Adjusted R-squared:  0.2315 
F-statistic: 20.99 on 3 and 196 DF,  p-value: 7.827e-12

