

	####### B112000 R script #######

install.packages("psych")
[1] 1
install.packages("car")
[1] 2
install.packages("interactions")
[1] 3
install.packages("lmtest")
[1] 4
library("psych", quietly = T)
[1] 5
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library("car", quietly = T)
[1] 6
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
library("interactions", quietly = T)
[1] 7
 [1] "interactions" "car"          "carData"      "psych"        "readr"        "stats"        "graphics"     "grDevices"   
 [9] "utils"        "datasets"     "methods"      "base"        
library("lmtest", quietly = T)
[1] 8
 [1] "lmtest"       "zoo"          "interactions" "car"          "carData"      "psych"        "readr"        "stats"       
 [9] "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
getwd()
[1] 9
[1] "/home/josiah/Desktop/rms2/code_check/turnitinuk_original_bulk_download"
setwd()
[1] 10
my_data <- read.csv("~/Desktop/rms2/code_check/RMS2_report_1920.csv")
[1] 11
str(my_data)
[1] 12
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : int  2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : int  2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
describeBy(my_data)
[1] 13
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training     3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
is.factor(my_data$training)
[1] 14
[1] FALSE
my_data$training <- factor(my_data$training, labels = c("no training", 
    "training"))
[1] 15
is.factor(my_data$training)
[1] 16
[1] TRUE
is.factor(my_data$feedback)
[1] 17
[1] FALSE
my_data$feedback <- factor(my_data$feedback, labels = c("no feedback", 
    "feedback"))
[1] 18
is.factor(my_data$feedback)
[1] 19
[1] TRUE
summary(my_data$incidents)
[1] 20
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
0.08333 0.33333 0.41667 0.47500 0.58333 0.91667 
summary(my_data$empathy)
[1] 21
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   3.00    9.00   10.00   10.18   12.00   16.00 
summary(my_data$years)
[1] 22
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1.00    6.00    8.00    8.13   10.00   19.00 
model_1 <- lm(empathy ~ years, data = my_data)
[1] 23
summary(model_1)
[1] 24

Call:
lm(formula = empathy ~ years, data = my_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  8.40625    0.49085  17.126  < 2e-16 ***
years        0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

crPlots(model_1)
[1] 25
hist(model_1$residuals)
[1] 26
qqPlot(model_1$residuals)
[1] 27
shapiro.test(model_1$residuals)
[1] 28

	Shapiro-Wilk normality test

data:  model_1$residuals
W = 0.98911, p-value = 0.1321

durbinWatsonTest(model_1)
[1] 29
 lag Autocorrelation D-W Statistic p-value
   1       0.1017162      1.769879   0.096
 Alternative hypothesis: rho != 0
residualPlots(model_1)
[1] 30
ncvTest(model_1)
[1] 31
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.9815033, Df = 1, p = 0.32183
plot(model_1, which = 4)
[1] 32
years_squared <- my_data$years * my_data$years
[1] 33
model_1b <- lm(empathy ~ years + years_squared, data = my_data)
[1] 34
summary(model_1b)
[1] 35

Call:
lm(formula = empathy ~ years + years_squared, data = my_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)    1.186356   0.791848   1.498    0.136    
years          2.068508   0.181845  11.375   <2e-16 ***
years_squared -0.103645   0.009861 -10.510   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

crPlots(model_1b)
[1] 36
hist(model_1b$residuals, main = "Histogram of Model 1b Residuals", 
    xlab = "Frequency", ylab = "Residuals")
[1] 37
qqPlot(model_1b$residuals, main = "QQ-Plot of Model 1b Residuals", 
    xlab = "Norm Quantiles", ylab = "Residuals")
[1] 38
shapiro.test(model_1b$residuals)
[1] 39

	Shapiro-Wilk normality test

data:  model_1b$residuals
W = 0.9941, p-value = 0.6155

durbinWatsonTest(model_1b)
[1] 40
 lag Autocorrelation D-W Statistic p-value
   1      0.01288905      1.973855   0.816
 Alternative hypothesis: rho != 0
residualPlots(model_1b)
[1] 41
ncvTest(model_1b)
[1] 42
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.5107658, Df = 1, p = 0.47481
plot(model_1b, which = 4)
[1] 43
model_2 <- lm(incidents ~ training + empathy + years, data = my_data)
[1] 44
summary(model_2)
[1] 45

Call:
lm(formula = incidents ~ training + empathy + years, data = my_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.407320   0.051814   7.861 2.48e-13 ***
trainingtraining -0.152427   0.023166  -6.580 4.20e-10 ***
empathy           0.025396   0.004735   5.363 2.29e-07 ***
years            -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

hist(model_2$residuals, main = "Histogram of Model 2 Residuals", 
    xlab = "Model 2 Residuals", ylab = "Frequency")
[1] 46
qqPlot(model_2$residuals, main = "QQ-Plot of Model 2 Residuals", 
    xlab = "Norm Quantiles", ylab = "Residuals")
[1] 47
shapiro.test(model_2$residuals)
[1] 48

	Shapiro-Wilk normality test

data:  model_2$residuals
W = 0.97994, p-value = 0.005838

durbinWatsonTest(model_2)
[1] 49
 lag Autocorrelation D-W Statistic p-value
   1      -0.1072849      2.199897   0.174
 Alternative hypothesis: rho != 0
residualPlots(model_2)
[1] 50
ncvTest(model_2)
[1] 51
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0293323, Df = 1, p = 0.86401
crPlots(model_2)
[1] 52
vif(model_2)
[1] 53
training  empathy    years 
1.020633 1.092467 1.085089 
plot(model_2, which = 4)
[1] 54
model_3 <- lm(incidents ~ feedback + training + empathy + years, 
    data = my_data)
[1] 55
summary(model_3)
[1] 56

Call:
lm(formula = incidents ~ feedback + training + empathy + years, 
    data = my_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.31626 -0.10096 -0.00949  0.09165  0.46650 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.331953   0.048708   6.815 1.15e-10 ***
feedbackfeedback  0.133715   0.020968   6.377 1.28e-09 ***
trainingtraining -0.153824   0.021128  -7.281 7.98e-12 ***
empathy           0.027191   0.004328   6.283 2.12e-09 ***
years            -0.015199   0.003551  -4.281 2.92e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1479 on 195 degrees of freedom
Multiple R-squared:  0.3848,	Adjusted R-squared:  0.3721 
F-statistic: 30.49 on 4 and 195 DF,  p-value: < 2.2e-16

hist(model_3$residuals, main = "Histogram of Model 3 Residuals", 
    xlab = "Model 3 Residuals", ylab = "Frequency")
[1] 57
qqPlot(model_3$residuals, main = "QQ-Plot of Model 3 Residuals", 
    xlab = "Norm Quantiles", ylab = "Residuals")
[1] 58
shapiro.test(model_3$residuals)
[1] 59

	Shapiro-Wilk normality test

data:  model_3$residuals
W = 0.98734, p-value = 0.07172

durbinWatsonTest(model_3)
[1] 60
 lag Autocorrelation D-W Statistic p-value
   1      0.07303546      1.841386   0.258
 Alternative hypothesis: rho != 0
residualPlots(model_3)
[1] 61
ncvTest(model_3)
[1] 62
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 3.684027, Df = 1, p = 0.054936
crPlots(model_3)
[1] 63
vif(model_3)
[1] 64
feedback training  empathy    years 
1.005320 1.020743 1.097109 1.087722 
plot(model_3, which = 4)
[1] 65
AIC(model_2, model_3)
[1] 66
        df       AIC
model_2  5 -154.1654
model_3  6 -190.0499
BIC(model_2, model_3)
[1] 67
        df       BIC
model_2  5 -137.6738
model_3  6 -170.2600
anova(model_2, model_3)
[1] 68
Analysis of Variance Table

Model 1: incidents ~ training + empathy + years
Model 2: incidents ~ feedback + training + empathy + years
  Res.Df    RSS Df Sum of Sq      F    Pr(>F)    
1    196 5.1532                                  
2    195 4.2639  1   0.88925 40.668 1.279e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
model_5 <- lm(incidents ~ training + feedback + empathy + years + 
    training * feedback, data = my_data)
[1] 69
summary(model_5)
[1] 70

Call:
lm(formula = incidents ~ training + feedback + empathy + years + 
    training * feedback, data = my_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30367 -0.10365 -0.00795  0.08806  0.44359 

Coefficients:
                                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)                        0.345467   0.048515   7.121 2.04e-11 ***
trainingtraining                  -0.203496   0.029874  -6.812 1.18e-10 ***
feedbackfeedback                   0.085558   0.029299   2.920  0.00391 ** 
empathy                            0.028695   0.004328   6.630 3.25e-10 ***
years                             -0.015720   0.003518  -4.468 1.34e-05 ***
trainingtraining:feedbackfeedback  0.097334   0.041840   2.326  0.02103 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1462 on 194 degrees of freedom
Multiple R-squared:  0.4015,	Adjusted R-squared:  0.386 
F-statistic: 26.02 on 5 and 194 DF,  p-value: < 2.2e-16

hist(model_5$residuals, main = "Histogram of Model 5 Residuals", 
    xlab = "Model 5 Residuals", ylab = "Frequency")
[1] 71
qqPlot(model_5$residuals, main = "QQ-Plot of Model 5 Residuals", 
    xlab = "Model 5 Residuals", ylab = "Frequency")
[1] 72
shapiro.test(model_5$residuals)
[1] 73

	Shapiro-Wilk normality test

data:  model_5$residuals
W = 0.98794, p-value = 0.08817

durbinWatsonTest(model_5)
[1] 74
 lag Autocorrelation D-W Statistic p-value
   1      0.09456969      1.801048   0.208
 Alternative hypothesis: rho != 0
residualPlots(model_5)
[1] 75
ncvTest(model_5)
[1] 76
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 4.398557, Df = 1, p = 0.035969
vif(model_5)
[1] 77
         training          feedback           empathy             years training:feedback 
         2.086826          2.007327          1.122147          1.092150          3.070068 
plot(model_5, which = 4)
[1] 78
