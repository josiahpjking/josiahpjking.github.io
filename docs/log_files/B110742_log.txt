

	####### B110742 R script #######

library(readr, quietly = T)
[1] 1
[1] "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(psych, quietly = T)
[1] 2
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(ggfortify, quietly = T)
[1] 3
 [1] "ggfortify" "ggplot2"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
library(car, quietly = T)
[1] 4
 [1] "car"       "carData"   "ggfortify" "ggplot2"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"    
[11] "datasets"  "methods"   "base"     
RMS2_report_1920 <- read.csv("~/Desktop/rms2/code_check/RMS2_report_1920.csv")
[1] 5
View(RMS2_report_1920)
[1] 6
sum_of_model <- describe(RMS2_report_1920)
[1] 7
View(sum_of_model)
[1] 8
RMS2_report_1920$training <- as.factor(RMS2_report_1920$training)
[1] 9
RMS2_report_1920$feedback <- as.factor(RMS2_report_1920$feedback)
[1] 10
plot(RMS2_report_1920$empathy ~ log(RMS2_report_1920$years))
[1] 11
linear_log_model <- lm(RMS2_report_1920$empathy ~ log(RMS2_report_1920$years), 
    data = RMS2_report_1920)
[1] 12
abline(linear_log_model)
[1] 13
summary(linear_log_model)
[1] 14

Call:
lm(formula = RMS2_report_1920$empathy ~ log(RMS2_report_1920$years), 
    data = RMS2_report_1920)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.4808 -1.6231 -0.0087  1.3740  5.8244 

Coefficients:
                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                   5.1909     0.7642   6.792 1.26e-10 ***
log(RMS2_report_1920$years)   2.4758     0.3709   6.674 2.44e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.298 on 198 degrees of freedom
Multiple R-squared:  0.1837,	Adjusted R-squared:  0.1795 
F-statistic: 44.55 on 1 and 198 DF,  p-value: 2.436e-10

autoplot(linear_log_model)
[1] 15
linear_model2 <- lm(RMS2_report_1920$incidents ~ RMS2_report_1920$training + 
    RMS2_report_1920$empathy + RMS2_report_1920$years)
[1] 16
summary(linear_model2)
[1] 17

Call:
lm(formula = RMS2_report_1920$incidents ~ RMS2_report_1920$training + 
    RMS2_report_1920$empathy + RMS2_report_1920$years)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                 0.407320   0.051814   7.861 2.48e-13 ***
RMS2_report_1920$training2 -0.152427   0.023166  -6.580 4.20e-10 ***
RMS2_report_1920$empathy    0.025396   0.004735   5.363 2.29e-07 ***
RMS2_report_1920$years     -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

autoplot(linear_model2)
[1] 18
linear_model3 <- lm(RMS2_report_1920$incidents ~ RMS2_report_1920$feedback + 
    RMS2_report_1920$empathy + RMS2_report_1920$years)
[1] 19
summary(linear_model3)
[1] 20

Call:
lm(formula = RMS2_report_1920$incidents ~ RMS2_report_1920$feedback + 
    RMS2_report_1920$empathy + RMS2_report_1920$years)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                 0.276161   0.054108   5.104 7.84e-07 ***
RMS2_report_1920$feedback2  0.132132   0.023585   5.602 7.09e-08 ***
RMS2_report_1920$empathy    0.023187   0.004829   4.802 3.11e-06 ***
RMS2_report_1920$years     -0.012689   0.003975  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

autoplot(linear_model3)
[1] 21
ANOVAtest <- aov(RMS2_report_1920$incidents ~ RMS2_report_1920$training + 
    RMS2_report_1920$feedback)
[1] 22
summary(ANOVAtest)
[1] 23
                           Df Sum Sq Mean Sq F value   Pr(>F)    
RMS2_report_1920$training   1  0.889  0.8889   33.16 3.22e-08 ***
RMS2_report_1920$feedback   1  0.761  0.7606   28.37 2.72e-07 ***
Residuals                 197  5.281  0.0268                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
autoplot(ANOVAtest)
[1] 24
AIC(linear_model2)
[1] 25
[1] -154.1654
AIC(linear_model3)
[1] 26
[1] -143.9591
BIC(linear_model2)
[1] 27
[1] -137.6738
BIC(linear_model3)
[1] 28
[1] -127.4675
linear_model4 <- lm(RMS2_report_1920$incidents ~ RMS2_report_1920$training * 
    RMS2_report_1920$feedback, data = RMS2_report_1920)
[1] 29
summary(linear_model4)
[1] 30

Call:
lm(formula = RMS2_report_1920$incidents ~ RMS2_report_1920$training * 
    RMS2_report_1920$feedback, data = RMS2_report_1920)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40000 -0.10500  0.00000  0.08333  0.43333 

Coefficients:
                                                      Estimate Std. Error t value Pr(>|t|)    
(Intercept)                                            0.49333    0.02314  21.323  < 2e-16 ***
RMS2_report_1920$training2                            -0.16000    0.03272  -4.890 2.09e-06 ***
RMS2_report_1920$feedback2                             0.09667    0.03272   2.954  0.00352 ** 
RMS2_report_1920$training2:RMS2_report_1920$feedback2  0.05333    0.04627   1.153  0.25047    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1636 on 196 degrees of freedom
Multiple R-squared:  0.2431,	Adjusted R-squared:  0.2315 
F-statistic: 20.99 on 3 and 196 DF,  p-value: 7.827e-12

autoplot(linear_model4)
[1] 31
