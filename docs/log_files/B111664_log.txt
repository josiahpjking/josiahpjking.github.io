

	####### B111664 R script #######

RMS2_report_1920 <- read.csv("../RMS2_report_1920.csv")
[1] 1
summary(RMS2_report_1920)
[1] 2
    subject         incidents          training      feedback      empathy          years      
 Min.   :  1.00   Min.   :0.08333   Min.   :1.0   Min.   :1.0   Min.   : 3.00   Min.   : 1.00  
 1st Qu.: 50.75   1st Qu.:0.33333   1st Qu.:1.0   1st Qu.:1.0   1st Qu.: 9.00   1st Qu.: 6.00  
 Median :100.50   Median :0.41667   Median :1.5   Median :1.5   Median :10.00   Median : 8.00  
 Mean   :100.50   Mean   :0.47500   Mean   :1.5   Mean   :1.5   Mean   :10.18   Mean   : 8.13  
 3rd Qu.:150.25   3rd Qu.:0.58333   3rd Qu.:2.0   3rd Qu.:2.0   3rd Qu.:12.00   3rd Qu.:10.00  
 Max.   :200.00   Max.   :0.91667   Max.   :2.0   Max.   :2.0   Max.   :16.00   Max.   :19.00  
plot(RMS2_report_1920$years, RMS2_report_1920$empathy)
[1] 3
abline(lm(RMS2_report_1920$empathy ~ RMS2_report_1920$years))
[1] 4
x <- RMS2_report_1920$years
[1] 5
y <- RMS2_report_1920$empathy
[1] 6
lines(lowess(x, y), col = "blue")
[1] 7
xsq <- x^2
[1] 8
xcu <- x^3
[1] 9
fit1 <- lm(y ~ x)
[1] 10
anova(fit1)
[1] 11
Analysis of Variance Table

Response: y
           Df Sum Sq Mean Sq F value    Pr(>F)    
x           1   89.3  89.297  14.838 0.0001582 ***
Residuals 198 1191.6   6.018                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
fit2 <- lm(y ~ x + xsq)
[1] 12
anova(fit2)
[1] 13
Analysis of Variance Table

Response: y
           Df Sum Sq Mean Sq F value    Pr(>F)    
x           1  89.30   89.30  23.042 3.129e-06 ***
xsq         1 428.11  428.11 110.468 < 2.2e-16 ***
Residuals 197 763.46    3.88                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
plot(fit2, which = 1)
[1] 14
plot(fit2, which = 2)
[1] 15
plot(RMS2_report_1920$training, RMS2_report_1920$incidents)
[1] 16
round(cor(cbind(RMS2_report_1920$incidents, RMS2_report_1920$years, 
    RMS2_report_1920$empathy)), 2)
[1] 17
      [,1]  [,2] [,3]
[1,]  1.00 -0.11 0.24
[2,] -0.11  1.00 0.26
[3,]  0.24  0.26 1.00
q2model <- lm(RMS2_report_1920$incidents ~ RMS2_report_1920$empathy + 
    RMS2_report_1920$years + RMS2_report_1920$training)
[1] 18
summary(q2model)
[1] 19

Call:
lm(formula = RMS2_report_1920$incidents ~ RMS2_report_1920$empathy + 
    RMS2_report_1920$years + RMS2_report_1920$training)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                           Estimate Std. Error t value Pr(>|t|)    
(Intercept)                0.559747   0.060141   9.307  < 2e-16 ***
RMS2_report_1920$empathy   0.025396   0.004735   5.363 2.29e-07 ***
RMS2_report_1920$years    -0.014085   0.003889  -3.622 0.000372 ***
RMS2_report_1920$training -0.152427   0.023166  -6.580 4.20e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

library(car, quietly = T)
[1] 20
 [1] "car"       "carData"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[10] "base"     
vif(q2model)
[1] 21
 RMS2_report_1920$empathy    RMS2_report_1920$years RMS2_report_1920$training 
                 1.092467                  1.085089                  1.020633 
plot(q2model, which = 1)
[1] 22
plot(q2model, which = 2)
[1] 23
plot(RMS2_report_1920$training, RMS2_report_1920$incidents)
[1] 24
round(cor(cbind(RMS2_report_1920$incidents, RMS2_report_1920$years, 
    RMS2_report_1920$empathy)), 2)
[1] 25
      [,1]  [,2] [,3]
[1,]  1.00 -0.11 0.24
[2,] -0.11  1.00 0.26
[3,]  0.24  0.26 1.00
q3model <- lm(RMS2_report_1920$incidents ~ RMS2_report_1920$empathy + 
    RMS2_report_1920$years + RMS2_report_1920$feedback)
[1] 26
summary(q3model)
[1] 27

Call:
lm(formula = RMS2_report_1920$incidents ~ RMS2_report_1920$empathy + 
    RMS2_report_1920$years + RMS2_report_1920$feedback)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                           Estimate Std. Error t value Pr(>|t|)    
(Intercept)                0.144029   0.064150   2.245  0.02587 *  
RMS2_report_1920$empathy   0.023187   0.004829   4.802 3.11e-06 ***
RMS2_report_1920$years    -0.012689   0.003975  -3.192  0.00165 ** 
RMS2_report_1920$feedback  0.132132   0.023585   5.602 7.09e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

library(car, quietly = T)
[1] 28
 [1] "car"       "carData"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[10] "base"     
vif(q3model)
[1] 29
 RMS2_report_1920$empathy    RMS2_report_1920$years RMS2_report_1920$feedback 
                 1.079397                  1.077467                  1.005211 
plot(q3model, which = 1)
[1] 30
plot(q3model, which = 2)
[1] 31
q4model <- aov(RMS2_report_1920$incidents ~ RMS2_report_1920$training + 
    RMS2_report_1920$feedback)
[1] 32
summary(q4model)
[1] 33
                           Df Sum Sq Mean Sq F value   Pr(>F)    
RMS2_report_1920$training   1  0.889  0.8889   33.16 3.22e-08 ***
RMS2_report_1920$feedback   1  0.761  0.7606   28.37 2.72e-07 ***
Residuals                 197  5.281  0.0268                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
plot(q4model, which = 1)
[1] 34
plot(q4model, which = 2)
[1] 35
q5model <- lm(RMS2_report_1920$incidents ~ RMS2_report_1920$training * 
    RMS2_report_1920$feedback)
[1] 36
summary(q5model)
[1] 37

Call:
lm(formula = RMS2_report_1920$incidents ~ RMS2_report_1920$training * 
    RMS2_report_1920$feedback)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40000 -0.10500  0.00000  0.08333  0.43333 

Coefficients:
                                                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)                                          0.61000    0.11568   5.273 3.53e-07 ***
RMS2_report_1920$training                           -0.21333    0.07316  -2.916  0.00396 ** 
RMS2_report_1920$feedback                            0.04333    0.07316   0.592  0.55433    
RMS2_report_1920$training:RMS2_report_1920$feedback  0.05333    0.04627   1.153  0.25047    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1636 on 196 degrees of freedom
Multiple R-squared:  0.2431,	Adjusted R-squared:  0.2315 
F-statistic: 20.99 on 3 and 196 DF,  p-value: 7.827e-12

plot(q5model, which = 1)
[1] 38
plot(q5model, which = 2)
[1] 39
