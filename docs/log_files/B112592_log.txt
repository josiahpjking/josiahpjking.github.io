

	####### B112592 R script #######

report <- read.csv("../RMS2_report_1920.csv")
[1] 1
View(report)
[1] 2
install.packages("psych")
[1] 3
install.packages("car")
[1] 4
install.packages("carData")
[1] 5
install.packages("MASS")
[1] 6
install.packages("interactions")
[1] 7
install.packages("sandwich")
[1] 8
library(psych, quietly = T)
[1] 9
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 10
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[10] "methods"   "base"     
library(carData, quietly = T)
[1] 11
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[10] "methods"   "base"     
library(interactions, quietly = T)
[1] 12
 [1] "interactions" "car"          "carData"      "psych"        "readr"        "stats"        "graphics"    
 [8] "grDevices"    "utils"        "datasets"     "methods"      "base"        
library(sandwich, quietly = T)
[1] 13
 [1] "sandwich"     "interactions" "car"          "carData"      "psych"        "readr"        "stats"       
 [8] "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
describe(report)
[1] 14
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training     3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
str(report)
[1] 15
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : int  2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : int  2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
f.feedback <- factor(report$feedback)
[1] 16
is.factor(f.feedback)
[1] 17
[1] TRUE
levels(f.feedback)
[1] 18
[1] "1" "2"
f.training <- factor(report$training)
[1] 19
is.factor(f.training)
[1] 20
[1] TRUE
levels(f.training)
[1] 21
[1] "1" "2"
f.training <- factor(f.training, labels = c("No Training", "Training"))
[1] 22
levels(f.training)
[1] 23
[1] "No Training" "Training"   
f.feedback <- factor(f.feedback, labels = c("No Feedback", "Feedback"))
[1] 24
levels(f.feedback)
[1] 25
[1] "No Feedback" "Feedback"   
m1 <- lm(empathy ~ years, data = report)
[1] 26
summary(m1)
[1] 27

Call:
lm(formula = empathy ~ years, data = report)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  8.40625    0.49085  17.126  < 2e-16 ***
years        0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

stdz <- MASS::studres(m1)
[1] 28
which(abs(stdz) > 2)
[1] 29
 61  68  70  88  89 137 141 142 154 175 200 
 61  68  70  88  89 137 141 142 154 175 200 
which(abs(stdz) > 3)
[1] 30
154 
154 
hats <- hatvalues(m1)
[1] 31
hats

          1           2           3           4           5           6           7           8           9 
0.006853526 0.005676819 0.010192832 0.005676819 0.012938483 0.006853526 0.005008958 0.006853526 0.005676819 
         10          11          12          13          14          15          16          17          18 
0.005401194 0.007404777 0.009365956 0.005676819 0.005676819 0.005676819 0.018949232 0.017571106 0.005676819 
         19          20          21          22          23          24          25          26          27 
0.010192832 0.012938483 0.009365956 0.014040983 0.005008958 0.005676819 0.005676819 0.007404777 0.005676819 
         28          29          30          31          32          33          34          35          36 
0.005676819 0.007404777 0.010192832 0.005676819 0.005008958 0.010192832 0.005401194 0.017571106 0.010192832 
         37          38          39          40          41          42          43          44          45 
0.014040983 0.010192832 0.009365956 0.010192832 0.010192832 0.005401194 0.012938483 0.014040983 0.010192832 
         46          47          48          49          50 
0.005008958 0.007404777 0.007404777 0.007404777 0.014040983 
 [ reached getOption("max.print") -- omitted 150 entries ]


which(hats > 2 * mean(hats))
[1] 33
 61  88  89  92  94 108 109 116 131 137 140 141 154 155 163 190 200 
 61  88  89  92  94 108 109 116 131 137 140 141 154 155 163 190 200 
plot(hats)
[1] 34
cooks1 <- cooks.distance(m1)
[1] 35
plot(cooks1, ylim = c(0, 1))
[1] 36
posCVR <- 1 + (3 * 2)/200
[1] 37
posCVR

[1] 1.03


negCVR <- 1 + (3 * 2)/200
[1] 39
negCVR

[1] 1.03


CVRs <- covratio(m1)
[1] 41
which(CVRs > posCVR | CVRs < negCVR)
[1] 42
 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 
 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 
40 41 42 43 44 45 46 47 48 49 50 
40 41 42 43 44 45 46 47 48 49 50 
 [ reached getOption("max.print") -- omitted 150 entries ]
scatterplot(report$empathy, report$years, xlab = "Empathy", ylab = "Years", 
    main = "Relationship between Empathy and Years", col = "magenta")
[1] 43
crPlots(m1)
[1] 44
m1a <- lm(empathy ~ years + I(years^2), data = report)
[1] 45
summary(m1a)
[1] 46

Call:
lm(formula = empathy ~ years + I(years^2), data = report)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  1.186356   0.791848   1.498    0.136    
years        2.068508   0.181845  11.375   <2e-16 ***
I(years^2)  -0.103645   0.009861 -10.510   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

ncvTest(m1a)
[1] 47
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.5107658, Df = 1, p = 0.47481
hist(m1a$residuals, col = "navy")
[1] 48
shapiro.test(m1a$residuals)
[1] 49

	Shapiro-Wilk normality test

data:  m1a$residuals
W = 0.9941, p-value = 0.6155

crPlots(m1a)
[1] 50
summary(m1a)
[1] 51

Call:
lm(formula = empathy ~ years + I(years^2), data = report)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  1.186356   0.791848   1.498    0.136    
years        2.068508   0.181845  11.375   <2e-16 ***
I(years^2)  -0.103645   0.009861 -10.510   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

m2a <- lm(incidents ~ empathy + years + f.training, data = report)
[1] 52
summary(m2a)
[1] 53

Call:
lm(formula = incidents ~ empathy + years + f.training, data = report)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)         0.407320   0.051814   7.861 2.48e-13 ***
empathy             0.025396   0.004735   5.363 2.29e-07 ***
years              -0.014085   0.003889  -3.622 0.000372 ***
f.trainingTraining -0.152427   0.023166  -6.580 4.20e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

stdz <- MASS::studres(m2a)
[1] 54
which(abs(stdz) > 2)
[1] 55
  7  13  35  74 159 165 176 181 
  7  13  35  74 159 165 176 181 
which(abs(stdz) > 3)
[1] 56
13 
13 
which(hats > 2 * mean(hats))
[1] 57
 61  88  89  92  94 108 109 116 131 137 140 141 154 155 163 190 200 
 61  88  89  92  94 108 109 116 131 137 140 141 154 155 163 190 200 
plot(hats)
[1] 58
hats <- hatvalues(m2a)
[1] 59
hats

         1          2          3          4          5          6          7          8          9         10 
0.01228875 0.01050612 0.01460984 0.01175403 0.01917551 0.01228875 0.01552392 0.02045647 0.01312775 0.01209596 
        11         12         13         14         15         16         17         18         19         20 
0.01282306 0.01887947 0.01175403 0.01312775 0.01175403 0.03896604 0.02934399 0.01175403 0.01460984 0.02037708 
        21         22         23         24         25         26         27         28         29         30 
0.01610229 0.01838715 0.01017972 0.01312775 0.01096403 0.01536910 0.01096403 0.01312775 0.01198283 0.03408432 
        31         32         33         34         35         36         37         38         39         40 
0.01470775 0.01552392 0.01509311 0.01209596 0.02541158 0.01460984 0.02029486 0.01876074 0.02205168 0.02117709 
        41         42         43         44         45         46         47         48         49         50 
0.02117709 0.01209596 0.01892339 0.02380744 0.02117709 0.01017972 0.01282306 0.01536910 0.01284842 0.02380744 
 [ reached getOption("max.print") -- omitted 150 entries ]


cooks2 <- cooks.distance(m2a)
[1] 61
plot(cooks1, ylim = c(0, 1))
[1] 62
posCVR <- 1 + (3 * 4)/200
[1] 63
posCVR

[1] 1.06


negCVR <- 1 + (3 * 4)/200
[1] 65
negCVR

[1] 1.06


CVRs <- covratio(m2a)
[1] 67
which(CVRs > posCVR | CVRs < negCVR)
[1] 68
 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 
 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 
40 41 42 43 44 45 46 47 48 49 50 
40 41 42 43 44 45 46 47 48 49 50 
 [ reached getOption("max.print") -- omitted 150 entries ]
residualPlots(m2a)
[1] 69
ncvTest(m2a)
[1] 70
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0293323, Df = 1, p = 0.86401
crPlots(m2a)
[1] 71
durbinWatsonTest(m2a)
[1] 72
 lag Autocorrelation D-W Statistic p-value
   1      -0.1072849      2.199897   0.198
 Alternative hypothesis: rho != 0
vif(m2a)
[1] 73
   empathy      years f.training 
  1.092467   1.085089   1.020633 
qqPlot(m2a)
[1] 74
shapiro.test(m2a$residuals)
[1] 75

	Shapiro-Wilk normality test

data:  m2a$residuals
W = 0.97994, p-value = 0.005838

hist(m2a$residuals)
[1] 76
report$logincidents <- log(report$incidents + 1)
[1] 77
report$logincidents
[1] 78
 [1] 0.51082562 0.28768207 0.28768207 0.34830669 0.40546511 0.22314355 0.60613580 0.34830669 0.40546511 0.15415068
[11] 0.55961579 0.28768207 0.65058757 0.40546511 0.45953233 0.15415068 0.15415068 0.28768207 0.55961579 0.34830669
[21] 0.15415068 0.34830669 0.34830669 0.45953233 0.34830669 0.22314355 0.40546511 0.28768207 0.34830669 0.08004271
[31] 0.28768207 0.40546511 0.28768207 0.34830669 0.55961579 0.34830669 0.40546511 0.45953233 0.45953233 0.15415068
[41] 0.51082562 0.34830669 0.28768207 0.22314355 0.34830669 0.22314355 0.45953233 0.45953233 0.40546511 0.15415068
 [ reached getOption("max.print") -- omitted 150 entries ]
describe(report$logincidents)
[1] 79
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 200 0.38 0.13   0.35    0.38 0.09 0.08 0.65  0.57 0.02    -0.37 0.01
m2b <- lm(report$logincidents ~ empathy + years + f.training, 
    data = report)
[1] 80
summary(m2b)
[1] 81

Call:
lm(formula = report$logincidents ~ empathy + years + f.training, 
    data = report)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.25974 -0.08206 -0.00301  0.07026  0.33183 

Coefficients:
                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)         0.334118   0.034793   9.603  < 2e-16 ***
empathy             0.017470   0.003180   5.494 1.21e-07 ***
years              -0.009683   0.002611  -3.708 0.000272 ***
f.trainingTraining -0.104810   0.015556  -6.737 1.75e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1089 on 196 degrees of freedom
Multiple R-squared:  0.2657,	Adjusted R-squared:  0.2544 
F-statistic: 23.63 on 3 and 196 DF,  p-value: 4.229e-13

m3a <- lm(incidents ~ empathy + years + f.feedback, data = report)
[1] 82
summary(m3a)
[1] 83

Call:
lm(formula = incidents ~ empathy + years + f.feedback, data = report)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)         0.276161   0.054108   5.104 7.84e-07 ***
empathy             0.023187   0.004829   4.802 3.11e-06 ***
years              -0.012689   0.003975  -3.192  0.00165 ** 
f.feedbackFeedback  0.132132   0.023585   5.602 7.09e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

stdz1 <- MASS::studres(m3a)
[1] 84
which(abs(stdz1) > 2)
[1] 85
 13  21  73  74 150 156 159 160 165 176 181 
 13  21  73  74 150 156 159 160 165 176 181 
which(abs(stdz1) > 3)
[1] 86
176 
176 
hats <- hatvalues(m3a)
[1] 87
hats

         1          2          3          4          5          6          7          8          9         10 
0.01193805 0.01056890 0.01591194 0.01155352 0.01862431 0.01211540 0.01766517 0.02100490 0.01499209 0.01233851 
        11         12         13         14         15         16         17         18         19         20 
0.01440768 0.01792139 0.01130286 0.01365588 0.01130286 0.03834202 0.02573877 0.01155352 0.01591194 0.01953690 
        21         22         23         24         25         26         27         28         29         30 
0.01442435 0.01889473 0.01002816 0.01365588 0.01207695 0.01602790 0.01207695 0.01365588 0.01280846 0.03305959 
        31         32         33         34         35         36         37         38         39         40 
0.01344393 0.01612821 0.01562865 0.01233851 0.02516110 0.01497723 0.02053750 0.01954213 0.02354412 0.02077043 
        41         42         43         44         45         46         47         48         49         50 
0.02011827 0.01233851 0.01755655 0.02357949 0.02011827 0.01007806 0.01440768 0.01602790 0.01289465 0.02357949 
 [ reached getOption("max.print") -- omitted 150 entries ]


which(hats > 2 * mean(hats))
[1] 89
 61  88  89  92 137 141 154 163 175 200 
 61  88  89  92 137 141 154 163 175 200 
plot(hats)
[1] 90
cooks3 <- cooks.distance(m3a)
[1] 91
plot(cooks1, ylim = c(0, 1))
[1] 92
posCVR <- 1 + (3 * 4)/200
[1] 93
posCVR

[1] 1.06


negCVR <- 1 + (3 * 4)/200
[1] 95
negCVR

[1] 1.06


CVRs <- covratio(m3a)
[1] 97
which(CVRs > posCVR | CVRs < negCVR)
[1] 98
 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 
 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 
40 41 42 43 44 45 46 47 48 49 50 
40 41 42 43 44 45 46 47 48 49 50 
 [ reached getOption("max.print") -- omitted 150 entries ]
residualPlots(m3a)
[1] 99
ncvTest(m3a)
[1] 100
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.01731234, Df = 1, p = 0.89532
crPlots(m3a)
[1] 101
durbinWatsonTest(m3a)
[1] 102
 lag Autocorrelation D-W Statistic p-value
   1       0.2738264      1.444081       0
 Alternative hypothesis: rho != 0
vif(m3a)
[1] 103
   empathy      years f.feedback 
  1.079397   1.077467   1.005211 
qqPlot(m3a)
[1] 104
hist(m3a$residuals, xlab = "Level of residuals", ylab = "Model", 
    main = "Histogram of Model and Level of residuals", col = "navy")
[1] 105
shapiro.test(m3a$residuals)
[1] 106

	Shapiro-Wilk normality test

data:  m3a$residuals
W = 0.98772, p-value = 0.08174

summary(m3a)
[1] 107

Call:
lm(formula = incidents ~ empathy + years + f.feedback, data = report)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)         0.276161   0.054108   5.104 7.84e-07 ***
empathy             0.023187   0.004829   4.802 3.11e-06 ***
years              -0.012689   0.003975  -3.192  0.00165 ** 
f.feedbackFeedback  0.132132   0.023585   5.602 7.09e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

AIC(m2b, m3a)
[1] 108
    df       AIC
m2b  5 -313.4627
m3a  5 -143.9591
BIC(m2b, m3a)
[1] 109
    df       BIC
m2b  5 -296.9711
m3a  5 -127.4675
m5 <- lm(incidents ~ f.training + f.feedback + f.training * f.feedback, 
    data = report)
[1] 110
summary(m5)
[1] 111

Call:
lm(formula = incidents ~ f.training + f.feedback + f.training * 
    f.feedback, data = report)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40000 -0.10500  0.00000  0.08333  0.43333 

Coefficients:
                                      Estimate Std. Error t value Pr(>|t|)    
(Intercept)                            0.49333    0.02314  21.323  < 2e-16 ***
f.trainingTraining                    -0.16000    0.03272  -4.890 2.09e-06 ***
f.feedbackFeedback                     0.09667    0.03272   2.954  0.00352 ** 
f.trainingTraining:f.feedbackFeedback  0.05333    0.04627   1.153  0.25047    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1636 on 196 degrees of freedom
Multiple R-squared:  0.2431,	Adjusted R-squared:  0.2315 
F-statistic: 20.99 on 3 and 196 DF,  p-value: 7.827e-12

cat_plot((m5), pred = f.training, modx = f.feedback)
[1] 112
