

	####### B109103 R script #######

library(psych, quietly = T)
[1] 1
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 2
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
library(ggplot2, quietly = T)
[1] 3
 [1] "ggplot2"   "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[11] "methods"   "base"     
library(interactions, quietly = T)
[1] 4
 [1] "interactions" "ggplot2"      "car"          "carData"      "psych"        "readr"        "stats"        "graphics"    
 [9] "grDevices"    "utils"        "datasets"     "methods"      "base"        
df <- read.csv("~/Desktop/rms2/code_check/RMS2_report_1920.csv")
[1] 5
data_description <- describe(df)
[1] 6
data_description[, c(2:4, 8:12)]
[1] 7
            n   mean    sd  min    max  range  skew kurtosis
subject   200 100.50 57.88 1.00 200.00 199.00  0.00    -1.22
incidents 200   0.48  0.19 0.08   0.92   0.83  0.32    -0.31
training  200   1.50  0.50 1.00   2.00   1.00  0.00    -2.01
feedback  200   1.50  0.50 1.00   2.00   1.00  0.00    -2.01
empathy   200  10.18  2.54 3.00  16.00  13.00 -0.37     0.23
years     200   8.13  3.08 1.00  19.00  18.00  0.52     0.48
summary(df)
[1] 8
    subject         incidents          training      feedback      empathy          years      
 Min.   :  1.00   Min.   :0.08333   Min.   :1.0   Min.   :1.0   Min.   : 3.00   Min.   : 1.00  
 1st Qu.: 50.75   1st Qu.:0.33333   1st Qu.:1.0   1st Qu.:1.0   1st Qu.: 9.00   1st Qu.: 6.00  
 Median :100.50   Median :0.41667   Median :1.5   Median :1.5   Median :10.00   Median : 8.00  
 Mean   :100.50   Mean   :0.47500   Mean   :1.5   Mean   :1.5   Mean   :10.18   Mean   : 8.13  
 3rd Qu.:150.25   3rd Qu.:0.58333   3rd Qu.:2.0   3rd Qu.:2.0   3rd Qu.:12.00   3rd Qu.:10.00  
 Max.   :200.00   Max.   :0.91667   Max.   :2.0   Max.   :2.0   Max.   :16.00   Max.   :19.00  
str(df)
[1] 9
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : int  2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : int  2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
incident_percent <- df$incidents * 100
[1] 10
df$training <- as.factor(df$training)
[1] 11
df$training <- factor(df$training, labels = c("No Training", 
    "Trained"))
[1] 12
df$feedback <- as.factor(df$feedback)
[1] 13
df$feedback <- factor(df$feedback, labels = c("No Feedback", 
    "Feedback Provided"))
[1] 14
summary(df$training)
[1] 15
No Training     Trained 
        100         100 
summary(df$feedback)
[1] 16
      No Feedback Feedback Provided 
              100               100 
Q1 <- lm(empathy ~ years, data = df)
[1] 17
plot(empathy ~ years, data = df, xlab = "Teachers' Experience (Years)", 
    ylab = "Empathy Score", main = "Relationship between Empathy and Experience (Raw Data)")
[1] 18
abline(lm(empathy ~ years, data = df), col = "red")
[1] 19
par(mfrow = c(2, 2))
[1] 20
$mfrow
[1] 2 2

plot(Q1)
[1] 21
summary(Q1)
[1] 22

Call:
lm(formula = empathy ~ years, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  8.40625    0.49085  17.126  < 2e-16 ***
years        0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

par(mfrow = c(1, 1))
[1] 23
$mfrow
[1] 2 2

crPlots(Q1)
[1] 24
hist(residuals(Q1))
[1] 25
plot(empathy ~ log(years), data = df, xlab = "Natural log of Teachers' Experience (Years)", 
    ylab = "Empathy Score", main = "Relationship between Empathy and Experience (Linearized Data)")
[1] 26
abline(lm(empathy ~ log(years), data = df), col = "red")
[1] 27
Q1_transformed1 <- lm(empathy ~ log(years), data = df)
[1] 28
shapiro.test(Q1_transformed1$residuals)
[1] 29

	Shapiro-Wilk normality test

data:  Q1_transformed1$residuals
W = 0.9925, p-value = 0.3981

durbinWatsonTest(Q1_transformed1)
[1] 30
 lag Autocorrelation D-W Statistic p-value
   1       0.1032774      1.788843   0.148
 Alternative hypothesis: rho != 0
par(mfrow = c(2, 2))
[1] 31
$mfrow
[1] 1 1

plot(Q1_transformed1)
[1] 32
par(mfrow = c(1, 2))
[1] 33
$mfrow
[1] 2 2

crPlots(Q1_transformed1)
[1] 34
hist(residuals(Q1_transformed1))
[1] 35
summary(Q1_transformed1)
[1] 36

Call:
lm(formula = empathy ~ log(years), data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.4808 -1.6231 -0.0087  1.3740  5.8244 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)   5.1909     0.7642   6.792 1.26e-10 ***
log(years)    2.4758     0.3709   6.674 2.44e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.298 on 198 degrees of freedom
Multiple R-squared:  0.1837,	Adjusted R-squared:  0.1795 
F-statistic: 44.55 on 1 and 198 DF,  p-value: 2.436e-10

AIC(Q1, Q1_transformed1)
[1] 37
                df      AIC
Q1               3 930.5187
Q1_transformed1  3 904.3845
BIC(Q1, Q1_transformed1)
[1] 38
                df      BIC
Q1               3 940.4137
Q1_transformed1  3 914.2795
Q2 <- lm(incident_percent ~ training + empathy + years, data = df)
[1] 39
par(mfrow = c(2, 2))
[1] 40
$mfrow
[1] 1 2

plot(Q2)
[1] 41
par(mfrow = c(1, 1))
[1] 42
$mfrow
[1] 2 2

hist(Q2$residuals)
[1] 43
shapiro.test(Q2$residuals)
[1] 44

	Shapiro-Wilk normality test

data:  Q2$residuals
W = 0.97994, p-value = 0.005838

summary(Q2)
[1] 45

Call:
lm(formula = incident_percent ~ training + empathy + years, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-35.648 -12.270  -1.474  10.105  53.180 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)      40.7320     5.1814   7.861 2.48e-13 ***
trainingTrained -15.2427     2.3166  -6.580 4.20e-10 ***
empathy           2.5396     0.4735   5.363 2.29e-07 ***
years            -1.4085     0.3889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 16.21 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

Q2_transformed <- lm(incident_percent^0.5 ~ training + empathy + 
    years, data = df)
[1] 46
summary(Q2_transformed)
[1] 47

Call:
lm(formula = incident_percent^0.5 ~ training + empathy + years, 
    data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.0419 -0.8520  0.0119  0.7633  3.5234 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)      6.22632    0.38530  16.160  < 2e-16 ***
trainingTrained -1.18020    0.17227  -6.851 9.26e-11 ***
empathy          0.19727    0.03521   5.602 7.10e-08 ***
years           -0.11010    0.02892  -3.807 0.000188 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.206 on 196 degrees of freedom
Multiple R-squared:  0.273,	Adjusted R-squared:  0.2619 
F-statistic: 24.53 on 3 and 196 DF,  p-value: 1.604e-13

par(mfrow = c(2, 2))
[1] 48
$mfrow
[1] 1 1

plot(Q2_transformed)
[1] 49
par(mfrow = c(1, 1))
[1] 50
$mfrow
[1] 2 2

hist(Q2_transformed$residuals)
[1] 51
shapiro.test(Q2_transformed$residuals)
[1] 52

	Shapiro-Wilk normality test

data:  Q2_transformed$residuals
W = 0.99413, p-value = 0.6202

durbinWatsonTest(Q2_transformed)
[1] 53
 lag Autocorrelation D-W Statistic p-value
   1      -0.1222031      2.229198   0.102
 Alternative hypothesis: rho != 0
AIC(Q2, Q2_transformed)
[1] 54
               df       AIC
Q2              5 1687.9027
Q2_transformed  5  648.3769
BIC(Q2, Q2_transformed)
[1] 55
               df       BIC
Q2              5 1704.3943
Q2_transformed  5  664.8685
Q3 <- lm(incident_percent ~ feedback + empathy + years, data = df)
[1] 56
par(mfrow = c(2, 2))
[1] 57
$mfrow
[1] 1 1

plot(Q3)
[1] 58
par(mfrow = c(1, 1))
[1] 59
$mfrow
[1] 2 2

crPlots(Q3)
[1] 60
qqPlot(Q3)
[1] 61
hist(Q3$residuals)
[1] 62
summary(Q3)
[1] 63

Call:
lm(formula = incident_percent ~ feedback + empathy + years, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-35.580 -11.148  -1.097  11.092  53.552 

Coefficients:
                          Estimate Std. Error t value Pr(>|t|)    
(Intercept)                27.6161     5.4108   5.104 7.84e-07 ***
feedbackFeedback Provided  13.2132     2.3585   5.602 7.09e-08 ***
empathy                     2.3187     0.4829   4.802 3.11e-06 ***
years                      -1.2689     0.3975  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 16.63 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

Q3_transformed <- lm(incident_percent^0.5 ~ feedback + empathy + 
    years, data = df)
[1] 64
par(mfrow = c(2, 2))
[1] 65
$mfrow
[1] 1 1

plot(Q3_transformed)
[1] 66
par(mfrow = c(1, 1))
[1] 67
$mfrow
[1] 2 2

hist(Q3_transformed$residuals)
[1] 68
shapiro.test(Q3_transformed$residuals)
[1] 69

	Shapiro-Wilk normality test

data:  Q3_transformed$residuals
W = 0.99404, p-value = 0.6064

durbinWatsonTest(Q2_transformed)
[1] 70
 lag Autocorrelation D-W Statistic p-value
   1      -0.1222031      2.229198   0.116
 Alternative hypothesis: rho != 0
summary(Q3_transformed)
[1] 71

Call:
lm(formula = incident_percent^0.5 ~ feedback + empathy + years, 
    data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.0473 -0.7409  0.0253  0.8507  3.5419 

Coefficients:
                          Estimate Std. Error t value Pr(>|t|)    
(Intercept)                5.22477    0.40485  12.905  < 2e-16 ***
feedbackFeedback Provided  0.99842    0.17647   5.658 5.38e-08 ***
empathy                    0.17985    0.03613   4.978 1.40e-06 ***
years                     -0.09909    0.02974  -3.332  0.00103 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.245 on 196 degrees of freedom
Multiple R-squared:  0.2254,	Adjusted R-squared:  0.2135 
F-statistic: 19.01 on 3 and 196 DF,  p-value: 7.304e-11

BIC(Q3, Q3_transformed)
[1] 72
               df       BIC
Q3              5 1714.6005
Q3_transformed  5  677.5489
AIC(Q3, Q3_transformed)
[1] 73
               df       AIC
Q3              5 1698.1090
Q3_transformed  5  661.0574
Q4 <- lm(incident_percent ~ empathy + years, data = df)
[1] 74
Q4_Feedback <- lm(incident_percent ~ feedback + empathy + years, 
    data = df)
[1] 75
Q4_Training <- lm(incident_percent ~ training + empathy + years, 
    data = df)
[1] 76
anova(Q4, Q4_Feedback)
[1] 77
Analysis of Variance Table

Model 1: incident_percent ~ empathy + years
Model 2: incident_percent ~ feedback + empathy + years
  Res.Df   RSS Df Sum of Sq      F   Pr(>F)    
1    197 62914                                 
2    196 54230  1    8684.1 31.387 7.09e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
anova(Q4, Q4_Training)
[1] 78
Analysis of Variance Table

Model 1: incident_percent ~ empathy + years
Model 2: incident_percent ~ training + empathy + years
  Res.Df   RSS Df Sum of Sq      F  Pr(>F)    
1    197 62914                                
2    196 51532  1     11382 43.292 4.2e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
BIC(Q4_Feedback, Q4_Training)
[1] 79
            df      BIC
Q4_Feedback  5 1714.601
Q4_Training  5 1704.394
par(mfrow = c(2, 2))
[1] 80
$mfrow
[1] 1 1

plot(Q4)
[1] 81
shapiro.test(Q4$residuals)
[1] 82

	Shapiro-Wilk normality test

data:  Q4$residuals
W = 0.98801, p-value = 0.09043

durbinWatsonTest(Q4)
[1] 83
 lag Autocorrelation D-W Statistic p-value
   1      0.09754768       1.79735   0.122
 Alternative hypothesis: rho != 0
contrasts(df$training) <- contr.treatment(2, base = 1)
[1] 84
contrasts(df$feedback) <- contr.treatment(2, base = 1)
[1] 85
Q5 <- lm(incidents ~ training * feedback, data = df)
[1] 86
summary(Q5)
[1] 87

Call:
lm(formula = incidents ~ training * feedback, data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40000 -0.10500  0.00000  0.08333  0.43333 

Coefficients:
                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)          0.49333    0.02314  21.323  < 2e-16 ***
training2           -0.16000    0.03272  -4.890 2.09e-06 ***
feedback2            0.09667    0.03272   2.954  0.00352 ** 
training2:feedback2  0.05333    0.04627   1.153  0.25047    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1636 on 196 degrees of freedom
Multiple R-squared:  0.2431,	Adjusted R-squared:  0.2315 
F-statistic: 20.99 on 3 and 196 DF,  p-value: 7.827e-12

cat_plot(Q5, pred = training, modx = feedback, plot.points = TRUE)
[1] 88
