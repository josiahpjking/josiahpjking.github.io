

	####### B123575 R script #######

rm(list = ls())
[1] 1
library(car, quietly = T)
[1] 2
 [1] "car"       "carData"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(psych, quietly = T)
[1] 3
 [1] "psych"     "car"       "carData"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
library(interactions, quietly = T)
[1] 4
 [1] "interactions" "psych"        "car"          "carData"      "readr"        "stats"        "graphics"     "grDevices"   
 [9] "utils"        "datasets"     "methods"      "base"        
data <- read.csv("~/Desktop/rms2/code_check/RMS2_report_1920.csv")
[1] 5
View(data)
[1] 6
str(data)
[1] 7
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : int  2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : int  2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
data$training <- as.factor(data$training)
[1] 8
data$feedback <- as.factor(data$feedback)
[1] 9
str(data)
[1] 10
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : Factor w/ 2 levels "1","2": 2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : Factor w/ 2 levels "1","2": 2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
describeBy(data)
[1] 11
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training*    3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
summary(data)
[1] 12
    subject         incidents       training feedback    empathy          years      
 Min.   :  1.00   Min.   :0.08333   1:100    1:100    Min.   : 3.00   Min.   : 1.00  
 1st Qu.: 50.75   1st Qu.:0.33333   2:100    2:100    1st Qu.: 9.00   1st Qu.: 6.00  
 Median :100.50   Median :0.41667                     Median :10.00   Median : 8.00  
 Mean   :100.50   Mean   :0.47500                     Mean   :10.18   Mean   : 8.13  
 3rd Qu.:150.25   3rd Qu.:0.58333                     3rd Qu.:12.00   3rd Qu.:10.00  
 Max.   :200.00   Max.   :0.91667                     Max.   :16.00   Max.   :19.00  
Q1model <- lm(incidents ~ scale(empathy) + scale(years), data = data)
[1] 13
crPlots(Q1model)
[1] 14
qqPlot(Q1model)
[1] 15
shapiro.test(Q1model$residuals)
[1] 16

	Shapiro-Wilk normality test

data:  Q1model$residuals
W = 0.98801, p-value = 0.09043

hist(Q1model$residuals, main = "Histogram of Residuals", xlab = "Standard Deviation", 
    ylab = "Frequency", col = blues9)
[1] 17
residualPlots(Q1model)
[1] 18
ncvTest(Q1model)
[1] 19
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.6254715, Df = 1, p = 0.42902
durbinWatsonTest(Q1model)
[1] 20
 lag Autocorrelation D-W Statistic p-value
   1      0.09754768       1.79735   0.158
 Alternative hypothesis: rho != 0
vif(Q1model)
[1] 21
scale(empathy)   scale(years) 
       1.07494        1.07494 
hats <- hatvalues(Q1model)
[1] 22
which(hats > 2 * mean(hats))
[1] 23
 16  61  68  88  89  92  94 108 116 137 141 142 154 155 163 171 175 190 200 
 16  61  68  88  89  92  94 108 116 137 141 142 154 155 163 171 175 190 200 
cooks <- cooks.distance(Q1model)
[1] 24
plot(Q1model, which = 4)
[1] 25
which(cooks.distance(Q1model) > (0.02))
[1] 26
 16  30  60  74  88  89  94 137 165 181 
 16  30  60  74  88  89  94 137 165 181 
CVRs <- covratio(Q1model)
[1] 27
which(CVRs > 1.045 | CVRs < 0.955)
[1] 28
 13  61  68  88  89 108 137 141 154 155 159 163 165 171 175 176 181 190 200 
 13  61  68  88  89 108 137 141 154 155 159 163 165 171 175 176 181 190 200 
Q1.1model <- lm(incidents ~ scale(empathy) + scale(years), data = data[-c(74, 
    88, 137), ])
[1] 29
crPlots(Q1.1model)
[1] 30
qqPlot(Q1.1model)
[1] 31
shapiro.test(Q1.1model$residuals)
[1] 32

	Shapiro-Wilk normality test

data:  Q1.1model$residuals
W = 0.98602, p-value = 0.04854

hist(Q1.1model$residuals, main = "Histogram of Residuals", xlab = "Standard Deviation", 
    ylab = "Frequency", col = blues9)
[1] 33
residualPlots(Q1.1model)
[1] 34
ncvTest(Q1.1model)
[1] 35
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.816676, Df = 1, p = 0.36615
durbinWatsonTest(Q1.1model)
[1] 36
 lag Autocorrelation D-W Statistic p-value
   1      0.06987259      1.852328   0.278
 Alternative hypothesis: rho != 0
vif(Q1.1model)
[1] 37
scale(empathy)   scale(years) 
      1.084502       1.084502 
summary(Q1.1model)
[1] 38

Call:
lm(formula = incidents ~ scale(empathy) + scale(years), data = data[-c(74, 
    88, 137), ])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35847 -0.11150 -0.01585  0.10338  0.47223 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.47758    0.01247  38.288  < 2e-16 ***
scale(empathy)  0.05888    0.01302   4.522 1.07e-05 ***
scale(years)   -0.04453    0.01302  -3.420 0.000764 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1751 on 194 degrees of freedom
Multiple R-squared:  0.1161,	Adjusted R-squared:  0.107 
F-statistic: 12.75 on 2 and 194 DF,  p-value: 6.294e-06

contrasts(data$training) <- contr.sum(2)
[1] 39
Q2model <- lm(incidents ~ scale(empathy) + scale(years) + training, 
    data = data)
[1] 40
summary(Q2model)
[1] 41

Call:
lm(formula = incidents ~ scale(empathy) + scale(years) + training, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.47500    0.01147  41.428  < 2e-16 ***
scale(empathy)  0.06443    0.01201   5.363 2.29e-07 ***
scale(years)   -0.04337    0.01197  -3.622 0.000372 ***
training1       0.07621    0.01158   6.580 4.20e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

confint(Q2model)
[1] 42
                     2.5 %      97.5 %
(Intercept)     0.45238834  0.49761166
scale(empathy)  0.04073642  0.08812297
scale(years)   -0.06698004 -0.01975377
training1       0.05336968  0.09905716
vif(Q2model)
[1] 43
scale(empathy)   scale(years)       training 
      1.092467       1.085089       1.020633 
shapiro.test(Q2model$residuals)
[1] 44

	Shapiro-Wilk normality test

data:  Q2model$residuals
W = 0.97994, p-value = 0.005838

hist(Q2model$residuals, main = "Histogram of Q2model Residuals", 
    xlab = "Q2model Residuals")
[1] 45
durbinWatsonTest(Q2model)
[1] 46
 lag Autocorrelation D-W Statistic p-value
   1      -0.1072849      2.199897   0.158
 Alternative hypothesis: rho != 0
residualPlot(Q2model)
[1] 47
ncvTest(Q2model)
[1] 48
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0293323, Df = 1, p = 0.86401
cooks2 <- cooks.distance(Q2model)
[1] 49
which(cooks2 > 4/(200 - 2 - 1))
[1] 50
 13  35  74 137 165 
 13  35  74 137 165 
plot(Q2model, which = 4)
[1] 51
contrasts(data$training)
[1] 52
  [,1]
1    1
2   -1
data$training <- recode(data$training, "1=2;2=1")
[1] 53
contrasts(data$training)
[1] 54
  2
1 0
2 1
Q2.1model <- lm(incidents ~ scale(empathy) + scale(years) + training, 
    data = data)
[1] 55
Q2.2model <- lm(incidents ~ training, data = data)
[1] 56
summary(Q2model)
[1] 57

Call:
lm(formula = incidents ~ scale(empathy) + scale(years) + training, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.47500    0.01147  41.428  < 2e-16 ***
scale(empathy)  0.06443    0.01201   5.363 2.29e-07 ***
scale(years)   -0.04337    0.01197  -3.622 0.000372 ***
training1       0.07621    0.01158   6.580 4.20e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

summary(Q2.1model)
[1] 58

Call:
lm(formula = incidents ~ scale(empathy) + scale(years) + training, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.39879    0.01630  24.468  < 2e-16 ***
scale(empathy)  0.06443    0.01201   5.363 2.29e-07 ***
scale(years)   -0.04337    0.01197  -3.622 0.000372 ***
training2       0.15243    0.02317   6.580 4.20e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

summary(Q2.2model)
[1] 59

Call:
lm(formula = incidents ~ training, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.32500 -0.12500  0.00833  0.12500  0.50833 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.40833    0.01747  23.376  < 2e-16 ***
training2    0.13333    0.02470   5.397 1.92e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1747 on 198 degrees of freedom
Multiple R-squared:  0.1283,	Adjusted R-squared:  0.1239 
F-statistic: 29.13 on 1 and 198 DF,  p-value: 1.922e-07

contrasts(data$feedback) <- contr.sum(2)
[1] 60
Q3model <- lm(incidents ~ scale(empathy) + scale(years) + feedback, 
    data = data)
[1] 61
summary(Q3model)
[1] 62

Call:
lm(formula = incidents ~ scale(empathy) + scale(years) + feedback, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.47500    0.01176  40.385  < 2e-16 ***
scale(empathy)  0.05883    0.01225   4.802 3.11e-06 ***
scale(years)   -0.03907    0.01224  -3.192  0.00165 ** 
feedback1      -0.06607    0.01179  -5.602 7.09e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

confint(Q3model)
[1] 63
                     2.5 %      97.5 %
(Intercept)     0.45180396  0.49819604
scale(empathy)  0.03466751  0.08298704
scale(years)   -0.06320693 -0.01493060
feedback1      -0.08932223 -0.04280942
vif(Q3model)
[1] 64
scale(empathy)   scale(years)       feedback 
      1.079397       1.077467       1.005211 
shapiro.test(Q3model$residuals)
[1] 65

	Shapiro-Wilk normality test

data:  Q3model$residuals
W = 0.98772, p-value = 0.08174

durbinWatsonTest(Q3model)
[1] 66
 lag Autocorrelation D-W Statistic p-value
   1       0.2738264      1.444081       0
 Alternative hypothesis: rho != 0
residualPlot(Q3model)
[1] 67
ncvTest(Q3model)
[1] 68
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.01731234, Df = 1, p = 0.89532
cooks2 <- cooks.distance(Q3model)
[1] 69
which(cooks2 > 4/(200 - 2 - 1))
[1] 70
 73  74  89 137 156 160 165 176 
 73  74  89 137 156 160 165 176 
plot(Q3model, which = 4)
[1] 71
data$feedback <- recode(data$feedback, "1=2;2=1")
[1] 72
contrasts(data$training)
[1] 73
  2
1 0
2 1
Q3.1model <- lm(incidents ~ scale(empathy) + scale(years) + feedback, 
    data = data)
[1] 74
Q3.2model <- lm(incidents ~ feedback, data = data)
[1] 75
summary(Q3model)
[1] 76

Call:
lm(formula = incidents ~ scale(empathy) + scale(years) + feedback, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.47500    0.01176  40.385  < 2e-16 ***
scale(empathy)  0.05883    0.01225   4.802 3.11e-06 ***
scale(years)   -0.03907    0.01224  -3.192  0.00165 ** 
feedback1      -0.06607    0.01179  -5.602 7.09e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

summary(Q3.1model)
[1] 77

Call:
lm(formula = incidents ~ scale(empathy) + scale(years) + feedback, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.54107    0.01666  32.486  < 2e-16 ***
scale(empathy)  0.05883    0.01225   4.802 3.11e-06 ***
scale(years)   -0.03907    0.01224  -3.192  0.00165 ** 
feedback2      -0.13213    0.02358  -5.602 7.09e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

summary(Q3.2model)
[1] 78

Call:
lm(formula = incidents ~ feedback, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.45333 -0.12000  0.00333  0.13000  0.50333 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.53667    0.01765   30.40  < 2e-16 ***
feedback2   -0.12333    0.02496   -4.94 1.66e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1765 on 198 degrees of freedom
Multiple R-squared:  0.1097,	Adjusted R-squared:  0.1052 
F-statistic: 24.41 on 1 and 198 DF,  p-value: 1.656e-06

AIC(Q2.1model, Q2.2model, Q3.1model, Q3.2model)
[1] 79
          df       AIC
Q2.1model  5 -154.1654
Q2.2model  3 -126.3521
Q3.1model  5 -143.9591
Q3.2model  3 -122.1483
BIC(Q2.1model, Q2.2model, Q3.1model, Q3.2model)
[1] 80
          df       BIC
Q2.1model  5 -137.6738
Q2.2model  3 -116.4571
Q3.1model  5 -127.4675
Q3.2model  3 -112.2533
is.factor(data$feedback)
[1] 81
[1] TRUE
is.factor(data$training)
[1] 82
[1] TRUE
levels(data$feedback)
[1] 83
[1] "1" "2"
levels(data$training)
[1] 84
[1] "1" "2"
data$feedback <- factor(data$feedback, labels = c("No", "Yes"))
[1] 85
data$training <- factor(data$training, labels = c("No", "Yes"))
[1] 86
table(data$feedback)
[1] 87

 No Yes 
100 100 
table(data$training)
[1] 88

 No Yes 
100 100 
contrasts(data$feedback) <- contr.treatment(2, base = 1)
[1] 89
contrasts(data$training) <- contr.treatment(2, base = 1)
[1] 90
contrasts(data$feedback)
[1] 91
    2
No  0
Yes 1
contrasts(data$training)
[1] 92
    2
No  0
Yes 1
Q5model <- lm(incidents ~ training + feedback + training * feedback, 
    data = data)
[1] 93
ncvTest(Q5model)
[1] 94
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 1.881673, Df = 1, p = 0.17014
durbinWatsonTest(Q5model)
[1] 95
 lag Autocorrelation D-W Statistic p-value
   1       0.1114255      1.770733   0.084
 Alternative hypothesis: rho != 0
summary(Q5model)
[1] 96

Call:
lm(formula = incidents ~ training + feedback + training * feedback, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40000 -0.10500  0.00000  0.08333  0.43333 

Coefficients:
                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)          0.48333    0.02314  20.891  < 2e-16 ***
training2            0.10667    0.03272   3.260  0.00131 ** 
feedback2           -0.15000    0.03272  -4.585  8.1e-06 ***
training2:feedback2  0.05333    0.04627   1.153  0.25047    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1636 on 196 degrees of freedom
Multiple R-squared:  0.2431,	Adjusted R-squared:  0.2315 
F-statistic: 20.99 on 3 and 196 DF,  p-value: 7.827e-12

cat_plot(Q5model, pred = training, modx = feedback, data = data)
[1] 97
