

	####### B122052 R script #######

library(car, quietly = T)
[1] 1
 [1] "car"       "carData"   "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[10] "base"     
library(interactions, quietly = T)
[1] 2
 [1] "interactions" "car"          "carData"      "readr"        "stats"        "graphics"     "grDevices"   
 [8] "utils"        "datasets"     "methods"      "base"        
library(psych, quietly = T)
[1] 3
 [1] "psych"        "interactions" "car"          "carData"      "readr"        "stats"        "graphics"    
 [8] "grDevices"    "utils"        "datasets"     "methods"      "base"        
library(ggplot2, quietly = T)
[1] 4
 [1] "ggplot2"      "psych"        "interactions" "car"          "carData"      "readr"        "stats"       
 [8] "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
library(ggrepel, quietly = T)
[1] 5
 [1] "ggrepel"      "ggplot2"      "psych"        "interactions" "car"          "carData"      "readr"       
 [8] "stats"        "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
library(stargazer, quietly = T)
[1] 6
 [1] "stargazer"    "ggrepel"      "ggplot2"      "psych"        "interactions" "car"          "carData"     
 [8] "readr"        "stats"        "graphics"     "grDevices"    "utils"        "datasets"     "methods"     
[15] "base"        
data <- read.csv("../RMS2_report_1920.csv")
[1] 7
data$training <- as.factor(data$training)
[1] 8
levels(data$training) <- c("Untrained", "Trained")
[1] 9
data$feedback <- as.factor(data$feedback)
[1] 10
levels(data$feedback) <- c("No FB", "FB")
[1] 11
head(data)
[1] 12
  subject incidents training feedback empathy years
1       1 0.6666667  Trained       FB      11    10
2       2 0.3333333  Trained    No FB      10     7
3       3 0.3333333  Trained       FB      10     5
4       4 0.4166667  Trained    No FB       9     7
5       5 0.5000000  Trained       FB      12    12
6       6 0.2500000  Trained    No FB      11    10
str(data)
[1] 13
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : Factor w/ 2 levels "Untrained","Trained": 2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : Factor w/ 2 levels "No FB","FB": 2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
desc <- describe(data)
[1] 14
desc[, c(2:4, 8:11, 13)]
[1] 15
            n   mean    sd  min    max  range  skew   se
subject   200 100.50 57.88 1.00 200.00 199.00  0.00 4.09
incidents 200   0.48  0.19 0.08   0.92   0.83  0.32 0.01
training* 200   1.50  0.50 1.00   2.00   1.00  0.00 0.04
feedback* 200   1.50  0.50 1.00   2.00   1.00  0.00 0.04
empathy   200  10.18  2.54 3.00  16.00  13.00 -0.37 0.18
years     200   8.13  3.08 1.00  19.00  18.00  0.52 0.22
M1 <- lm(empathy ~ years, data = data)
[1] 16
crPlots(M1)
[1] 17
M1a <- lm(empathy ~ years + I(years^2), data = data)
[1] 18
qqPlot(M1a)
[1] 19
shapiro.test(M1a$residuals)
[1] 20

	Shapiro-Wilk normality test

data:  M1a$residuals
W = 0.9941, p-value = 0.6155

ncvTest(M1a)
[1] 21
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.5107658, Df = 1, p = 0.47481
crPlots(M1a)
[1] 22
durbinWatsonTest(M1a)
[1] 23
 lag Autocorrelation D-W Statistic p-value
   1      0.01288905      1.973855   0.858
 Alternative hypothesis: rho != 0
subject <- data$subject
[1] 24
str1a <- MASS::studres(M1a)
[1] 25
hats1a <- hatvalues(M1a)
[1] 26
cd1a <- cooks.distance(M1a)
[1] 27
cvrs1a <- covratio(M1a)
[1] 28
diag1a <- data.frame(subject, str1a, hats1a, cd1a, cvrs1a)
[1] 29
ggplot(diag1a, aes(subject, str1a)) + geom_col() + geom_text_repel(data = subset(diag1a, 
    str1a > 2 | str1a < -2), aes(label = subject, col = "red")) + 
    labs(x = "Subject", y = "Studentised Residual", title = "M1a - Studentised Residuals", 
        subtitle = "Cutoff = +/-2") + theme_bw() + theme(legend.position = "none") + 
    geom_hline(yintercept = 2, col = "blue", linetype = "dashed") + 
    geom_hline(yintercept = -2, col = "blue", linetype = "dashed")
[1] 30
ggplot(diag1a, aes(subject, hats1a)) + geom_col() + geom_text_repel(data = subset(diag1a, 
    hats1a > 2 * mean(hats1a)), aes(label = subject, col = "red")) + 
    labs(x = "Subject", y = "Hat Values", title = "M1a - Hat Values", 
        subtitle = "Cutoff = 2*mean") + theme_bw() + theme(legend.position = "none") + 
    geom_hline(yintercept = (2 * mean(hats1a)), col = "blue", 
        linetype = "dashed") + geom_text(aes(0, 2 * mean(hats1a), 
    label = "2*Mean", vjust = -0.5), size = 3, col = "blue")
[1] 31
ggplot(diag1a, aes(subject, cd1a)) + geom_col() + geom_text_repel(data = subset(diag1a, 
    cd1a > (4/197)), aes(label = subject, col = "red")) + labs(x = "Subject", 
    y = "Cook's Distance", title = "M1a - Cook's Distance", subtitle = "Cutoff = 4/197") + 
    theme_bw() + theme(legend.position = "none") + geom_hline(yintercept = (4/197), 
    col = "blue", linetype = "dashed") + geom_text(aes(0, 4/197, 
    label = "0.0203", vjust = -0.5), size = 3, col = "blue")
[1] 32
ggplot(diag1a, aes(subject, (cvrs1a - 1))) + geom_col() + geom_text_repel(data = subset(diag1a, 
    cvrs1a > 1.045 | cvrs1a < 0.955), aes(label = subject, col = "red")) + 
    labs(x = "Subject", y = "Covariance Ratio - 1", title = "M1a - Covariance Ratios", 
        subtitle = "Centred at covratio = 1.  Cutoff = 1 +/- 3*3/200") + 
    theme_bw() + theme(legend.position = "none") + geom_hline(yintercept = (0.045), 
    col = "blue", linetype = "dashed") + geom_text(aes(0, 0.045, 
    label = "0.045", vjust = -0.5), size = 3, col = "blue") + 
    geom_hline(yintercept = (-0.045), col = "blue", linetype = "dashed") + 
    geom_text(aes(0, -0.045, label = "-0.045", vjust = -0.5), 
        size = 3, col = "blue")
[1] 33
data_s1 <- subset(data[-c(61, 68, 69, 70, 88, 89, 92, 116, 137, 
    141, 142, 154, 155, 162, 165, 175, 190, 200), ])
[1] 34
M1ab <- lm(empathy ~ years + I(years^2), data = data_s1)
[1] 35
stargazer(M1, M1a, M1ab, type = "text", column.labels = c("M1", 
    "M1a", "M1b", "M1ab"))
[1] 36

===========================================================================================
                                              Dependent variable:                          
                    -----------------------------------------------------------------------
                                                    empathy                                
                              M1                      M1a                     M1b          
                              (1)                     (2)                     (3)          
-------------------------------------------------------------------------------------------
years                      0.218***                2.069***                2.386***        
                            (0.056)                 (0.182)                 (0.306)        
                                                                                           
I(years2)                                          -0.104***               -0.122***       
                                                    (0.010)                 (0.018)        
                                                                                           
Constant                   8.406***                  1.186                  -0.116         
                            (0.491)                 (0.792)                 (1.253)        
                                                                                           
-------------------------------------------------------------------------------------------
Observations                  200                     200                     182          
R2                           0.070                   0.404                   0.307         
Adjusted R2                  0.065                   0.398                   0.299         
Residual Std. Error    2.453 (df = 198)        1.969 (df = 197)        1.814 (df = 179)    
F Statistic         14.838*** (df = 1; 198) 66.755*** (df = 2; 197) 39.664*** (df = 2; 179)
===========================================================================================
Note:                                                           *p<0.1; **p<0.05; ***p<0.01
 [1] ""                                                                                           
 [2] "==========================================================================================="
 [3] "                                              Dependent variable:                          "
 [4] "                    -----------------------------------------------------------------------"
 [5] "                                                    empathy                                "
 [6] "                              M1                      M1a                     M1b          "
 [7] "                              (1)                     (2)                     (3)          "
 [8] "-------------------------------------------------------------------------------------------"
 [9] "years                      0.218***                2.069***                2.386***        "
[10] "                            (0.056)                 (0.182)                 (0.306)        "
[11] "                                                                                           "
[12] "I(years2)                                          -0.104***               -0.122***       "
[13] "                                                    (0.010)                 (0.018)        "
[14] "                                                                                           "
[15] "Constant                   8.406***                  1.186                  -0.116         "
[16] "                            (0.491)                 (0.792)                 (1.253)        "
[17] "                                                                                           "
[18] "-------------------------------------------------------------------------------------------"
[19] "Observations                  200                     200                     182          "
[20] "R2                           0.070                   0.404                   0.307         "
[21] "Adjusted R2                  0.065                   0.398                   0.299         "
[22] "Residual Std. Error    2.453 (df = 198)        1.969 (df = 197)        1.814 (df = 179)    "
[23] "F Statistic         14.838*** (df = 1; 198) 66.755*** (df = 2; 197) 39.664*** (df = 2; 179)"
[24] "==========================================================================================="
[25] "Note:                                                           *p<0.1; **p<0.05; ***p<0.01"
durbinWatsonTest(M1ab)
[1] 37
 lag Autocorrelation D-W Statistic p-value
   1         0.21796      1.563227       0
 Alternative hypothesis: rho != 0
summary(M1a)
[1] 38

Call:
lm(formula = empathy ~ years + I(years^2), data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  1.186356   0.791848   1.498    0.136    
years        2.068508   0.181845  11.375   <2e-16 ***
I(years^2)  -0.103645   0.009861 -10.510   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

ggplot(data, aes(x = years)) + geom_point(aes(y = empathy), shape = 16) + 
    geom_smooth(aes(y = empathy), method = "lm", formula = y ~ 
        x + I(x^2)) + labs(x = "Years of Experience", y = "Empathy Score", 
    title = "RQ1 - Scatter Plot", subtitle = "Including Outliers") + 
    theme_bw()
[1] 39
M2 <- lm(incidents ~ training + feedback + training:feedback + 
    empathy + years, data = data)
[1] 40
shapiro.test(M2$residuals)
[1] 41

	Shapiro-Wilk normality test

data:  M2$residuals
W = 0.98794, p-value = 0.08817

hist(M2$residuals, breaks = 30)
[1] 42
ncvTest(M2)
[1] 43
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 4.398557, Df = 1, p = 0.035969
log_constant <- 1 - min(data$incidents)
[1] 44
M2a <- lm(log(incidents + log_constant) ~ training + feedback + 
    training:feedback + empathy + years, data = data)
[1] 45
qqPlot(M2a)
[1] 46
shapiro.test(M2a$residuals)
[1] 47

	Shapiro-Wilk normality test

data:  M2a$residuals
W = 0.99434, p-value = 0.6515

hist(M2a$residuals, breaks = 30)
[1] 48
ncvTest(M2a)
[1] 49
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.577295, Df = 1, p = 0.44737
durbinWatsonTest(M2a)
[1] 50
 lag Autocorrelation D-W Statistic p-value
   1      0.09726586      1.794988   0.184
 Alternative hypothesis: rho != 0
vif(M2a)
[1] 51
         training          feedback           empathy             years training:feedback 
         2.086826          2.007327          1.122147          1.092150          3.070068 
subject <- data$subject
[1] 52
str2 <- MASS::studres(M2a)
[1] 53
hats2 <- hatvalues(M2a)
[1] 54
cd2 <- cooks.distance(M2a)
[1] 55
cvrs2 <- covratio(M2a)
[1] 56
diag2 <- data.frame(subject, str2, hats2, cd2, cvrs2)
[1] 57
ggplot(diag2, aes(subject, str2)) + geom_col() + geom_text_repel(data = subset(diag2, 
    str2 > 2 | str2 < -2), aes(label = subject, col = "red")) + 
    labs(x = "Subject", y = "Studentised Residual", title = "M2 - Studentised Residuals", 
        subtitle = "Cutoff = +/-2") + theme_bw() + theme(legend.position = "none") + 
    geom_hline(yintercept = 2, col = "blue", linetype = "dashed") + 
    geom_hline(yintercept = -2, col = "blue", linetype = "dashed")
[1] 58
ggplot(diag2, aes(subject, hats2)) + geom_col() + geom_text_repel(data = subset(diag2, 
    hats2 > 2 * mean(hats2)), aes(label = subject, col = "red")) + 
    labs(x = "Subject", y = "Hat Values", title = "M2 - Hat Values", 
        subtitle = "Cutoff = 2*mean") + theme_bw() + theme(legend.position = "none") + 
    geom_hline(yintercept = (2 * mean(hats2)), col = "blue", 
        linetype = "dashed") + geom_text(aes(0, 2 * mean(hats2), 
    label = "2*Mean", vjust = -0.5), size = 3, col = "blue")
[1] 59
ggplot(diag2, aes(subject, cd2)) + geom_col() + geom_text_repel(data = subset(diag2, 
    cd2 > (4/194)), aes(label = subject, col = "red")) + labs(x = "Subject", 
    y = "Cook's Distance", title = "M2 - Cook's Distance", subtitle = "Cutoff = 4/197") + 
    theme_bw() + theme(legend.position = "none") + geom_hline(yintercept = (4/194), 
    col = "blue", linetype = "dashed") + geom_text(aes(0, 4/194, 
    label = "0.0203", vjust = -0.5), size = 3, col = "blue")
[1] 60
ggplot(diag2, aes(subject, (cvrs2 - 1))) + geom_col() + geom_text_repel(data = subset(diag2, 
    cvrs2 > 1.09 | cvrs2 < 0.91), aes(label = subject, col = "red")) + 
    labs(x = "Subject", y = "Covariance Ratio - 1", title = "M2 - Covariance Ratios", 
        subtitle = "Centred at covratio = 1.  Cutoff = 1 +/- 3*6/200") + 
    theme_bw() + theme(legend.position = "none") + geom_hline(yintercept = (0.09), 
    col = "blue", linetype = "dashed") + geom_text(aes(0, 0.09, 
    label = "0.06", vjust = -0.5), size = 3, col = "blue") + 
    geom_hline(yintercept = (-0.09), col = "blue", linetype = "dashed") + 
    geom_text(aes(0, -0.09, label = "-0.06", vjust = -0.5), size = 3, 
        col = "blue")
[1] 61
data_s2 <- subset(data[-c(13, 61, 73, 74, 88, 89, 117, 137, 154, 
    176, 200), ])
[1] 62
M2ab <- lm(log(incidents + log_constant) ~ training + feedback + 
    training:feedback + empathy + years, data = data_s2)
[1] 63
stargazer(M2, M2a, M2ab, type = "text", column.labels = c("M2", 
    "M2a", "M2ab"), covariate.labels = c("Training Group", "Feedback Group", 
    "Empathy", "Years of Experience", "Training * Feedback Interaction", 
    "Intercept"))
[1] 64

=======================================================================================================
                                                          Dependent variable:                          
                                -----------------------------------------------------------------------
                                       incidents                 log(incidents + log_constant)         
                                          M2                      M2a                    M2ab          
                                          (1)                     (2)                     (3)          
-------------------------------------------------------------------------------------------------------
Training Group                         -0.203***               -0.152***               -0.142***       
                                        (0.030)                 (0.021)                 (0.020)        
                                                                                                       
Feedback Group                         0.086***                0.058***                0.066***        
                                        (0.029)                 (0.021)                 (0.020)        
                                                                                                       
Empathy                                0.029***                0.021***                0.024***        
                                        (0.004)                 (0.003)                 (0.003)        
                                                                                                       
Years of Experience                    -0.016***               -0.012***               -0.013***       
                                        (0.004)                 (0.002)                 (0.003)        
                                                                                                       
Training * Feedback Interaction         0.097**                0.078***                 0.069**        
                                        (0.042)                 (0.030)                 (0.028)        
                                                                                                       
Intercept                              0.345***                0.228***                0.202***        
                                        (0.049)                 (0.034)                 (0.035)        
                                                                                                       
-------------------------------------------------------------------------------------------------------
Observations                              200                     200                     189          
R2                                       0.401                   0.418                   0.459         
Adjusted R2                              0.386                   0.403                   0.444         
Residual Std. Error                0.146 (df = 194)        0.103 (df = 194)        0.096 (df = 183)    
F Statistic                     26.025*** (df = 5; 194) 27.821*** (df = 5; 194) 31.050*** (df = 5; 183)
=======================================================================================================
Note:                                                                       *p<0.1; **p<0.05; ***p<0.01
 [1] ""                                                                                                       
 [2] "======================================================================================================="
 [3] "                                                          Dependent variable:                          "
 [4] "                                -----------------------------------------------------------------------"
 [5] "                                       incidents                 log(incidents + log_constant)         "
 [6] "                                          M2                      M2a                    M2ab          "
 [7] "                                          (1)                     (2)                     (3)          "
 [8] "-------------------------------------------------------------------------------------------------------"
 [9] "Training Group                         -0.203***               -0.152***               -0.142***       "
[10] "                                        (0.030)                 (0.021)                 (0.020)        "
[11] "                                                                                                       "
[12] "Feedback Group                         0.086***                0.058***                0.066***        "
[13] "                                        (0.029)                 (0.021)                 (0.020)        "
[14] "                                                                                                       "
[15] "Empathy                                0.029***                0.021***                0.024***        "
[16] "                                        (0.004)                 (0.003)                 (0.003)        "
[17] "                                                                                                       "
[18] "Years of Experience                    -0.016***               -0.012***               -0.013***       "
[19] "                                        (0.004)                 (0.002)                 (0.003)        "
[20] "                                                                                                       "
[21] "Training * Feedback Interaction         0.097**                0.078***                 0.069**        "
[22] "                                        (0.042)                 (0.030)                 (0.028)        "
[23] "                                                                                                       "
[24] "Intercept                              0.345***                0.228***                0.202***        "
[25] "                                        (0.049)                 (0.034)                 (0.035)        "
[26] "                                                                                                       "
[27] "-------------------------------------------------------------------------------------------------------"
[28] "Observations                              200                     200                     189          "
[29] "R2                                       0.401                   0.418                   0.459         "
[30] "Adjusted R2                              0.386                   0.403                   0.444         "
[31] "Residual Std. Error                0.146 (df = 194)        0.103 (df = 194)        0.096 (df = 183)    "
[32] "F Statistic                     26.025*** (df = 5; 194) 27.821*** (df = 5; 194) 31.050*** (df = 5; 183)"
[33] "======================================================================================================="
[34] "Note:                                                                       *p<0.1; **p<0.05; ***p<0.01"
summary(M2a)
[1] 65

Call:
lm(formula = log(incidents + log_constant) ~ training + feedback + 
    training:feedback + empathy + years, data = data)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.226383 -0.071808 -0.000811  0.069089  0.284822 

Coefficients:
                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                 0.228340   0.034303   6.656 2.80e-10 ***
trainingTrained            -0.151903   0.021123  -7.191 1.36e-11 ***
feedbackFB                  0.058376   0.020716   2.818  0.00533 ** 
empathy                     0.021048   0.003060   6.878 8.14e-11 ***
years                      -0.011505   0.002488  -4.625 6.84e-06 ***
trainingTrained:feedbackFB  0.077604   0.029583   2.623  0.00940 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1034 on 194 degrees of freedom
Multiple R-squared:  0.4176,	Adjusted R-squared:  0.4026 
F-statistic: 27.82 on 5 and 194 DF,  p-value: < 2.2e-16

Training_beta <- summary(M2a)$coefficients["trainingTrained", 
    "Estimate"]
[1] 66
exp(abs(Training_beta)) - log_constant
[1] 67
[1] 0.2473805
ggplot(data, aes(x = training, y = log(incidents + log_constant))) + 
    geom_bar(position = "dodge", stat = "summary", fun.y = "mean", 
        fill = "#3399FF", alpha = 0.5) + stat_summary(fun.data = "mean_cl_normal", 
    geom = "errorbar", width = 0.2, position = position_dodge(0.9)) + 
    labs(x = "Training", y = "Incidents - Log Tranformed", title = "RQ2 Bar Plot", 
        subtitle = "Effect of Training on Incidents") + theme_bw()
[1] 68
summary(M2a)
[1] 69

Call:
lm(formula = log(incidents + log_constant) ~ training + feedback + 
    training:feedback + empathy + years, data = data)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.226383 -0.071808 -0.000811  0.069089  0.284822 

Coefficients:
                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                 0.228340   0.034303   6.656 2.80e-10 ***
trainingTrained            -0.151903   0.021123  -7.191 1.36e-11 ***
feedbackFB                  0.058376   0.020716   2.818  0.00533 ** 
empathy                     0.021048   0.003060   6.878 8.14e-11 ***
years                      -0.011505   0.002488  -4.625 6.84e-06 ***
trainingTrained:feedbackFB  0.077604   0.029583   2.623  0.00940 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1034 on 194 degrees of freedom
Multiple R-squared:  0.4176,	Adjusted R-squared:  0.4026 
F-statistic: 27.82 on 5 and 194 DF,  p-value: < 2.2e-16

FB_beta <- summary(M2a)$coefficients["feedbackFB", "Estimate"]
[1] 70
exp(FB_beta) - log_constant
[1] 71
[1] 0.1434471
ggplot(data, aes(x = feedback, y = log(incidents + log_constant))) + 
    geom_bar(position = "dodge", stat = "summary", fun.y = "mean", 
        fill = "pink", alpha = 0.5) + stat_summary(fun.data = "mean_cl_normal", 
    geom = "errorbar", width = 0.2, position = position_dodge(0.9)) + 
    labs(x = "Feedback", y = "Incidents - Log Tranformed", title = "RQ3 Bar Plot", 
        subtitle = "Effect of Feedback on Incidents") + theme_bw()
[1] 72
summary(M2a)
[1] 73

Call:
lm(formula = log(incidents + log_constant) ~ training + feedback + 
    training:feedback + empathy + years, data = data)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.226383 -0.071808 -0.000811  0.069089  0.284822 

Coefficients:
                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                 0.228340   0.034303   6.656 2.80e-10 ***
trainingTrained            -0.151903   0.021123  -7.191 1.36e-11 ***
feedbackFB                  0.058376   0.020716   2.818  0.00533 ** 
empathy                     0.021048   0.003060   6.878 8.14e-11 ***
years                      -0.011505   0.002488  -4.625 6.84e-06 ***
trainingTrained:feedbackFB  0.077604   0.029583   2.623  0.00940 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1034 on 194 degrees of freedom
Multiple R-squared:  0.4176,	Adjusted R-squared:  0.4026 
F-statistic: 27.82 on 5 and 194 DF,  p-value: < 2.2e-16

Training_SE <- summary(M2a)$coefficients["trainingTrained", "Std. Error"]
[1] 74
CI_M2a <- confint(M2a)
[1] 75
RQ4_tab <- data.frame(c("Training", "Feedback"), c(Training_beta, 
    FB_beta), c(CI_M2a[2:3, 1]), c(CI_M2a[2:3, 2]))
[1] 76
colnames(RQ4_tab) <- c("variable", "effect", "lower.ci", "upper.ci")
[1] 77
RQ4_t_val <- (abs(Training_beta) - FB_beta)/Training_SE
[1] 78
RQ4_p_val <- dt(RQ4_t_val, df = 194)
[1] 79
RQ4_tab2 <- data.frame(c("Training beta", "Feedback beta", "Training SE", 
    "t value", "p-value, df = 194"), c(Training_beta, FB_beta, 
    Training_SE, RQ4_t_val, RQ4_p_val))
[1] 80
colnames(RQ4_tab2) <- c("Statistic", "Value")
[1] 81
print(RQ4_tab2)
[1] 82
          Statistic         Value
1     Training beta -1.519029e-01
2     Feedback beta  5.837624e-02
3       Training SE  2.112263e-02
4           t value  4.427792e+00
5 p-value, df = 194  3.340701e-05
          Statistic         Value
1     Training beta -1.519029e-01
2     Feedback beta  5.837624e-02
3       Training SE  2.112263e-02
4           t value  4.427792e+00
5 p-value, df = 194  3.340701e-05
summary(M2a)
[1] 83

Call:
lm(formula = log(incidents + log_constant) ~ training + feedback + 
    training:feedback + empathy + years, data = data)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.226383 -0.071808 -0.000811  0.069089  0.284822 

Coefficients:
                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                 0.228340   0.034303   6.656 2.80e-10 ***
trainingTrained            -0.151903   0.021123  -7.191 1.36e-11 ***
feedbackFB                  0.058376   0.020716   2.818  0.00533 ** 
empathy                     0.021048   0.003060   6.878 8.14e-11 ***
years                      -0.011505   0.002488  -4.625 6.84e-06 ***
trainingTrained:feedbackFB  0.077604   0.029583   2.623  0.00940 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1034 on 194 degrees of freedom
Multiple R-squared:  0.4176,	Adjusted R-squared:  0.4026 
F-statistic: 27.82 on 5 and 194 DF,  p-value: < 2.2e-16

Interaction_beta <- summary(M2a)$coefficients["trainingTrained:feedbackFB", 
    "Estimate"]
[1] 84
exp(Interaction_beta) - log_constant
[1] 85
[1] 0.1640274
ggplot(data, aes(x = training, y = log(incidents + log_constant), 
    fill = feedback, group = feedback)) + geom_bar(position = "dodge", 
    stat = "summary", fun.y = "mean", alpha = 0.6) + stat_summary(fun.data = "mean_cl_normal", 
    geom = "errorbar", width = 0.2, position = position_dodge(0.9)) + 
    stat_summary(fun.y = mean, geom = "line", linetype = "dashed", 
        position = position_dodge(0.9)) + scale_fill_manual(values = alpha(c("#3399FF", 
    "pink"), 0.6)) + labs(x = "Training", y = "Incidents - Log Tranformed", 
    title = "RQ5 Bar Chart", fill = "Feedback") + theme_bw()
[1] 86
stargazer(M1a, M2a, type = "text", column.labels = c("M1a", "M2a"), 
    dep.var.labels = c("Empathy", "Incidents - Log Transformed"), 
    covariate.labels = c("Trained Group", "Feedback Group", "Empathy", 
        "Years of Experience", "Years of Experience - Squared", 
        "Training*Feedback Interaction", "Intercept"), intercept.bottom = TRUE)
[1] 87

=================================================================================
                                              Dependent variable:                
                              ---------------------------------------------------
                                      Empathy         Incidents - Log Transformed
                                        M1a                       M2a            
                                        (1)                       (2)            
---------------------------------------------------------------------------------
Trained Group                                                  -0.152***         
                                                                (0.021)          
                                                                                 
Feedback Group                                                 0.058***          
                                                                (0.021)          
                                                                                 
Empathy                                                        0.021***          
                                                                (0.003)          
                                                                                 
Years of Experience                  2.069***                  -0.012***         
                                      (0.182)                   (0.002)          
                                                                                 
Years of Experience - Squared        -0.104***                                   
                                      (0.010)                                    
                                                                                 
Training*Feedback Interaction                                  0.078***          
                                                                (0.030)          
                                                                                 
Intercept                              1.186                   0.228***          
                                      (0.792)                   (0.034)          
                                                                                 
---------------------------------------------------------------------------------
Observations                            200                       200            
R2                                     0.404                     0.418           
Adjusted R2                            0.398                     0.403           
Residual Std. Error              1.969 (df = 197)          0.103 (df = 194)      
F Statistic                   66.755*** (df = 2; 197)   27.821*** (df = 5; 194)  
=================================================================================
Note:                                                 *p<0.1; **p<0.05; ***p<0.01
 [1] ""                                                                                 
 [2] "================================================================================="
 [3] "                                              Dependent variable:                "
 [4] "                              ---------------------------------------------------"
 [5] "                                      Empathy         Incidents - Log Transformed"
 [6] "                                        M1a                       M2a            "
 [7] "                                        (1)                       (2)            "
 [8] "---------------------------------------------------------------------------------"
 [9] "Trained Group                                                  -0.152***         "
[10] "                                                                (0.021)          "
[11] "                                                                                 "
[12] "Feedback Group                                                 0.058***          "
[13] "                                                                (0.021)          "
[14] "                                                                                 "
[15] "Empathy                                                        0.021***          "
[16] "                                                                (0.003)          "
[17] "                                                                                 "
[18] "Years of Experience                  2.069***                  -0.012***         "
[19] "                                      (0.182)                   (0.002)          "
[20] "                                                                                 "
[21] "Years of Experience - Squared        -0.104***                                   "
[22] "                                      (0.010)                                    "
[23] "                                                                                 "
[24] "Training*Feedback Interaction                                  0.078***          "
[25] "                                                                (0.030)          "
[26] "                                                                                 "
[27] "Intercept                              1.186                   0.228***          "
[28] "                                      (0.792)                   (0.034)          "
[29] "                                                                                 "
[30] "---------------------------------------------------------------------------------"
[31] "Observations                            200                       200            "
[32] "R2                                     0.404                     0.418           "
[33] "Adjusted R2                            0.398                     0.403           "
[34] "Residual Std. Error              1.969 (df = 197)          0.103 (df = 194)      "
[35] "F Statistic                   66.755*** (df = 2; 197)   27.821*** (df = 5; 194)  "
[36] "================================================================================="
[37] "Note:                                                 *p<0.1; **p<0.05; ***p<0.01"
