

	####### B120982 R script #######

library(psych, quietly = T)
[1] 1
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(interactions, quietly = T)
[1] 2
 [1] "interactions" "psych"        "readr"        "stats"        "graphics"     "grDevices"    "utils"        "datasets"    
 [9] "methods"      "base"        
library(car, quietly = T)
[1] 3
 [1] "car"          "carData"      "interactions" "psych"        "readr"        "stats"        "graphics"     "grDevices"   
 [9] "utils"        "datasets"     "methods"      "base"        
ReportData <- read.csv("~/Desktop/rms2/code_check/RMS2_report_1920.csv")
[1] 4
str(ReportData)
[1] 5
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : int  2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : int  2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
ReportData$training <- as.factor(ReportData$training)
[1] 6
ReportData$feedback <- as.factor(ReportData$feedback)
[1] 7
str(ReportData)
[1] 8
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : Factor w/ 2 levels "1","2": 2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : Factor w/ 2 levels "1","2": 2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
contrasts(ReportData$training)
[1] 9
  2
1 0
2 1
contrasts(ReportData$feedback)
[1] 10
  2
1 0
2 1
head(ReportData)
[1] 11
  subject incidents training feedback empathy years
1       1 0.6666667        2        2      11    10
2       2 0.3333333        2        1      10     7
3       3 0.3333333        2        2      10     5
4       4 0.4166667        2        1       9     7
5       5 0.5000000        2        2      12    12
6       6 0.2500000        2        1      11    10
describe(ReportData)
[1] 12
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training*    3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
plot(ReportData$empathy ~ ReportData$years, xlab = "Years of experience", 
    ylab = "Empathy Score", main = "Empathy by Experience")
[1] 13
ModelEmYear <- lm(ReportData$empathy ~ ReportData$years)
[1] 14
summary(ModelEmYear)
[1] 15

Call:
lm(formula = ReportData$empathy ~ ReportData$years)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)       8.40625    0.49085  17.126  < 2e-16 ***
ReportData$years  0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

abline(ModelEmYear)
[1] 16
stds <- MASS::studres(ModelEmYear)
[1] 17
which(abs(stds) > 2)
[1] 18
 61  68  70  88  89 137 141 142 154 175 200 
 61  68  70  88  89 137 141 142 154 175 200 
cooks <- cooks.distance(ModelEmYear)
[1] 19
which(cooks > 0.02)
[1] 20
 16  61  88  89  94 108 137 141 154 163 171 175 192 200 
 16  61  88  89  94 108 137 141 154 163 171 175 192 200 
ReportData2 <- ReportData[-c(61, 88, 89, 137, 141, 154, 175, 
    200), ]
[1] 21
str(ReportData2)
[1] 22
'data.frame':	192 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : Factor w/ 2 levels "1","2": 2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : Factor w/ 2 levels "1","2": 2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
plot(ReportData2$empathy ~ ReportData2$years, xlab = "Years of experience", 
    ylab = "Empathy Score", main = "Empathy by Experience")
[1] 23
ModelEmYear2 <- lm(ReportData2$empathy ~ ReportData2$years)
[1] 24
summary(ModelEmYear2)
[1] 25

Call:
lm(formula = ReportData2$empathy ~ ReportData2$years)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.8416 -1.3997 -0.0833  1.4143  5.6655 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)        8.32492    0.49086  16.960  < 2e-16 ***
ReportData2$years  0.25119    0.05716   4.395 1.84e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.167 on 190 degrees of freedom
Multiple R-squared:  0.09228,	Adjusted R-squared:  0.0875 
F-statistic: 19.31 on 1 and 190 DF,  p-value: 1.841e-05

abline(ModelEmYear2)
[1] 26
lines(lowess(ReportData2$years, ReportData2$empathy))
[1] 27
hist(ModelEmYear2$residuals, main = "Histogram of residuals, empathy by years", 
    xlab = "residuals")
[1] 28
shapiro.test(ModelEmYear2$residuals)
[1] 29

	Shapiro-Wilk normality test

data:  ModelEmYear2$residuals
W = 0.98937, p-value = 0.1643

residualPlots(ModelEmYear2)
[1] 30
ncvTest(ModelEmYear2)
[1] 31
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.5218758, Df = 1, p = 0.47004
durbinWatsonTest(ModelEmYear2)
[1] 32
 lag Autocorrelation D-W Statistic p-value
   1       0.1205174      1.757419   0.084
 Alternative hypothesis: rho != 0
ReportData2$years <- ReportData2$years - mean(ReportData2$years)
[1] 33
ReportData2$empathy <- ReportData2$empathy - mean(ReportData2$empathy)
[1] 34
ModelTraining <- aov(incidents ~ training + empathy + years + 
    training:empathy + training:years, data = ReportData2)
[1] 35
summary(ModelTraining)
[1] 36
                  Df Sum Sq Mean Sq F value   Pr(>F)    
training           1  0.830  0.8302  31.057  8.7e-08 ***
empathy            1  0.383  0.3826  14.311 0.000209 ***
years              1  0.340  0.3396  12.702 0.000464 ***
training:empathy   1  0.018  0.0176   0.657 0.418748    
training:years     1  0.013  0.0132   0.495 0.482414    
Residuals        186  4.972  0.0267                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
ModelTraining2 <- aov(incidents ~ training + empathy + years, 
    data = ReportData2)
[1] 37
summary(ModelTraining2)
[1] 38
             Df Sum Sq Mean Sq F value   Pr(>F)    
training      1  0.830  0.8302   31.20 8.07e-08 ***
empathy       1  0.383  0.3826   14.38 0.000202 ***
years         1  0.340  0.3396   12.76 0.000450 ***
Residuals   188  5.003  0.0266                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary.lm(ModelTraining2)
[1] 39

Call:
aov(formula = incidents ~ training + empathy + years, data = ReportData2)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.36086 -0.12410 -0.01098  0.09703  0.52924 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.555278   0.016840  32.973  < 2e-16 ***
training2   -0.150653   0.023834  -6.321 1.84e-09 ***
empathy      0.026051   0.005520   4.720 4.60e-06 ***
years       -0.016211   0.004538  -3.572  0.00045 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1631 on 188 degrees of freedom
Multiple R-squared:  0.2368,	Adjusted R-squared:  0.2246 
F-statistic: 19.44 on 3 and 188 DF,  p-value: 5.045e-11

hist(ModelTraining2$residuals, main = "Histogram of residuals, incidents by training", 
    xlab = "residuals")
[1] 40
shapiro.test(ModelTraining2$residuals)
[1] 41

	Shapiro-Wilk normality test

data:  ModelTraining2$residuals
W = 0.9809, p-value = 0.01008

hist(ReportData2$incidents, main = "Histogram of incidents", 
    xlab = "incidents")
[1] 42
ReportData2$incidents2 <- sqrt(ReportData2$incidents)
[1] 43
ModelTraining3 <- aov(incidents2 ~ training + empathy + years + 
    training:empathy + training:years, data = ReportData2)
[1] 44
summary(ModelTraining3)
[1] 45
                  Df Sum Sq Mean Sq F value   Pr(>F)    
training           1 0.4851  0.4851  33.131  3.5e-08 ***
empathy            1 0.2229  0.2229  15.223 0.000133 ***
years              1 0.1913  0.1913  13.061 0.000388 ***
training:empathy   1 0.0033  0.0033   0.227 0.634673    
training:years     1 0.0006  0.0006   0.042 0.837573    
Residuals        186 2.7236  0.0146                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
ModelTraining4 <- aov(incidents2 ~ training + empathy + years, 
    data = ReportData2)
[1] 46
summary(ModelTraining4)
[1] 47
             Df Sum Sq Mean Sq F value   Pr(>F)    
training      1 0.4851  0.4851   33.44 3.02e-08 ***
empathy       1 0.2229  0.2229   15.37 0.000124 ***
years         1 0.1913  0.1913   13.18 0.000364 ***
Residuals   188 2.7275  0.0145                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary.lm(ModelTraining4)
[1] 48

Call:
aov(formula = incidents2 ~ training + empathy + years, data = ReportData2)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30669 -0.08677  0.00231  0.07800  0.34916 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.736553   0.012434  59.237  < 2e-16 ***
training2   -0.115033   0.017598  -6.537 5.75e-10 ***
empathy      0.019806   0.004075   4.860 2.47e-06 ***
years       -0.012166   0.003351  -3.631 0.000364 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1204 on 188 degrees of freedom
Multiple R-squared:  0.248,	Adjusted R-squared:  0.236 
F-statistic: 20.66 on 3 and 188 DF,  p-value: 1.293e-11

hist(ModelTraining4$residuals, main = "Histogram of residuals, incidents by training", 
    xlab = "residuals")
[1] 49
shapiro.test(ModelTraining4$residuals)
[1] 50

	Shapiro-Wilk normality test

data:  ModelTraining4$residuals
W = 0.99519, p-value = 0.7999

boxplot(ReportData2$incidents2 ~ ReportData2$training, main = "Variance of both levels of training", 
    xlab = "training")
[1] 51
ModelTraining4lm <- lm(incidents2 ~ training + empathy + years, 
    data = ReportData2)
[1] 52
ncvTest(ModelTraining4lm)
[1] 53
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 2.957013, Df = 1, p = 0.085506
plot(ReportData2$empathy, ReportData2$incidents2, col = ReportData2$training, 
    main = "Incidents by empathy for both levels of training", 
    xlab = "empathy", ylab = "incidents")
[1] 54
abline(lm(ReportData2$incidents2 ~ ReportData2$empathy))
[1] 55
plot(ReportData2$years, ReportData2$incidents2, col = ReportData2$training, 
    main = "Incidents by years for both levels of training", 
    xlab = "years", ylab = "incidents")
[1] 56
abline(lm(ReportData2$incidents2 ~ ReportData2$years))
[1] 57
ModelFeedback <- aov(incidents2 ~ feedback + empathy + years + 
    feedback:empathy + feedback:years, data = ReportData2)
[1] 58
summary(ModelFeedback)
[1] 59
                  Df Sum Sq Mean Sq F value   Pr(>F)    
feedback           1 0.4391  0.4391  28.815 2.35e-07 ***
empathy            1 0.1840  0.1840  12.075 0.000636 ***
years              1 0.1585  0.1585  10.405 0.001485 ** 
feedback:empathy   1 0.0012  0.0012   0.082 0.775270    
feedback:years     1 0.0100  0.0100   0.654 0.419887    
Residuals        186 2.8341  0.0152                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
ModelFeedback2 <- aov(incidents2 ~ feedback + empathy + years, 
    data = ReportData2)
[1] 60
summary(ModelFeedback2)
[1] 61
             Df Sum Sq Mean Sq F value   Pr(>F)    
feedback      1 0.4391  0.4391   29.01 2.13e-07 ***
empathy       1 0.1840  0.1840   12.16 0.000609 ***
years         1 0.1585  0.1585   10.47 0.001430 ** 
Residuals   188 2.8453  0.0151                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
summary.lm(ModelFeedback2)
[1] 62

Call:
aov(formula = incidents2 ~ feedback + empathy + years, data = ReportData2)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30341 -0.07446  0.00479  0.08371  0.35689 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.627649   0.012512  50.162  < 2e-16 ***
feedback2    0.102645   0.017819   5.760 3.37e-08 ***
empathy      0.017809   0.004131   4.311 2.62e-05 ***
years       -0.011038   0.003411  -3.237  0.00143 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.123 on 188 degrees of freedom
Multiple R-squared:  0.2155,	Adjusted R-squared:  0.203 
F-statistic: 17.21 on 3 and 188 DF,  p-value: 6.42e-10

hist(ModelFeedback2$residuals, main = "Histogram of residuals, incidents by feedback", 
    xlab = "residuals")
[1] 63
shapiro.test(ModelFeedback2$residuals)
[1] 64

	Shapiro-Wilk normality test

data:  ModelFeedback2$residuals
W = 0.99469, p-value = 0.7313

boxplot(ReportData2$incidents2 ~ ReportData2$feedback, main = "Variance of both levels of feedback", 
    xlab = "feedback")
[1] 65
ModelFeedback2lm <- lm(incidents2 ~ feedback + empathy + years, 
    data = ReportData2)
[1] 66
ncvTest(ModelFeedback2lm)
[1] 67
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 1.616408, Df = 1, p = 0.20359
plot(ReportData2$empathy, ReportData2$incidents2, col = ReportData2$feedback, 
    main = "Incidents by empathy for both levels of feedback", 
    xlab = "empathy", ylab = "incidents")
[1] 68
abline(lm(ReportData2$incidents2 ~ ReportData2$empathy))
[1] 69
plot(ReportData2$years, ReportData2$incidents2, col = ReportData2$feedback, 
    main = "Incidents by years for both levels of feedback", 
    xlab = "years", ylab = "incidents")
[1] 70
abline(lm(ReportData2$incidents2 ~ ReportData2$years))
[1] 71
ModelTrainFeed <- lm(scale(incidents2) ~ training + feedback + 
    scale(empathy, center = FALSE) + scale(years, center = FALSE), 
    data = ReportData2)
[1] 72
summary(ModelTrainFeed)
[1] 73

Call:
lm(formula = scale(incidents2) ~ training + feedback + scale(empathy, 
    center = FALSE) + scale(years, center = FALSE), data = ReportData2)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.91226 -0.49686  0.03129  0.50389  2.20845 

Coefficients:
                               Estimate Std. Error t value Pr(>|t|)    
(Intercept)                     0.05279    0.09872   0.535    0.593    
training2                      -0.84478    0.11528  -7.328 6.81e-12 ***
feedback2                       0.75587    0.11429   6.613 3.83e-10 ***
scale(empathy, center = FALSE)  0.35763    0.06074   5.888 1.78e-08 ***
scale(years, center = FALSE)   -0.26309    0.06029  -4.364 2.11e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.789 on 187 degrees of freedom
Multiple R-squared:  0.3905,	Adjusted R-squared:  0.3775 
F-statistic: 29.95 on 4 and 187 DF,  p-value: < 2.2e-16

hist(ModelTrainFeed$residuals, main = "Histogram of residuals, incidents by training and feedback", 
    xlab = "residuals")
[1] 74
shapiro.test(ModelTrainFeed$residuals)
[1] 75

	Shapiro-Wilk normality test

data:  ModelTrainFeed$residuals
W = 0.99534, p-value = 0.8197

residualPlots(ModelTrainFeed)
[1] 76
ncvTest(ModelTrainFeed)
[1] 77
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0626811, Df = 1, p = 0.80231
crPlots(ModelTrainFeed)
[1] 78
durbinWatsonTest(ModelTrainFeed)
[1] 79
 lag Autocorrelation D-W Statistic p-value
   1      0.09553267      1.798105   0.162
 Alternative hypothesis: rho != 0
vif(ModelTrainFeed)
[1] 80
                      training                       feedback scale(empathy, center = FALSE)   scale(years, center = FALSE) 
                      1.024619                       1.007083                       1.132085                       1.115313 
ModelInteraction <- lm(scale(incidents2) ~ training * feedback + 
    scale(empathy, center = FALSE) + scale(years, center = FALSE), 
    data = ReportData2)
[1] 81
summary(ModelInteraction)
[1] 82

Call:
lm(formula = scale(incidents2) ~ training * feedback + scale(empathy, 
    center = FALSE) + scale(years, center = FALSE), data = ReportData2)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.80078 -0.53100  0.01227  0.54041  2.05634 

Coefficients:
                               Estimate Std. Error t value Pr(>|t|)    
(Intercept)                     0.21469    0.11246   1.909  0.05780 .  
training2                      -1.16888    0.16079  -7.269 9.69e-12 ***
feedback2                       0.43564    0.15914   2.737  0.00679 ** 
scale(empathy, center = FALSE)  0.38227    0.06026   6.344 1.66e-09 ***
scale(years, center = FALSE)   -0.27159    0.05926  -4.583 8.39e-06 ***
training2:feedback2             0.64116    0.22597   2.837  0.00505 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.7745 on 186 degrees of freedom
Multiple R-squared:  0.4158,	Adjusted R-squared:  0.4001 
F-statistic: 26.48 on 5 and 186 DF,  p-value: < 2.2e-16

cat_plot(ModelInteraction, pred = training, modx = feedback, 
    geom = "line", y.label = "sd units of incidents intervened in")
[1] 83
hist(ModelInteraction$residuals, main = "Histogram of residuals, incidents by training*feedback", 
    xlab = "residuals")
[1] 84
shapiro.test(ModelInteraction$residuals)
[1] 85

	Shapiro-Wilk normality test

data:  ModelInteraction$residuals
W = 0.99546, p-value = 0.8356

residualPlots(ModelInteraction)
[1] 86
ncvTest(ModelInteraction)
[1] 87
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.00282972, Df = 1, p = 0.95758
durbinWatsonTest(ModelInteraction)
[1] 88
 lag Autocorrelation D-W Statistic p-value
   1       0.1178686      1.755442     0.1
 Alternative hypothesis: rho != 0
vif(ModelInteraction)
[1] 89
                      training                       feedback scale(empathy, center = FALSE)   scale(years, center = FALSE) 
                      2.068502                       2.026180                       1.156088                       1.118174 
             training:feedback 
                      3.064344 
