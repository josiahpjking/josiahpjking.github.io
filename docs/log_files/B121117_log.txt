

	####### B121117 R script #######

rm(list = ls())
[1] 1
data <- read.csv("../RMS2_report_1920.csv")
[1] 2
data$training <- as.factor(data$training)
[1] 3
data$feedback <- as.factor(data$feedback)
[1] 4
library(psych, quietly = T)
[1] 5
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
d <- describe(data[, c(2, 3, 4, 5, 6)])
[1] 6
d[, c(2:4)]
[1] 7
            n  mean   sd
incidents 200  0.48 0.19
training* 200  1.50 0.50
feedback* 200  1.50 0.50
empathy   200 10.18 2.54
years     200  8.13 3.08
describeBy(data$incidents, data$training)
[1] 8

 Descriptive statistics by group 
group: 1
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 100 0.54 0.18    0.5    0.53 0.25 0.25 0.92  0.67 0.39    -0.73 0.02
--------------------------------------------------------------------------------------- 
group: 2
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 100 0.41 0.17   0.42     0.4 0.12 0.08 0.92  0.83 0.38    -0.05 0.02
describeBy(data$incidents, data$feedback)
[1] 9

 Descriptive statistics by group 
group: 1
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 100 0.41 0.17   0.42     0.4 0.12 0.08 0.92  0.83  0.6     0.36 0.02
--------------------------------------------------------------------------------------- 
group: 2
   vars   n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 100 0.54 0.18    0.5    0.53 0.25 0.08 0.92  0.83 0.11    -0.44 0.02
boxplot(data$incidents)
[1] 10
boxplot(incidents ~ training, data = data, main = "Incidents by training or not", 
    xlab = "Training", ylab = "Incidents")
[1] 11
boxplot(incidents ~ feedback, data = data, main = "Incidents by feedback or not", 
    xlab = "Feedback", ylab = "Incidents")
[1] 12
library(interactions, quietly = T)
[1] 13
 [1] "interactions" "psych"        "readr"        "stats"        "graphics"     "grDevices"    "utils"       
 [8] "datasets"     "methods"      "base"        
cor(data$empathy, data$years)
[1] 14
[1] 0.2640369
model <- lm(empathy ~ years, data = data)
[1] 15
summary(model)
[1] 16

Call:
lm(formula = empathy ~ years, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  8.40625    0.49085  17.126  < 2e-16 ***
years        0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

par(mfrow = c(2, 2))
[1] 17
$mfrow
[1] 1 2

plot(model, 1:4)
[1] 18
model2 <- lm(empathy ~ years + I(years^2), data = data)
[1] 19
summary(model2)
[1] 20

Call:
lm(formula = empathy ~ years + I(years^2), data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  1.186356   0.791848   1.498    0.136    
years        2.068508   0.181845  11.375   <2e-16 ***
I(years^2)  -0.103645   0.009861 -10.510   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

par(mfrow = c(2, 2))
[1] 21
$mfrow
[1] 2 2

plot(model2, 1:4)
[1] 22
plot(empathy ~ years, data = data, pch = 16, col = "blue")
[1] 23
abline(model, col = "yellow", lwd = 2)
[1] 24
fits <- fitted.values(model2)
[1] 25
od <- order(data$years)
[1] 26
lines(data$years[od], fits[od], col = "red", lwd = 2)
[1] 27
BIC(model)
[1] 28
[1] 940.4137
BIC(model2)
[1] 29
[1] 856.6783
data$training <- factor(data$training)
[1] 30
model3 <- lm(incidents ~ empathy + years + training, data = data)
[1] 31
summary(model3)
[1] 32

Call:
lm(formula = incidents ~ empathy + years + training, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.407320   0.051814   7.861 2.48e-13 ***
empathy      0.025396   0.004735   5.363 2.29e-07 ***
years       -0.014085   0.003889  -3.622 0.000372 ***
training2   -0.152427   0.023166  -6.580 4.20e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

par(mfrow = c(2, 2))
[1] 33
$mfrow
[1] 2 2

plot(model3, 1:4)
[1] 34
model4 <- lm(incidents ~ (empathy + years) * training, data = data)
[1] 35
summary(model4)
[1] 36

Call:
lm(formula = incidents ~ (empathy + years) * training, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.34719 -0.12113 -0.00776  0.09883  0.52921 

Coefficients:
                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)        0.3818012  0.0781693   4.884 2.17e-06 ***
empathy            0.0278878  0.0070563   3.952 0.000108 ***
years             -0.0139859  0.0049719  -2.813 0.005413 ** 
training2         -0.1085415  0.1040157  -1.044 0.298010    
empathy:training2 -0.0045362  0.0097174  -0.467 0.641157    
years:training2    0.0002764  0.0081145   0.034 0.972866    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1629 on 194 degrees of freedom
Multiple R-squared:  0.2573,	Adjusted R-squared:  0.2382 
F-statistic: 13.44 on 5 and 194 DF,  p-value: 2.929e-11

par(mfrow = c(2, 2))
[1] 37
$mfrow
[1] 2 2

plot(model4, 1:4)
[1] 38
library(interactions, quietly = T)
[1] 39
 [1] "interactions" "psych"        "readr"        "stats"        "graphics"     "grDevices"    "utils"       
 [8] "datasets"     "methods"      "base"        
interact_plot(model4, pred = years, modx = training, plot.points = TRUE)
[1] 40
anova(model3, model4)
[1] 41
Analysis of Variance Table

Model 1: incidents ~ empathy + years + training
Model 2: incidents ~ (empathy + years) * training
  Res.Df    RSS Df Sum of Sq      F Pr(>F)
1    196 5.1532                           
2    194 5.1471  2 0.0060753 0.1145 0.8919
data$feedback <- factor(data$feedback)
[1] 42
model5 <- lm(incidents ~ empathy + years + feedback, data = data)
[1] 43
summary(model5)
[1] 44

Call:
lm(formula = incidents ~ empathy + years + feedback, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.276161   0.054108   5.104 7.84e-07 ***
empathy      0.023187   0.004829   4.802 3.11e-06 ***
years       -0.012689   0.003975  -3.192  0.00165 ** 
feedback2    0.132132   0.023585   5.602 7.09e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

par(mfrow = c(2, 2))
[1] 45
$mfrow
[1] 2 2

plot(model5, 1:4)
[1] 46
model6 <- lm(incidents ~ (empathy + years) * feedback, data = data)
[1] 47
summary(model6)
[1] 48

Call:
lm(formula = incidents ~ (empathy + years) * feedback, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35647 -0.11398 -0.01795  0.11182  0.52756 

Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)        0.293778   0.071276   4.122 5.57e-05 ***
empathy            0.018862   0.006418   2.939  0.00369 ** 
years             -0.009328   0.005816  -1.604  0.11039    
feedback2          0.084885   0.105862   0.802  0.42362    
empathy:feedback2  0.009756   0.009779   0.998  0.31970    
years:feedback2   -0.006384   0.007980  -0.800  0.42468    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1666 on 194 degrees of freedom
Multiple R-squared:  0.2228,	Adjusted R-squared:  0.2027 
F-statistic: 11.12 on 5 and 194 DF,  p-value: 1.967e-09

par(mfrow = c(2, 2))
[1] 49
$mfrow
[1] 2 2

plot(model6, 1:4)
[1] 50
interact_plot(model6, pred = years, modx = feedback, plot.points = TRUE)
[1] 51
anova(model5, model6)
[1] 52
Analysis of Variance Table

Model 1: incidents ~ empathy + years + feedback
Model 2: incidents ~ (empathy + years) * feedback
  Res.Df    RSS Df Sum of Sq     F Pr(>F)
1    196 5.4230                          
2    194 5.3868  2   0.03621 0.652 0.5221
abs(coef(model3)[4])
[1] 53
training2 
0.1524268 
abs(coef(model5)[4])
[1] 54
feedback2 
0.1321317 
model7 <- lm(incidents ~ empathy + years + training + feedback, 
    data = data)
[1] 55
summary(model7)
[1] 56

Call:
lm(formula = incidents ~ empathy + years + training + feedback, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.31626 -0.10096 -0.00949  0.09165  0.46650 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.331953   0.048708   6.815 1.15e-10 ***
empathy      0.027191   0.004328   6.283 2.12e-09 ***
years       -0.015199   0.003551  -4.281 2.92e-05 ***
training2   -0.153824   0.021128  -7.281 7.98e-12 ***
feedback2    0.133715   0.020968   6.377 1.28e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1479 on 195 degrees of freedom
Multiple R-squared:  0.3848,	Adjusted R-squared:  0.3721 
F-statistic: 30.49 on 4 and 195 DF,  p-value: < 2.2e-16

par(mfrow = c(2, 2))
[1] 57
$mfrow
[1] 2 2

plot(model7, 1:4)
[1] 58
model8 <- lm(incidents ~ empathy + years + training * feedback, 
    data = data)
[1] 59
summary(model8)
[1] 60

Call:
lm(formula = incidents ~ empathy + years + training * feedback, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30367 -0.10365 -0.00795  0.08806  0.44359 

Coefficients:
                     Estimate Std. Error t value Pr(>|t|)    
(Intercept)          0.345467   0.048515   7.121 2.04e-11 ***
empathy              0.028695   0.004328   6.630 3.25e-10 ***
years               -0.015720   0.003518  -4.468 1.34e-05 ***
training2           -0.203496   0.029874  -6.812 1.18e-10 ***
feedback2            0.085558   0.029299   2.920  0.00391 ** 
training2:feedback2  0.097334   0.041840   2.326  0.02103 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1462 on 194 degrees of freedom
Multiple R-squared:  0.4015,	Adjusted R-squared:  0.386 
F-statistic: 26.02 on 5 and 194 DF,  p-value: < 2.2e-16

par(mfrow = c(2, 2))
[1] 61
$mfrow
[1] 2 2

plot(model8, 1:4)
[1] 62
anova(model7, model8)
[1] 63
Analysis of Variance Table

Model 1: incidents ~ empathy + years + training + feedback
Model 2: incidents ~ empathy + years + training * feedback
  Res.Df    RSS Df Sum of Sq      F  Pr(>F)  
1    195 4.2639                              
2    194 4.1482  1   0.11572 5.4119 0.02103 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
data$training <- as.integer(data$training) + 1
[1] 64
model_forplot <- lm(incidents ~ empathy + years + training * 
    feedback, data = data)
[1] 65
interact_plot(model_forplot, pred = training, modx = feedback, 
    plot.points = TRUE)
[1] 66
