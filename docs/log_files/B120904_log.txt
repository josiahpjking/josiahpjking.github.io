

	####### B120904 R script #######

install.packages("psych")
[1] 1
install.packages("car")
[1] 2
install.packages("ez")
[1] 3
install.packages("tidyr")
[1] 4
install.packages("ggplot2")
[1] 5
install.packages("lme4")
[1] 6
library(psych, quietly = T)
[1] 7
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(car, quietly = T)
[1] 8
 [1] "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[11] "base"     
library(ez, quietly = T)
[1] 9
 [1] "ez"        "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[11] "methods"   "base"     
library(tidyr, quietly = T)
[1] 10
 [1] "tidyr"     "ez"        "car"       "carData"   "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"    
[11] "datasets"  "methods"   "base"     
library(lme4, quietly = T)
[1] 11
 [1] "lme4"      "Matrix"    "tidyr"     "ez"        "car"       "carData"   "psych"     "readr"     "stats"     "graphics" 
[11] "grDevices" "utils"     "datasets"  "methods"   "base"     
data_report <- read.csv("~/Desktop/rms2/code_check/RMS2_report_1920.csv")
[1] 12
summary(data_report)
[1] 13
    subject         incidents          training      feedback      empathy          years      
 Min.   :  1.00   Min.   :0.08333   Min.   :1.0   Min.   :1.0   Min.   : 3.00   Min.   : 1.00  
 1st Qu.: 50.75   1st Qu.:0.33333   1st Qu.:1.0   1st Qu.:1.0   1st Qu.: 9.00   1st Qu.: 6.00  
 Median :100.50   Median :0.41667   Median :1.5   Median :1.5   Median :10.00   Median : 8.00  
 Mean   :100.50   Mean   :0.47500   Mean   :1.5   Mean   :1.5   Mean   :10.18   Mean   : 8.13  
 3rd Qu.:150.25   3rd Qu.:0.58333   3rd Qu.:2.0   3rd Qu.:2.0   3rd Qu.:12.00   3rd Qu.:10.00  
 Max.   :200.00   Max.   :0.91667   Max.   :2.0   Max.   :2.0   Max.   :16.00   Max.   :19.00  
data_report$incidents[data_report$incidents > 1] <- NA
[1] 14
data_report$training[data_report$training > 2] <- NA
[1] 15
data_report$feedback[data_report$feedback > 2] <- NA
[1] 16
data_report$empathy[data_report$empathy > 20] <- NA
[1] 17
data_report$years[data_report$years > 30] <- NA
[1] 18
sapply(data_report, class)
[1] 19
  subject incidents  training  feedback   empathy     years 
"integer" "numeric" "integer" "integer" "integer" "integer" 
data_report$training <- as.factor(data_report$training)
[1] 20
summary(data_report$training)
[1] 21
  1   2 
100 100 
data_report$feadback <- as.factor(data_report$feedback)
[1] 22
summary(data_report$feadback)
[1] 23
  1   2 
100 100 
sapply(data_report, class)
[1] 24
  subject incidents  training  feedback   empathy     years  feadback 
"integer" "numeric"  "factor" "integer" "integer" "integer"  "factor" 
empathymean <- data_report$empathy - mean(data_report$empathy)
[1] 25
yearsmean <- data_report$years - mean(data_report$years)
[1] 26
lm1 <- lm(empathymean ~ yearsmean)
[1] 27
summary(lm1)
[1] 28

Call:
lm(formula = empathymean ~ yearsmean)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept) -6.013e-16  1.735e-01   0.000 1.000000    
yearsmean    2.176e-01  5.648e-02   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

plot(lm1)
[1] 29
qqPlot(lm1)
[1] 30
plot(lm1)
[1] 31
hist(lm1$residuals)
[1] 32
shapiro.test(lm1$residuals)
[1] 33

	Shapiro-Wilk normality test

data:  lm1$residuals
W = 0.98911, p-value = 0.1321

residualPlots(lm1)
[1] 34
ncvTest(lm1)
[1] 35
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.9815033, Df = 1, p = 0.32183
crPlots(lm1)
[1] 36
durbinWatsonTest(lm1)
[1] 37
 lag Autocorrelation D-W Statistic p-value
   1       0.1017162      1.769879   0.086
 Alternative hypothesis: rho != 0
plot(cooks.distance(lm1))
[1] 38
abline(h = cooks.distance(lm1) > (4/(200 - 2 - 1)), col = "red")
[1] 39
cooks <- cooks.distance(lm1)
[1] 40
names(which(cooks > (4/(200 - 2 - 1))))
[1] 41
 [1] "16"  "61"  "88"  "89"  "94"  "108" "137" "141" "154" "163" "171" "175" "192" "200"
plot(lm1, which = 4)
[1] 42
lm2 <- lm(empathymean ~ yearsmean + I(yearsmean^2))
[1] 43
summary(lm2)
[1] 44

Call:
lm(formula = empathymean ~ yearsmean + I(yearsmean^2))

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)     0.977696   0.167423   5.840 2.13e-08 ***
yearsmean       0.383236   0.047986   7.986 1.13e-13 ***
I(yearsmean^2) -0.103645   0.009861 -10.510  < 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

qqPlot(lm2)
[1] 45
plot(lm2)
[1] 46
hist(lm2$residuals)
[1] 47
shapiro.test(lm2$residuals)
[1] 48

	Shapiro-Wilk normality test

data:  lm2$residuals
W = 0.9941, p-value = 0.6155

residualPlots(lm2)
[1] 49
ncvTest(lm2)
[1] 50
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.5107658, Df = 1, p = 0.47481
crPlots(lm2)
[1] 51
plot(lm2)
[1] 52
durbinWatsonTest(lm2)
[1] 53
 lag Autocorrelation D-W Statistic p-value
   1      0.01288905      1.973855   0.832
 Alternative hypothesis: rho != 0
vif(lm2)
[1] 54
     yearsmean I(yearsmean^2) 
      1.120963       1.120963 
plot(cooks.distance(lm2))
[1] 55
abline(h = cooks.distance(lm2) > (4/(200 - 2 - 1)), col = "red")
[1] 56
cooks <- cooks.distance(lm2)
[1] 57
names(which(cooks > (4/(200 - 2 - 1))))
[1] 58
[1] "61"  "89"  "137" "141" "154" "163" "165" "175"
plot(lm2, which = 4)
[1] 59
m2 <- lm(data_report$incidents ~ data_report$training + data_report$empathy + 
    data_report$years)
[1] 60
summary(m2)
[1] 61

Call:
lm(formula = data_report$incidents ~ data_report$training + data_report$empathy + 
    data_report$years)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                       Estimate Std. Error t value Pr(>|t|)    
(Intercept)            0.407320   0.051814   7.861 2.48e-13 ***
data_report$training2 -0.152427   0.023166  -6.580 4.20e-10 ***
data_report$empathy    0.025396   0.004735   5.363 2.29e-07 ***
data_report$years     -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

qqPlot(m2)
[1] 62
plot(m2)
[1] 63
hist(m2$residuals)
[1] 64
shapiro.test(m2$residuals)
[1] 65

	Shapiro-Wilk normality test

data:  m2$residuals
W = 0.97994, p-value = 0.005838

residualPlots(m2)
[1] 66
ncvTest(m2)
[1] 67
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0293323, Df = 1, p = 0.86401
crPlots(m2)
[1] 68
plot(data_report$empathy ~ yearsmean)
[1] 69
abline(lm(empathy ~ yearsmean, data = data_report))
[1] 70
lines(lowess(empathymean, yearsmean))
[1] 71
durbinWatsonTest(m2)
[1] 72
 lag Autocorrelation D-W Statistic p-value
   1      -0.1072849      2.199897   0.166
 Alternative hypothesis: rho != 0
plot(cooks.distance(m2))
[1] 73
abline(h = cooks.distance(m2) > (4/(200 - 4 - 1)), col = "red")
[1] 74
cooks <- cooks.distance(m2)
[1] 75
names(which(cooks > (4/(200 - 4 - 1))))
[1] 76
[1] "13"  "35"  "74"  "137" "165"
plot(lm1, which = 4)
[1] 77
m4 <- lm(data_report$incidents ~ data_report$feedback + data_report$empathy + 
    data_report$years)
[1] 78
summary(m4)
[1] 79

Call:
lm(formula = data_report$incidents ~ data_report$feedback + data_report$empathy + 
    data_report$years)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                      Estimate Std. Error t value Pr(>|t|)    
(Intercept)           0.144029   0.064150   2.245  0.02587 *  
data_report$feedback  0.132132   0.023585   5.602 7.09e-08 ***
data_report$empathy   0.023187   0.004829   4.802 3.11e-06 ***
data_report$years    -0.012689   0.003975  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

qqPlot(m4)
[1] 80
plot(m4)
[1] 81
hist(m4$residuals)
[1] 82
shapiro.test(m4$residuals)
[1] 83

	Shapiro-Wilk normality test

data:  m4$residuals
W = 0.98772, p-value = 0.08174

residualPlots(m4)
[1] 84
ncvTest(m4)
[1] 85
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.01731234, Df = 1, p = 0.89532
crPlots(m4)
[1] 86
plot(data_report$empathy ~ yearsmean)
[1] 87
abline(lm(empathy ~ yearsmean, data = data_report))
[1] 88
lines(lowess(empathymean, yearsmean))
[1] 89
durbinWatsonTest(m4)
[1] 90
 lag Autocorrelation D-W Statistic p-value
   1       0.2738264      1.444081       0
 Alternative hypothesis: rho != 0
plot(cooks.distance(m4))
[1] 91
abline(h = cooks.distance(m4) > (4/(200 - 4 - 1)), col = "red")
[1] 92
cooks <- cooks.distance(m4)
[1] 93
names(which(cooks > (4/(200 - 4 - 1))))
[1] 94
[1] "73"  "74"  "89"  "137" "156" "160" "165" "176"
plot(lm1, which = 4)
[1] 95
AIC(m2, m4)
[1] 96
   df       AIC
m2  5 -154.1654
m4  5 -143.9591
BIC(m2, m4)
[1] 97
   df       BIC
m2  5 -137.6738
m4  5 -127.4675
summary(m2)
[1] 98

Call:
lm(formula = data_report$incidents ~ data_report$training + data_report$empathy + 
    data_report$years)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                       Estimate Std. Error t value Pr(>|t|)    
(Intercept)            0.407320   0.051814   7.861 2.48e-13 ***
data_report$training2 -0.152427   0.023166  -6.580 4.20e-10 ***
data_report$empathy    0.025396   0.004735   5.363 2.29e-07 ***
data_report$years     -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

summary(m4)
[1] 99

Call:
lm(formula = data_report$incidents ~ data_report$feedback + data_report$empathy + 
    data_report$years)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                      Estimate Std. Error t value Pr(>|t|)    
(Intercept)           0.144029   0.064150   2.245  0.02587 *  
data_report$feedback  0.132132   0.023585   5.602 7.09e-08 ***
data_report$empathy   0.023187   0.004829   4.802 3.11e-06 ***
data_report$years    -0.012689   0.003975  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

m5 <- lm(data_report$incidents ~ data_report$empathy + data_report$years + 
    data_report$training + data_report$feedback + data_report$training * 
    data_report$feedback)
[1] 100
summary(m5)
[1] 101

Call:
lm(formula = data_report$incidents ~ data_report$empathy + data_report$years + 
    data_report$training + data_report$feedback + data_report$training * 
    data_report$feedback)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30367 -0.10365 -0.00795  0.08806  0.44359 

Coefficients:
                                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                                 0.259909   0.062748   4.142 5.13e-05 ***
data_report$empathy                         0.028695   0.004328   6.630 3.25e-10 ***
data_report$years                          -0.015720   0.003518  -4.468 1.34e-05 ***
data_report$training2                      -0.300830   0.066556  -4.520 1.07e-05 ***
data_report$feedback                        0.085558   0.029299   2.920  0.00391 ** 
data_report$training2:data_report$feedback  0.097334   0.041840   2.326  0.02103 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1462 on 194 degrees of freedom
Multiple R-squared:  0.4015,	Adjusted R-squared:  0.386 
F-statistic: 26.02 on 5 and 194 DF,  p-value: < 2.2e-16

dummy_training <- dummy.code(data_report$training)
[1] 102
dummy_feedback <- dummy.code(data_report$feedback)
[1] 103
m6 <- lm(data_report$incidents ~ data_report$empathy + data_report$years + 
    dummy_feedback + dummy_training + data_report$training * 
    data_report$feedback)
[1] 104
summary(m6)
[1] 105

Call:
lm(formula = data_report$incidents ~ data_report$empathy + data_report$years + 
    dummy_feedback + dummy_training + data_report$training * 
    data_report$feedback)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30367 -0.10365 -0.00795  0.08806  0.44359 

Coefficients: (4 not defined because of singularities)
                                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                                 0.130195   0.092049   1.414  0.15884    
data_report$empathy                         0.028695   0.004328   6.630 3.25e-10 ***
data_report$years                          -0.015720   0.003518  -4.468 1.34e-05 ***
dummy_feedback1                            -0.085558   0.029299  -2.920  0.00391 ** 
dummy_feedback2                                   NA         NA      NA       NA    
dummy_training1                             0.300830   0.066556   4.520 1.07e-05 ***
dummy_training2                                   NA         NA      NA       NA    
data_report$training2                             NA         NA      NA       NA    
data_report$feedback                              NA         NA      NA       NA    
data_report$training2:data_report$feedback  0.097334   0.041840   2.326  0.02103 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1462 on 194 degrees of freedom
Multiple R-squared:  0.4015,	Adjusted R-squared:  0.386 
F-statistic: 26.02 on 5 and 194 DF,  p-value: < 2.2e-16

qqPlot(m6)
[1] 106
plot(m6)
[1] 107
hist(m6$residuals)
[1] 108
shapiro.test(m6$residuals)
[1] 109

	Shapiro-Wilk normality test

data:  m6$residuals
W = 0.98794, p-value = 0.08817

residualPlots(m6)
[1] 110
ncvTest(m6)
[1] 111
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 4.398557, Df = 1, p = 0.035969
plot(m6)
[1] 112
