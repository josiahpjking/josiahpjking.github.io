

	####### B103490 R script #######

library(agricolae, quietly = T)
[1] 1
[1] "agricolae" "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(psych, quietly = T)
[1] 2
 [1] "psych"     "agricolae" "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[10] "base"     
library(car, quietly = T)
[1] 3
 [1] "car"       "carData"   "psych"     "agricolae" "readr"     "stats"     "graphics"  "grDevices" "utils"    
[10] "datasets"  "methods"   "base"     
library(carData, quietly = T)
[1] 4
 [1] "car"       "carData"   "psych"     "agricolae" "readr"     "stats"     "graphics"  "grDevices" "utils"    
[10] "datasets"  "methods"   "base"     
library(datasets, quietly = T)
[1] 5
 [1] "car"       "carData"   "psych"     "agricolae" "readr"     "stats"     "graphics"  "grDevices" "utils"    
[10] "datasets"  "methods"   "base"     
library(ggplot2, quietly = T)
[1] 6
 [1] "ggplot2"   "car"       "carData"   "psych"     "agricolae" "readr"     "stats"     "graphics"  "grDevices"
[10] "utils"     "datasets"  "methods"   "base"     
library(graphics, quietly = T)
[1] 7
 [1] "ggplot2"   "car"       "carData"   "psych"     "agricolae" "readr"     "stats"     "graphics"  "grDevices"
[10] "utils"     "datasets"  "methods"   "base"     
library(grDevices, quietly = T)
[1] 8
 [1] "ggplot2"   "car"       "carData"   "psych"     "agricolae" "readr"     "stats"     "graphics"  "grDevices"
[10] "utils"     "datasets"  "methods"   "base"     
library(interactions, quietly = T)
[1] 9
 [1] "interactions" "ggplot2"      "car"          "carData"      "psych"        "agricolae"    "readr"       
 [8] "stats"        "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
library(lm.beta, quietly = T)
[1] 10
 [1] "lm.beta"      "interactions" "ggplot2"      "car"          "carData"      "psych"        "agricolae"   
 [8] "readr"        "stats"        "graphics"     "grDevices"    "utils"        "datasets"     "methods"     
[15] "base"        
library(parameters, quietly = T)
[1] 11
 [1] "parameters"   "lm.beta"      "interactions" "ggplot2"      "car"          "carData"      "psych"       
 [8] "agricolae"    "readr"        "stats"        "graphics"     "grDevices"    "utils"        "datasets"    
[15] "methods"      "base"        
library(stats, quietly = T)
[1] 12
 [1] "parameters"   "lm.beta"      "interactions" "ggplot2"      "car"          "carData"      "psych"       
 [8] "agricolae"    "readr"        "stats"        "graphics"     "grDevices"    "utils"        "datasets"    
[15] "methods"      "base"        
library(utils, quietly = T)
[1] 13
 [1] "parameters"   "lm.beta"      "interactions" "ggplot2"      "car"          "carData"      "psych"       
 [8] "agricolae"    "readr"        "stats"        "graphics"     "grDevices"    "utils"        "datasets"    
[15] "methods"      "base"        
rm(list = ls())
[1] 14
cw <- read.csv("../RMS2_report_1920.csv")
[1] 15
View(cw)
[1] 16
describe(cw)
[1] 17
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training     3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
which(is.na(cw))
[1] 18
integer(0)
str(cw)
[1] 19
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : int  2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : int  2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
cw$subject <- as.factor(cw$subject)
[1] 20
cw$training <- as.factor(cw$training)
[1] 21
cw$feedback <- as.factor(cw$feedback)
[1] 22
cw$training <- factor(cw$training, labels = c("No training", 
    "Training"))
[1] 23
cw$feedback <- factor(cw$feedback, labels = c("No feedback", 
    "Feedback"))
[1] 24
par(mfrow = c(2, 3))
[1] 25
$mfrow
[1] 1 1

par("mar")
[1] 26
[1] 5.1 4.1 4.1 2.1
par(mar = c(1, 1, 1, 1))
[1] 27
$mar
[1] 5.1 4.1 4.1 2.1

plot(cw$training, cw$incidents, xlab = "Training", ylab = "Number of Incidents", 
    main = "Training & Incidents", col = "orange")
[1] 28
plot(cw$feedback, cw$incidents, xlab = "Feedback", ylab = "Number of Incidents", 
    main = "Feedback & Incidents", col = "pink")
[1] 29
plot(cw$empathy, cw$years, xlab = "Empathy Score", ylab = "Years of Experience", 
    main = "Empathy & Years", pch = 16, col = "light green")
[1] 30
abline(lm(cw$years ~ cw$empathy))
[1] 31
plot(cw$empathy, cw$incidents, xlab = "Empathy Score", ylab = "Number of Incidents", 
    main = "Empathy & Incidents", pch = 16, col = "cyan")
[1] 32
abline(lm(cw$incidents ~ cw$empathy))
[1] 33
plot(cw$years, cw$incidents, xlab = "Years of experience", ylab = "Number of Incidents", 
    main = "Years & Incidents", pch = 16, col = "purple")
[1] 34
abline(lm(cw$incidents ~ cw$years))
[1] 35
description <- describe(cw)
[1] 36
description[c(2, 3, 4, 8, 9)]
[1] 37
            n   mean    sd  min    max
subject*  200 100.50 57.88 1.00 200.00
incidents 200   0.48  0.19 0.08   0.92
training* 200   1.50  0.50 1.00   2.00
feedback* 200   1.50  0.50 1.00   2.00
empathy   200  10.18  2.54 3.00  16.00
years     200   8.13  3.08 1.00  19.00
cw$empathy_mean <- cw$empathy - mean(cw$empathy)
[1] 38
Q1model <- lm(cw$empathy_mean ~ cw$years)
[1] 39
summary(Q1model)
[1] 40

Call:
lm(formula = cw$empathy_mean ~ cw$years)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) -1.76875    0.49085  -3.603 0.000397 ***
cw$years     0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

cooks <- cooks.distance(Q1model)
[1] 41
which(cooks > (4/(200 - 2 - 1)))
[1] 42
 16  61  88  89  94 108 137 141 154 163 171 175 192 200 
 16  61  88  89  94 108 137 141 154 163 171 175 192 200 
names(which(cooks > (4/200 - 2 - 1)))
[1] 43
 [1] "1"  "2"  "3"  "4"  "5"  "6"  "7"  "8"  "9"  "10" "11" "12" "13" "14" "15" "16" "17" "18" "19" "20" "21" "22"
[23] "23" "24" "25" "26" "27" "28" "29" "30" "31" "32" "33" "34" "35" "36" "37" "38" "39" "40" "41" "42" "43" "44"
[45] "45" "46" "47" "48" "49" "50"
 [ reached getOption("max.print") -- omitted 150 entries ]
plot(Q1model, which = 4, col = "orange")
[1] 44
Q1modela <- lm(empathy_mean ~ years, data = cw[-c(88, 137, 154), 
    ])
[1] 45
summary(Q1modela)
[1] 46

Call:
lm(formula = empathy_mean ~ years, data = cw[-c(88, 137, 154), 
    ])

Residuals:
    Min      1Q  Median      3Q     Max 
-6.2211 -1.6555  0.0411  1.4756  5.7583 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) -2.19556    0.49438  -4.441 1.50e-05 ***
years        0.28278    0.05778   4.894 2.07e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.325 on 195 degrees of freedom
Multiple R-squared:  0.1094,	Adjusted R-squared:  0.1048 
F-statistic: 23.95 on 1 and 195 DF,  p-value: 2.068e-06

summary(Q1model)
[1] 47

Call:
lm(formula = cw$empathy_mean ~ cw$years)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) -1.76875    0.49085  -3.603 0.000397 ***
cw$years     0.21756    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

Q1modelstd <- summary(lm.beta(Q1model))
[1] 48
Q1modela_std <- summary(lm.beta(Q1modela))
[1] 49
Q1modelstd


Call:
lm(formula = cw$empathy_mean ~ cw$years)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5399 -1.5160  0.0708  1.6357  5.8533 

Coefficients:
            Estimate Standardized Std. Error t value Pr(>|t|)    
(Intercept) -1.76875      0.00000    0.49085  -3.603 0.000397 ***
cw$years     0.21756      0.26404    0.05648   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.453 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582



Q1modela_std


Call:
lm(formula = empathy_mean ~ years, data = cw[-c(88, 137, 154), 
    ])

Residuals:
    Min      1Q  Median      3Q     Max 
-6.2211 -1.6555  0.0411  1.4756  5.7583 

Coefficients:
            Estimate Standardized Std. Error t value Pr(>|t|)    
(Intercept) -2.19556      0.00000    0.49438  -4.441 1.50e-05 ***
years        0.28278      0.33072    0.05778   4.894 2.07e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.325 on 195 degrees of freedom
Multiple R-squared:  0.1094,	Adjusted R-squared:  0.1048 
F-statistic: 23.95 on 1 and 195 DF,  p-value: 2.068e-06



compare1 <- data.frame(round(Q1modelstd$coefficients[, 1], 5), 
    round(Q1modelstd$coefficients[, 5], 5), round(Q1modela_std$coefficients[, 
        1], 5), round(Q1modela_std$coefficients[, 5], 5))
[1] 52
colnames(compare1) <- c("m1 coef", "m1 p-value", "m1a coef", 
    "m1a p-value")
[1] 53
compare1

             m1 coef m1 p-value m1a coef m1a p-value
(Intercept) -1.76875    0.00040 -2.19556       1e-05
cw$years     0.21756    0.00016  0.28278       0e+00


names(which(cooks.distance(Q1model) > 1))
[1] 55
character(0)
crPlots(Q1model)
[1] 56
hist(cw$empathy_mean, main = "Mean Centered Empathy", col = "pink")
[1] 57
hist(cw$years, main = "Years", col = "orange")
[1] 58
skew(cw$empathy_mean)
[1] 59
[1] -0.371876
skew(cw$years)
[1] 60
[1] 0.516562
Q1modelb <- lm(cw$empathy_mean ~ cw$years + I(cw$years^2), data = cw)
[1] 61
summary(Q1modelb)
[1] 62

Call:
lm(formula = cw$empathy_mean ~ cw$years + I(cw$years^2), data = cw)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)   -8.988644   0.791848  -11.35   <2e-16 ***
cw$years       2.068508   0.181845   11.38   <2e-16 ***
I(cw$years^2) -0.103645   0.009861  -10.51   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

crPlots(Q1modelb)
[1] 63
qqPlot(Q1modelb)
[1] 64
shapiro.test(Q1modelb$residuals)
[1] 65

	Shapiro-Wilk normality test

data:  Q1modelb$residuals
W = 0.9941, p-value = 0.6155

hist(Q1modelb$residuals, main = "Normality of errors", col = "pink")
[1] 66
residualPlots(Q1modelb)
[1] 67
ncvTest(Q1modelb)
[1] 68
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.5107658, Df = 1, p = 0.47481
durbinWatsonTest(Q1modelb)
[1] 69
 lag Autocorrelation D-W Statistic p-value
   1      0.01288905      1.973855   0.826
 Alternative hypothesis: rho != 0
summary(Q1modelb)
[1] 70

Call:
lm(formula = cw$empathy_mean ~ cw$years + I(cw$years^2), data = cw)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5069 -1.4011 -0.0835  1.1707  6.0622 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)   -8.988644   0.791848  -11.35   <2e-16 ***
cw$years       2.068508   0.181845   11.38   <2e-16 ***
I(cw$years^2) -0.103645   0.009861  -10.51   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.969 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

Q2model <- lm(incidents ~ training, data = cw)
[1] 71
summary(Q2model)
[1] 72

Call:
lm(formula = incidents ~ training, data = cw)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.32500 -0.12500  0.00833  0.12500  0.50833 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.54167    0.01747  31.009  < 2e-16 ***
trainingTraining -0.13333    0.02470  -5.397 1.92e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1747 on 198 degrees of freedom
Multiple R-squared:  0.1283,	Adjusted R-squared:  0.1239 
F-statistic: 29.13 on 1 and 198 DF,  p-value: 1.922e-07

str(Q2model)
[1] 73
List of 13
 $ coefficients : Named num [1:2] 0.542 -0.133
  ..- attr(*, "names")= chr [1:2] "(Intercept)" "trainingTraining"
 $ residuals    : Named num [1:200] 0.25833 -0.075 -0.075 0.00833 0.09167 ...
  ..- attr(*, "names")= chr [1:200] "1" "2" "3" "4" ...
 $ effects      : Named num [1:200] -6.71751 0.94281 -0.08636 -0.00302 0.08031 ...
  ..- attr(*, "names")= chr [1:200] "(Intercept)" "trainingTraining" "" "" ...
 $ rank         : int 2
 $ fitted.values: Named num [1:200] 0.408 0.408 0.408 0.408 0.408 ...
  ..- attr(*, "names")= chr [1:200] "1" "2" "3" "4" ...
 $ assign       : int [1:2] 0 1
 $ qr           :List of 5
  ..$ qr   : num [1:200, 1:2] -14.1421 0.0707 0.0707 0.0707 0.0707 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr [1:200] "1" "2" "3" "4" ...
  .. .. ..$ : chr [1:2] "(Intercept)" "trainingTraining"
  .. ..- attr(*, "assign")= int [1:2] 0 1
  .. ..- attr(*, "contrasts")=List of 1
  .. .. ..$ training: chr "contr.treatment"
  ..$ qraux: num [1:2] 1.07 1.07
  ..$ pivot: int [1:2] 1 2
  ..$ tol  : num 1e-07
  ..$ rank : int 2
  ..- attr(*, "class")= chr "qr"
 $ df.residual  : int 198
 $ contrasts    :List of 1
  ..$ training: chr "contr.treatment"
 $ xlevels      :List of 1
  ..$ training: chr [1:2] "No training" "Training"
 $ call         : language lm(formula = incidents ~ training, data = cw)
 $ terms        :Classes 'terms', 'formula'  language incidents ~ training
  .. ..- attr(*, "variables")= language list(incidents, training)
  .. ..- attr(*, "factors")= int [1:2, 1] 0 1
  .. .. ..- attr(*, "dimnames")=List of 2
  .. .. .. ..$ : chr [1:2] "incidents" "training"
  .. .. .. ..$ : chr "training"
  .. ..- attr(*, "term.labels")= chr "training"
  .. ..- attr(*, "order")= int 1
  .. ..- attr(*, "intercept")= int 1
  .. ..- attr(*, "response")= int 1
  .. ..- attr(*, ".Environment")=<environment: R_GlobalEnv> 
  .. ..- attr(*, "predvars")= language list(incidents, training)
  .. ..- attr(*, "dataClasses")= Named chr [1:2] "numeric" "factor"
  .. .. ..- attr(*, "names")= chr [1:2] "incidents" "training"
 $ model        :'data.frame':	200 obs. of  2 variables:
  ..$ incidents: num [1:200] 0.667 0.333 0.333 0.417 0.5 ...
  ..$ training : Factor w/ 2 levels "No training",..: 2 2 2 2 2 2 2 2 2 2 ...
  ..- attr(*, "terms")=Classes 'terms', 'formula'  language incidents ~ training
  .. .. ..- attr(*, "variables")= language list(incidents, training)
  .. .. ..- attr(*, "factors")= int [1:2, 1] 0 1
  .. .. .. ..- attr(*, "dimnames")=List of 2
  .. .. .. .. ..$ : chr [1:2] "incidents" "training"
  .. .. .. .. ..$ : chr "training"
  .. .. ..- attr(*, "term.labels")= chr "training"
  .. .. ..- attr(*, "order")= int 1
  .. .. ..- attr(*, "intercept")= int 1
  .. .. ..- attr(*, "response")= int 1
  .. .. ..- attr(*, ".Environment")=<environment: R_GlobalEnv> 
  .. .. ..- attr(*, "predvars")= language list(incidents, training)
  .. .. ..- attr(*, "dataClasses")= Named chr [1:2] "numeric" "factor"
  .. .. .. ..- attr(*, "names")= chr [1:2] "incidents" "training"
 - attr(*, "class")= chr "lm"
NULL
Q2modelb <- lm(incidents ~ training + empathy_mean + years, data = cw)
[1] 74
summary(Q2modelb)
[1] 75

Call:
lm(formula = incidents ~ training + empathy_mean + years, data = cw)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.665721   0.036551  18.214  < 2e-16 ***
trainingTraining -0.152427   0.023166  -6.580 4.20e-10 ***
empathy_mean      0.025396   0.004735   5.363 2.29e-07 ***
years            -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

anova(Q2model, Q2modelb)
[1] 76
Analysis of Variance Table

Model 1: incidents ~ training
Model 2: incidents ~ training + empathy_mean + years
  Res.Df    RSS Df Sum of Sq      F    Pr(>F)    
1    198 6.0417                                  
2    196 5.1532  2   0.88849 16.897 1.698e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
AIC(Q2model, Q2modelb)
[1] 77
         df       AIC
Q2model   3 -126.3521
Q2modelb  5 -154.1654
which(cooks.distance(Q2modelb) > (4/(200 - 4 - 1)))
[1] 78
 13  35  74 137 165 
 13  35  74 137 165 
plot(Q2modelb, which = 4, col = "orange")
[1] 79
names(which(cooks.distance(Q2modelb) > 1))
[1] 80
character(0)
Q2modelupdateb <- lm(incidents ~ training + empathy_mean + years, 
    data = cw[-c(13, 74, 137), ])
[1] 81
summary(Q2modelupdateb)
[1] 82

Call:
lm(formula = incidents ~ training + empathy_mean + years, data = cw[-c(13, 
    74, 137), ])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.29350 -0.11585 -0.00812  0.10001  0.40267 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.681518   0.035735  19.071  < 2e-16 ***
trainingTraining -0.153719   0.022279  -6.900 7.28e-11 ***
empathy_mean      0.029033   0.004656   6.236 2.77e-09 ***
years            -0.016244   0.003864  -4.204 4.01e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1552 on 193 degrees of freedom
Multiple R-squared:  0.2988,	Adjusted R-squared:  0.2879 
F-statistic: 27.41 on 3 and 193 DF,  p-value: 8.212e-15

summary(Q2modelb)
[1] 83

Call:
lm(formula = incidents ~ training + empathy_mean + years, data = cw)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.665721   0.036551  18.214  < 2e-16 ***
trainingTraining -0.152427   0.023166  -6.580 4.20e-10 ***
empathy_mean      0.025396   0.004735   5.363 2.29e-07 ***
years            -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

Q2modelb_coef <- summary(lm.beta(Q2modelb))
[1] 84
Q2modelupdateb_coef <- summary(lm.beta(Q2modelupdateb))
[1] 85
compare2 <- data.frame(round(Q2modelb_coef$coefficients[, 1], 
    5), round(Q2modelb_coef$coefficients[, 5], 5), round(Q2modelupdateb_coef$coefficients[, 
    1], 5), round(Q2modelupdateb_coef$coefficients[, 5], 5))
[1] 86
colnames(compare2) <- c("m2 coef", "m2 p-value", "m2a coef", 
    "m2a p-value")
[1] 87
compare2

                  m2 coef m2 p-value m2a coef m2a p-value
(Intercept)       0.66572    0.00000  0.68152       0e+00
trainingTraining -0.15243    0.00000 -0.15372       0e+00
empathy_mean      0.02540    0.00000  0.02903       0e+00
years            -0.01408    0.00037 -0.01624       4e-05


qqPlot(Q2modelb)
[1] 89
shapiro.test(Q2modelb$residuals)
[1] 90

	Shapiro-Wilk normality test

data:  Q2modelb$residuals
W = 0.97994, p-value = 0.005838

hist(Q2modelb$residuals, col = "pink", main = "Normality of errors")
[1] 91
residualPlots(Q2modelb)
[1] 92
ncvTest(Q2modelb)
[1] 93
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.0293323, Df = 1, p = 0.86401
crPlots(Q2modelb)
[1] 94
durbinWatsonTest(Q2modelb)
[1] 95
 lag Autocorrelation D-W Statistic p-value
   1      -0.1072849      2.199897   0.138
 Alternative hypothesis: rho != 0
vif(Q2modelb)
[1] 96
    training empathy_mean        years 
    1.020633     1.092467     1.085089 
summary(Q2modelb)
[1] 97

Call:
lm(formula = incidents ~ training + empathy_mean + years, data = cw)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.665721   0.036551  18.214  < 2e-16 ***
trainingTraining -0.152427   0.023166  -6.580 4.20e-10 ***
empathy_mean      0.025396   0.004735   5.363 2.29e-07 ***
years            -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

Q3model <- lm(incidents ~ feedback, data = cw)
[1] 98
summary(Q3model)
[1] 99

Call:
lm(formula = incidents ~ feedback, data = cw)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.45333 -0.12000  0.00333  0.13000  0.50333 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.41333    0.01765   23.41  < 2e-16 ***
feedbackFeedback  0.12333    0.02496    4.94 1.66e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1765 on 198 degrees of freedom
Multiple R-squared:  0.1097,	Adjusted R-squared:  0.1052 
F-statistic: 24.41 on 1 and 198 DF,  p-value: 1.656e-06

Q3modelb <- lm(incidents ~ feedback + empathy_mean + years, data = cw)
[1] 100
summary(Q3modelb)
[1] 101

Call:
lm(formula = incidents ~ feedback + empathy_mean + years, data = cw)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.512093   0.035846  14.286  < 2e-16 ***
feedbackFeedback  0.132132   0.023585   5.602 7.09e-08 ***
empathy_mean      0.023187   0.004829   4.802 3.11e-06 ***
years            -0.012689   0.003975  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

anova(Q3model, Q3modelb)
[1] 102
Analysis of Variance Table

Model 1: incidents ~ feedback
Model 2: incidents ~ feedback + empathy_mean + years
  Res.Df   RSS Df Sum of Sq    F    Pr(>F)    
1    198 6.170                                
2    196 5.423  2   0.74702 13.5 3.216e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
AIC(Q3model, Q3modelb)
[1] 103
         df       AIC
Q3model   3 -122.1483
Q3modelb  5 -143.9591
which(cooks.distance(Q3modelb) > (4/(200 - 4 - 1)))
[1] 104
 73  74  89 137 156 160 165 176 
 73  74  89 137 156 160 165 176 
plot(Q3modelb, which = 4, col = "orange")
[1] 105
names((which(cooks.distance(Q3modelb) > 1)))
[1] 106
character(0)
Q3modelbupdate <- lm(incidents ~ feedback + empathy_mean + years, 
    data = cw[-c(74, 89, 137), ])
[1] 107
summary(Q3modelbupdate)
[1] 108

Call:
lm(formula = incidents ~ feedback + empathy_mean + years, data = cw[-c(74, 
    89, 137), ])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.34740 -0.11326 -0.01073  0.11335  0.53413 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.522720   0.036999  14.128  < 2e-16 ***
feedbackFeedback  0.128900   0.023282   5.537 9.99e-08 ***
empathy_mean      0.024888   0.004950   5.028 1.13e-06 ***
years            -0.013583   0.004147  -3.276  0.00125 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1633 on 193 degrees of freedom
Multiple R-squared:  0.2282,	Adjusted R-squared:  0.2162 
F-statistic: 19.02 on 3 and 193 DF,  p-value: 7.541e-11

Q3modelb_coef <- summary(lm.beta(Q3modelb))
[1] 109
Q3modelbupdate_coef <- summary(lm.beta(Q3modelbupdate))
[1] 110
compare3 <- data.frame(round(Q3modelb_coef$coefficients[, 1], 
    5), round(Q3modelb_coef$coefficients[, 5], 5), round(Q3modelbupdate_coef$coefficients[, 
    1], 5), round(Q3modelbupdate_coef$coefficients[, 5], 5))
[1] 111
colnames(compare3) <- c("m3 coef", "m3 p-value", "m3b coef", 
    "m3b p-value")
[1] 112
compare3

                  m3 coef m3 p-value m3b coef m3b p-value
(Intercept)       0.51209    0.00000  0.52272     0.00000
feedbackFeedback  0.13213    0.00000  0.12890     0.00000
empathy_mean      0.02319    0.00000  0.02489     0.00000
years            -0.01269    0.00165 -0.01358     0.00125


qqPlot(Q3modelb, main = "QQ Plot")
[1] 114
shapiro.test(Q3modelb$residuals)
[1] 115

	Shapiro-Wilk normality test

data:  Q3modelb$residuals
W = 0.98772, p-value = 0.08174

residualPlots(Q3modelb)
[1] 116
ncvTest(Q3modelb)
[1] 117
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.01731234, Df = 1, p = 0.89532
crPlots(Q3modelb)
[1] 118
durbinWatsonTest(Q3modelb)
[1] 119
 lag Autocorrelation D-W Statistic p-value
   1       0.2738264      1.444081       0
 Alternative hypothesis: rho != 0
vif(Q3modelb)
[1] 120
    feedback empathy_mean        years 
    1.005211     1.079397     1.077467 
summary(Q3modelb)
[1] 121

Call:
lm(formula = incidents ~ feedback + empathy_mean + years, data = cw)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.512093   0.035846  14.286  < 2e-16 ***
feedbackFeedback  0.132132   0.023585   5.602 7.09e-08 ***
empathy_mean      0.023187   0.004829   4.802 3.11e-06 ***
years            -0.012689   0.003975  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

summary(Q2modelb)
[1] 122

Call:
lm(formula = incidents ~ training + empathy_mean + years, data = cw)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.665721   0.036551  18.214  < 2e-16 ***
trainingTraining -0.152427   0.023166  -6.580 4.20e-10 ***
empathy_mean      0.025396   0.004735   5.363 2.29e-07 ***
years            -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

summary(Q3modelb)
[1] 123

Call:
lm(formula = incidents ~ feedback + empathy_mean + years, data = cw)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35580 -0.11148 -0.01097  0.11092  0.53552 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.512093   0.035846  14.286  < 2e-16 ***
feedbackFeedback  0.132132   0.023585   5.602 7.09e-08 ***
empathy_mean      0.023187   0.004829   4.802 3.11e-06 ***
years            -0.012689   0.003975  -3.192  0.00165 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1663 on 196 degrees of freedom
Multiple R-squared:  0.2175,	Adjusted R-squared:  0.2055 
F-statistic: 18.16 on 3 and 196 DF,  p-value: 1.933e-10

effectsize_training <- sqrt(0.2565)
[1] 124
effectsize_Feedback <- sqrt(0.2175)
[1] 125
table(effectsize_training, effectsize_Feedback)
[1] 126
                   effectsize_Feedback
effectsize_training 0.466368952654441
  0.506458290484024                 1
contrasts(cw$training) <- contr.treatment(2, base = 1)
[1] 127
contrasts(cw$feedback) <- contr.treatment(2, base = 1)
[1] 128
Q5intmodel <- lm(incidents ~ training * feedback, data = cw)
[1] 129
summary(Q5intmodel)
[1] 130

Call:
lm(formula = incidents ~ training * feedback, data = cw)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40000 -0.10500  0.00000  0.08333  0.43333 

Coefficients:
                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)          0.49333    0.02314  21.323  < 2e-16 ***
training2           -0.16000    0.03272  -4.890 2.09e-06 ***
feedback2            0.09667    0.03272   2.954  0.00352 ** 
training2:feedback2  0.05333    0.04627   1.153  0.25047    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1636 on 196 degrees of freedom
Multiple R-squared:  0.2431,	Adjusted R-squared:  0.2315 
F-statistic: 20.99 on 3 and 196 DF,  p-value: 7.827e-12

Q5intmodelb <- lm(incidents ~ training * feedback + years + empathy_mean, 
    data = cw)
[1] 131
summary(Q5intmodelb)
[1] 132

Call:
lm(formula = incidents ~ training * feedback + years + empathy_mean, 
    data = cw)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30367 -0.10365 -0.00795  0.08806  0.44359 

Coefficients:
                     Estimate Std. Error t value Pr(>|t|)    
(Intercept)          0.637438   0.036309  17.556  < 2e-16 ***
training2           -0.203496   0.029874  -6.812 1.18e-10 ***
feedback2            0.085558   0.029299   2.920  0.00391 ** 
years               -0.015720   0.003518  -4.468 1.34e-05 ***
empathy_mean         0.028695   0.004328   6.630 3.25e-10 ***
training2:feedback2  0.097334   0.041840   2.326  0.02103 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1462 on 194 degrees of freedom
Multiple R-squared:  0.4015,	Adjusted R-squared:  0.386 
F-statistic: 26.02 on 5 and 194 DF,  p-value: < 2.2e-16

anova(Q5intmodel, Q5intmodelb)
[1] 133
Analysis of Variance Table

Model 1: incidents ~ training * feedback
Model 2: incidents ~ training * feedback + years + empathy_mean
  Res.Df    RSS Df Sum of Sq     F    Pr(>F)    
1    196 5.2456                                 
2    194 4.1482  2    1.0974 25.66 1.296e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
AIC(Q5intmodel, Q5intmodelb)
[1] 134
            df       AIC
Q5intmodel   5 -150.6118
Q5intmodelb  7 -193.5529
which(cooks.distance(Q5intmodelb) > (4/(200 - 4 - 1)))
[1] 135
 13  73  74  89 117 137 160 165 176 
 13  73  74  89 117 137 160 165 176 
plot(Q5intmodelb, which = 4, col = "orange")
[1] 136
Q5intmodelupdate <- lm(incidents ~ training * feedback + years + 
    empathy_mean, data = cw[-c(13, 137, 176), ])
[1] 137
summary(Q5intmodelb)
[1] 138

Call:
lm(formula = incidents ~ training * feedback + years + empathy_mean, 
    data = cw)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30367 -0.10365 -0.00795  0.08806  0.44359 

Coefficients:
                     Estimate Std. Error t value Pr(>|t|)    
(Intercept)          0.637438   0.036309  17.556  < 2e-16 ***
training2           -0.203496   0.029874  -6.812 1.18e-10 ***
feedback2            0.085558   0.029299   2.920  0.00391 ** 
years               -0.015720   0.003518  -4.468 1.34e-05 ***
empathy_mean         0.028695   0.004328   6.630 3.25e-10 ***
training2:feedback2  0.097334   0.041840   2.326  0.02103 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1462 on 194 degrees of freedom
Multiple R-squared:  0.4015,	Adjusted R-squared:  0.386 
F-statistic: 26.02 on 5 and 194 DF,  p-value: < 2.2e-16

summary(Q5intmodelupdate)
[1] 139

Call:
lm(formula = incidents ~ training * feedback + years + empathy_mean, 
    data = cw[-c(13, 137, 176), ])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.29641 -0.09999 -0.00384  0.09683  0.33452 

Coefficients:
                     Estimate Std. Error t value Pr(>|t|)    
(Intercept)          0.646933   0.035414  18.268  < 2e-16 ***
training2           -0.197969   0.028484  -6.950 5.60e-11 ***
feedback2            0.087979   0.028093   3.132  0.00201 ** 
years               -0.017844   0.003468  -5.146 6.58e-07 ***
empathy_mean         0.030659   0.004183   7.330 6.34e-12 ***
training2:feedback2  0.088478   0.040074   2.208  0.02845 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1386 on 191 degrees of freedom
Multiple R-squared:  0.4376,	Adjusted R-squared:  0.4228 
F-statistic: 29.72 on 5 and 191 DF,  p-value: < 2.2e-16

Q5intmodelb_coef <- summary(lm.beta(Q5intmodelb))
[1] 140
Q5modelupdate_coef <- summary(lm.beta(Q5intmodelupdate))
[1] 141
compare4 <- data.frame(round(Q5intmodelb_coef$coefficients[, 
    1], 5), round(Q5intmodelb_coef$coefficients[, 5], 5), round(Q5modelupdate_coef$coefficients[, 
    1], 5), round(Q5modelupdate_coef$coefficients[, 5], 5))
[1] 142
colnames(compare4) <- c("m4 coef", "m4 p-value", "m4b coef", 
    "m4b p-value")
[1] 143
compare4

                     m4 coef m4 p-value m4b coef m4b p-value
(Intercept)          0.63744    0.00000  0.64693     0.00000
training2           -0.20350    0.00000 -0.19797     0.00000
feedback2            0.08556    0.00391  0.08798     0.00201
years               -0.01572    0.00001 -0.01784     0.00000
empathy_mean         0.02869    0.00000  0.03066     0.00000
training2:feedback2  0.09733    0.02103  0.08848     0.02845


qqPlot(Q5intmodelb, main = "QQ Plot")
[1] 145
shapiro.test(Q5intmodelb$residuals)
[1] 146

	Shapiro-Wilk normality test

data:  Q5intmodelb$residuals
W = 0.98794, p-value = 0.08817

residualPlots(Q5intmodelb)
[1] 147
ncvTest(Q5intmodelb)
[1] 148
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 4.398557, Df = 1, p = 0.035969
durbinWatsonTest(Q5intmodelb)
[1] 149
 lag Autocorrelation D-W Statistic p-value
   1      0.09456969      1.801048   0.218
 Alternative hypothesis: rho != 0
vif(Q5intmodelb)
[1] 150
         training          feedback             years      empathy_mean training:feedback 
         2.086826          2.007327          1.092150          1.122147          3.070068 
cat_plot(Q5intmodelb, pred = training, modx = feedback, plot.points = FALSE, 
    x.label = "Amount of Training", y.label = "No. of Incidents", 
    legend.main = "Feedback", main = "Interaction")
[1] 151
summary(Q5intmodelb)
[1] 152

Call:
lm(formula = incidents ~ training * feedback + years + empathy_mean, 
    data = cw)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.30367 -0.10365 -0.00795  0.08806  0.44359 

Coefficients:
                     Estimate Std. Error t value Pr(>|t|)    
(Intercept)          0.637438   0.036309  17.556  < 2e-16 ***
training2           -0.203496   0.029874  -6.812 1.18e-10 ***
feedback2            0.085558   0.029299   2.920  0.00391 ** 
years               -0.015720   0.003518  -4.468 1.34e-05 ***
empathy_mean         0.028695   0.004328   6.630 3.25e-10 ***
training2:feedback2  0.097334   0.041840   2.326  0.02103 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1462 on 194 degrees of freedom
Multiple R-squared:  0.4015,	Adjusted R-squared:  0.386 
F-statistic: 26.02 on 5 and 194 DF,  p-value: < 2.2e-16

