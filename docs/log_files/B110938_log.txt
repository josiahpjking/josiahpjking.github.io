

	####### B110938 R script #######

library(psych, quietly = T)
[1] 1
[1] "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     
library(CARS, quietly = T)
[1] 2
 [1] "CARS"      "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[10] "base"     
library(car, quietly = T)
[1] 3
 [1] "car"       "carData"   "CARS"      "psych"     "readr"     "stats"     "graphics"  "grDevices" "utils"    
[10] "datasets"  "methods"   "base"     
library(gdata, quietly = T)
[1] 4
 [1] "gdata"     "car"       "carData"   "CARS"      "psych"     "readr"     "stats"     "graphics"  "grDevices"
[10] "utils"     "datasets"  "methods"   "base"     
library(interactions, quietly = T)
[1] 5
 [1] "interactions" "gdata"        "car"          "carData"      "CARS"         "psych"        "readr"       
 [8] "stats"        "graphics"     "grDevices"    "utils"        "datasets"     "methods"      "base"        
library(sandwich, quietly = T)
[1] 6
 [1] "sandwich"     "interactions" "gdata"        "car"          "carData"      "CARS"         "psych"       
 [8] "readr"        "stats"        "graphics"     "grDevices"    "utils"        "datasets"     "methods"     
[15] "base"        
data <- read.csv("../RMS2_report_1920.csv")
[1] 7
data

  subject incidents training feedback empathy years
1       1 0.6666667        2        2      11    10
2       2 0.3333333        2        1      10     7
3       3 0.3333333        2        2      10     5
4       4 0.4166667        2        1       9     7
5       5 0.5000000        2        2      12    12
6       6 0.2500000        2        1      11    10
7       7 0.8333333        2        2      13     8
8       8 0.4166667        2        1      14    10
 [ reached 'max' / getOption("max.print") -- omitted 192 rows ]


describe(data)
[1] 9
          vars   n   mean    sd median trimmed   mad  min    max  range skew kurtosis   se
subject      1 200 100.50 57.88 100.50  100.50 74.13 1.00 200.00 199.00 0.00    -1.22 4.09
incidents    2 200   0.48  0.19   0.42    0.47  0.12 0.08   0.92   0.83 0.32    -0.31 0.01
training     3 200   1.50  0.50   1.50    1.50  0.74 1.00   2.00   1.00 0.00    -2.01 0.04
 [ reached 'max' / getOption("max.print") -- omitted 3 rows ]
str(data)
[1] 10
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : int  2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : int  2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : int  11 10 10 9 12 11 13 14 12 12 ...
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
data$empathy <- scale(data$empathy)
[1] 11
data$training <- as.factor(data$training)
[1] 12
data$feedback <- as.factor(data$feedback)
[1] 13
str(data)
[1] 14
'data.frame':	200 obs. of  6 variables:
 $ subject  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ incidents: num  0.667 0.333 0.333 0.417 0.5 ...
 $ training : Factor w/ 2 levels "1","2": 2 2 2 2 2 2 2 2 2 2 ...
 $ feedback : Factor w/ 2 levels "1","2": 2 1 2 1 2 1 2 1 2 1 ...
 $ empathy  : num [1:200, 1] 0.325 -0.069 -0.069 -0.463 0.719 ...
  ..- attr(*, "scaled:center")= num 10.2
  ..- attr(*, "scaled:scale")= num 2.54
 $ years    : int  10 7 5 7 12 10 8 10 7 9 ...
NULL
summary(data$training)
[1] 15
  1   2 
100 100 
data$training <- factor(data$training, labels = c("No Training", 
    "Training"))
[1] 16
str(data$training)
[1] 17
 Factor w/ 2 levels "No Training",..: 2 2 2 2 2 2 2 2 2 2 ...
NULL
summary(data$training)
[1] 18
No Training    Training 
        100         100 
data$feedback <- factor(data$feedback, labels = c("No Feedback", 
    "Feedback"))
[1] 19
str(data$feedback)
[1] 20
 Factor w/ 2 levels "No Feedback",..: 2 1 2 1 2 1 2 1 2 1 ...
NULL
summary(data$feedback)
[1] 21
No Feedback    Feedback 
        100         100 
lmall <- lm(incidents ~ training + years + feedback + empathy, 
    data = data)
[1] 22
summary(lmall)
[1] 23

Call:
lm(formula = incidents ~ training + years + feedback + empathy, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.31626 -0.10096 -0.00949  0.09165  0.46650 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.608620   0.034515  17.634  < 2e-16 ***
trainingTraining -0.153824   0.021128  -7.281 7.98e-12 ***
years            -0.015199   0.003551  -4.281 2.92e-05 ***
feedbackFeedback  0.133715   0.020968   6.377 1.28e-09 ***
empathy           0.068984   0.010980   6.283 2.12e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1479 on 195 degrees of freedom
Multiple R-squared:  0.3848,	Adjusted R-squared:  0.3721 
F-statistic: 30.49 on 4 and 195 DF,  p-value: < 2.2e-16

cooks <- cooks.distance(lmall)
[1] 24
cooks

           1            2            3            4            5            6            7            8            9 
6.993859e-03 1.555403e-05 5.799632e-03 1.617538e-03 4.501393e-04 9.394531e-04 1.701849e-02 2.323864e-05 1.794505e-04 
          10           11           12           13           14           15           16           17           18 
6.452812e-03 9.226001e-03 1.441990e-03 3.406085e-02 1.733781e-03 2.775397e-03 4.639622e-03 1.201860e-02 4.588141e-05 
          19           20           21           22           23           24           25           26           27 
1.118606e-02 5.619500e-03 1.221461e-02 1.649083e-04 2.942409e-04 5.725458e-03 1.190188e-03 4.990018e-03 3.193301e-06 
          28           29           30           31           32           33           34           35           36 
6.978812e-04 9.390332e-04 9.542631e-03 1.470601e-03 1.533623e-03 4.176873e-03 3.841762e-04 2.346537e-02 3.329237e-04 
          37           38           39           40           41           42           43           44           45 
2.407395e-04 5.268522e-03 8.959685e-04 4.072166e-03 1.436492e-02 3.841762e-04 2.037944e-03 9.393481e-04 2.250966e-05 
          46           47           48           49           50 
8.904401e-04 7.035440e-04 5.419468e-03 2.025109e-04 5.615437e-03 
 [ reached getOption("max.print") -- omitted 150 entries ]


names(which(cooks > 4/195))
[1] 26
 [1] "13"  "35"  "74"  "117" "131" "137" "141" "156" "160" "176"
plot(lmall, which = 4)
[1] 27
lmclean <- lm(incidents ~ years + training + feedback + empathy, 
    data = data[-c(137, 176, 13), ])
[1] 28
summary(lmclean)
[1] 29

Call:
lm(formula = incidents ~ years + training + feedback + empathy, 
    data = data[-c(137, 176, 13), ])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.31479 -0.10102 -0.00300  0.09041  0.35676 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.619020   0.033412  18.527  < 2e-16 ***
years            -0.017169   0.003489  -4.921 1.85e-06 ***
trainingTraining -0.153003   0.020113  -7.607 1.22e-12 ***
feedbackFeedback  0.132020   0.019981   6.607 3.76e-10 ***
empathy           0.073938   0.010573   6.993 4.34e-11 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.14 on 192 degrees of freedom
Multiple R-squared:  0.4232,	Adjusted R-squared:  0.4112 
F-statistic: 35.22 on 4 and 192 DF,  p-value: < 2.2e-16

hats <- hatvalues(lmall)
[1] 30
head(hats, 20)
[1] 31
         1          2          3          4          5          6          7          8          9         10 
0.01712163 0.01549576 0.02001541 0.01701625 0.02394476 0.01751286 0.02125280 0.02488761 0.01874782 0.01688360 
        11         12         13         14         15         16         17         18         19         20 
0.01833535 0.02484967 0.01655041 0.01759398 0.01655041 0.04465575 0.03320873 0.01701625 0.02001541 0.02623618 
which(hats > 2 * mean(hats))
[1] 32
 61  88  89  92 137 141 154 175 200 
 61  88  89  92 137 141 154 175 200 
lmremoval <- lm(empathy ~ years, data = data[-c(13, 61, 88, 89, 
    92, 137, 141, 154, 175, 176, 200), ])
[1] 33
summary(lmremoval)
[1] 34

Call:
lm(formula = empathy ~ years, data = data[-c(13, 61, 88, 89, 
    92, 137, 141, 154, 175, 176, 200), ])

Residuals:
     Min       1Q   Median       3Q      Max 
-1.95532 -0.56245 -0.00985  0.54146  2.22330 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) -0.76888    0.19624  -3.918 0.000125 ***
years        0.10520    0.02298   4.578 8.53e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.8551 on 187 degrees of freedom
Multiple R-squared:  0.1008,	Adjusted R-squared:  0.09599 
F-statistic: 20.96 on 1 and 187 DF,  p-value: 8.532e-06

m1 <- lm(empathy ~ years, data = data)
[1] 35
summary(m1)
[1] 36

Call:
lm(formula = empathy ~ years, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.97192 -0.59754  0.02792  0.64474  2.30713 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) -0.69717    0.19347  -3.603 0.000397 ***
years        0.08575    0.02226   3.852 0.000158 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.9669 on 198 degrees of freedom
Multiple R-squared:  0.06972,	Adjusted R-squared:  0.06502 
F-statistic: 14.84 on 1 and 198 DF,  p-value: 0.0001582

plot(data$empathy ~ data$years, xlab = "years", ylab = "empathy", 
    main = "Empathy against experience")
[1] 37
abline(lm(empathy ~ years, data = data))
[1] 38
lines(lowess(data$years, data$empathy))
[1] 39
years2 <- data$years^2
[1] 40
quadmodel <- lm(data$empathy ~ data$years + years2)
[1] 41
summary(quadmodel)
[1] 42

Call:
lm(formula = data$empathy ~ data$years + years2)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.77645 -0.55225 -0.03293  0.46143  2.38949 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept) -3.542969   0.312115  -11.35   <2e-16 ***
data$years   0.815324   0.071676   11.38   <2e-16 ***
years2      -0.040853   0.003887  -10.51   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.776 on 197 degrees of freedom
Multiple R-squared:  0.404,	Adjusted R-squared:  0.3979 
F-statistic: 66.75 on 2 and 197 DF,  p-value: < 2.2e-16

qqPlot(quadmodel)
[1] 43
shapiro.test(quadmodel$residuals)
[1] 44

	Shapiro-Wilk normality test

data:  quadmodel$residuals
W = 0.9941, p-value = 0.6155

ncvTest(quadmodel)
[1] 45
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.5107658, Df = 1, p = 0.47481
residualPlot(quadmodel)
[1] 46
durbinWatsonTest(quadmodel)
[1] 47
 lag Autocorrelation D-W Statistic p-value
   1      0.01288905      1.973855   0.912
 Alternative hypothesis: rho != 0
vif(quadmodel)
[1] 48
data$years     years2 
   16.0978    16.0978 
plot(data$empathy ~ data$years, main = "Relationship Between Empathy and Years", 
    xlab = "Years", ylab = "Empathy")
[1] 49
points(data$years, fitted(quadmodel), col = "red", pch = 20)
[1] 50
NULL
lines(sort(data$years), fitted(quadmodel)[order(data$years)], 
    col = "red", type = "b")
[1] 51
m2 <- lm(incidents ~ training + empathy + years, data = data)
[1] 52
m2


Call:
lm(formula = incidents ~ training + empathy + years, data = data)

Coefficients:
     (Intercept)  trainingTraining           empathy             years  
         0.66572          -0.15243           0.06443          -0.01408  



summary(m2)
[1] 54

Call:
lm(formula = incidents ~ training + empathy + years, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35648 -0.12270 -0.01474  0.10105  0.53180 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.665721   0.036551  18.214  < 2e-16 ***
trainingTraining -0.152427   0.023166  -6.580 4.20e-10 ***
empathy           0.064430   0.012014   5.363 2.29e-07 ***
years            -0.014085   0.003889  -3.622 0.000372 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1621 on 196 degrees of freedom
Multiple R-squared:  0.2565,	Adjusted R-squared:  0.2451 
F-statistic: 22.53 on 3 and 196 DF,  p-value: 1.408e-12

hist(m2$residuals)
[1] 55
shapiro.test(m2$residuals)
[1] 56

	Shapiro-Wilk normality test

data:  m2$residuals
W = 0.97994, p-value = 0.005838

log.incidents <- log(data$incidents + (-1 * min(data$incidents) + 
    1))
[1] 57
summary(log.incidents)
[1] 58
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0000  0.2231  0.2877  0.3216  0.4055  0.6061 
m3 <- lm(log.incidents ~ training + empathy + years, data = data)
[1] 59
summary(m3)
[1] 60

Call:
lm(formula = log.incidents ~ training + empathy + years, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.27676 -0.08678 -0.00271  0.07438  0.35035 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.460852   0.026028  17.706  < 2e-16 ***
trainingTraining -0.111288   0.016497  -6.746 1.67e-10 ***
empathy           0.047061   0.008555   5.501 1.17e-07 ***
years            -0.010283   0.002769  -3.713 0.000266 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1155 on 196 degrees of freedom
Multiple R-squared:  0.2661,	Adjusted R-squared:  0.2549 
F-statistic: 23.69 on 3 and 196 DF,  p-value: 3.963e-13

shapiro.test(m3$residuals)
[1] 61

	Shapiro-Wilk normality test

data:  m3$residuals
W = 0.9905, p-value = 0.2109

ncvTest(m3)
[1] 62
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 1.036059, Df = 1, p = 0.30874
residualPlot(m3)
[1] 63
durbinWatsonTest(m3)
[1] 64
 lag Autocorrelation D-W Statistic p-value
   1       -0.116516      2.217742   0.134
 Alternative hypothesis: rho != 0
vif(m3)
[1] 65
training  empathy    years 
1.020633 1.092467 1.085089 
crPlots(m3)
[1] 66
m4 <- lm(log.incidents ~ feedback + years + empathy, data = data)
[1] 67
summary(m4)
[1] 68

Call:
lm(formula = log.incidents ~ feedback + years + empathy, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.27663 -0.07576 -0.00237  0.08302  0.35261 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       0.349057   0.025597  13.637  < 2e-16 ***
feedbackFeedback  0.095615   0.016841   5.677 4.87e-08 ***
years            -0.009257   0.002839  -3.261  0.00131 ** 
empathy           0.042942   0.008748   4.909 1.92e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1188 on 196 degrees of freedom
Multiple R-squared:  0.2235,	Adjusted R-squared:  0.2116 
F-statistic:  18.8 on 3 and 196 DF,  p-value: 9.283e-11

qqPlot(m4)
[1] 69
hist(m4$residuals)
[1] 70
shapiro.test(m4$residuals)
[1] 71

	Shapiro-Wilk normality test

data:  m4$residuals
W = 0.99572, p-value = 0.8487

ncvTest(m4)
[1] 72
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.6746094, Df = 1, p = 0.41145
durbinWatsonTest(m4)
[1] 73
 lag Autocorrelation D-W Statistic p-value
   1       0.2794347      1.431864       0
 Alternative hypothesis: rho != 0
vif(m4)
[1] 74
feedback    years  empathy 
1.005211 1.077467 1.079397 
crPlots(m4)
[1] 75
BIC(m3, m4)
[1] 76
   df       BIC
m3  5 -273.4824
m4  5 -262.1757
m5 <- lm(log.incidents ~ training + feedback + training * feedback, 
    data = data)
[1] 77
summary(m5)
[1] 78

Call:
lm(formula = log.incidents ~ training + feedback + training * 
    feedback, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.32886 -0.07357  0.00614  0.07068  0.27727 

Coefficients:
                                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)                        0.33701    0.01649  20.442  < 2e-16 ***
trainingTraining                  -0.12001    0.02332  -5.147  6.4e-07 ***
feedbackFeedback                   0.06653    0.02332   2.853  0.00479 ** 
trainingTraining:feedbackFeedback  0.04534    0.03297   1.375  0.17072    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1166 on 196 degrees of freedom
Multiple R-squared:  0.252,	Adjusted R-squared:  0.2405 
F-statistic: 22.01 on 3 and 196 DF,  p-value: 2.515e-12

shapiro.test(m5$residuals)
[1] 79

	Shapiro-Wilk normality test

data:  m5$residuals
W = 0.98649, p-value = 0.05345

qqPlot(m5)
[1] 80
residualPlot(m5)
[1] 81
ncvTest(m5)
[1] 82
Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 0.04011943, Df = 1, p = 0.84125
vif(m5)
[1] 83
         training          feedback training:feedback 
                2                 2                 3 
durbinWatsonTest(m5)
[1] 84
 lag Autocorrelation D-W Statistic p-value
   1       0.1133615      1.766819   0.104
 Alternative hypothesis: rho != 0
interaction.plot(data$training, data$feedback, log.incidents, 
    xlab = "Training", ylab = "Incidents", main = "Interaction plot")
[1] 85
